Kind: captions
Language: en
okay we're live
okay we're live
here there's a lot of stuff I want to
here there's a lot of stuff I want to
get done
get done
today um we're going to probably do some
today um we're going to probably do some
stuff on this rocket project over the
stuff on this rocket project over the
weekend
here let me see if we did
here let me see if we did
anything kind
anything kind
of kind of I have to fix this later um
of kind of I have to fix this later um
there are a few things I want to do
there are a few things I want to do
today the first big one is there's a
today the first big one is there's a
limitation with the new native API that
limitation with the new native API that
I would like to fix
I would like to fix
potentially um but I also want to
potentially um but I also want to
get I want to test a couple potential
get I want to test a couple potential
bugs that uh people have reporting some
bugs that uh people have reporting some
things will re with and I want to see if
things will re with and I want to see if
we can get uh some of the environments
we can get uh some of the environments
really polished and training properly
really polished and training properly
today
today
me take a quick look for
PRS yeah okay this is I've already
PRS yeah okay this is I've already
discussed these with contributors um you
discussed these with contributors um you
don't see it here but it's a lot of the
don't see it here but it's a lot of the
discussions are in
Discord okay so I think what we're going
Discord okay so I think what we're going
to do is we're going to just start with
to do is we're going to just start with
um the Moa for a bit
let's commit all this stuff up I don't
let's commit all this stuff up I don't
know what we're going to do with this
know what we're going to do with this
build
build
file um I think we'll just for now
yeah we'll do this for
yeah we'll do this for
now and then I think we'll just go over
now and then I think we'll just go over
to uh
to uh
MOA and we'll see if we can get some
MOA and we'll see if we can get some
stuff done there
all
right whole bunch of new code gets
right whole bunch of new code gets
pulled
in a lot of stuff
the first thing I'm going to want to
the first thing I'm going to want to
probably test is multi- discreete
probably test is multi- discreete
actions whether these work as expected
the heck
uh what's wrong
here rib
oh it's because it's a Sim link that's
oh it's because it's a Sim link that's
fine so I changed it essentially so that
fine so I changed it essentially so that
um if RB isn't installs it'll install it
um if RB isn't installs it'll install it
for you and I had something with an old
for you and I had something with an old
outdated
outdated
name I'm hopeful we can actually make
name I'm hopeful we can actually make
some good progress on the mob today I
some good progress on the mob today I
really just want to get puffer to the
really just want to get puffer to the
point where I have reasonable policies
point where I have reasonable policies
trained for all these various different
trained for all these various different
environments um so that like ultra high
environments um so that like ultra high
perf RL really just starts to feel
perf RL really just starts to feel
stable across a variety of domains I
stable across a variety of domains I
think I need to do more work on that
think I need to do more work on that
side
okay so if if we just train
squared Why is this
importing rocket
Lander uh
one of the downsides the new
one of the downsides the new
setup okay so this is squared squared is
setup okay so this is squared squared is
a very simple sanity test environment
a very simple sanity test environment
that trains in
that trains in
seconds this seems to work
multi
multi
agent
basis so I made this specifically to
basis so I made this specifically to
test
test
for weird screwups
no attribute hidden size
Dev Branch I'm allowed to have stuff
Dev Branch I'm allowed to have stuff
break
break
occasionally okay so this space m does
occasionally okay so this space m does
work on
work on
dev but I thought didn't bet mess with
dev but I thought didn't bet mess with
this
yeah
yeah
H why did I think B messed with this
H why did I think B messed with this
this looks
fine just watch your PhD this this video
fine just watch your PhD this this video
on YouTube very interesting congrats on
on YouTube very interesting congrats on
completing it than thank
completing it than thank
you I made uh recently if you're
you I made uh recently if you're
interested in just a general overview of
interested in just a general overview of
RL in a way that is somewhat
RL in a way that is somewhat
entertaining and not like math heavy or
entertaining and not like math heavy or
anything I suggest the iceberg video on
anything I suggest the iceberg video on
my channel I put quite a bit of effort
my channel I put quite a bit of effort
into making that one
into making that one
good it didn't catch on as much as my
good it didn't catch on as much as my
thesis video but the production value I
thesis video but the production value I
think is a bit higher
and thanks for your
interest I mean we're really here trying
interest I mean we're really here trying
to now that I've graduated the really
to now that I've graduated the really
the goal is to just revamp the entire
the goal is to just revamp the entire
field um I'm working on that full time
field um I'm working on that full time
and it's gone very very well so far
things are like 100 to a th times faster
things are like 100 to a th times faster
than they were 6 months ago across the
field okay so this thing seems
fine what do we have in Mobile
200 million
steps I think that this Freez is the
steps I think that this Freez is the
problem right
340k steps per
second environment very
second environment very
slow it's a
problem but does it get stuck
we can see
that it appears to be
that it appears to be
training I can see just the summary
training I can see just the summary
here we see leveling up we see skill
here we see leveling up we see skill
usage we see Towers being taken looks
usage we see Towers being taken looks
like radiant is winning
let's see what this looks
like okay so we
like okay so we
have a ton of
matx isn't there a sorting of this
okay so we do have all of
okay so we do have all of
these we have all these
these we have all these
metrics I don't know if rewards are
metrics I don't know if rewards are
going through or
not doesn't look like rewards are being
not doesn't look like rewards are being
computed entropy
computed entropy
variance we have good monitoring
variance we have good monitoring
here looks
like some form of Elo over
like some form of Elo over
time would be good it's expensive to
time would be good it's expensive to
compute as the
problem we have the infer to do
it can always do it post
talk okay though this does look stable
talk okay though this does look stable
which is
nice the environment is too slow though
nice the environment is too slow though
so
so
something something must have happened
something something must have happened
with this because this should be
with this because this should be
running much much
running much much
faster so let's get this policy see what
faster so let's get this policy see what
it
does and then we will go from there yeah
does and then we will go from there yeah
I think that's a good plan for today um
I think that's a good plan for today um
meanwhile we have new breakout
meanwhile we have new breakout
and let me ask Noah
and let me ask Noah
where is breakout and
this
e for
[Music]
okay so entropy is all the way down here
okay so entropy is all the way down here
this is probably not the best the Run
this is probably not the best the Run
doesn't look terribly unstable
doesn't look terribly unstable
though let's
see and both sides are taking
see and both sides are taking
Towers it's not completely
Towers it's not completely
one-sided uh for whatever reason dire is
one-sided uh for whatever reason dire is
dire has a huge level
dire has a huge level
Advantage but radiant is
winning that's
odd let's look at kills
odd let's look at kills
maybe I mean the cool thing with all
maybe I mean the cool thing with all
these stats right is
we
get Le
get Le
panels
so you can see that just on the
so you can see that just on the
different teams these they're wildly
different teams these they're wildly
different uh they are
different uh they are
all going
up Carrie doesn't seem to do very
up Carrie doesn't seem to do very
well the is
op this is almost done training though
op this is almost done training though
so we'll have a little model to play
so we'll have a little model to play
with we'll see if it does anything
reasonable let's get prepared for that
reasonable let's get prepared for that
actually
I think I have to do V native as well
I think I have to do V native as well
hold
on yeah the new V mode is
on yeah the new V mode is
native okay so here is a random
policy and can I take
policy and can I take
over uh I cannot take over I don't
think no but here we have the
think no but here we have the
Bots playing randomly
oh this is funny Escape doesn't quit the
oh this is funny Escape doesn't quit the
whole
thing hello
[Laughter]
bet bet is our resident puffer
bet bet is our resident puffer
Advertiser though do star the repository
Advertiser though do star the repository
it helps us out a
lot fuing wasting our El
I did a little bit of puffer advertising
I did a little bit of puffer advertising
this morning
this morning
but this uh this has done decently well
but this uh this has done decently well
for a
morning okay so it's running
morning okay so it's running
evals yeah 1:41 in like three hours
evals yeah 1:41 in like three hours
though I think I should get a
though I think I should get a
that one should be doing quite well for
that one should be doing quite well for
us we should get like an extra we'll
us we should get like an extra we'll
probably get a good 100 followers off of
probably get a good 100 followers off of
a post like
that okay so what happened
that okay so what happened
here
here
Len okay so I have to change the script
Len okay so I have to change the script
a little bit not a big deal though
log I have to copy this manually that's
log I have to copy this manually that's
fine
so
CP
box
for
e e
here we
here we
go for
okay so
here know why this guy's stuck
something feels very wrong with evals
here the fact that they're stuck on the
here the fact that they're stuck on the
walls like
this like okay this guy got
this like okay this guy got
through he's ghosting through walls
through he's ghosting through walls
apparently
is he ghosting through all the walls or
is he ghosting through all the walls or
just some
walls does he live
walls does he live
this if he doesn't take a tower shot I
this if he doesn't take a tower shot I
think he dies here
it's weird cuz
it's weird cuz
like some of the things done are
reasonable why are the rest of these
reasonable why are the rest of these
guys
guys
stuck like it makes no sense right
it makes no sense that they would just
it makes no sense that they would just
go like this and get
stuck I to check some
[Music]
things let's just sanity check a couple
things let's just sanity check a couple
couple environment side things
first these are fine
first these are fine
multi discreete
right then presumably I was smart enough
right then presumably I was smart enough
to do this
correctly 10 *
correctly 10 *
I 10 * I +
1 is correct
1 is correct
10 agents per
environment
right I don't see anything weird there
[Music]
why would why would one agent do okay
why would why would one agent do okay
and the rest of them get
stuck it's very weird
What observations am I
giving
255 by 255
255 by 255
what about the
mobet extra map
mobet extra map
features divide by
features divide by
255 flat
255 flat
features get divided by
features get divided by
255 for
I'm not confident that this is a data
I'm not confident that this is a data
problem and I'm not confident that this
problem and I'm not confident that this
isn't just a data
isn't just a data
problem that's the thing that's
problem that's the thing that's
obnoxious
obnoxious
here let me see
something how insane are these
parameters
H the only one of these that I can see
H the only one of these that I can see
that is completely insane
that is completely insane
is the uh value function clipping
is the uh value function clipping
coefficient and we've seen that happen
coefficient and we've seen that happen
across a variety of
environments what happens to the value
environments what happens to the value
function well what happens to the value
function I don't believe
that it could just be that this thing
that it could just be that this thing
fails
right value loss is not
exploded entropy collapse is pretty bad
just guess some hyper
parameters well actually hold
on they are getting
on they are getting
stuck which corresponds to
me just try something
we're going to try something a little
YOLO 50
Star Puffer
Star Puffer
indeed do we get any stars actually off
indeed do we get any stars actually off
of the latest
of the latest
um latest post
yet
11:24 I need to keep this trajectory
11:24 I need to keep this trajectory
going straight up though like before I
going straight up though like before I
need to keep promoting it
need to keep promoting it
really helps us to have uh the
growth that's just I need to tweet this
growth that's just I need to tweet this
stuff
more all right well what we're going to
more all right well what we're going to
do is we're going to try
do is we're going to try
this uh what do we have for batch
sizes two M's two workers
what if I do
this okay so immediately it's training
this okay so immediately it's training
way faster with the uh multiprocessing
on does it learn anything
on does it learn anything
though uhoh is it
though uhoh is it
stuck huh it's
stuck huh it's
stuck with multiprocessing on it's
stuck be back later maybe you can help
stuck be back later maybe you can help
me fix and d i
sure I get done with
sure I get done with
this okay so this should not be
this okay so this should not be
stuck why would it ever be stuck because
stuck why would it ever be stuck because
of
of
multiprocessing how does this make
sense I remember this actually being an
sense I remember this actually being an
issue and I'm trying to think why this
issue and I'm trying to think why this
would ever make sense
why would it ever get stuck in stuck
why would it ever get stuck in stuck
with
multiprocessing do Native for
multiprocessing do Native for
now and we'll look at this
we'll have to do some work on
we'll have to do some work on
that welcome
that welcome
folks I should probably put this thing
folks I should probably put this thing
that we're training up on the side so
that we're training up on the side so
people can see what we're
people can see what we're
doing
today this is a combination of looking
today this is a combination of looking
at the new API and trying to make sure
at the new API and trying to make sure
everything works as well as trying to
everything works as well as trying to
make this specific mend work
okay so this n
it's training any different from
before I want to get this up on the
plot okay
plot okay
so we have MOA before we have MOA after
so this is going to tell us actually
so this is going to tell us actually
learning
learning
progress uh
progress uh
we more towers are being taken
immediately level is
immediately level is
up do we have
up do we have
victories yeah we have some victories
victories yeah we have some victories
here so I think it's getting wins faster
here so I think it's getting wins faster
which which is meaning that it's going
which which is meaning that it's going
to be you're going to get this
to be you're going to get this
oscillatory
oscillatory
behavior um essentially I want to have a
behavior um essentially I want to have a
decently trained MOBA policy today I
decently trained MOBA policy today I
just want to have something that like
just want to have something that like
the Bots run at each other down mid at
the Bots run at each other down mid at
the very least you
the very least you
know we should be able to get that and
know we should be able to get that and
if we can't get that that's it's either
if we can't get that that's it's either
a data issue or some sort of infer issue
a data issue or some sort of infer issue
because as a task it should be very
because as a task it should be very
learnable
send a followup email while this is
send a followup email while this is
training this will be done in a couple
minutes just make sure
follow up
so
so
what I mean it's not surprising that
what I mean it's not surprising that
this would train way
this would train way
better I'm trying to think
better I'm trying to think
why we had the hyper parameters from
before is value loss okay
hi
welcome
welcome
H where are other
parameters also why do we
parameters also why do we
have nine visualize visualize
have nine visualize visualize
none and we do
this w b
if I ever get bored of doing
if I ever get bored of doing
reinforcement
reinforcement
learning and I want to get into more
learning and I want to get into more
General ml Ops I'm going to rewrite wand
General ml Ops I'm going to rewrite wand
B and C so that it's
fast it's so glitchy and slow
okay so this is sketchy um level kept
okay so this is sketchy um level kept
going up before but now in this run it
going up before but now in this run it
doesn't appear to be stable
maybe entropy is staying high in this
maybe entropy is staying high in this
run whereas before it was very quickly
crashed value
crashed value
loss not looking good
loss not looking good
which is
weird dire
Victory hold
Victory hold
on I think this is actually good
on I think this is actually good
because they stopped winning games after
because they stopped winning games after
this first point in training before so
this first point in training before so
probably this is what happened is that
probably this is what happened is that
they learned something and they
they learned something and they
unlearned stuff because the the Run
unlearned stuff because the the Run
wasn't stable whereas now the fact that
wasn't stable whereas now the fact that
this is oscillating around means that
this is oscillating around means that
games are starting and stopping so this
games are starting and stopping so this
could actually be a good
thing
thing
level I don't know why it would go way
level I don't know why it would go way
back
back
down we'll have to
see oh you know what I can do in the
see oh you know what I can do in the
meantime I'm kind of curious for
what if we take an early
checkpoint so this is from the previous
checkpoint so this is from the previous
trained
run ah look at
this learns to glitch through through
terrain this guy is stuck
terrain this guy is stuck
here it's going to use its speed buff to
here it's going to use its speed buff to
glitch through the terrain
glitch through the terrain
more oh wait that's a tank that's a tank
more oh wait that's a tank that's a tank
engage that's a tank engage learned
engage that's a tank engage learned
right there
that's engaging
AOE okay so it's it started learning
AOE okay so it's it started learning
some stuff and then crashed and then
some stuff and then crashed and then
these guys aren't really doing it any
these guys aren't really doing it any
favors being stuck there like
that what about now
they should be learning to win more
they should be learning to win more
games faster
right I should be able to refresh
this oh yeah look at
this oh yeah look at
this games are actually being
this games are actually being
ended for
okay so now we have this
model here is our new model
oh look at
oh look at
this wait whoa whoa they're running at
this wait whoa whoa they're running at
each other down
mid let's see Tank's actually going to
go they run straight down mid
why do the dire team not do
anything why is dire team not do
anything why is dire team not do
anything
do I have something messed up with like
do I have something messed up with like
the action handling for these
guys I don't think I
do reward
handling mean you can learn
handling mean you can learn
policies well now they get
policies well now they get
stuck this one doesn't
it's very
weird how does Dyer ever win doing this
according to this it does
according to this it does
win and it wins some games
these guys aren't doing anything at
all were they doing anything earlier in
all were they doing anything earlier in
training
I mean kind of Meandering around
started farming a little
bit Yeah so it does look like they're
bit Yeah so it does look like they're
being controlled correctly learning is
being controlled correctly learning is
just doing something very weird
just doing something very weird
here for
what stats can we look
at well we're not logging
at well we're not logging
everything the way we would want to I
everything the way we would want to I
also I don't believe
also I don't believe
this like look it says it's using its
this like look it says it's using its
skills it's going up l
nearly usage
Q let's go look at our logging and the
Q let's go look at our logging and the
way we're handling logging I think that
way we're handling logging I think that
there is some stuff that we need to be
there is some stuff that we need to be
recording
correctly yeah cuz this is going up
correctly yeah cuz this is going up
infin
Ely we need to get we need to see um we
Ely we need to get we need to see um we
need to see this a bit
differently individual usage Q
we have to
we have to
reset what logs
here yeah
if do
reset oh well this is going to be weird
add
log okay so this is fine actually
let's try
this this should get us usage uh this
this this should get us usage uh this
should get us per game logs rather
should get us per game logs rather
than cross game
logs and then we're going to have to
logs and then we're going to have to
make these
make these
barer what happened
here oh this is a
player player log sure
now we should get more reasonable stats
now we should get more reasonable stats
out of
stuff we'll see whether that's the case
uh i' just
uh i' just
say have to run for a little bit
okay so I'll have to integrate this
okay so I'll have to integrate this
later this
cool okay you can already see that this
cool okay you can already see that this
is the curve is different just from this
log yeah so this what my hope it here is
log yeah so this what my hope it here is
that this is going to actually tell us
that this is going to actually tell us
um the problem with these
um the problem with these
curves well
either of these really make sense I
either of these really make sense I
don't know if either of these really
don't know if either of these really
make sense to be
honest according to this graph the agent
honest according to this graph the agent
that we were watching on the dire side
that we were watching on the dire side
should absolutely not just be sitting
there so either the logs are wrong or
there so either the logs are wrong or
something else is
screwy well actually wait this is
deaths where do they have kills
okay so
okay so
here it says that this is dealing a ton
here it says that this is dealing a ton
of
of
damage which I don't believe because
damage which I don't believe because
it's not actually going anywhere on the
map so this one is going to match
map so this one is going to match
closely to's alive
right these graphs yeah these ones match
right these graphs yeah these ones match
pretty much the
same reward XP we need to actually graph
same reward XP we need to actually graph
this
level yeah so we'll see this in a second
[Music]
in the meantime
let's see how rewards
go for
TR think how I want to graph this
graph like
this and what's this level
kills let's see what's not getting
kills let's see what's not getting
grafted right
grafted right
now uh radiant
assassin so the usages
a lot of things aren't getting logged
actually this one
Ked there like neutral
Ked there like neutral
skill layer log
well this is weird why isn't this
well this is weird why isn't this
getting logged
yeah these logs are not coming out the
yeah these logs are not coming out the
way they're supposed to
be this will finish running we'll pull
be this will finish running we'll pull
this we'll launch this new one see if
this we'll launch this new one see if
that logs and we'll like keep iterating
that logs and we'll like keep iterating
on logs essentially
and then we'll look for like a metric
and then we'll look for like a metric
that we can optimize a bit
[Music]
better
for e
there we
go okay so these guys aren't really
go okay so these guys aren't really
doing
anything well what model did I
anything well what model did I
copy oh wait I copied um an early
copy oh wait I copied um an early
checkpoint in that case that might be
fine so early checkpoint behaves very
fine so early checkpoint behaves very
much like the previous early
much like the previous early
checkpoint and then it's like just
checkpoint and then it's like just
starting to
starting to
learn to leave base
and then if I run
this now we can see a lot more
this now we can see a lot more
intentionality in leaving the base they
intentionality in leaving the base they
get
get
stuck and then these guys actually are
stuck and then these guys actually are
staying up
staying up
here this could just be like a
here this could just be like a
directionality bias and that they just
directionality bias and that they just
basically learn to go that
way but now I should have better stats
way but now I should have better stats
on this because clearly if they're doing
on this because clearly if they're doing
this they're not getting any kills or
this they're not getting any kills or
anything
anything
right so I should actually be able to
right so I should actually be able to
get something out of this
now yeah I should be able to get
now yeah I should be able to get
something out of
something out of
this we can't see neutral kills we still
this we can't see neutral kills we still
need that stat
damage
damage
received damage
received damage
dealt okay so we have some graphs for
dealt okay so we have some graphs for
the radiant assassin that it's doing
the radiant assassin that it's doing
damage right and then we have
damage right and then we have
graphs for dire
it says it's still doing damage is the
it says it's still doing damage is the
thing I don't believe
thing I don't believe
it it's still doing
damage doesn't have Tower kills on
it let's see if we can fix that uh that
it let's see if we can fix that uh that
version of stats next
yeah why don't we have
yeah why don't we have
uh that's weird that's very weird
okay so right here we're supposed to
okay so right here we're supposed to
have this neutral kill
have this neutral kill
field
right tower killed neutral
right tower killed neutral
killed and if I go
killed and if I go
to unless it's like the radiant tank
to unless it's like the radiant tank
doing
doing
everything I'm pretty
everything I'm pretty
sure you can see it's just not logging
sure you can see it's just not logging
yet
so player PID
gets its own
pit something's very weird
here it doesn't get any kills
let's
do
neutral right here is a good spot for a
neutral right here is a good spot for a
break point
yeah it's a good spot for a break
point okay
we should actually do this locally
so when a neutral dies is what we want
right which is 701
okay so as soon as a neutral
okay so as soon as a neutral
dies we will get a break
dies we will get a break
point let's go kill a
neutral aha
neutral aha
we get our break point
right
player player entity type is
zero entity player is zero
player optim
out 980 damage delt total
out 980 damage delt total
it's more than I dealt just in this one
it's more than I dealt just in this one
last tick
right received some
right received some
damage looks like a valid log to
me this does look like a valid
log why is it always zero in train
log why is it always zero in train
to get cleared
[Music]
somehow layer pit is one
which is this one
right did I reset it
right did I reset it
wrong that wouldn't make a difference
1852 is
1852 is
okay just to continue
Tower or clam something killed it
right yeah this guy must have killed the
right yeah this guy must have killed the
neutral it's
neutral it's
fine we just run down this way we take a
fine we just run down this way we take a
tower I forget this game's actually kind
tower I forget this game's actually kind
of fun
of fun
and
then there we
go okay so here's our M vog
go okay so here's our M vog
right and
optimized
optimized
out but we can see n logo one is
out but we can see n logo one is
there was my aggregate function
wrong add log
then we have Aggregate and
clear oh I'm just missing the
clear oh I'm just missing the
uh I'm just missing some stuff
uh I'm just missing some stuff
here
right we have like level and kills right
that's
level uh we actually don't have
level we do have
kills well but this could be uh
[Music]
[Music]
H maybe that one doesn't get
logged I think I found most likely the
logged I think I found most likely the
cause of this just a logging
bug I mean really what we need is
okay right here all these
okay right here all these
metrics these are these need to be
metrics these are these need to be
adjusted XP distance
adjusted XP distance
Tower uh level kills deaths damage dealt
Tower uh level kills deaths damage dealt
received and now this is we're just
received and now this is we're just
missing all the kill stats
we also missed Auto usage so wait this
we also missed Auto usage so wait this
is creeps
is creeps
neutrals
Towers okay so that works
level why is this not Auto completing
e
there we
go that should give us the new
level and we're ready for a new
level and we're ready for a new
experiment
what did I do over
here ladders
here ladders
misleadingly oh I think I got
bit yep look at
that okay always use um early
that okay always use um early
braces and I know why for some reason I
braces and I know why for some reason I
thought it was a good idea not to have
thought it was a good idea not to have
them logging part of the RL
them logging part of the RL
algorithm or for metrics and
algorithm or for metrics and
troubleshooting uh it's for metrics and
troubleshooting uh it's for metrics and
troubleshooting
troubleshooting
mostly like honestly reinforcement
mostly like honestly reinforcement
learning is easy getting um getting data
learning is easy getting um getting data
out of
out of
simulations in a way that is correct and
simulations in a way that is correct and
transparent is hard
that's become increasingly obvious the
that's become increasingly obvious the
further I get along and
puffer like the reason that RL is hard
puffer like the reason that RL is hard
is because of complete and utter lack of
is because of complete and utter lack of
engineering and logging and things like
this okay so here's our next
this okay so here's our next
experiment hope hopefully this
runs and now we should be getting
runs and now we should be getting
additional
additional
logs this is just a
logs this is just a
subset so here are some runs that we had
subset so here are some runs that we had
from
from
before and if I refresh this and for
before and if I refresh this and for
newcomers to the stream I see some
newcomers to the stream I see some
people just
people just
joined um this is the game
joined um this is the game
environment that we are currently
environment that we are currently
working on and doing reinforcement
working on and doing reinforcement
learning with it's like a strip down
learning with it's like a strip down
League of Legends or DOTA Style game
League of Legends or DOTA Style game
it's got a few different classes they've
it's got a few different classes they've
got different abilities you can play it
got different abilities you can play it
it's kind of fun it needs animations and
it's kind of fun it needs animations and
stuff
still whoa
still whoa
whoa look at
whoa look at
that so here this wasn't being logged
that so here this wasn't being logged
before now we can actually see this
before now we can actually see this
thing is actually csing
thing is actually csing
you can see it's autoing you can see all
you can see it's autoing you can see all
sorts of
sorts of
stuff yeah this is very cool actually
stuff yeah this is very cool actually
look very early in
look very early in
training this thing's just been training
training this thing's just been training
for like two minutes or whatever no this
for like two minutes or whatever no this
thing's been training for 40 seconds and
thing's been training for 40 seconds and
uh it's already killing
neutrals we're starting to get some
neutrals we're starting to get some
rewards as well
tow
tow
killed
killed
perfect so I'm going to go get a yeah
perfect so I'm going to go get a yeah
nice it charts it all out yeah literally
nice it charts it all out yeah literally
we have look at the number of metrics
we have look at the number of metrics
I'm logging here you see I'm logging
I'm logging here you see I'm logging
actually hundreds of metrics cuz I have
actually hundreds of metrics cuz I have
I have um 19 metrics at the moment for
I have um 19 metrics at the moment for
each of 10 different agents it's like
each of 10 different agents it's like
400 metrics and then there's some Global
400 metrics and then there's some Global
ones so we can kind of see right like
ones so we can kind of see right like
look I'm made these changes now we can
look I'm made these changes now we can
see how this works out on the graphs
see how this works out on the graphs
it's very
nice this experiment is going to take
nice this experiment is going to take
six or so minutes to run uh this
six or so minutes to run uh this
actually should be running twice as fast
actually should be running twice as fast
but we have a few bugs to fix with
but we have a few bugs to fix with
vectorization I think in this
vectorization I think in this
n I'm going to let this run I'm going to
n I'm going to let this run I'm going to
go grab a cup of tea use the rest from
go grab a cup of tea use the rest from
real quick and then we're going to see
real quick and then we're going to see
if we can't figure out why this is uh
if we can't figure out why this is uh
the behaviors that we're seeing don't
the behaviors that we're seeing don't
seem to match the learning charts we be
seem to match the learning charts we be
right
back
e
e
e
e
e
e
e e
okay
okay
what do we have
here looks like Wan B didn't
refresh one
refresh one
B
B
uhuh how the turns
table you see the
table you see the
problem look now we can see clearly what
problem look now we can see clearly what
we couldn't see
we couldn't see
before it stops far fing here completely
before it stops far fing here completely
stops farming these neutrals
stops farming these neutrals
almost and if we look at dire
almost and if we look at dire
side but like dire
assassin yeah it just stops doing stuff
assassin yeah it just stops doing stuff
right
so the run is not
so the run is not
stable I think it's both sides right we
stable I think it's both sides right we
saw it was both
saw it was both
sides both sides
crash it's radiant
assassin yeah look it's Autos drop a
assassin yeah look it's Autos drop a
whole bunch
level level actually keeps
level level actually keeps
up still getting Tower
up still getting Tower
kills actually reward XP went up which
kills actually reward XP went up which
is
is
weird well I guess the rant is the one
weird well I guess the rant is the one
that actually keeps kind of doing stuff
that actually keeps kind of doing stuff
huh it stops farming
huh it stops farming
neutrals overall does not look
neutrals overall does not look
particularly stable
particularly stable
I don't know if can we see anything in
I don't know if can we see anything in
the
losses okay
losses okay
so clip Frack is
so clip Frack is
fine
fine
entropy doesn't really
budge the policy loss
budge the policy loss
increasing no potentially tells
increasing no potentially tells
us explain variance increasing it could
us explain variance increasing it could
just be an unstable
just be decreas decreased learning rate
just be decreas decreased learning rate
or
something at least now we can see
something at least now we can see
clearly
what about
what about
rewards I'm going look at some
rewards so the dire carry doesn't really
rewards so the dire carry doesn't really
get anything
get anything
ever radiant carry also not looking
ever radiant carry also not looking
great
great
radiant assassin is very mobile does
radiant assassin is very mobile does
actually get some XP and actually the XP
actually get some XP and actually the XP
reward continues to go
reward continues to go
up as well as Tower taking so really the
up as well as Tower taking so really the
the assassin class is carrying here uh
the assassin class is carrying here uh
you can see that the
you can see that the
tank the tank learns a bunch and then
tank the tank learns a bunch and then
stops kind of just
stops kind of just
crashes support
gets a little XP not
gets a little XP not
much burst
much burst
character so reward keeps going
up can these things not see
see dire
see dire
tank this keeps going
up how does this keep going
up how does this keep going
up I guess it's drops at the
up I guess it's drops at the
end let's go grab like a pretty late
end let's go grab like a pretty late
checkpoint
me so there was one obnoxious thing that
me so there was one obnoxious thing that
I wanted to reply to I saw briefly on my
I wanted to reply to I saw briefly on my
phone
oops where did it
oops where did it
go
uh where is it I want to be
b252 let's get like model 600.
P this is like a relatively
P this is like a relatively
late checkpoint in our short little
late checkpoint in our short little
train run
[Music]
and
and
okay now keep in mind this is like
okay now keep in mind this is like
they've been trained for a few minutes
they've been trained for a few minutes
so like they're going to be kind of
so like they're going to be kind of
Spazzy we just want to see them like
Spazzy we just want to see them like
generally go down
mid so the Assassin character looks to
mid so the Assassin character looks to
be doing what we
be doing what we
want it's going to dash in take this
want it's going to dash in take this
Camp take some of the
Camp take some of the
camp me they are kind of spazy and non
committ going to get
committ going to get
XP there is the opposing
XP there is the opposing
tank so actually that's not bad these
tank so actually that's not bad these
guys are stuck in
guys are stuck in
base but uh we did actually see the
base but uh we did actually see the
enemy tank coming on over
enemy tank coming on over
is
interesting so I don't think we're like
interesting so I don't think we're like
completely on the wrong track here I
completely on the wrong track here I
think we're in a decent
Direction and we just have to figure out
Direction and we just have to figure out
what it is that's preventing these guys
what it is that's preventing these guys
from uh from
learning there a few experiments we can
try first of all I want to take a look
try first of all I want to take a look
at what I just want to confirm what one
at what I just want to confirm what one
thing welcome YouTube
folks I want to confirm one thing
here this is the whole
here this is the whole
file uh I want to confirm
compute compute observations
here obs map is equal to
tile map
tile map
grid we do have walls here so they
grid we do have walls here so they
should actually they should be able to
should actually they should be able to
see when they're walking into
something what's my Moet what's the Moet
something what's my Moet what's the Moet
look like
flat
project so this is the hidden Dimensions
project so this is the hidden Dimensions
here are kind of troll I
here are kind of troll I
think I might have trolled here
let me try to mess with the network
let me try to mess with the network
sizes real quick this is just like a
sizes real quick this is just like a
quick
quick
YOLO
YOLO
uh quick like YOLO thing
here like this
let me see if this
runs so thinking was um we just have a
runs so thinking was um we just have a
really tiny hidden
dims I'm curious to see if the uh if the
dims I'm curious to see if the uh if the
train graph
train graph
changes
substantially so this
substantially so this
about a little more than doubled the uh
about a little more than doubled the uh
number of parameters in the network here
number of parameters in the network here
it's still very small we'll still be
it's still very small we'll still be
able to run this on web but I'm curious
able to run this on web but I'm curious
to
to
see whether this uh makes a difference
see whether this uh makes a difference
we'll get the result for this in here in
we'll get the result for this in here in
just a few
just a few
minutes we'll take a look at it early on
minutes we'll take a look at it early on
as
as
well um for folks that are new around
well um for folks that are new around
here the mob is currently published it's
here the mob is currently published it's
in the dev
in the dev
Branch I'll link this here if you want
Branch I'll link this here if you want
to help me out go ahead and Star Puffer
to help me out go ahead and Star Puffer
helps a
helps a
ton you can also play it online same
ton you can also play it online same
game we have like some not particularly
game we have like some not particularly
well trained bots in here uh that we're
well trained bots in here uh that we're
going to try to improve on today but
going to try to improve on today but
like it's it's kind of like leag or DOTA
like it's it's kind of like leag or DOTA
right You've Got A qw and E scale it's
right You've Got A qw and E scale it's
different for every class and what's
different for every class and what's
this guy do he do
I think the clam is the one that has
I think the clam is the one that has
yeah this is this one has like a
retreat got like gale
force I'm going to try to get some
force I'm going to try to get some
reasonable policies trained for
these okay
these okay
so that looks different
so that looks different
already I don't know whether it's
already I don't know whether it's
meaningfully
meaningfully
different where are
different where are
our where the aggregated
our where the aggregated
metrics okay
environment the heck oh hold
on dire
Towers r
Victory dire
Victory
Victory
H we'll change the graph a
H we'll change the graph a
bit I don't know whether it's a
bit I don't know whether it's a
substantial change
Sol have this sort of
Sol have this sort of
cyclical Behavior
here the question is really about
here the question is really about
whether this is more
whether this is more
stable you doing box one I'm on box zero
stable you doing box one I'm on box zero
now Spencer you're good go do some
now Spencer you're good go do some
experiments I have but I have a there's
experiments I have but I have a there's
a puffer
a puffer
box like zero that I use uh as default
box like zero that I use uh as default
if I need more I'll tell
you but you should be
good yeah it would be good to get that
good yeah it would be good to get that
environment going as well I'm trying to
environment going as well I'm trying to
get the Moa into a good spot at the
moment we really just need these
moment we really just need these
environments to ship frankly like as
environments to ship frankly like as
soon as we ship uh the next puffer
update that's really the prerequisite
update that's really the prerequisite
for catapulting RL into modern
era we just need the m to be like known
era we just need the m to be like known
good with baselines
good with baselines
right they don't even have to be bug
right they don't even have to be bug
free you just have to be able to learn
free you just have to be able to learn
something interesting within them uh to
something interesting within them uh to
a point that like it's useful and we can
a point that like it's useful and we can
you know we can ship patches
thereafter but they need to be
thereafter but they need to be
stable pong is pretty much stable as is
stable pong is pretty much stable as is
right now connect for as soon as we have
right now connect for as soon as we have
a better opponent policy if Jack does
a better opponent policy if Jack does
that we'll be uh we'll be
that we'll be uh we'll be
good we need some sort of greedy thing
good we need some sort of greedy thing
for triple
for triple
Triad you know some sort of opponent for
Triad you know some sort of opponent for
go need to be
go need to be
fast Noah has a couple things on
fast Noah has a couple things on
breakout that I will just integrate
breakout that I will just integrate
whenever
whenever
mhm what bugs haven't heard of
mhm what bugs haven't heard of
him well
him well
the M's get to be
complicated I don't know if I'm going to
complicated I don't know if I'm going to
be happy or disappointed if this
be happy or disappointed if this
experiment
works this experiment working would just
works this experiment working would just
be the Run somehow being more stable
be the Run somehow being more stable
I don't even know if that's a reasonable
I don't even know if that's a reasonable
expectation do we look at losses
expectation do we look at losses
here the thing that made me suspicious
here the thing that made me suspicious
is like 32 hidden dim is really low oh
is like 32 hidden dim is really low oh
there's Jake not Jack
there's Jake not Jack
Jake end the weekend
Jake end the weekend
awesome yeah it doesn't have to be
awesome yeah it doesn't have to be
perfect we mainly just needs to we want
perfect we mainly just needs to we want
to be able to train like a decent
to be able to train like a decent
Connect 4 agent as well
1 2 3 4 5
1 2 3 4 5
six plus secret M that I'm working on
six plus secret M that I'm working on
makes seven wait no wait four 5 six
makes seven wait no wait four 5 six
seven makes eight plus go makes nine
seven makes eight plus go makes nine
plus pick any of the other Ms we finish
plus pick any of the other Ms we finish
one other one of the other Ms we've got
one other one of the other Ms we've got
TCG needs to get going
TCG needs to get going
to lots of
to lots of
stuff really I'm enjoying learning C
stuff really I'm enjoying learning C
it's really nice
it's really nice
frankly I swear it's like if you've been
frankly I swear it's like if you've been
working in higher level languages for a
working in higher level languages for a
while it's it's like all of modern
while it's it's like all of modern
software engineering is kind of just a
software engineering is kind of just a
lie C is just really easy and
lie C is just really easy and
comfortable and fast
I don't know if you're terminally online
I don't know if you're terminally online
on Twitter or not but um there are all
on Twitter or not but um there are all
these dumb posts about like akusha or
these dumb posts about like akusha or
whatever this like hallucinogen is just
whatever this like hallucinogen is just
ruining people's lives and like making
ruining people's lives and like making
them do dumb stuff well uh I didn't take
them do dumb stuff well uh I didn't take
any hallucinogens but I am going to say
any hallucinogens but I am going to say
like I ran a 50k and then 3 days after
like I ran a 50k and then 3 days after
that when I started coding I just just
that when I started coding I just just
basically went straight into C I went
basically went straight into C I went
from 10 years of python to doing
from 10 years of python to doing
everything in C so I don't know if
everything in C so I don't know if
there's a correlation
there maybe it's uh less masochistic
there maybe it's uh less masochistic
after you do something far more
masochistic but I've actually I've never
masochistic but I've actually I've never
been happier with Dev
been happier with Dev
like these M's just feel good to write
like these M's just feel good to write
MC
Advent of code with Cuda last year oh
geez I don't know we'll see maybe after
geez I don't know we'll see maybe after
the next athletic goal then I'll start
the next athletic goal then I'll start
doing
Cuda I'm considering trying to deadlift
Cuda I'm considering trying to deadlift
uh 405 for their first time in two years
uh 405 for their first time in two years
later today we'll see how that
goes I basically took two years off from
goes I basically took two years off from
doing very very serious lower body
doing very very serious lower body
strength training in order to do the
strength training in order to do the
running stuff and now I'm trying to get
running stuff and now I'm trying to get
them both at the same time so I can be
them both at the same time so I can be
hybrid big Tech stack minimal Tech stack
cycle
yeah I really like the minimal Tech
yeah I really like the minimal Tech
stack I really really don't like when
stack I really really don't like when
stuff is too complicated for you to know
stuff is too complicated for you to know
how everything works all at the same
how everything works all at the same
time and like Dev just slows down it's
time and like Dev just slows down it's
no longer enjoyable like you've got to
no longer enjoyable like you've got to
enjoy your work and like if
enjoy your work and like if
uh know if stuff gets too slow I just
uh know if stuff gets too slow I just
stop enjoying it and I stop being
stop enjoying it and I stop being
productive so it's like the focus on
productive so it's like the focus on
Simplicity in some way it's not just
Simplicity in some way it's not just
like a a choice it's like required in
like a a choice it's like required in
order for me to get the stuff
order for me to get the stuff
done to see have good neuronet training
done to see have good neuronet training
inference libraries like pytorch sensor
inference libraries like pytorch sensor
flow it has an inference Library cuz I
flow it has an inference Library cuz I
wrote
yaml for kubernetes in a few
yaml for kubernetes in a few
months uh you know probably just shoot
months uh you know probably just shoot
me before that
happens here here's puffer N.H 500 line
happens here here's puffer N.H 500 line
inference Library compatible with
inference Library compatible with
pytorch in
C can ignore the allocator stuff we
C can ignore the allocator stuff we
don't even use these you got weights you
don't even use these you got weights you
got an ability to load a flat P torch
got an ability to load a flat P torch
file you've got sigmoid re linear comms
file you've got sigmoid re linear comms
lstms one hot concatenate argmax with a
lstms one hot concatenate argmax with a
multi- discreete soft Max multi-
multi- discreete soft Max multi-
discreete sample you got a bunch of
discreete sample you got a bunch of
stuff less than 300 lines and then
stuff less than 300 lines and then
there's some bindings just for
convenience so it's kind of funny when
convenience so it's kind of funny when
it's like oh this but you don't have
it's like oh this but you don't have
this like library right you need like an
this like library right you need like an
inference Library you can just write one
inference Library you can just write one
it'll take you a couple days and you can
it'll take you a couple days and you can
just do
it this stupid con function was not easy
it this stupid con function was not easy
to
to
write the rest of it wasn't that
write the rest of it wasn't that
bad you've been productive I try to be I
bad you've been productive I try to be I
don't know the productivity comes in
don't know the productivity comes in
Cycles I got to really capitalize you
Cycles I got to really capitalize you
know when I'm like on I really got to
know when I'm like on I really got to
capitalize and get a lot done
capitalize and get a lot done
I'm not so sure about the rocket thing I
I'm not so sure about the rocket thing I
was doing yesterday it's you might have
was doing yesterday it's you might have
been right it's kind of a waste but hey
been right it's kind of a waste but hey
I mean I got a new potential
I mean I got a new potential
collaborator out of it so if I get to
collaborator out of it so if I get to
spend uh if I got to spend a Saturday
spend uh if I got to spend a Saturday
trying to like sit down and fix a rocket
trying to like sit down and fix a rocket
EMP with somebody new that'll be
fun I'm always down to do that
[Music]
where's our
experiment that was
funny saying no shame in switching well
funny saying no shame in switching well
I mean that's what it means right it's
I mean that's what it means right it's
like I don't know if it was if it's
like I don't know if it was if it's
worth the
worth the
effort like I essentially I'm going to
effort like I essentially I'm going to
do physics stuff at some point
um
um
but the question is essentially just how
but the question is essentially just how
much of a pain it is going to be to work
much of a pain it is going to be to work
with the physics libraries and such to
with the physics libraries and such to
get stuff working
nicely I did get box 2D running at 250k
nicely I did get box 2D running at 250k
steps per second though
steps per second though
and I think we can and that was on my
and I think we can and that was on my
local so we can go way faster than that
local so we can go way faster than that
probably get a
probably get a
million
million
here what do we think happened do we
here what do we think happened do we
think bigger neural networks are magic
think bigger neural networks are magic
or do we think RL on small neural
or do we think RL on small neural
networks is
saying take your
bets um
oh
interesting you see
that I think we might just have
magic it's still dropping towards the
magic it's still dropping towards the
end here but not anywhere near as
badly radiant assassin
level's
level's
higher a little
higher a little
bit but
dire is this dire
dire is this dire
assess oh
assess oh
yeah huh what about this dire
tank it still
tank it still
drops not Magic
let's see the bigger
model this one should be big enough to
model this one should be big enough to
learn something at
least so here's our new
model taking its sweet time
what about these
what about these
guys you're getting out of the
guys you're getting out of the
base they're not like hard running into
base they're not like hard running into
the wall at
the wall at
least here comes the
least here comes the
Assassin oh assassin
Assassin oh assassin
battle H you're under Tower my
friend probably Tower diving level one
friend probably Tower diving level one
is not the best strategy
H there goes the Tank tank versus burst
H there goes the Tank tank versus burst
under tower Tower diving level one not a
under tower Tower diving level one not a
good
idea but I mean this is closer to what
idea but I mean this is closer to what
we
we
want there're like some of these guys
want there're like some of these guys
are still stuck in
base I don't know why you would be stuck
base I don't know why you would be stuck
in base there's like no reason to be in
in base there's like no reason to be in
base there's nothing for you
there let's see if we can figure out
there let's see if we can figure out
um there's like a reward reason for
this like here's the radiant
support radiant
support reward
death okay look it just falls
death okay look it just falls
off you see apparently the support was
off you see apparently the support was
going out before and it stopped so
going out before and it stopped so
there's got to be some reason it learned
there's got to be some reason it learned
to stop going
out creeps killed CS here
it actually started at the at the uh the
it actually started at the at the uh the
start here it was actually
CSM
CSM
[Music]
[Music]
reward I mean the reward is just so
reward I mean the reward is just so
sparse right
it's not getting like a consistent
it's not getting like a consistent
signal or maybe it's the fact that this
signal or maybe it's the fact that this
is this is a tiny tiny
reward it shouldn't be tiny I think it's
reward it shouldn't be tiny I think it's
just
just
rare reward
rare reward
Tower it's not getting penalized for
Tower it's not getting penalized for
death I don't think
it actually should
it actually should
be reward death is negative
here is this not being
added hold on background
noise
e e
so um I just forgot to
do Target
log reward
death This should now be good
death This should now be good
[Music]
all
all
right baseship catching we got a little
right baseship catching we got a little
end working uh we need to run sweeps and
end working uh we need to run sweeps and
fix some stuff on it though one be free
fix some stuff on it though one be free
for those types of metric yeah I think I
for those types of metric yeah I think I
technically pay them a little
technically pay them a little
bit but
bit but
yeah W is pretty good they need to
yeah W is pretty good they need to
rewrite this thing faster at some point
rewrite this thing faster at some point
like that's the only complaint is it
like that's the only complaint is it
needs to be the UI just needs to be
needs to be the UI just needs to be
faster with when you have a bunch of
faster with when you have a bunch of
metrics and
stuff what if we did web dev and
C make all of wand be a Raab like a Raab
C make all of wand be a Raab like a Raab
UI that'd be
UI that'd be
fun okay so we have the this metric here
fun okay so we have the this metric here
um you know what I want to try let me
um you know what I want to try let me
try
try
something I wonder if the death reward
something I wonder if the death reward
is the thing that's SC it up cuz I
is the thing that's SC it up cuz I
wasn't logging it
right what if I just set this reward to
zero so now you're literally you just
zero so now you're literally you just
get a reward for getting XP and you get
get a reward for getting XP and you get
a reward for taking Towers yeah and then
a reward for taking Towers yeah and then
this is 01 so like 50 reward would give
this is 01 so like 50 reward would give
you 0.05 reward XP something like that
you 0.05 reward XP something like that
uh where's learning rate 05 yeah let's
uh where's learning rate 05 yeah let's
let's let's try
this because something is
this because something is
causing like some of the characters to
causing like some of the characters to
learn to stay in base and it could just
learn to stay in base and it could just
be that they're like well my character
be that they're like well my character
is weak and I die a lot so maybe I just
is weak and I die a lot so maybe I just
stop doing it you
know maybe they're smart and uh the
know maybe they're smart and uh the
rewards are dumb you
know thank you to our resident
know thank you to our resident
Advertiser bet here um yeah do Star
Advertiser bet here um yeah do Star
Puffer Leb if you uh if you're
Puffer Leb if you uh if you're
interested in the project at all it
interested in the project at all it
really does help a
really does help a
lot basically the only two channels
lot basically the only two channels
where uh I promote work and show stuff
where uh I promote work and show stuff
off we've got the puffer GitHub here and
off we've got the puffer GitHub here and
then also uh if you are doing RL
then also uh if you are doing RL
stuff I mean I do Post resources on X as
stuff I mean I do Post resources on X as
well for instance just
well for instance just
today this little quick start
today this little quick start
guide literally a one weekend guide to
guide literally a one weekend guide to
getting into reinforcement
getting into reinforcement
learning basically if you are new and
learning basically if you are new and
you do this stuff you and you have an
you do this stuff you and you have an
engineering background uh you will
engineering background uh you will
already be able to contribute usefully
already be able to contribute usefully
to RL and to puffer and to all these fun
projects find another
PhD
PhD
yeah well that's the fun
thing H you do get good support on this
thing H you do get good support on this
stuff contributors actually get quite a
stuff contributors actually get quite a
bit
of quite a bit of input
of quite a bit of input
on learning
on learning
stuff and people actually learn quite a
stuff and people actually learn quite a
bit very fast
here I wanted to make like some meme
here I wanted to make like some meme
right where like puffer Li contributors
right where like puffer Li contributors
like you know you type in GitHub you
like you know you type in GitHub you
start typing an issue it's already
start typing an issue it's already
answered you start typing in Discord
answered you start typing in Discord
it's already answered you like get tired
it's already answered you like get tired
and you like queue up a game of League
and you like queue up a game of League
like puffer has joined as your support
like puffer has joined as your support
but then I realized I'm too bad at that
but then I realized I'm too bad at that
game to actually do
game to actually do
that spending too much time freaking
that spending too much time freaking
writing all the code on this
thing yeah literally though you get like
thing yeah literally though you get like
a support thing with puffer you say okay
a support thing with puffer you say okay
I'm tired for the night nope
all the RL stuff but it's just
all the RL stuff but it's just
you
yeah do we have our new experiment open
here it's fun
okay
okay
so um is something happening
so um is something happening
here I can't tell
yet this could be
I
I
mean I can't think of any reason why
mean I can't think of any reason why
specific characters would stay in base
specific characters would stay in base
if you don't have a penalty for dying
if you don't have a penalty for dying
what's wrong with the Moa um I mean we
what's wrong with the Moa um I mean we
have stuff that's training but like
have stuff that's training but like
they're kind of weird right
they're kind of weird right
like they first they all start going
like they first they all start going
down mid and then some of the characters
down mid and then some of the characters
just decide that they're going to stop
just decide that they're going to stop
doing that and they stay in base and
doing that and they stay in base and
then like just the Assassin and the tank
then like just the Assassin and the tank
which are probably the two strongest
which are probably the two strongest
characters go down mid at each other so
characters go down mid at each other so
I think that
I think that
probably it's the death uh the death
probably it's the death uh the death
penalty is the
penalty is the
problem like the negative reward for
problem like the negative reward for
dying
post actually is doing very
post actually is doing very
well people like RL
guides negative rewards
guides negative rewards
yeah see oh I think this
yeah see oh I think this
is this looks better to me right this
is this looks better to me right this
looks more consistent already oh yeah
looks more consistent already oh yeah
there it is we fixed it
there it is we fixed it
folks you see that
folks you see that
we took away the penalty for
we took away the penalty for
dying and now the support will actually
dying and now the support will actually
play the game
[Music]
um I don't know about the hugging face
um I don't know about the hugging face
stuff is the hugging face course
stuff is the hugging face course
good I don't know how their code is
[Music]
[Music]
uh yeah I don't
uh yeah I don't
know the only thing is I don't know how
know the only thing is I don't know how
their code
is oh they use clean RL oh of course
is oh they use clean RL oh of course
they use clean RL because Costa was at
they use clean RL because Costa was at
hugging face for a while yeah okay yeah
hugging face for a while yeah okay yeah
totally then this is
totally then this is
good this is good
good this is good
this is a good because
Costa so the reason I wasn't sure is
Costa so the reason I wasn't sure is
because like some of the hugging face
because like some of the hugging face
engineering is a bit dodgy like it's
engineering is a bit dodgy like it's
just overbuilt and over
just overbuilt and over
complicated um but yeah if cost if they
complicated um but yeah if cost if they
use cleaner stuff it's
use cleaner stuff it's
great anybody else follow serpent AI was
great anybody else follow serpent AI was
building an RL yeah I think
this one
right so I looked at this
um I looked at this and I think that
um I looked at this and I think that
it's not going to be fast enough Jake
it's not going to be fast enough Jake
like the games aren't going to run fast
like the games aren't going to run fast
enough is they going to be the problem
do you know tiny grad yeah I know of
do you know tiny grad yeah I know of
tiny grad I haven't tried it yet because
tiny grad I haven't tried it yet because
it's newer
it's newer
um and I don't know about not having
um and I don't know about not having
fast eager mode and having to do
fast eager mode and having to do
everything compiled but I'm keeping my
everything compiled but I'm keeping my
eye on it it looks very nice we'll
eye on it it looks very nice we'll
probably end up buying some tiny boxes
probably end up buying some tiny boxes
in the future as
well it's definitely a cool project
puffer play is nice it plays as nice as
puffer play is nice it plays as nice as
it can play with
compile ooh so what happened here the
compile ooh so what happened here the
reward went back down
right this did way better but then it
right this did way better but then it
still
stopped how about this
I don't
know well this was from bigger
model oh yeah no this is better
it's almost
it's almost
trained we'll be able to watch this
trained we'll be able to watch this
model and see how this plays I think
model and see how this plays I think
this should be getting closer to what I
this should be getting closer to what I
was trying to do I just basically all I
was trying to do I just basically all I
want to do today is I want to train a
want to do today is I want to train a
basic model that run where the teams
basic model that run where the teams
will learn to at least run down mid at
will learn to at least run down mid at
each other and maybe like Farm some
camps I want to just like have a decent
camps I want to just like have a decent
enough model to put on the website just
enough model to put on the website just
like so that we know that the uh the
like so that we know that the uh the
environment is not completely broken
environment is not completely broken
that we're getting good logs and that we
that we're getting good logs and that we
can use this for
can use this for
research that's the main
goal anybody nope spam
yeah this looks
yeah this looks
better what about the
better what about the
support the support seems like it's
support the support seems like it's
didn't
learn man the support was
learn man the support was
learning why did the support
learning why did the support
stop I mean it didn't complete
stop I mean it didn't complete
completely
stop
stop
huh let's just see the the model maybe
huh let's just see the the model maybe
it's decent
enough 65 C
okay here's the new
okay here's the new
model let's see what these guys are
model let's see what these guys are
doing uh the Assassin is starting to get
doing uh the Assassin is starting to get
out of Base
out of Base
gu starting to get out of
Base I don't know what you're doing over
here okay assassin and tank are starting
here okay assassin and tank are starting
to do
things they're going to look Spazzy like
things they're going to look Spazzy like
this for a while early in training
this for a while early in training
especially without uh good hyper
especially without uh good hyper
parameters so that's fine the question
parameters so that's fine the question
is just do they go down okay yeah
is just do they go down okay yeah
there's our burst our burst is like
there's our burst our burst is like
farming waves in
mid tank is slowly getting there
mid tank is slowly getting there
maybe the walls are also one tile off in
maybe the walls are also one tile off in
the renderer which is why they're kind
the renderer which is why they're kind
of
glitching support and carry aren't
glitching support and carry aren't
really doing
really doing
much oh okay we have a we've got a tower
much oh okay we have a we've got a tower
fight here we've got two siing First
fight here we've got two siing First
Tower and
Tower and
then we've got a 2v2
here
here
oh that's legit
still not quite as good as I want uh as
still not quite as good as I want uh as
I'm looking
for but this is like closer to the right
for but this is like closer to the right
direction this is not like it's not
direction this is not like it's not
clearly being stupid
it's like looks like it's getting into
it's like looks like it's getting into
the right
direction interestingly you can
direction interestingly you can
see are there any instabilities in the
see are there any instabilities in the
train
run there might just be some
run there might just be some
instabilities in the
training oops
training oops
okay so here we can
okay so here we can
see
victories see your
level the policy loss going up like that
level the policy loss going up like that
is
is
sketchy and the policy loss going up
sketchy and the policy loss going up
like that is sketchy
like that is sketchy
I think
I think
why why it would be doing
this we just do we have too large of a
this we just do we have too large of a
learning rate like
learning rate like
what why would this be
what why would this be
happening you can see the training is
happening you can see the training is
just
not policy law should not be going up
not policy law should not be going up
like that even though that's very small
like that even though that's very small
it's consistent what about
it's consistent what about
value oh yeah look we have value lost
value oh yeah look we have value lost
Spike right
here let's go look at the clean RL
defaults for
flip
coefficient Yeah we actually have these
reasonable what do we have as batch size
reasonable what do we have as batch size
here
256k this could simply be too small
me
think wait num Ms is
think wait num Ms is
four how does that make sense
400 so
400 so
4K hold
on so we
have two that's probably too
short I think I did this for Speed and
short I think I did this for Speed and
then forgot to
then forgot to
to adjust
it4 2
34 let's see if this
works oh wait this is also a crazy ratio
works oh wait this is also a crazy ratio
isn't
it 256k to 16k like this is a crazy
it 256k to 16k like this is a crazy
ratio
what if we
do let's do like
do let's do like
64k how many updates is this no that's
64k how many updates is this no that's
still crazy that's 16 updates
I'm going to do
I'm going to do
this let's do like
this I bet you this this this fixes
this I bet you this this this fixes
stability let's
see this should at least improve
see this should at least improve
stability it might tank the training
stability it might tank the training
speed we'll
see for
[Music]
what do we think the train curves will
what do we think the train curves will
look
look
like for
this welcome YouTube
folks this was the policy I had before
folks this was the policy I had before
right yeah so I think we're already
right yeah so I think we're already
better than
better than
this how long do training take just a
this how long do training take just a
few minutes and it should be even
few minutes and it should be even
shorter we got to fix some stuff with
vectorization let's do just the last
vectorization let's do just the last
three runs I think or the last yeah
three runs I think or the last yeah
let's just take these off got too many
runs yeah so you can see
runs yeah so you can see
here the training speed is tanked
here the training speed is tanked
based on what I just
based on what I just
did oh wait this steps thing hold on the
did oh wait this steps thing hold on the
steps might be different I don't even
steps might be different I don't even
know why it is
know why it is
on steps for everything it should be
on steps for everything it should be
on
on
agent should be on agent
steps what the hell is wrong with this
steps what the hell is wrong with this
section
there okay so 50
[Music]
[Music]
mil actually it's weird cuz the dire
mil actually it's weird cuz the dire
level is not going up very quickly but
level is not going up very quickly but
radiant is about the same as it was
before what about
before what about
individual individual Rewards
usually radiant assassin is the easiest
usually radiant assassin is the easiest
to
learn okay so it's hard to say I think
learn okay so it's hard to say I think
it just takes it could just be taking
it just takes it could just be taking
longer to get
started which would make sense cuz
started which would make sense cuz
you're doing fewer
you're doing fewer
updates but um The Hope is that it'll be
updates but um The Hope is that it'll be
actually stable
as soon as we get something
as soon as we get something
stable uh I'm going to switch over to
stable uh I'm going to switch over to
just fixing figuring out what is wrong
just fixing figuring out what is wrong
with vectorization that way we can run
with vectorization that way we can run
this at a proper
this at a proper
speed I mean by proper speed I mean this
speed I mean by proper speed I mean this
is already running about a 100 times
is already running about a 100 times
faster than it would normally be in
faster than it would normally be in
Academia it's just not running at 300
Academia it's just not running at 300
times normal which is what we want
360,000
360,000
which I forget if I made this run at
which I forget if I made this run at
five steps per second at 10 steps per or
five steps per second at 10 steps per or
10 steps per second but it's either
10 steps per second but it's either
15,000 or 30,000 times realtime
speed it's still over it's still playing
speed it's still over it's still playing
like more it's still playing more games
like more it's still playing more games
of uh of this than I've played of League
of uh of this than I've played of League
every minute
so how much League have I played I
so how much League have I played I
couple hundred
hours not that
much oh look at
much oh look at
that this is starting to take
that this is starting to take
off right here
off right here
it's starting to take
it's starting to take
towers and get
XP we'll see whether it's
stable the only thing that would really
stable the only thing that would really
surprise me here is if this ends up
surprise me here is if this ends up
being both worse and less stable
where's the uh the
loss policy loss is actually
not well explain variance is
lower
lower
value our value is still clean
but this is not like perfectly
but this is not like perfectly
stable I mean it is entering a high
stable I mean it is entering a high
learning like a high learning Pace
learning like a high learning Pace
regime we will see this is still a whole
regime we will see this is still a whole
bunch of updates is the
bunch of updates is the
thing this is still a ton of
updates we might end up having to do a
updates we might end up having to do a
weight accumulation or no wait grading
weight accumulation or no wait grading
accumulation we'll see do you even need
accumulation we'll see do you even need
mini batches you need them because of
mini batches you need them because of
memory we might end up needing to do um
memory we might end up needing to do um
gradient
gradient
accumulation welcome YouTube
folks currently running experiments on
folks currently running experiments on
this MOA here trying to get some
this MOA here trying to get some
reasonable
policies I like this en
uh good question Nvidia
SMI 23%
SMI 23%
so we can probably go up a
so we can probably go up a
bit oh no wait duh it's like a
quarter well we still do need mini
quarter well we still do need mini
batches bet cuz then we could only go up
batches bet cuz then we could only go up
to like 250 K I think that's still too
to like 250 K I think that's still too
small for the
small for the
batch cuz like here I'll do a quick RL
batch cuz like here I'll do a quick RL
tutorial on
tutorial on
this this is a very important and not
this this is a very important and not
often made
often made
point with
point with
RL so the way that RL works right you're
RL so the way that RL works right you're
collecting your agent
collecting your agent
trajectories your agent trajectories
trajectories your agent trajectories
look like this right you have like
look like this right you have like
T1 T2
T1 T2
you know and then this is you you have
you know and then this is you you have
to collect a batch of data um so let's
to collect a batch of data um so let's
say that you're going to have 8,000
say that you're going to have 8,000
agents because you have 800 copies of
agents because you have 800 copies of
the environment which is what I have
the environment which is what I have
because that's what's effective for the
because that's what's effective for the
hardware then so I have 8K agents and I
hardware then so I have 8K agents and I
do
256k batch size well then when I go to
256k batch size well then when I go to
optimize this I'm not going to have a
optimize this I'm not going to have a
really long trajectory cuz I'm going to
really long trajectory cuz I'm going to
have on average 250
have on average 250
8K per
8K per
agent right and uh I don't know what's
agent right and uh I don't know what's
this
32 which is
32 which is
short so ideally if we have 8K
short so ideally if we have 8K
environments we would like to have
environments we would like to have
512k or uh a
512k or uh a
million batch size which is not going to
million batch size which is not going to
fit in memory which means you either
fit in memory which means you either
have to mini batch or you have to do
have to mini batch or you have to do
grading to
accumulation common screw
up are we looking
okay well value loss actually stayed
okay well value loss actually stayed
stable length
stable length
32 yeah the segments because you need to
32 yeah the segments because you need to
do generalized Advantage estimations
do generalized Advantage estimations
you're Computing reward across segments
you're Computing reward across segments
like that uh and it's just really that's
like that uh and it's just really that's
not long enough okay but look though we
not long enough okay but look though we
have this stable looking
have this stable looking
level
here episode length going down is
here episode length going down is
actually probably good
actually probably good
I want to look at some of these
rewards hey Spencer one second let
rewards hey Spencer one second let
me using latest go changes increasing
me using latest go changes increasing
size of board 5x five and up one each
size of board 5x five and up one each
time still solving M just taking
time still solving M just taking
longer increase Forex looks like just
longer increase Forex looks like just
taking longer to realize that bad does
taking longer to realize that bad does
figure it out eventually yeah that makes
figure it out eventually yeah that makes
total sense so get training to a million
total sense so get training to a million
steps per second right and we tune hyper
steps per second right and we tune hyper
parameters and then it figures that out
parameters and then it figures that out
quicker probably
right I don't know about this reward
right I don't know about this reward
here
is this guy not doing anything let me
is this guy not doing anything let me
see it's getting some
kills well it is actually taking more
kills well it is actually taking more
Towers it looks like
n this is not stable like
n this is not stable like
look it's not
look it's not
[Music]
[Music]
farming I don't think this is farming as
well yeah right
here let's go look at the policy anyways
here let's go look at the policy anyways
though
okay
what do we
think okay here's our
assassin we see our burst on the right
assassin we see our burst on the right
migrating out over to the rest of the
migrating out over to the rest of the
map what do we think over here up yep
map what do we think over here up yep
there 's their assassin and their
burst checkpoint we
got oh there's our tank farming some
got oh there's our tank farming some
camps that's
cool the training stability is very
cool the training stability is very
important
like hold
on radiant
on radiant
assassin yeah this should be
assassin yeah this should be
consistently going up
the fact that it stops
farming I kind of want
to I want to try something
crazy well actually is it
crazy well actually is it
crazy what I do for Atari
uh I'm going try
something
something
28 can you fit 256k in
28 can you fit 256k in
here and like
here and like
1024 can I fit this
looks like you can fit
looks like you can fit
this 1 million batch size
this 1 million batch size
250k this is with the bigger model as
250k this is with the bigger model as
well that's
nice 42% on the
nice 42% on the
n because we don't have vectorization so
n because we don't have vectorization so
we can actually uh shove this up to like
we can actually uh shove this up to like
500k pretty
easily main thing I'm looking for is
easily main thing I'm looking for is
stability of
training so like with the previous one
here if we go look at the
losses policy loss is not in a good spot
losses policy loss is not in a good spot
and explain
and explain
variances
yeah clip Frack is okay
yeah clip Frack is okay
but now the value loss is technically
but now the value loss is technically
okay but it is
increasing maybe this will be more
increasing maybe this will be more
stable cuz it doesn't look like we have
stable cuz it doesn't look like we have
a learning problem it looks like we've
a learning problem it looks like we've
got a stability
got a stability
problem we also should change the way
problem we also should change the way
that we're recording logs a
that we're recording logs a
bit we're recording too
frequently was there reward hold
frequently was there reward hold
on
reward yeah look the reward for XP is
reward yeah look the reward for XP is
just not consistent increasing
just not consistent increasing
here or
here or
here this
is
maybe just looks very
unstable I think we also probably have
unstable I think we also probably have
I mean we can manually do a couple of
I mean we can manually do a couple of
these parameters just for
these parameters just for
now I can probably guess decent
ones just to start us
off where's our
off where's our
run already have 60
mil okay
mil okay
so
now
now
okay there's some
XP we'll see if it gets to be
stable Lambda and Gamma are going to
stable Lambda and Gamma are going to
be interesting
probably will change a little
probably will change a little
bit the current parameters that we're
bit the current parameters that we're
using for
this gamma's
this gamma's
97 lambda's 995
I think that Lambda is a bit
nutty exact
interpretation Lambda probably goes to
interpretation Lambda probably goes to
0.
N5 97 is a reasonable
gamma um
see too early to say use the restroom
see too early to say use the restroom
grab more tea and uh we'll be back doing
grab more tea and uh we'll be back doing
more of
this
e
e
e
e e
H well that looks that's
H well that looks that's
something I don't know the thing is I
something I don't know the thing is I
don't know if it's going to actually
don't know if it's going to actually
be
be
hm a weird
hm a weird
curve what about this
one you
know this could be it this could just
know this could be it this could just
take way longer but be more stable I
take way longer but be more stable I
wouldn't be
surprised 200 mil train is not enough on
surprised 200 mil train is not enough on
this well we haven't messed hold on we
this well we haven't messed hold on we
haven't messed with J parameters yet
haven't messed with J parameters yet
so we still we're not out of
options we still have options
here but yeah presumably this is just it
here but yeah presumably this is just it
has so many fewer updates
right of course cuz like in reality we
right of course cuz like in reality we
don't actually need to have a batch size
don't actually need to have a batch size
this ridiculous right at least not early
this ridiculous right at least not early
in training uh the reason that we have a
in training uh the reason that we have a
batch size like this is because of
batch size like this is because of
Hardware
constraints so yeah it's just not going
constraints so yeah it's just not going
to be it's going to it's like oh 200
to be it's going to it's like oh 200
million samples should be enough but no
million samples should be enough but no
not with these settings because it's
not with these settings because it's
only like 200 uh it's 800 total gradient
only like 200 uh it's 800 total gradient
steps yeah it's not a
lot and it is starting to increase
lot and it is starting to increase
pretty much all the different
metrics so we'll do um
metrics so we'll do um
J G parameter
J G parameter
next we'll be
next we'll be
good change that to
0.95 and we'll run it for longer as
well and we'll see if that makes a
well and we'll see if that makes a
difference
difference
I think we're getting close
I think we're getting close
though to like finding something that
though to like finding something that
makes a relatively consistent
makes a relatively consistent
performance improvements I mean we're
performance improvements I mean we're
not looking for a crazy model right
not looking for a crazy model right
we're just trying to
we're just trying to
show the things run at each other down
show the things run at each other down
mid they like you expect that they
mid they like you expect that they
should learn to at least run at each
should learn to at least run at each
other down mid maybe take some camps and
other down mid maybe take some camps and
throw their abilities at each other
throw their abilities at each other
right
what happened to
what happened to
my what happened to my
runs that was weird okay
oh
oh
okay I mean it kind of did
okay I mean it kind of did
something I guess we just need to look
something I guess we just need to look
at
at
losses we can do that once we launch the
losses we can do that once we launch the
new one
new one
though
oops gamma goes to 095 from
oops gamma goes to 095 from
995 learning
rate learning rate
rate learning rate
increase probably learning rate can
increase probably learning rate can
increase do I want to risk doing both
increase do I want to risk doing both
these at once not
these at once not
really do you have a reward for damage
really do you have a reward for damage
dealt we have a reward for gaining
experience policy on I I'll tell you in
experience policy on I I'll tell you in
a second hold on got to sleep have a
a second hold on got to sleep have a
productive day thank you thanks for
productive day thank you thanks for
dropping by
dropping by
by feel free to stop by the Discord we
by feel free to stop by the Discord we
do uh if you want to get involved with
do uh if you want to get involved with
contributing we got a lot of Ms to build
on okay so this is now the je parameter
on okay so this is now the je parameter
uh I'm going to go pour this cup of tea
uh I'm going to go pour this cup of tea
and I'll tell you about um reward
and I'll tell you about um reward
shaping and how to do that be right
shaping and how to do that be right
[Music]
[Music]
back
e
e e
[Music]
[Music]
I forgot to unmute my
I forgot to unmute my
mic
mic
um let me go through
um let me go through
reward
reward
shaping yeah I just realized
shaping yeah I just realized
that let me talk about reward shaping
that let me talk about reward shaping
so you don't want to be in a spot where
so you don't want to be in a spot where
you're like manually tuning reward
you're like manually tuning reward
components for weeks on end for a hard
components for weeks on end for a hard
problem and like tune reward like tweak
problem and like tune reward like tweak
reward run experiment tweak reward run
reward run experiment tweak reward run
experiment that's a mess you want to be
experiment that's a mess you want to be
in a place where you have like a bunch
in a place where you have like a bunch
of different reward component weights
of different reward component weights
and you have a very fast environment and
and you have a very fast environment and
then you run a giant hyperparameter
then you run a giant hyperparameter
sweep that includes automatically tuning
sweep that includes automatically tuning
the weights of those
the weights of those
rewards um that's where you want to
rewards um that's where you want to
be and that's actually what I did
be and that's actually what I did
originally with
originally with
this the time that you start tuning
this the time that you start tuning
parameters at all like I'm doing at the
parameters at all like I'm doing at the
moment is basically when you have a new
moment is basically when you have a new
environment where the environment might
environment where the environment might
have bugs there might be other things
have bugs there might be other things
wrong and you're essentially just
wrong and you're essentially just
playing with it in order to try to
playing with it in order to try to
understand how it works and how it
understand how it works and how it
responds to stuff um you want to use
responds to stuff um you want to use
this sparingly but it's a good way to
this sparingly but it's a good way to
debug stuff um so yeah that's what I'm
debug stuff um so yeah that's what I'm
doing at the
doing at the
moment and I have a few different reward
moment and I have a few different reward
components for this project uh but
components for this project uh but
actually there are only two of them that
actually there are only two of them that
are enabled right now they get a reward
are enabled right now they get a reward
for getting experience that's
for getting experience that's
proportional to experience gained and
proportional to experience gained and
they get a a pretty high constant reward
they get a a pretty high constant reward
for taking a tower that's it
what do you tune against in the sweep
what do you tune against in the sweep
like a few
like a few
higher yeah you just come up with some
higher yeah you just come up with some
components of like yeah this is probably
components of like yeah this is probably
relevant right like if I think of a MOA
relevant right like if I think of a MOA
right it's like okay probably taking
right it's like okay probably taking
Towers like getting kills getting
Towers like getting kills getting
experience or gold or whatever stuff
experience or gold or whatever stuff
like that just come up with a few
like that just come up with a few
components and then let the uh the hyper
components and then let the uh the hyper
parameter sweep figure out how much they
parameter sweep figure out how much they
matter or
matter or
don't would you encourage people to do a
don't would you encourage people to do a
PhD in pure
PhD in pure
RL
RL
um if you were going to do a PhD already
um if you were going to do a PhD already
RL is a perfectly good area of research
RL is a perfectly good area of research
yeah
it's like it's going to be a valuable
it's like it's going to be a valuable
area um the alternative is you can go
area um the alternative is you can go
jump on the language model boat with
jump on the language model boat with
everybody else already doing
everybody else already doing
that but like we've got enough people
that but like we've got enough people
doing that already we don't have enough
doing that already we don't have enough
people working on smaller subfields of
people working on smaller subfields of
AI that like could potentially have a
AI that like could potentially have a
much larger proportional
impact I forgot to make this experiment
impact I forgot to make this experiment
run for
run for
longer uh it looks like it's doing
longer uh it looks like it's doing
something
though
though
yeah that's why I phrased it as if
yeah that's why I phrased it as if
you're going to do a
PhD can you tune hyper parameters for
PhD can you tune hyper parameters for
the rewards how can you compare yeah so
the rewards how can you compare yeah so
what you need is you need a success
what you need is you need a success
metric so like let's say that your
metric so like let's say that your
training something to play Breakout or
training something to play Breakout or
whatever the metric you're tuning
whatever the metric you're tuning
against is score in the game like
against is score in the game like
overall score you could have a reward
overall score you could have a reward
for hitting the ball back you can have
for hitting the ball back you can have
the reward like a negative reward for
the reward like a negative reward for
hitting the top you can do whatever you
hitting the top you can do whatever you
want but then the final thing you care
want but then the final thing you care
about is the score so that's what you
about is the score so that's what you
use to compare it gets harder in this
use to compare it gets harder in this
environment which is this MOA here right
environment which is this MOA here right
um in competitive games you need
um in competitive games you need
something like ELO which we have
something like ELO which we have
implemented it's just a bit of a pain
implemented it's just a bit of a pain
thinking about it currently doing time
thinking about it currently doing time
series Foundation
series Foundation
models plan on using those in decision
models plan on using those in decision
Transformer applied for drone
control do you have a ton of offline
control do you have a ton of offline
data decision Transformers for offline
data decision Transformers for offline
data
like there was online RL I believe
there's this
thing hard to find Labs doing pure
thing hard to find Labs doing pure
RL there are
few I mean look it depends on what your
few I mean look it depends on what your
priorities are right in my mind if
priorities are right in my mind if
there're a bunch of people doing a thing
there're a bunch of people doing a thing
I have no interest in doing it cuz like
I have no interest in doing it cuz like
it's going to get solved with or without
it's going to get solved with or without
me right I get interested in like Niche
me right I get interested in like Niche
long shot bet area is where like if I'm
long shot bet area is where like if I'm
right you can totally change
everything we can generate data yeah but
everything we can generate data yeah but
like online RL is a process for
like online RL is a process for
generating data it depends if you have a
simulator onlineer RL is very very
simulator onlineer RL is very very
powerful because your agent gets to
powerful because your agent gets to
expand its own distribution of data
offline RL is basically just supervised
offline RL is basically just supervised
learning right it's like it's imitation
learning right it's like it's imitation
learning plus a little bit that's
learning plus a little bit that's
all it's uh in my mind it's like an
all it's uh in my mind it's like an
entirely different thing like I like the
entirely different thing like I like the
portion of RL I care about I really
portion of RL I care about I really
don't even care about the specific
don't even care about the specific
algorithms for RL or the math or any of
algorithms for RL or the math or any of
it the portion of RL that I think is
it the portion of RL that I think is
most likely to be useful and interesting
most likely to be useful and interesting
is the part that you are gathering your
is the part that you are gathering your
own data and learning interactively
own data and learning interactively
you're learning in like this very
you're learning in like this very
natural trial and error way and that's
natural trial and error way and that's
something that's just not the case in
something that's just not the case in
the rest of all of AI so that's what I
the rest of all of AI so that's what I
see in
see in
it time will tell whether I'm
it time will tell whether I'm
right but it has already done some
right but it has already done some
pretty darn cool things it's done so
pretty darn cool things it's done so
like a thousandth of the scale of uh the
like a thousandth of the scale of uh the
rest of
AI it's interesting that this thing is
AI it's interesting that this thing is
getting XP just very slowly
getting XP just very slowly
is this actually worse than
is this actually worse than
before can't
tell it looks worse than
tell it looks worse than
before that's very weird
does it evaluate hold
on yeah neither of these are good to be
on yeah neither of these are good to be
honest neither of these are very good
Foundation models for a classical
Foundation models for a classical
problem but like why
though one of the great advantages of
though one of the great advantages of
reinforcement learning is it's for
reinforcement learning is it's for
settings where you have a fast simulator
settings where you have a fast simulator
you have unlimited data
you have unlimited data
your foundation model
your foundation model
cannot train on unlimited data it's too
cannot train on unlimited data it's too
big you run out of compute you can train
big you run out of compute you can train
RL on more data than all of gp4 on one
GPU compute vers
performance you don't need a lot of
performance you don't need a lot of
compute in RL you just need a fast
compute in RL you just need a fast
simulator
score some tiny boxes down the line what
score some tiny boxes down the line what
would you do with the GPU well we would
would you do with the GPU well we would
need to have a parallel GPU trainer by
need to have a parallel GPU trainer by
then essentially the plan is that
then essentially the plan is that
eventually RL is going to have enough
eventually RL is going to have enough
environments that run fast enough that
environments that run fast enough that
you can saturate all the gpus on a
you can saturate all the gpus on a
multi-gpu box just using the CPU cores
multi-gpu box just using the CPU cores
that are on that box for simulation so
that are on that box for simulation so
like let's say that I get if I really
like let's say that I get if I really
optimize each GPU
optimize each GPU
we could get um over a million train
we could get um over a million train
steps per second per GPU so with six of
steps per second per GPU so with six of
them we have 6 million train steps per
them we have 6 million train steps per
second per GPU and like at that pace you
second per GPU and like at that pace you
know you're training faster than all of
know you're training faster than all of
opening I5 is but on one little com like
opening I5 is but on one little com like
one little box instead of on a massive
cluster you just chunk through tons and
cluster you just chunk through tons and
tons of data
they're not useful until we have the uh
they're not useful until we have the uh
the multi-gpu training for
though which has not been a priority
though which has not been a priority
because like there's so much room for
because like there's so much room for
improvement even on single card and the
improvement even on single card and the
hardware is very cost
effective like even a lot of Industry
effective like even a lot of Industry
problems you can solve them on one
GPU just need a fast
Sim very weird how this
is might have to back up a little bit on
this cab base Sims no
this cab base Sims no
you can have Cuda Bas Sims if you want
you can have Cuda Bas Sims if you want
sure it'll work there just as well but
sure it'll work there just as well but
uh fast CPU Sims are good too we're
uh fast CPU Sims are good too we're
basically we can Implement stuff plenty
basically we can Implement stuff plenty
fast on CPU now the way I've been doing
fast on CPU now the way I've been doing
stuff with
stuff with
puffer how are you funding puffer is the
puffer how are you funding puffer is the
only a full-time
only a full-time
Dev puffer is my company I uh I finished
Dev puffer is my company I uh I finished
my PhD six months
my PhD six months
ago so I'm working on this full-time
ago so I'm working on this full-time
other people are contributing stuff uh
other people are contributing stuff uh
open source all the stuff is open source
open source all the stuff is open source
we just officially launched uh business
we just officially launched uh business
side of this a few weeks ago the plan is
side of this a few weeks ago the plan is
to be uh providing extended support and
to be uh providing extended support and
priority features and things like that
priority features and things like that
for
companies so the idea is hey are you a
companies so the idea is hey are you a
company trying to do RL for something
company trying to do RL for something
important and having a hard time of it
important and having a hard time of it
give puffer a
give puffer a
call we'll get you set up with puffer
call we'll get you set up with puffer
which is all open source and free you're
which is all open source and free you're
not going to be tied to any proprietary
not going to be tied to any proprietary
Tech but you get experienced eyes on the
Tech but you get experienced eyes on the
problem you get prioritized features for
problem you get prioritized features for
anything that you might need for your
anything that you might need for your
specific
problem that's the
problem that's the
idea you already get to use it in a real
idea you already get to use it in a real
live application
nope brand new company we have a couple
nope brand new company we have a couple
um couple potential clients I'm chatting
um couple potential clients I'm chatting
with at the moment uh we'll be building
with at the moment uh we'll be building
that side out more but a lot of this is
that side out more but a lot of this is
early stage like just building awesome
early stage like just building awesome
tech for RL and that's been going pretty
tech for RL and that's been going pretty
well like you can see all these on
well like you can see all these on
puffer GG these run very fast some of
puffer GG these run very fast some of
them are kind of complex we've got a
them are kind of complex we've got a
couple more in the works as well and
couple more in the works as well and
there's a lot of nice Tooling in Puffer
lot a lot of nice tooling and puffer for
lot a lot of nice tooling and puffer for
making stuff
making stuff
easier like this whole field of RL uh in
easier like this whole field of RL uh in
the dev branch of puffer right now is
the dev branch of puffer right now is
100 to a thousand times faster than it
100 to a thousand times faster than it
is in the rest of
is in the rest of
Academia and the idea is that when you
Academia and the idea is that when you
have all these this ability to test
have all these this ability to test
stuff so quickly on a number of
stuff so quickly on a number of
different problems some of which are
different problems some of which are
easy some of which are not so easy you
easy some of which are not so easy you
can be very very confident in the
can be very very confident in the
approaches that you're taking so like if
approaches that you're taking so like if
you decide that you need to do you have
you decide that you need to do you have
like a new algorithm or a new thing that
like a new algorithm or a new thing that
needs to be tested on your fancy
needs to be tested on your fancy
production environment that's going to
production environment that's going to
be slow well what you can do is you can
be slow well what you can do is you can
evaluate it comprehensively on a big
evaluate it comprehensively on a big
Suite of different tasks um and you can
Suite of different tasks um and you can
do that very
do that very
efficiently without needing a giant
cluster and then if your method is
cluster and then if your method is
actually good then you can then transfer
actually good then you can then transfer
that to
that to
prod and then you know that the actual
prod and then you know that the actual
the bigger run is worth doing
the bigger run is worth doing
the ability to test stuff like that
the ability to test stuff like that
really doesn't exist in RL right now and
really doesn't exist in RL right now and
uh it's a huge huge source of cost and
uh it's a huge huge source of cost and
time
time
sync obviously we do a bunch of other
sync obviously we do a bunch of other
stuff a bunch of other things with the
stuff a bunch of other things with the
puffer Tech but that's one of the big
puffer Tech but that's one of the big
ones right
ones right
now just came across your page looking
now just came across your page looking
to start L my computer can't handle it
to start L my computer can't handle it
saving but I also need to save a lot
saving but I also need to save a lot
because international student school
because international student school
fees yeah that's a rough one um
fees yeah that's a rough one um
I will say RL is pretty fast like you
I will say RL is pretty fast like you
can do like you can do environment side
can do like you can do environment side
work um without needing really any
work um without needing really any
compute resources it just depends on
compute resources it just depends on
engineering background and the
engineering background and the
like like some of these M's here this
like like some of these M's here this
one's built by a contributor this one's
one's built by a contributor this one's
built by a different contributor these
built by a different contributor these
two are built by yet another contributor
two are built by yet another contributor
this TCG I made a prototype of and now
this TCG I made a prototype of and now
we have contributors looking at it these
we have contributors looking at it these
two are mine
but it's a nice space to get
into we also occasionally provide
into we also occasionally provide
hardware for specific projects we've got
hardware for specific projects we've got
a little very small little cluster
here all right can I figure out what is
here all right can I figure out what is
wrong with this experiment now
what's your goal with puffer are you
what's your goal with puffer are you
planning on hiring I'm planning on
planning on hiring I'm planning on
hiring once we are profitable like once
hiring once we are profitable like once
we have revenue from uh a few clients
we have revenue from uh a few clients
and we need more people to handle more
and we need more people to handle more
of
them the goal yes also for multi-agent a
them the goal yes also for multi-agent a
lot of our stuff is multi-agent
lot of our stuff is multi-agent
um the primary goal for puffer is to
um the primary goal for puffer is to
revolutionize the field of reinforcement
revolutionize the field of reinforcement
learning in order to do that you know
learning in order to do that you know
the secondary goal there is to be a
the secondary goal there is to be a
small profitable industry lab that does
small profitable industry lab that does
open source
open source
work yeah that's the goal have like a
work yeah that's the goal have like a
small profitable industry lab that does
small profitable industry lab that does
a bunch of Open Source work and fixes
a bunch of Open Source work and fixes
the
the
field that's my goal for
puffer now it's very interesting to
puffer now it's very interesting to
see that with this run the actual the
see that with this run the actual the
skill usage is very
skill usage is very
good why is the reward kn good if the
good why is the reward kn good if the
skill usage is
skill usage is
good I'm
good I'm
confused this doesn't make
sense Towers is very
low for reference Yanick my um my thesis
low for reference Yanick my um my thesis
is on neural was on neural MMO so like
is on neural was on neural MMO so like
massively multi-agent is kind of my
massively multi-agent is kind of my
thing
thing
thing I've been making some single agent
thing I've been making some single agent
environments because you know a lot of
environments because you know a lot of
problems don't need
problems don't need
it but
it but
um yeah that's that's where I originally
um yeah that's that's where I originally
started and a lot of the stuff in puffer
started and a lot of the stuff in puffer
makes multi-agent just as easy as single
makes multi-agent just as easy as single
agent I built a lot of stuff explicitly
agent I built a lot of stuff explicitly
to handle multi-agent
well where is it using all these
well where is it using all these
abilities oh it's
abilities oh it's
farming wait How's It farming well this
farming wait How's It farming well this
is kind of crazy isn't
it why is the reward so low if it's
it why is the reward so low if it's
farming this
well I should look at this
policy I have a Quant project with
policy I have a Quant project with
ML did that an intership parameter
ML did that an intership parameter
optimization and PC to run it properly
optimization and PC to run it properly
someday takes me 4 hours to run one test
someday takes me 4 hours to run one test
and sometimes would fail at hour three
and sometimes would fail at hour three
yeah that's rough do you think companies
yeah that's rough do you think companies
like Riot use RL in back in for bounce
like Riot use RL in back in for bounce
test I know that they do is it hard even
test I know that they do is it hard even
too hard for them it is hard for them
too hard for them it is hard for them
but it's hard for them because they have
but it's hard for them because they have
uh they are using Ray no they're using
uh they are using Ray no they're using
rib for a lot of it at least they used
rib for a lot of it at least they used
to be I don't know if they're still
to be I don't know if they're still
doing it RB is a god aul Library I
doing it RB is a god aul Library I
actually tried to pitch them on um on
actually tried to pitch them on um on
doing something with puffer though that
doing something with puffer though that
was like I was still a PhD stage student
was like I was still a PhD stage student
and it was way earlier
stage I was originally going to make
stage I was originally going to make
puffer uh game focused but I decided it
puffer uh game focused but I decided it
would be better to have puffer be more
would be better to have puffer be more
broadly RL for whatever application and
broadly RL for whatever application and
we still use games a lot but mainly we
we still use games a lot but mainly we
use we use games for RL more than we use
use we use games for RL more than we use
RL for games if that makes sense we use
RL for games if that makes sense we use
games as tests for reinforcement
games as tests for reinforcement
learning cuz they're fun to implement
learning cuz they're fun to implement
they are very very fast and uh they're
they are very very fast and uh they're
very easy to interpret which many other
very easy to interpret which many other
types of Sims are not so we'll add more
types of Sims are not so we'll add more
specific industry simulators as we go
specific industry simulators as we go
forward but games are a really nice core
forward but games are a really nice core
test
set rip
set rip
Rita yeah I don't actually know if
Rita yeah I don't actually know if
they're still doing stuff
um not entirely sure
I'm pretty happy with how puffer's gone
I'm pretty happy with how puffer's gone
so far though like we have actually sped
so far though like we have actually sped
up reinforcement learning 100 to a th000
up reinforcement learning 100 to a th000
fold we have a variety of environments
fold we have a variety of environments
some of which are already nice and
some of which are already nice and
stable others of which are still in
stable others of which are still in
production but are looking
production but are looking
good we've gotten a nice community of
good we've gotten a nice community of
users and contributors it's a very fast
users and contributors it's a very fast
growing project um we've solved a ton of
growing project um we've solved a ton of
the problems that were virtually
the problems that were virtually
impossible just a few months ago it's
impossible just a few months ago it's
been going
been going
well I'd say we're definitely on Pace
let's see what this guy
is fun to get Farming C stuff
up if you found the Pu recor is getting
up if you found the Pu recor is getting
settled in regarding rppo cm is mostly
settled in regarding rppo cm is mostly
it's n work uh it's n work because
it's n work uh it's n work because
there's no point of doing algorithm work
there's no point of doing algorithm work
when everything is this slow in
when everything is this slow in
RL like you can't tell if one algorithm
RL like you can't tell if one algorithm
is better than another like you can't
is better than another like you can't
run enough tests like literally like
run enough tests like literally like
we're going to end up redoing the last
we're going to end up redoing the last
10 years worth of orl research because
10 years worth of orl research because
the majority of Publications are wrong
the majority of Publications are wrong
it's actually that
bad what are these guys
doing okay so they're
doing okay so they're
farming working I'd be up for working on
farming working I'd be up for working on
a more busy
environment envin Cuda for European
environment envin Cuda for European
space agen torso decomposition challenge
space agen torso decomposition challenge
be a lot slower than most
be a lot slower than most
M's yeah M speed is the tough
M's yeah M speed is the tough
one like resources go up proportionally
one like resources go up proportionally
if M are
slow so this guy's just
farming is it easy to write a game I
farming is it easy to write a game I
made an environment for German card game
made an environment for German card game
although it was made for gymnasium yeah
although it was made for gymnasium yeah
very easy
um I mean no easier than like no easier
um I mean no easier than like no easier
or harder than it would be to write on
or harder than it would be to write on
its own normally like we have this here
its own normally like we have this here
I made a basic template for a card game
I made a basic template for a card game
that we're going to be expanding on kind
that we're going to be expanding on kind
of Magic the Gathering right we can play
of Magic the Gathering right we can play
a land do this we can like attack let's
a land do this we can like attack let's
see play this this
see play this this
swing um uh
swing um uh
this and this two four
this and this two four
six and I think we got a
six and I think we got a
block and
block and
four two
four two
two and I
two and I
win yeah so you can look at the code for
win yeah so you can look at the code for
these they're on uh the GitHub St the
these they're on uh the GitHub St the
puffer it's in Dev
we have to do RL for that one still but
we have to do RL for that one still but
it'll be very easy to
it'll be very easy to
bind well I thought for Speed you'd
bind well I thought for Speed you'd
write it in yeah we write our M's in
C but like it's
C but like it's
easy so here's the Moa the MOBA that
easy so here's the Moa the MOBA that
I've been working on right now here's
I've been working on right now here's
the entire source for it it's 2,000
the entire source for it it's 2,000
lines it's C just pure
lines it's C just pure
c um where's the
c um where's the
TCG the TCG prototype that you just
saw
TCG yeah TCG is like 500
TCG yeah TCG is like 500
lines I technically have a LinkedIn
lines I technically have a LinkedIn
though actually it's kind of funny I've
though actually it's kind of funny I've
stopped updating it cuz all the business
stopped updating it cuz all the business
stuff these days comes off of
stuff these days comes off of
X funny
X funny
enough like literally all of the
enough like literally all of the
uh all the business stuff comes off of X
uh all the business stuff comes off of X
these
days Jake going to look at building
days Jake going to look at building
industry adjacent Ms that are open
industry adjacent Ms that are open
source after I get a baseline done
source after I get a baseline done
either that or TCG yeah industry Ms are
either that or TCG yeah industry Ms are
good next time I log into LinkedIn I
good next time I log into LinkedIn I
have to like update everything H that
have to like update everything H that
site is a mess I haven't updated like
site is a mess I haven't updated like
any of my my profiles on stuff other
any of my my profiles on stuff other
than x I'm actually I'm live on X as
than x I'm actually I'm live on X as
well well right now it's multi streamed
well well right now it's multi streamed
this is the
this is the
xlink I do Post quite a bit of stuff on
xlink I do Post quite a bit of stuff on
here about reinfor it's all like RL
here about reinfor it's all like RL
stuff right it's a professional
account I try not to get bored and post
account I try not to get bored and post
random stuff too
often all right what are these guys
often all right what are these guys
doing so this guy got level
doing so this guy got level
three oh it's just he's just chilling
three oh it's just he's just chilling
around base and like farming
huh it's not necessarily
bad it's just hasn't optimized well it's
bad it's just hasn't optimized well it's
been stable at
least here let me just whoops let me
least here let me just whoops let me
make a longer run
and then we'll do some stuff in the
and then we'll do some stuff in the
meantime while this uh this while this
meantime while this uh this while this
works actually let's make your
commit piix some logs thanks Dylan uni
commit piix some logs thanks Dylan uni
trying to have reach for future
trying to have reach for future
opportunities need to be more active on
opportunities need to be more active on
X yeah X is really good for
ML yeah we do uh all all of the stuff is
ML yeah we do uh all all of the stuff is
on like the open source stuff is on
on like the open source stuff is on
discord.gg puffer
discord.gg puffer
um I mean we have people that have just
um I mean we have people that have just
joined like in the last few weeks it's a
joined like in the last few weeks it's a
really good way to learn this stuff
really good way to learn this stuff
quickly because you do a lot of
quickly because you do a lot of
engineering side stuff building
engineering side stuff building
environments you learn some RL in the
environments you learn some RL in the
process of doing that you get a lot of
process of doing that you get a lot of
feedback both from myself and from all
feedback both from myself and from all
the other people working on it it's like
the other people working on it it's like
a very fun and fast-paced thing and like
a very fun and fast-paced thing and like
it's not a giant code base it's a very
it's not a giant code base it's a very
small code base it's very easy to work
small code base it's very easy to work
on like a small specific like
on like a small specific like
environment or whatever um
yeah you even get
yeah you even get
um people that contribute like
um people that contribute like
environments also get cluster access
environments also get cluster access
once they like if they're like actively
once they like if they're like actively
contributing
stuff bet here who is star Zerg in the
stuff bet here who is star Zerg in the
chat works on uh Pokemon reinforcement
chat works on uh Pokemon reinforcement
learning we've got Spencer who was here
learning we've got Spencer who was here
earlier is done is currently working on
earlier is done is currently working on
go uh BET's doing Enduro stuff as well
go uh BET's doing Enduro stuff as well
at the moment what else is in here uh
at the moment what else is in here uh
Noah has a breakout and clone Nathan's
Noah has a breakout and clone Nathan's
got like this MMO combat M that he's
got like this MMO combat M that he's
been working on lots and lots of
stuff let's see if we can figure out
stuff let's see if we can figure out
what the heck is wrong with
what the heck is wrong with
vectorization
here I got a bit frustrated with RL so
here I got a bit frustrated with RL so
much comes down to how you design your
much comes down to how you design your
neural
neural
network example for 20
network example for 20
48 yeah but the thing is
48 yeah but the thing is
like I have the experience on that side
like I have the experience on that side
of things um and you can really just
of things um and you can really just
automate all of the experiments if the
automate all of the experiments if the
en is fast like for 2048 I could very
en is fast like for 2048 I could very
easily make that environment run a
easily make that environment run a
million plus steps per second per CPU
million plus steps per second per CPU
core and at that point you can just like
core and at that point you can just like
you can run tens of billions of steps
you can run tens of billions of steps
worth of experiments and you don't have
worth of experiments and you don't have
to think about anything at that point
to think about anything at that point
because you just run all the experiments
because you just run all the experiments
like the performance engineering side
like the performance engineering side
makes everything else
easy let me see if I can figure out
easy let me see if I can figure out
multiprocessing while we're doing this
multiprocessing while we're doing this
why it's like freezing for the Moa
it's freezing for the mobile on the
it's freezing for the mobile on the
bigger
machine well we'll see if it freezes
here in the meantime we've got our
puffer and here's our latest
run we'll see how this
run we'll see how this
Compares so many hypers to worry about
Compares so many hypers to worry about
you need autoo yeah we have that though
you need autoo yeah we have that though
we have automated hyper parameter Sweep
we have automated hyper parameter Sweep
with a good algorithm we have carbs
with a good algorithm we have carbs
integration it's much better than your
integration it's much better than your
typical randomer Bay
search these are already things that
search these are already things that
I've thought about and solved in
puffer okay so here we can see this is
puffer okay so here we can see this is
frozen right
so the question is why is this Frozen
one cores at
Max very cool project thank
you I wouldn't be working on this full
you I wouldn't be working on this full
time right if I didn't think that there
time right if I didn't think that there
was the ability to really just change an
was the ability to really just change an
entire field
yeah no that's not Yan kiler no way
yeah no that's not Yan kiler no way
that' be funny
though we've had some funny stream
though we've had some funny stream
things
things
happen we had uh Eugene hop in
happen we had uh Eugene hop in
NYU Professor hop in stream uh just in
NYU Professor hop in stream uh just in
time to see puffer lib solve one of his
time to see puffer lib solve one of his
RL uh one of his RL simulators like a
RL uh one of his RL simulators like a
100 times faster than it was solved
[Music]
before why is this stuck I'm trying to
before why is this stuck I'm trying to
think why where this could be stuck
should accumulate some stream clip for
should accumulate some stream clip for
marketing pretty cool you're working in
marketing pretty cool you're working in
public like this think is really needed
public like this think is really needed
yeah I mean I figure like I can be I can
yeah I mean I figure like I can be I can
work in silence or I can stream it and
work in silence or I can stream it and
have a bunch of people see it and like
have a bunch of people see it and like
this has been a great way to get people
this has been a great way to get people
interested in contributing as well it's
interested in contributing as well it's
like yeah you can literally just be um
like yeah you can literally just be um
deving cool environments and like people
deving cool environments and like people
will show up on stream and just be like
will show up on stream and just be like
hey I wrote this environment thing for
hey I wrote this environment thing for
puffer like can you go look at the code
puffer like can you go look at the code
for it sure I'll go do code review
for it sure I'll go do code review
live heck uh in the evenings I'm often
live heck uh in the evenings I'm often
in the Discord voice of uh you know the
in the Discord voice of uh you know the
puffer Discord voice like checking on
puffer Discord voice like checking on
code review for people's mends and
code review for people's mends and
giving us suggestions on stuff and
giving us suggestions on stuff and
whatnot
trying to think how this could
trying to think how this could
possibly be
possibly be
[Music]
[Music]
hanging because
like what's the worker process
do if
infos get native
buff equal
buff is it okay if I join the voice if
buff is it okay if I join the voice if
I'm not yeah you can totally join it's
I'm not yeah you can totally join it's
open might try to do a 2048 puffer lip
open might try to do a 2048 puffer lip
version so the fun thing with puffer is
version so the fun thing with puffer is
you can just use it if you have a
you can just use it if you have a
gymnasium M you can use it with puffer
gymnasium M you can use it with puffer
instantly and then if you want to make
instantly and then if you want to make
it faster right then we give you lots of
it faster right then we give you lots of
different options for how to make it
different options for how to make it
faster with
faster with
puffer all the M's are only on GitHub or
puffer all the M's are only on GitHub or
is there a separate place to search for
is there a separate place to search for
M's we have them on GitHub we have one
M's we have them on GitHub we have one
repo for the time being they're just in
repo for the time being they're just in
uh the first party environments are an
ocean the fun thing about writing the
ocean the fun thing about writing the
M's the way that we do is you get a web
M's the way that we do is you get a web
build for free
build for free
like you don't have to do anything
like you don't have to do anything
special to get these on web cuz they're
special to get these on web cuz they're
written in C with rib so
written in C with rib so
like you just compile them for web to
like you just compile them for web to
web assembly and you're done and then
web assembly and you're done and then
it's like hey I wrote breakout but I can
it's like hey I wrote breakout but I can
also play it online and like hey I wrote
also play it online and like hey I wrote
snake but also I can play it online and
snake but also I can play it online and
in fact I can take my hands off the
in fact I can take my hands off the
keyboard and the RL will play all the
snakes so we got some fun demos like
snakes so we got some fun demos like
that yeah but I'd write it and see you
that yeah but I'd write it and see you
don't have to
don't have to
I mean it depends on how familiar you
I mean it depends on how familiar you
are on lowlevel stuff generally like if
are on lowlevel stuff generally like if
you write it in Python it'll be faster
you write it in Python it'll be faster
and puffer than it'll be anywhere else
and puffer than it'll be anywhere else
if you want it to be fast then you can
if you want it to be fast then you can
write it in scon which is very much like
write it in scon which is very much like
python but it's very fast and then if
python but it's very fast and then if
you want to be able to play it on the
you want to be able to play it on the
web and have it be fast and have it be a
web and have it be fast and have it be a
standalone then you go to
see looks like for 9 by9 this is for go
see looks like for 9 by9 this is for go
when I cut Max steps per epis episode to
when I cut Max steps per epis episode to
100 from 200 it is learning
100 from 200 it is learning
better almost like it had too much
better almost like it had too much
leeway to make bad
moves Max deps per
episode something's weird there Spencer
episode something's weird there Spencer
if it's getting a reward for bad moves
if it's getting a reward for bad moves
if it's getting a negative reward for
if it's getting a negative reward for
bad mov something's weird
bad mov something's weird
there you're actually writing UI I I
there you're actually writing UI I I
mean
mean
here let me show you how simple this
here let me show you how simple this
is because people do not understand when
is because people do not understand when
they see this stuff like it's actually a
they see this stuff like it's actually a
lot of this is very easy to get
lot of this is very easy to get
into like here let's look at um what
into like here let's look at um what
pong
pong
breakout one of these here's pong this
breakout one of these here's pong this
is 300 some odd lines this is all the
is 300 some odd lines this is all the
code
here is the UI at the bottom the UI is a
here is the UI at the bottom the UI is a
struct a little make function and this
struct a little make function and this
is the render function right here it's
is the render function right here it's
like 100 lines of code it runs on
like 100 lines of code it runs on
desktop you can compile it to web
desktop you can compile it to web
assembly and it runs on web that's
it so it's actually incredibly easy
what on Earth is this
wait how do I
adjust semors
oh cuz I set the seore down
here yeah there's nothing that should be
here yeah there's nothing that should be
able to Loop
here render the eval in a second waiting
here render the eval in a second waiting
for it to finish episode return has been
for it to finish episode return has been
slowly increasing episode length has
slowly increasing episode length has
been slowly decreasing all right
been slowly decreasing all right
something is weird there but that's fine
something is weird there but that's fine
for
for
now there's definitely something weird
now there's definitely something weird
there it should be able to learn to
there it should be able to learn to
prune inv valid moves very easily my
prune inv valid moves very easily my
guess is that there's something that's
guess is that there's something that's
not being handled
not being handled
correctly there's probably like a
correctly there's probably like a
specific invalid move or like
specific invalid move or like
um there's probably some move that it's
um there's probably some move that it's
not getting penalized for that it's like
not getting penalized for that it's like
able to spam or something weird like
able to spam or something weird like
that
TR think
TR think
why this would be
why this would be
possible that like
wait a
second yeah it's the main process that's
spinning how is only the main process
spinning that doesn't make sense does
it there's one process that's spinning
it there's one process that's spinning
at
at
e e
top I by top
4499 just chilling and receive
not running anything
I don't even know why there are this
I don't even know why there are this
many processes there shouldn't be this
many processes there shouldn't be this
many of them
let's see this uh progress here oh look
let's see this uh progress here oh look
at
at
that we get uh training
that we get uh training
here and then it
crashes stability is a big problem
what happened here value function
spiked policy law
spiked policy law
spiked clip crack didn't
spike is this just like too big learning
spike is this just like too big learning
rate what the hell
there was one Spike
here oh invalid map value hold on
here oh invalid map value hold on
there it
is we found
something invalid MTH
something invalid MTH
value there's some like bug
value there's some like bug
thing let's fix let's fix something real
quick we're going to see if we can fix
quick we're going to see if we can fix
that
is I'm going use a rest from real quick
is I'm going use a rest from real quick
I'll be right back we'll see if we can't
I'll be right back we'll see if we can't
find that bug it' be really good to have
find that bug it' be really good to have
this thing multiprocess
this thing multiprocess
correctly be right
back
e
e
e e
[Music]
don't doubt that something may be screwy
don't doubt that something may be screwy
but what winning 80 to 90% random
but what winning 80 to 90% random
watching
watching
render yeah we'll
render yeah we'll
see we'll see uh what it's doing that's
see we'll see uh what it's doing that's
good though that's
progress this stck
progress this stck
now no it's not
now no it's not
stuck this one though invalid map value
stuck this one though invalid map value
and it's this is now Frozen right yeah
and it's this is now Frozen right yeah
so it froze at 10.2 with this invalid
so it froze at 10.2 with this invalid
map value
message
12412 which what we're going to do
there
okay
so it found a
255 how did it
255 how did it
find a 250
find a 250
5 map
grid map game map numpy
and it gets M
copied gam map.
numpy right
right it's in resources now
right it should be in resources
cannot load
read
read
file I make this
binary gu this is binary
unsign
charar
um uh
and what's the script that I use to save
this nice bites
so here you have this convert
so here you have this convert
map and then it gets saved like this
right go to
right go to
map oh we don't even have DOTA map do
map oh we don't even have DOTA map do
we okay
I don't know how it's possible it's
I don't know how it's possible it's
equal to 255 unless I have the
equal to 255 unless I have the
dimensions
wrong 128 by 128
so this is 128 by
128 to the exact size
respawn
respawn
Towers respawn agents
I mean there could be something Jank
I mean there could be something Jank
going on
trying to see
trying to see
how the grid would get messed
up it had a value of
255 the only other place I know where
255 the only other place I know where
I'm filling stuff with 255 a
bunch and there is this AI path thing
bunch and there is this AI path thing
here
right this gets filled with
255s wait we had another clue didn't we
we had another another
clue I was dumb I ignored
clue I was dumb I ignored
it I lose it oh no wait
1242 well you shouldn't be able to be at
1242 well you shouldn't be able to be at
124 but that's still a valid map value
map offset
know what we should
do load up um
void
test
bugs let's do
this for
allocate
let's see
that right
there might need to look
at I need to look at that
that could be it
there tempting to free
reallocated mooba
I just do like
this I'm essentially trying to figure
this I'm essentially trying to figure
out there's something in here that's
out there's something in here that's
screwing up in multiprocessing and I
screwing up in multiprocessing and I
don't know what it is I don't know why
don't know what it is I don't know why
only screws up in multi prosing but I'm
only screws up in multi prosing but I'm
hoping I can find it with um some
hoping I can find it with um some
compile
compile
tools okay we're leaking tons of
stuff um for
okay
oh this needs to call free
MOA okay and
MOA okay and
now this goes away
now we're leaking tons of stuff
wait
wait
net con re
con flat
I don't know what happened
there sometimes you need to do this type
there sometimes you need to do this type
of work for a bit in order to fix stuff
of work for a bit in order to fix stuff
it's
it's
fine read
fine read
file for
load
weights
for the reason I'm doing this is because
for the reason I'm doing this is because
I'm I fear that there's like some weird
I'm I fear that there's like some weird
memory corruption thing happening uh
memory corruption thing happening uh
that I'm not seeing because of all of
that I'm not seeing because of all of
this
Terminals and truncations
okay so these are good and then here's
okay so these are good and then here's
the big
the big
one I guess the uh the line moved hold
one I guess the uh the line moved hold
on
allocate log
buffer this needs to be free log
buffer okay now we should have no
buffer okay now we should have no
more memory
problems
perfect and
furthermore we now have a clean slate to
furthermore we now have a clean slate to
look at this
problem compute
observations array
subscript how is 484
this eror does not make sense to
me I don't understand this error because
me I don't understand this error because
like 44 is less than 512 last I checked
Gent
that's a [__] warning
but I see that that could potentially
but I see that that could potentially
be
be
okay so
510 there's 26 elements though
unless I'm off by one or something but I
unless I'm off by one or something but I
don't think
so yeah that's fine
that was the only thing I could think
that was the only thing I could think
of what about ob's
map 11 by 11 by4 is this still the OB
map 11 by 11 by4 is this still the OB
size did I mess something up
size did I mess something up
there still 11 by 11 by4
[Music]
[Music]
right and then this gives you 8
right and then this gives you 8
11 by 11 by 4 + 26 right
and the other thing is like
where is this the only place hold on
where is this the only place hold on
what what compile flags do I
what what compile flags do I
have I have all of these
have I have all of these
I have all of these
flags I'm just trying to figure out
flags I'm just trying to figure out
how how it's possible for something on
how how it's possible for something on
the map to be invalid
the map to be invalid
there especially as a 255
like the map is getting corrupted
like the map is getting corrupted
somehow I don't know if this is actually
somehow I don't know if this is actually
the bug oh wait no it's totally the bug
the bug oh wait no it's totally the bug
look cuz you have an exit one
look cuz you have an exit one
here you see
here you see
this so yeah this will silently
crash what if I just delete this
crash what if I just delete this
what if I just delete this line
let's see if that gets stuck while we go
let's see if that gets stuck while we go
look at our
look at our
uh our new run
uh our new run
here w
here w
we look at that
something
something
happened radiant
level they're very weird train curves
carry what was happening with this run
carry what was happening with this run
here well I mean this looks good to
here well I mean this looks good to
me I would like to go grab this
me I would like to go grab this
policy see what happened with it and
policy see what happened with it and
actually this one as well
yeah there two policies for us to look
at are we stuck
at are we stuck
here how are we going to be stuck here
it's very weird here let's go grab our
it's very weird here let's go grab our
um our
experiments from uh the main machine
experiments from uh the main machine
here
let's see so we want
probably like 100
right
okay I lose the SCP term that I was
okay I lose the SCP term that I was
using
using
before yeah
okay so this is the previous run that we
okay so this is the previous run that we
did
uh they don't seem to be doing
anything I get the wrong
one think so
according to this this model went
nuts unlike every
metric I guess uh 150 Maybe
yeah it was a very
quick let's try this
one I'm not seeing anything different oh
one I'm not seeing anything different oh
no these guys are coming
no these guys are coming
hold
on whole team is coming we getting
stuck it's not look particularly good
though I would like to at least see the
though I would like to at least see the
behavior that got those scores
okay so now it's different
Meandering down a side lane
interesting there's the tank
engage I
engage I
mean that's a three man going down
mean that's a three man going down
fourman going down a side
fourman going down a side
lane this guy's
lane this guy's
stuck these guys are getting there
stuck these guys are getting there
slowly
about to have a team fight here
about to have a team fight here
right
no okay
no okay
interesting I don't really know what to
interesting I don't really know what to
think of this
one let me see if
which model did I copy
before okay for
okay so here's the new
okay so here's the new
model was trained for
longer I
longer I
mean that looks good
that's a way better model that's what we
that's a way better model that's what we
were going for
today we got to fix the multiprocessing
today we got to fix the multiprocessing
thing so we can do these runs fast
thing so we can do these runs fast
I want to get like a cool screenshot of
I want to get like a cool screenshot of
a team
fight that's nice
for e
M
M
new this is going to be mobile
weights bin
okay
so this
what
for for
just loading the new policy in it's not
just loading the new policy in it's not
a completely automated process
yet here so now I'm assassin I control
yet here so now I'm assassin I control
this guy uh I have like standard MOBA
this guy uh I have like standard MOBA
controls I've got my team with me come
controls I've got my team with me come
on these are my RL teammates they're
on these are my RL teammates they're
kind of slow come on guys you guys are
kind of slow come on guys you guys are
like rank plastic four or
like rank plastic four or
something I'm literally going to have to
something I'm literally going to have to
go farm something while I wait because
go farm something while I wait because
you guys are so slow
on except I can't really Farm very well
on except I can't really Farm very well
at low level here we'll do
this got kind of a a dash strike
somebody
Mana Tower
Mana Tower
okay we counter their assassin cool I
okay we counter their assassin cool I
mean this is like a little MOA now they
mean this is like a little MOA now they
actually have a look there's their
carry oh he stunned me he actually got
carry oh he stunned me he actually got
me with a stun that's freaking
cool go
cool go
regen yeah solid
regen yeah solid
oh Das strike
there we go got him all right that's
solid put this here
I want to push some of these to the web
Maybe e
why is there nothing in
here oh EMCC command not found that's
here oh EMCC command not found that's
fine um
upper net not found
now I have to
do how do I include
do how do I include
theh this m script in
I
slet poet. H not
found do I just need a dash ey puffer
found do I just need a dash ey puffer
lib
oh there we go
we're going to update the
we're going to update the
website bunch of assets for
okay okay so here's our
website uh Connect 4 does
website uh Connect 4 does
not any of these
work uhoh
file not
found oh this
found oh this
works and take over for the puffer
right pong
right pong
Works puffer Triad works
mobile
mobile
work so the Moa does not
work so the Moa does not
work and Connect 4 does not
work and Connect 4 does not
work fure out why that
work fure out why that
is file not
found okay
what's wrong with this
is there no game map. wome is that the
is there no game map. wome is that the
problem hold on for
h
what's this game.
what's this game.
data two Megs
nothing shouldn't even need this though
nothing shouldn't even need this though
why does it have this much it's probably
why does it have this much it's probably
because we're loading all the assets
because we're loading all the assets
yeah so I have to improve
yeah so I have to improve
that um they should be able to load
though yeah this exact
file for
128 no difference between this and the
128 no difference between this and the
other one
right I don't even have a policy loaded
right I don't even have a policy loaded
in this one oh
in this one oh
dope
dope
LP that was
dumb bu connect for for
web what
web what
and MOA is the one that doesn't work now
right
demo the demo is what we want right
okay so the
okay so the
Moa does work
Moa does work
locally so we actually do have some sort
locally so we actually do have some sort
of issue
of issue
here it would
seem do we get some sort of error
seem do we get some sort of error
here stack overflow
oh
yeah I had some flag here for this
yeah I had some flag here for this
didn't I
didn't I
I did have some flag for
this push some nice fixes
initial memory
how about
this do like this
what am I doing that's like crazy stack
size I think I was doing anything crazy
size I think I was doing anything crazy
stack
size could just be like initial memory
size could just be like initial memory
whatever this flag
was I think that this one was
required
required
mobile okay
still know
there we
go do we have our
go do we have our
team come on
team come on
come on
come on
puffers yeah we got our
team and they actually do stuff now
right that's
right that's
solid that's very solid
oops
status
status
okay those are some nice
improvements we got to get the uh
improvements we got to get the uh
Connect
Connect
4 thing faster so we can uh watch that
4 thing faster so we can uh watch that
play be
interesting but yeah that's the better
interesting but yeah that's the better
MOA
MOA
opponent not an amazing MOA opponent by
opponent not an amazing MOA opponent by
any means but you know we at least we
any means but you know we at least we
got something reasonable that I think we
got something reasonable that I think we
can work with and we can convert that
can work with and we can convert that
into much better MO opponents over time
into much better MO opponents over time
uh we need to figure out this
uh we need to figure out this
vectorization
vectorization
Shenanigans thing happening at the
Shenanigans thing happening at the
moment
though like what's going on
here should also commit the mo prams
here should also commit the mo prams
before we lose
them
them
MOA um
that's
fixed we
fixed we
freeze no
does this fix
does this fix
it the thing that we
changed for
we fix this
we're going to see if this actually runs
billion
look stable to
me 500k
me 500k
train very
train very
nice okay so there's some weird Edge
nice okay so there's some weird Edge
case thing that we have not caught
case thing that we have not caught
correctly at least now it it doesn't
correctly at least now it it doesn't
like hard fail um we'll see if it screws
like hard fail um we'll see if it screws
up training or anything
few issues remaining with environment
few issues remaining with environment
speed and the
speed and the
like that we need to
fix I'm leave this here for
fix I'm leave this here for
now it's 5:00 P p.m. be right back I'm
now it's 5:00 P p.m. be right back I'm
going to use a
going to use a
restroom I'm going to come back I'm
restroom I'm going to come back I'm
going to see if I can do some per fixes
going to see if I can do some per fixes
on the
on the
MOBA get this thing a little bit faster
MOBA get this thing a little bit faster
and then we should be good and I don't
and then we should be good and I don't
know if we'll run a sweep or how we'll
know if we'll run a sweep or how we'll
treat this but we will do some sort of
treat this but we will do some sort of
experiments overnight on this be right
experiments overnight on this be right
[Music]
back
e
e
e e
is the Run still
good let's
see ooh
see ooh
uh that's
weird oh it's fine we didn't uh we
weird oh it's fine we didn't uh we
didn't
rebuild that's my
rebuild that's my
bad
uh yeah I just didn't rebuild it
all right we'll see if that's stable in
all right we'll see if that's stable in
a
second e
[Music]
we're stuck at 10.2 still aren't
we're stuck at 10.2 still aren't
we how do that
we how do that
work we got the 44 million over here so
work we got the 44 million over here so
how's this
happen there's no exit
here I mean
we going to get stuck at 10.2
there we
there we
go all right
go all right
well we're not stuck at 10.2 we're stuck
well we're not stuck at 10.2 we're stuck
at
at
12.3 big
12.3 big
Improvement why the heck does it work
Improvement why the heck does it work
here I ran it with multiprocessing on
there are no other possible places it
there are no other possible places it
should be able to be stuck
here
here
weird maybe we uh we figure this out in
weird maybe we uh we figure this out in
the process of doing a little bit of
the process of doing a little bit of
perf
profiling and there's the main annoyance
profiling and there's the main annoyance
at the moment I think if we fix this
at the moment I think if we fix this
everything else is good
fix perf in the meantime as
well all
well all
right be right back and then we'll fix
right be right back and then we'll fix
this I don't know what's up with it
though
e e
let's
see
for
for e
this is 600,000 steps per
second h
is the python wrapper
slow
for for
I don't know why it needs to load that
and this is my
local so it's plenty fast or should be
local so it's plenty fast or should be
plenty
fast there's no reason for it to be slow
fast there's no reason for it to be slow
600k on the slow box should be like 2
600k on the slow box should be like 2
million on the past box
so we're dropping perf somewhere
hm
h e
it's somehow all on the
step is this actually compile
Flags this might literally be compile
Flags this might literally be compile
Flags
no way it should be 43% like that
I didn't do that yet that's fine
it's literally just
dash2 why is it so much
slower for
there's just simply no way that this
there's just simply no way that this
should be 44%
compute for
there's simply no way
is this scon just being terrible or like
is this scon just being terrible or like
what
I don't
I don't
understand uh what's the what the hell
understand uh what's the what the hell
is wrong with this
I swear it stands for I don't know what
I swear it stands for I don't know what
the
the
[__] I don't know maybe before we solve
[__] I don't know maybe before we solve
AGI we can solve
AGI we can solve
um
um
indenting or pasting in Vim that would
indenting or pasting in Vim that would
be
great whatever
Okay so
either the perf test is wrong or it's
either the perf test is wrong or it's
like something screwy here let's
like something screwy here let's
see okay
see okay
12 1.2 million
right is my perf test
wrong 10
seconds end minus start
wait no this is steps yeah times 10 cuz
wait no this is steps yeah times 10 cuz
agents and that's how I did it up here
right did you write your own C version
right did you write your own C version
of linear LS layer plus lstm
of linear LS layer plus lstm
yeah we have comms as
yeah we have comms as
well you want to play with them
now available on Discord dot well not
now available on Discord dot well not
discord. GP puffer just puffer Dogg
discord. GP puffer just puffer Dogg
there you go so you can play this guy
there you go so you can play this guy
and your teammates will come after you
and your teammates will come after you
using their little CN lstm policy there
using their little CN lstm policy there
you go and eventually they'll fight in
mid come on
mid come on
puffers here there's the other team
puffers here there's the other team
coming here's our team
coming here's our team
going let's here this guy's strong right
going let's here this guy's strong right
let's uh save the
let's uh save the
oops I got to get back to the fight to
help Dash strike the
carry yeah there you go
is this actually 10
seconds yeah that's 10
seconds 1.2
mil do I have to time it from
python that we have to do next
still gives me 800k
still gives me
still gives me
800k
so 800k would actually be
40% no wait
yeah there should be less than 40%
compute at that speed
I also don't know why this freezes
I don't even know how it's possible it's
I don't even know how it's possible it's
still 26% with two of these
still 26% with two of these
environments now there it goes Frozen
environments now there it goes Frozen
again
I actually can't think of anything that
I actually can't think of anything that
would cause a process like this to
would cause a process like this to
freeze
especially not something that would
especially not something that would
cause it to freeze multiprocess and not
normally like
t- San what's
that red
sanitizer there's not even anything
sanitizer there's not even anything
happening
across but like I'm not doing anything
across but like I'm not doing anything
that's
that's
actually multi-threaded or anything like
actually multi-threaded or anything like
that
I mean I can put this in but like I'm
I mean I can put this in but like I'm
not even using
not even using
threads unless something like I don't
threads unless something like I don't
even have dependencies that could be
even have dependencies that could be
using threads that I'm aware
of is there an F sanitize all
incompatible it's
frozen yeah well the thing is like it
frozen yeah well the thing is like it
runs the end runs native it doesn't run
runs the end runs native it doesn't run
with
with
multiprocessing like it'll run 10
multiprocessing like it'll run 10
million steps and then freeze
I don't know why like I have no idea
I don't know why like I have no idea
what the heck could be causing that you
know does it work multi-threaded how am
know does it work multi-threaded how am
I supposed to
know I mean I'm not doing anything I can
know I mean I'm not doing anything I can
think of that would make it not work
think of that would make it not work
mult
threaded it's multiprocess though
regardless objects are inherited between
regardless objects are inherited between
processes
incorrectly but like we're making the
environments we're making the
environments we're making the
environments
environments
on the subprocess anyways
on the subprocess anyways
right standard
vectorization the fail in
vectorization the fail in
cereal I don't know we don't really
cereal I don't know we don't really
support like cereal doesn't really work
support like cereal doesn't really work
at the moment for
at the moment for
um puffer native M I got to fix
um puffer native M I got to fix
that and I can run it
yeah have this
warning let's see if it fails
it's also running way slower than the
it's also running way slower than the
perf tests indicate it should be
running look looks like it's
running I mean I actually can't think of
running I mean I actually can't think of
anything that would cause this at
all e
now this doesn't
hang
for e
this is only on a net
they work without computer
observations let's see
Frozen at 10.2 without even Computing
Frozen at 10.2 without even Computing
obs
very small at least
I can't see how it would possibly be
I can't see how it would possibly be
this
Frozen at
7.2 well there's no error
7.2 well there's no error
print you changed it yeah that doesn't
print you changed it yeah that doesn't
matter it's not deterministic when it
matter it's not deterministic when it
freezes
not always just
commonly now fren at
3.1
for e
pass path buffer and paths
I don't
know I don't think I use
it yeah I don't set terminals
it yeah I don't set terminals
anywhere so it shouldn't be able to
anywhere so it shouldn't be able to
be screwed with
3 * 8 * 12 *
and then we have this
is using unsigned Char for terminals
is using unsigned Char for terminals
correct
that's for
that for
I'm like trying to think what the hell
I'm like trying to think what the hell
this could be
I mean is it like some memory bug that's
I mean is it like some memory bug that's
not getting caught because of
um let me try
something what if I do
this for
okay Giga slow
build Giga slow
build
for
e e
the hell
that's going to make it take
forever I I think I just have the
forever I I think I just have the
thing oh you know what this is
thing oh you know what this is
here there
static libus on let's see about that
dude what the [__] how do I get this
dude what the [__] how do I get this
these
flags
for
e
e e
can I just do a dress
can I just do a dress
sanitizer will this
sanitizer will this
work how about just this one and I have
work how about just this one and I have
one sanitizer
one sanitizer
scon what do I got to do for one
sanitizer why is it always that the C
sanitizer why is it always that the C
works and then the [__] python
works and then the [__] python
binding somehow screws it
up yeah no iand detect
whatever re BRB rewriting all of modern
whatever re BRB rewriting all of modern
software and
C
for e
that do anything
what am I supposed to do with this
yeah this doesn't
work as some [__]
I'm just like I don't know what the hell
I'm just like I don't know what the hell
this could possibly be
hey
welcome
like what's possibly different with this
multiprocess e
I'm trying to think like how I can even
I'm trying to think like how I can even
debug this
okay idea
does it
does it
crash when I do one end even with just
crash when I do one end even with just
one M
one M
multiprocess trying to get
multiprocess trying to get
multiprocessing working on the latest
multiprocessing working on the latest
it's something screwy with uh the Moa
it's something screwy with uh the Moa
it's not
it's not
multi-processing it's just randomly
multi-processing it's just randomly
hanging welcome
hanging welcome
Spencer I'm going to jump off of this do
Spencer I'm going to jump off of this do
some stuff for like half an hour and
some stuff for like half an hour and
then uh I'll check in on go or whatever
then uh I'll check in on go or whatever
in a bit I just want to try a couple
in a bit I just want to try a couple
last
last
things I will set up some experiments to
things I will set up some experiments to
run regardless it's just obnoxious cuz
run regardless it's just obnoxious cuz
like I mean look it's hanging even
there I don't understand how it's
there I don't understand how it's
possible that the exact same code
possible that the exact same code
doesn't work in a subprocess
waiting on Jimmy Johns
puffer
en it's a puffen
so
so
here we do with this right
typ OB
typ OB
type
actions um
thanks bet Star Puffer indeed star repo
thanks bet Star Puffer indeed star repo
helps me very
much e
i' would be willing to be less human if
i' would be willing to be less human if
I didn't have to [__] deal with this
I didn't have to [__] deal with this
[__] [__]
[__] [__]
hell all right well we found something
hell all right well we found something
that causes the same hanging Behavior
that causes the same hanging Behavior
which is passing bad buffer or passing
which is passing bad buffer or passing
different buffer actually that's weird
let me think about
this let me try one other
thing
for
e
e e
this has to be
it it's got to be Memory corruption on
it it's got to be Memory corruption on
actions
what e
this is a very evil bug I see it
[__] gem I
swear e
that is [__]
evil memory
evil memory
corruption on python to scon on data
transfer yeah this is the same thing
transfer yeah this is the same thing
that you were dealing with with actions
that you were dealing with with actions
it's [__]
evil we need I need to add some guard
evil we need I need to add some guard
checks to the new
checks to the new
API that's evil evil
that's like unbelievably
evil half a million
evil half a million
train on the
Moa I'm trying to think what I even want
Moa I'm trying to think what I even want
to run for sweeps
we're not doing the fixes tonight we
we're not doing the fixes tonight we
know what it is we know we have to add
know what it is we know we have to add
those checks we know it produces
hangs the other M's good it depends on
hangs the other M's good it depends on
the
will'll make it architecturally
will'll make it architecturally
impossible to have that bug
again get rid of this
again get rid of this
this
we'll just do this for
now we'll see if this produces anything
now we'll see if this produces anything
um anything
noteworthy for
see how that goes
okay well we figured out the evil evil
okay well we figured out the evil evil
bug that's the last really evil bug with
bug that's the last really evil bug with
the new uh
the new uh
API couple more things to do but we got
API couple more things to do but we got
at least a reasonably competent MOBA
at least a reasonably competent MOBA
model trained
model trained
today and deployed
it's not amazing or anything but you do
it's not amazing or anything but you do
actually get the agents fighting each
actually get the agents fighting each
other in mid which is what we
wanted we deployed a bunch of other ones
what's the record GIF
thing screen to
GIF thought I had that installed
oh maybe I have the portable
one maybe
not for
how does software literally not
oh okay it does work
[__] why does this not
work I don't understand why this does
work I don't understand why this does
not show up in the stupid
bar for
oops
that's a convenient little UI
there we
go for
how many games of break how many games
how many games of break how many games
of uh breakout does it play
I mean we can see episode length
right
right
16,000 times real Time That's crazy
how did you pick the name
how did you pick the name
puffer it's like the puffer fish up
puffer it's like the puffer fish up
there you see
him you can play with the puffer too at
him you can play with the puffer too at
puffer
puffer
Dogg you just hold shift you can take
Dogg you just hold shift you can take
over for the train agent and see if you
over for the train agent and see if you
can do any
better well why the puffer fish I mean
better well why the puffer fish I mean
what would you do if you were going to
what would you do if you were going to
start a company that did like
start a company that did like
complicated Tooling in a niche domain
complicated Tooling in a niche domain
that's really hard to explain it's like
that's really hard to explain it's like
I'm not not going to have a logo that
I'm not not going to have a logo that
has anything to do with that no here
has anything to do with that no here
have a puffer fish it's funny and it's
memeable this actually feels like a fair
memeable this actually feels like a fair
game as well as of pong it doesn't feel
game as well as of pong it doesn't feel
[__] like the original Atari games
[__] like the original Atari games
do with all the rappers and [__] like
do with all the rappers and [__] like
you actually have very precise control
here puffer fish ball is funny yeah we
here puffer fish ball is funny yeah we
did it for breakout as well oops you can
did it for breakout as well oops you can
hold shift for this one
hold shift for this one
too this one is
harder I got to get nowhere to like fix
harder I got to get nowhere to like fix
some stuff on this or I'm probably I'm
some stuff on this or I'm probably I'm
going to have to do it he's linked me
going to have to do it he's linked me
the code um
yeah exactly so I'm probably going to
yeah exactly so I'm probably going to
have to do
have to do
it big deal unless you want to but it's
it big deal unless you want to but it's
not really a huge
not really a huge
deal so we got this one right uh we also
deal so we got this one right uh we also
have this Connect 4 one where we need a
have this Connect 4 one where we need a
better agent versus this I think Jack is
better agent versus this I think Jack is
going to do that
Enduro going to be a
Enduro going to be a
meme yeah got to finish
meme yeah got to finish
that we upgraded the graphics on Triad a
that we upgraded the graphics on Triad a
little bit as well I got to update the
little bit as well I got to update the
thumbnails
probably but yeah there you
probably but yeah there you
go let me make sure my Wanda Bay weeps
go let me make sure my Wanda Bay weeps
are good
looks good to
me
me
cool we have our carb sweep
cool all right I'm going to call it
cool all right I'm going to call it
there
there
um you
um you
can try out this stuff at puffer G you
can try out this stuff at puffer G you
can get all the code at puffer ai.
can get all the code at puffer ai.
github.io right here is the
github.io right here is the
GitHub go ahead and start the GitHub if
GitHub go ahead and start the GitHub if
you haven't already please actually do
you haven't already please actually do
that it really does help me out a lot um
that it really does help me out a lot um
that and followers on X are the only
that and followers on X are the only
really two growth metrics I track for
really two growth metrics I track for
the project you can also join us on
the project you can also join us on
discord.gg puffer if you want to get
discord.gg puffer if you want to get
involved with contributing to the
involved with contributing to the
project and developing some of these
project and developing some of these
environments you really just need an
environments you really just need an
engineering background as all um the
engineering background as all um the
reinforcement learning side of things
reinforcement learning side of things
you kind of pick up along the way no big
you kind of pick up along the way no big
deal um yeah so I'm going to go hop off
deal um yeah so I'm going to go hop off
of this I'm going to do a couple things
of this I'm going to do a couple things
and then I'll probably jump into the
and then I'll probably jump into the
Discord voice for a bit to help
Discord voice for a bit to help
troubleshoot uh whatever problems people
troubleshoot uh whatever problems people
have on custom M thanks all and

Kind: captions
Language: en
okay we're live
okay we're live
here there's a lot of stuff I want to
here there's a lot of stuff I want to
get done
get done
today um we're going to probably do some
today um we're going to probably do some
stuff on this rocket project over the
stuff on this rocket project over the
weekend
here let me see if we did
here let me see if we did
anything kind
anything kind
of kind of I have to fix this later um
of kind of I have to fix this later um
there are a few things I want to do
there are a few things I want to do
today the first big one is there's a
today the first big one is there's a
limitation with the new native API that
limitation with the new native API that
I would like to fix
I would like to fix
potentially um but I also want to
potentially um but I also want to
get I want to test a couple potential
get I want to test a couple potential
bugs that uh people have reporting some
bugs that uh people have reporting some
things will re with and I want to see if
things will re with and I want to see if
we can get uh some of the environments
we can get uh some of the environments
really polished and training properly
really polished and training properly
today
today
me take a quick look for
PRS yeah okay this is I've already
PRS yeah okay this is I've already
discussed these with contributors um you
discussed these with contributors um you
don't see it here but it's a lot of the
don't see it here but it's a lot of the
discussions are in
Discord okay so I think what we're going
Discord okay so I think what we're going
to do is we're going to just start with
to do is we're going to just start with
um the Moa for a bit
let's commit all this stuff up I don't
let's commit all this stuff up I don't
know what we're going to do with this
know what we're going to do with this
build
build
file um I think we'll just for now
yeah we'll do this for
yeah we'll do this for
now and then I think we'll just go over
now and then I think we'll just go over
to uh
to uh
MOA and we'll see if we can get some
MOA and we'll see if we can get some
stuff done there
all
right whole bunch of new code gets
right whole bunch of new code gets
pulled
in a lot of stuff
the first thing I'm going to want to
the first thing I'm going to want to
probably test is multi- discreete
probably test is multi- discreete
actions whether these work as expected
the heck
uh what's wrong
here rib
oh it's because it's a Sim link that's
oh it's because it's a Sim link that's
fine so I changed it essentially so that
fine so I changed it essentially so that
um if RB isn't installs it'll install it
um if RB isn't installs it'll install it
for you and I had something with an old
for you and I had something with an old
outdated
outdated
name I'm hopeful we can actually make
name I'm hopeful we can actually make
some good progress on the mob today I
some good progress on the mob today I
really just want to get puffer to the
really just want to get puffer to the
point where I have reasonable policies
point where I have reasonable policies
trained for all these various different
trained for all these various different
environments um so that like ultra high
environments um so that like ultra high
perf RL really just starts to feel
perf RL really just starts to feel
stable across a variety of domains I
stable across a variety of domains I
think I need to do more work on that
think I need to do more work on that
side
okay so if if we just train
squared Why is this
importing rocket
Lander uh
one of the downsides the new
one of the downsides the new
setup okay so this is squared squared is
setup okay so this is squared squared is
a very simple sanity test environment
a very simple sanity test environment
that trains in
that trains in
seconds this seems to work
multi
multi
agent
basis so I made this specifically to
basis so I made this specifically to
test
test
for weird screwups
no attribute hidden size
Dev Branch I'm allowed to have stuff
Dev Branch I'm allowed to have stuff
break
break
occasionally okay so this space m does
occasionally okay so this space m does
work on
work on
dev but I thought didn't bet mess with
dev but I thought didn't bet mess with
this
yeah
yeah
H why did I think B messed with this
H why did I think B messed with this
this looks
fine just watch your PhD this this video
fine just watch your PhD this this video
on YouTube very interesting congrats on
on YouTube very interesting congrats on
completing it than thank
completing it than thank
you I made uh recently if you're
you I made uh recently if you're
interested in just a general overview of
interested in just a general overview of
RL in a way that is somewhat
RL in a way that is somewhat
entertaining and not like math heavy or
entertaining and not like math heavy or
anything I suggest the iceberg video on
anything I suggest the iceberg video on
my channel I put quite a bit of effort
my channel I put quite a bit of effort
into making that one
into making that one
good it didn't catch on as much as my
good it didn't catch on as much as my
thesis video but the production value I
thesis video but the production value I
think is a bit higher
and thanks for your
interest I mean we're really here trying
interest I mean we're really here trying
to now that I've graduated the really
to now that I've graduated the really
the goal is to just revamp the entire
the goal is to just revamp the entire
field um I'm working on that full time
field um I'm working on that full time
and it's gone very very well so far
things are like 100 to a th times faster
things are like 100 to a th times faster
than they were 6 months ago across the
field okay so this thing seems
fine what do we have in Mobile
200 million
steps I think that this Freez is the
steps I think that this Freez is the
problem right
340k steps per
second environment very
second environment very
slow it's a
problem but does it get stuck
we can see
that it appears to be
that it appears to be
training I can see just the summary
training I can see just the summary
here we see leveling up we see skill
here we see leveling up we see skill
usage we see Towers being taken looks
usage we see Towers being taken looks
like radiant is winning
let's see what this looks
like okay so we
like okay so we
have a ton of
matx isn't there a sorting of this
okay so we do have all of
okay so we do have all of
these we have all these
these we have all these
metrics I don't know if rewards are
metrics I don't know if rewards are
going through or
not doesn't look like rewards are being
not doesn't look like rewards are being
computed entropy
computed entropy
variance we have good monitoring
variance we have good monitoring
here looks
like some form of Elo over
like some form of Elo over
time would be good it's expensive to
time would be good it's expensive to
compute as the
problem we have the infer to do
it can always do it post
talk okay though this does look stable
talk okay though this does look stable
which is
nice the environment is too slow though
nice the environment is too slow though
so
so
something something must have happened
something something must have happened
with this because this should be
with this because this should be
running much much
running much much
faster so let's get this policy see what
faster so let's get this policy see what
it
does and then we will go from there yeah
does and then we will go from there yeah
I think that's a good plan for today um
I think that's a good plan for today um
meanwhile we have new breakout
meanwhile we have new breakout
and let me ask Noah
and let me ask Noah
where is breakout and
this
e for
[Music]
okay so entropy is all the way down here
okay so entropy is all the way down here
this is probably not the best the Run
this is probably not the best the Run
doesn't look terribly unstable
doesn't look terribly unstable
though let's
see and both sides are taking
see and both sides are taking
Towers it's not completely
Towers it's not completely
one-sided uh for whatever reason dire is
one-sided uh for whatever reason dire is
dire has a huge level
dire has a huge level
Advantage but radiant is
winning that's
odd let's look at kills
odd let's look at kills
maybe I mean the cool thing with all
maybe I mean the cool thing with all
these stats right is
we
get Le
get Le
panels
so you can see that just on the
so you can see that just on the
different teams these they're wildly
different teams these they're wildly
different uh they are
different uh they are
all going
up Carrie doesn't seem to do very
up Carrie doesn't seem to do very
well the is
op this is almost done training though
op this is almost done training though
so we'll have a little model to play
so we'll have a little model to play
with we'll see if it does anything
reasonable let's get prepared for that
reasonable let's get prepared for that
actually
I think I have to do V native as well
I think I have to do V native as well
hold
on yeah the new V mode is
on yeah the new V mode is
native okay so here is a random
policy and can I take
policy and can I take
over uh I cannot take over I don't
think no but here we have the
think no but here we have the
Bots playing randomly
oh this is funny Escape doesn't quit the
oh this is funny Escape doesn't quit the
whole
thing hello
[Laughter]
bet bet is our resident puffer
bet bet is our resident puffer
Advertiser though do star the repository
Advertiser though do star the repository
it helps us out a
lot fuing wasting our El
I did a little bit of puffer advertising
I did a little bit of puffer advertising
this morning
this morning
but this uh this has done decently well
but this uh this has done decently well
for a
morning okay so it's running
morning okay so it's running
evals yeah 1:41 in like three hours
evals yeah 1:41 in like three hours
though I think I should get a
though I think I should get a
that one should be doing quite well for
that one should be doing quite well for
us we should get like an extra we'll
us we should get like an extra we'll
probably get a good 100 followers off of
probably get a good 100 followers off of
a post like
that okay so what happened
that okay so what happened
here
here
Len okay so I have to change the script
Len okay so I have to change the script
a little bit not a big deal though
log I have to copy this manually that's
log I have to copy this manually that's
fine
so
CP
box
for
e e
here we
here we
go for
okay so
here know why this guy's stuck
something feels very wrong with evals
here the fact that they're stuck on the
here the fact that they're stuck on the
walls like
this like okay this guy got
this like okay this guy got
through he's ghosting through walls
through he's ghosting through walls
apparently
is he ghosting through all the walls or
is he ghosting through all the walls or
just some
walls does he live
walls does he live
this if he doesn't take a tower shot I
this if he doesn't take a tower shot I
think he dies here
it's weird cuz
it's weird cuz
like some of the things done are
reasonable why are the rest of these
reasonable why are the rest of these
guys
guys
stuck like it makes no sense right
it makes no sense that they would just
it makes no sense that they would just
go like this and get
stuck I to check some
[Music]
things let's just sanity check a couple
things let's just sanity check a couple
couple environment side things
first these are fine
first these are fine
multi discreete
right then presumably I was smart enough
right then presumably I was smart enough
to do this
correctly 10 *
correctly 10 *
I 10 * I +
1 is correct
1 is correct
10 agents per
environment
right I don't see anything weird there
[Music]
why would why would one agent do okay
why would why would one agent do okay
and the rest of them get
stuck it's very weird
What observations am I
giving
255 by 255
255 by 255
what about the
mobet extra map
mobet extra map
features divide by
features divide by
255 flat
255 flat
features get divided by
features get divided by
255 for
I'm not confident that this is a data
I'm not confident that this is a data
problem and I'm not confident that this
problem and I'm not confident that this
isn't just a data
isn't just a data
problem that's the thing that's
problem that's the thing that's
obnoxious
obnoxious
here let me see
something how insane are these
parameters
H the only one of these that I can see
H the only one of these that I can see
that is completely insane
that is completely insane
is the uh value function clipping
is the uh value function clipping
coefficient and we've seen that happen
coefficient and we've seen that happen
across a variety of
environments what happens to the value
environments what happens to the value
function well what happens to the value
function I don't believe
that it could just be that this thing
that it could just be that this thing
fails
right value loss is not
exploded entropy collapse is pretty bad
just guess some hyper
parameters well actually hold
on they are getting
on they are getting
stuck which corresponds to
me just try something
we're going to try something a little
YOLO 50
Star Puffer
Star Puffer
indeed do we get any stars actually off
indeed do we get any stars actually off
of the latest
of the latest
um latest post
yet
11:24 I need to keep this trajectory
11:24 I need to keep this trajectory
going straight up though like before I
going straight up though like before I
need to keep promoting it
need to keep promoting it
really helps us to have uh the
growth that's just I need to tweet this
growth that's just I need to tweet this
stuff
more all right well what we're going to
more all right well what we're going to
do is we're going to try
do is we're going to try
this uh what do we have for batch
sizes two M's two workers
what if I do
this okay so immediately it's training
this okay so immediately it's training
way faster with the uh multiprocessing
on does it learn anything
on does it learn anything
though uhoh is it
though uhoh is it
stuck huh it's
stuck huh it's
stuck with multiprocessing on it's
stuck be back later maybe you can help
stuck be back later maybe you can help
me fix and d i
sure I get done with
sure I get done with
this okay so this should not be
this okay so this should not be
stuck why would it ever be stuck because
stuck why would it ever be stuck because
of
of
multiprocessing how does this make
sense I remember this actually being an
sense I remember this actually being an
issue and I'm trying to think why this
issue and I'm trying to think why this
would ever make sense
why would it ever get stuck in stuck
why would it ever get stuck in stuck
with
multiprocessing do Native for
multiprocessing do Native for
now and we'll look at this
we'll have to do some work on
we'll have to do some work on
that welcome
that welcome
folks I should probably put this thing
folks I should probably put this thing
that we're training up on the side so
that we're training up on the side so
people can see what we're
people can see what we're
doing
today this is a combination of looking
today this is a combination of looking
at the new API and trying to make sure
at the new API and trying to make sure
everything works as well as trying to
everything works as well as trying to
make this specific mend work
okay so this n
it's training any different from
before I want to get this up on the
plot okay
plot okay
so we have MOA before we have MOA after
so this is going to tell us actually
so this is going to tell us actually
learning
learning
progress uh
progress uh
we more towers are being taken
immediately level is
immediately level is
up do we have
up do we have
victories yeah we have some victories
victories yeah we have some victories
here so I think it's getting wins faster
here so I think it's getting wins faster
which which is meaning that it's going
which which is meaning that it's going
to be you're going to get this
to be you're going to get this
oscillatory
oscillatory
behavior um essentially I want to have a
behavior um essentially I want to have a
decently trained MOBA policy today I
decently trained MOBA policy today I
just want to have something that like
just want to have something that like
the Bots run at each other down mid at
the Bots run at each other down mid at
the very least you
the very least you
know we should be able to get that and
know we should be able to get that and
if we can't get that that's it's either
if we can't get that that's it's either
a data issue or some sort of infer issue
a data issue or some sort of infer issue
because as a task it should be very
because as a task it should be very
learnable
send a followup email while this is
send a followup email while this is
training this will be done in a couple
minutes just make sure
follow up
so
so
what I mean it's not surprising that
what I mean it's not surprising that
this would train way
this would train way
better I'm trying to think
better I'm trying to think
why we had the hyper parameters from
before is value loss okay
hi
welcome
welcome
H where are other
parameters also why do we
parameters also why do we
have nine visualize visualize
have nine visualize visualize
none and we do
this w b
if I ever get bored of doing
if I ever get bored of doing
reinforcement
reinforcement
learning and I want to get into more
learning and I want to get into more
General ml Ops I'm going to rewrite wand
General ml Ops I'm going to rewrite wand
B and C so that it's
fast it's so glitchy and slow
okay so this is sketchy um level kept
okay so this is sketchy um level kept
going up before but now in this run it
going up before but now in this run it
doesn't appear to be stable
maybe entropy is staying high in this
maybe entropy is staying high in this
run whereas before it was very quickly
crashed value
crashed value
loss not looking good
loss not looking good
which is
weird dire
Victory hold
Victory hold
on I think this is actually good
on I think this is actually good
because they stopped winning games after
because they stopped winning games after
this first point in training before so
this first point in training before so
probably this is what happened is that
probably this is what happened is that
they learned something and they
they learned something and they
unlearned stuff because the the Run
unlearned stuff because the the Run
wasn't stable whereas now the fact that
wasn't stable whereas now the fact that
this is oscillating around means that
this is oscillating around means that
games are starting and stopping so this
games are starting and stopping so this
could actually be a good
thing
thing
level I don't know why it would go way
level I don't know why it would go way
back
back
down we'll have to
see oh you know what I can do in the
see oh you know what I can do in the
meantime I'm kind of curious for
what if we take an early
checkpoint so this is from the previous
checkpoint so this is from the previous
trained
run ah look at
this learns to glitch through through
terrain this guy is stuck
terrain this guy is stuck
here it's going to use its speed buff to
here it's going to use its speed buff to
glitch through the terrain
glitch through the terrain
more oh wait that's a tank that's a tank
more oh wait that's a tank that's a tank
engage that's a tank engage learned
engage that's a tank engage learned
right there
that's engaging
AOE okay so it's it started learning
AOE okay so it's it started learning
some stuff and then crashed and then
some stuff and then crashed and then
these guys aren't really doing it any
these guys aren't really doing it any
favors being stuck there like
that what about now
they should be learning to win more
they should be learning to win more
games faster
right I should be able to refresh
this oh yeah look at
this oh yeah look at
this games are actually being
this games are actually being
ended for
okay so now we have this
model here is our new model
oh look at
oh look at
this wait whoa whoa they're running at
this wait whoa whoa they're running at
each other down
mid let's see Tank's actually going to
go they run straight down mid
why do the dire team not do
anything why is dire team not do
anything why is dire team not do
anything
do I have something messed up with like
do I have something messed up with like
the action handling for these
guys I don't think I
do reward
handling mean you can learn
handling mean you can learn
policies well now they get
policies well now they get
stuck this one doesn't
it's very
weird how does Dyer ever win doing this
according to this it does
according to this it does
win and it wins some games
these guys aren't doing anything at
all were they doing anything earlier in
all were they doing anything earlier in
training
I mean kind of Meandering around
started farming a little
bit Yeah so it does look like they're
bit Yeah so it does look like they're
being controlled correctly learning is
being controlled correctly learning is
just doing something very weird
just doing something very weird
here for
what stats can we look
at well we're not logging
at well we're not logging
everything the way we would want to I
everything the way we would want to I
also I don't believe
also I don't believe
this like look it says it's using its
this like look it says it's using its
skills it's going up l
nearly usage
Q let's go look at our logging and the
Q let's go look at our logging and the
way we're handling logging I think that
way we're handling logging I think that
there is some stuff that we need to be
there is some stuff that we need to be
recording
correctly yeah cuz this is going up
correctly yeah cuz this is going up
infin
Ely we need to get we need to see um we
Ely we need to get we need to see um we
need to see this a bit
differently individual usage Q
we have to
we have to
reset what logs
here yeah
if do
reset oh well this is going to be weird
add
log okay so this is fine actually
let's try
this this should get us usage uh this
this this should get us usage uh this
should get us per game logs rather
should get us per game logs rather
than cross game
logs and then we're going to have to
logs and then we're going to have to
make these
make these
barer what happened
here oh this is a
player player log sure
now we should get more reasonable stats
now we should get more reasonable stats
out of
stuff we'll see whether that's the case
uh i' just
uh i' just
say have to run for a little bit
okay so I'll have to integrate this
okay so I'll have to integrate this
later this
cool okay you can already see that this
cool okay you can already see that this
is the curve is different just from this
log yeah so this what my hope it here is
log yeah so this what my hope it here is
that this is going to actually tell us
that this is going to actually tell us
um the problem with these
um the problem with these
curves well
either of these really make sense I
either of these really make sense I
don't know if either of these really
don't know if either of these really
make sense to be
honest according to this graph the agent
honest according to this graph the agent
that we were watching on the dire side
that we were watching on the dire side
should absolutely not just be sitting
there so either the logs are wrong or
there so either the logs are wrong or
something else is
screwy well actually wait this is
deaths where do they have kills
okay so
okay so
here it says that this is dealing a ton
here it says that this is dealing a ton
of
of
damage which I don't believe because
damage which I don't believe because
it's not actually going anywhere on the
map so this one is going to match
map so this one is going to match
closely to's alive
right these graphs yeah these ones match
right these graphs yeah these ones match
pretty much the
same reward XP we need to actually graph
same reward XP we need to actually graph
this
level yeah so we'll see this in a second
[Music]
in the meantime
let's see how rewards
go for
TR think how I want to graph this
graph like
this and what's this level
kills let's see what's not getting
kills let's see what's not getting
grafted right
grafted right
now uh radiant
assassin so the usages
a lot of things aren't getting logged
actually this one
Ked there like neutral
Ked there like neutral
skill layer log
well this is weird why isn't this
well this is weird why isn't this
getting logged
yeah these logs are not coming out the
yeah these logs are not coming out the
way they're supposed to
be this will finish running we'll pull
be this will finish running we'll pull
this we'll launch this new one see if
this we'll launch this new one see if
that logs and we'll like keep iterating
that logs and we'll like keep iterating
on logs essentially
and then we'll look for like a metric
and then we'll look for like a metric
that we can optimize a bit
[Music]
better
for e
there we
go okay so these guys aren't really
go okay so these guys aren't really
doing
anything well what model did I
anything well what model did I
copy oh wait I copied um an early
copy oh wait I copied um an early
checkpoint in that case that might be
fine so early checkpoint behaves very
fine so early checkpoint behaves very
much like the previous early
much like the previous early
checkpoint and then it's like just
checkpoint and then it's like just
starting to
starting to
learn to leave base
and then if I run
this now we can see a lot more
this now we can see a lot more
intentionality in leaving the base they
intentionality in leaving the base they
get
get
stuck and then these guys actually are
stuck and then these guys actually are
staying up
staying up
here this could just be like a
here this could just be like a
directionality bias and that they just
directionality bias and that they just
basically learn to go that
way but now I should have better stats
way but now I should have better stats
on this because clearly if they're doing
on this because clearly if they're doing
this they're not getting any kills or
this they're not getting any kills or
anything
anything
right so I should actually be able to
right so I should actually be able to
get something out of this
now yeah I should be able to get
now yeah I should be able to get
something out of
something out of
this we can't see neutral kills we still
this we can't see neutral kills we still
need that stat
damage
damage
received damage
received damage
dealt okay so we have some graphs for
dealt okay so we have some graphs for
the radiant assassin that it's doing
the radiant assassin that it's doing
damage right and then we have
damage right and then we have
graphs for dire
it says it's still doing damage is the
it says it's still doing damage is the
thing I don't believe
thing I don't believe
it it's still doing
damage doesn't have Tower kills on
it let's see if we can fix that uh that
it let's see if we can fix that uh that
version of stats next
yeah why don't we have
yeah why don't we have
uh that's weird that's very weird
okay so right here we're supposed to
okay so right here we're supposed to
have this neutral kill
have this neutral kill
field
right tower killed neutral
right tower killed neutral
killed and if I go
killed and if I go
to unless it's like the radiant tank
to unless it's like the radiant tank
doing
doing
everything I'm pretty
everything I'm pretty
sure you can see it's just not logging
sure you can see it's just not logging
yet
so player PID
gets its own
pit something's very weird
here it doesn't get any kills
let's
do
neutral right here is a good spot for a
neutral right here is a good spot for a
break point
yeah it's a good spot for a break
point okay
we should actually do this locally
so when a neutral dies is what we want
right which is 701
okay so as soon as a neutral
okay so as soon as a neutral
dies we will get a break
dies we will get a break
point let's go kill a
neutral aha
neutral aha
we get our break point
right
player player entity type is
zero entity player is zero
player optim
out 980 damage delt total
out 980 damage delt total
it's more than I dealt just in this one
it's more than I dealt just in this one
last tick
right received some
right received some
damage looks like a valid log to
me this does look like a valid
log why is it always zero in train
log why is it always zero in train
to get cleared
[Music]
somehow layer pit is one
which is this one
right did I reset it
right did I reset it
wrong that wouldn't make a difference
1852 is
1852 is
okay just to continue
Tower or clam something killed it
right yeah this guy must have killed the
right yeah this guy must have killed the
neutral it's
neutral it's
fine we just run down this way we take a
fine we just run down this way we take a
tower I forget this game's actually kind
tower I forget this game's actually kind
of fun
of fun
and
then there we
go okay so here's our M vog
go okay so here's our M vog
right and
optimized
optimized
out but we can see n logo one is
out but we can see n logo one is
there was my aggregate function
wrong add log
then we have Aggregate and
clear oh I'm just missing the
clear oh I'm just missing the
uh I'm just missing some stuff
uh I'm just missing some stuff
here
right we have like level and kills right
that's
level uh we actually don't have
level we do have
kills well but this could be uh
[Music]
[Music]
H maybe that one doesn't get
logged I think I found most likely the
logged I think I found most likely the
cause of this just a logging
bug I mean really what we need is
okay right here all these
okay right here all these
metrics these are these need to be
metrics these are these need to be
adjusted XP distance
adjusted XP distance
Tower uh level kills deaths damage dealt
Tower uh level kills deaths damage dealt
received and now this is we're just
received and now this is we're just
missing all the kill stats
we also missed Auto usage so wait this
we also missed Auto usage so wait this
is creeps
is creeps
neutrals
Towers okay so that works
level why is this not Auto completing
e
there we
go that should give us the new
level and we're ready for a new
level and we're ready for a new
experiment
what did I do over
here ladders
here ladders
misleadingly oh I think I got
bit yep look at
that okay always use um early
that okay always use um early
braces and I know why for some reason I
braces and I know why for some reason I
thought it was a good idea not to have
thought it was a good idea not to have
them logging part of the RL
them logging part of the RL
algorithm or for metrics and
algorithm or for metrics and
troubleshooting uh it's for metrics and
troubleshooting uh it's for metrics and
troubleshooting
troubleshooting
mostly like honestly reinforcement
mostly like honestly reinforcement
learning is easy getting um getting data
learning is easy getting um getting data
out of
out of
simulations in a way that is correct and
simulations in a way that is correct and
transparent is hard
that's become increasingly obvious the
that's become increasingly obvious the
further I get along and
puffer like the reason that RL is hard
puffer like the reason that RL is hard
is because of complete and utter lack of
is because of complete and utter lack of
engineering and logging and things like
this okay so here's our next
this okay so here's our next
experiment hope hopefully this
runs and now we should be getting
runs and now we should be getting
additional
additional
logs this is just a
logs this is just a
subset so here are some runs that we had
subset so here are some runs that we had
from
from
before and if I refresh this and for
before and if I refresh this and for
newcomers to the stream I see some
newcomers to the stream I see some
people just
people just
joined um this is the game
joined um this is the game
environment that we are currently
environment that we are currently
working on and doing reinforcement
working on and doing reinforcement
learning with it's like a strip down
learning with it's like a strip down
League of Legends or DOTA Style game
League of Legends or DOTA Style game
it's got a few different classes they've
it's got a few different classes they've
got different abilities you can play it
got different abilities you can play it
it's kind of fun it needs animations and
it's kind of fun it needs animations and
stuff
still whoa
still whoa
whoa look at
whoa look at
that so here this wasn't being logged
that so here this wasn't being logged
before now we can actually see this
before now we can actually see this
thing is actually csing
thing is actually csing
you can see it's autoing you can see all
you can see it's autoing you can see all
sorts of
sorts of
stuff yeah this is very cool actually
stuff yeah this is very cool actually
look very early in
look very early in
training this thing's just been training
training this thing's just been training
for like two minutes or whatever no this
for like two minutes or whatever no this
thing's been training for 40 seconds and
thing's been training for 40 seconds and
uh it's already killing
neutrals we're starting to get some
neutrals we're starting to get some
rewards as well
tow
tow
killed
killed
perfect so I'm going to go get a yeah
perfect so I'm going to go get a yeah
nice it charts it all out yeah literally
nice it charts it all out yeah literally
we have look at the number of metrics
we have look at the number of metrics
I'm logging here you see I'm logging
I'm logging here you see I'm logging
actually hundreds of metrics cuz I have
actually hundreds of metrics cuz I have
I have um 19 metrics at the moment for
I have um 19 metrics at the moment for
each of 10 different agents it's like
each of 10 different agents it's like
400 metrics and then there's some Global
400 metrics and then there's some Global
ones so we can kind of see right like
ones so we can kind of see right like
look I'm made these changes now we can
look I'm made these changes now we can
see how this works out on the graphs
see how this works out on the graphs
it's very
nice this experiment is going to take
nice this experiment is going to take
six or so minutes to run uh this
six or so minutes to run uh this
actually should be running twice as fast
actually should be running twice as fast
but we have a few bugs to fix with
but we have a few bugs to fix with
vectorization I think in this
vectorization I think in this
n I'm going to let this run I'm going to
n I'm going to let this run I'm going to
go grab a cup of tea use the rest from
go grab a cup of tea use the rest from
real quick and then we're going to see
real quick and then we're going to see
if we can't figure out why this is uh
if we can't figure out why this is uh
the behaviors that we're seeing don't
the behaviors that we're seeing don't
seem to match the learning charts we be
seem to match the learning charts we be
right
back
e
e
e
e
e
e
e e
okay
okay
what do we have
here looks like Wan B didn't
refresh one
refresh one
B
B
uhuh how the turns
table you see the
table you see the
problem look now we can see clearly what
problem look now we can see clearly what
we couldn't see
we couldn't see
before it stops far fing here completely
before it stops far fing here completely
stops farming these neutrals
stops farming these neutrals
almost and if we look at dire
almost and if we look at dire
side but like dire
assassin yeah it just stops doing stuff
assassin yeah it just stops doing stuff
right
so the run is not
so the run is not
stable I think it's both sides right we
stable I think it's both sides right we
saw it was both
saw it was both
sides both sides
crash it's radiant
assassin yeah look it's Autos drop a
assassin yeah look it's Autos drop a
whole bunch
level level actually keeps
level level actually keeps
up still getting Tower
up still getting Tower
kills actually reward XP went up which
kills actually reward XP went up which
is
is
weird well I guess the rant is the one
weird well I guess the rant is the one
that actually keeps kind of doing stuff
that actually keeps kind of doing stuff
huh it stops farming
huh it stops farming
neutrals overall does not look
neutrals overall does not look
particularly stable
particularly stable
I don't know if can we see anything in
I don't know if can we see anything in
the
losses okay
losses okay
so clip Frack is
so clip Frack is
fine
fine
entropy doesn't really
budge the policy loss
budge the policy loss
increasing no potentially tells
increasing no potentially tells
us explain variance increasing it could
us explain variance increasing it could
just be an unstable
just be decreas decreased learning rate
just be decreas decreased learning rate
or
something at least now we can see
something at least now we can see
clearly
what about
what about
rewards I'm going look at some
rewards so the dire carry doesn't really
rewards so the dire carry doesn't really
get anything
get anything
ever radiant carry also not looking
ever radiant carry also not looking
great
great
radiant assassin is very mobile does
radiant assassin is very mobile does
actually get some XP and actually the XP
actually get some XP and actually the XP
reward continues to go
reward continues to go
up as well as Tower taking so really the
up as well as Tower taking so really the
the assassin class is carrying here uh
the assassin class is carrying here uh
you can see that the
you can see that the
tank the tank learns a bunch and then
tank the tank learns a bunch and then
stops kind of just
stops kind of just
crashes support
gets a little XP not
gets a little XP not
much burst
much burst
character so reward keeps going
up can these things not see
see dire
see dire
tank this keeps going
up how does this keep going
up how does this keep going
up I guess it's drops at the
up I guess it's drops at the
end let's go grab like a pretty late
end let's go grab like a pretty late
checkpoint
me so there was one obnoxious thing that
me so there was one obnoxious thing that
I wanted to reply to I saw briefly on my
I wanted to reply to I saw briefly on my
phone
oops where did it
oops where did it
go
uh where is it I want to be
b252 let's get like model 600.
P this is like a relatively
P this is like a relatively
late checkpoint in our short little
late checkpoint in our short little
train run
[Music]
and
and
okay now keep in mind this is like
okay now keep in mind this is like
they've been trained for a few minutes
they've been trained for a few minutes
so like they're going to be kind of
so like they're going to be kind of
Spazzy we just want to see them like
Spazzy we just want to see them like
generally go down
mid so the Assassin character looks to
mid so the Assassin character looks to
be doing what we
be doing what we
want it's going to dash in take this
want it's going to dash in take this
Camp take some of the
Camp take some of the
camp me they are kind of spazy and non
committ going to get
committ going to get
XP there is the opposing
XP there is the opposing
tank so actually that's not bad these
tank so actually that's not bad these
guys are stuck in
guys are stuck in
base but uh we did actually see the
base but uh we did actually see the
enemy tank coming on over
enemy tank coming on over
is
interesting so I don't think we're like
interesting so I don't think we're like
completely on the wrong track here I
completely on the wrong track here I
think we're in a decent
Direction and we just have to figure out
Direction and we just have to figure out
what it is that's preventing these guys
what it is that's preventing these guys
from uh from
learning there a few experiments we can
try first of all I want to take a look
try first of all I want to take a look
at what I just want to confirm what one
at what I just want to confirm what one
thing welcome YouTube
folks I want to confirm one thing
here this is the whole
here this is the whole
file uh I want to confirm
compute compute observations
here obs map is equal to
tile map
tile map
grid we do have walls here so they
grid we do have walls here so they
should actually they should be able to
should actually they should be able to
see when they're walking into
something what's my Moet what's the Moet
something what's my Moet what's the Moet
look like
flat
project so this is the hidden Dimensions
project so this is the hidden Dimensions
here are kind of troll I
here are kind of troll I
think I might have trolled here
let me try to mess with the network
let me try to mess with the network
sizes real quick this is just like a
sizes real quick this is just like a
quick
quick
YOLO
YOLO
uh quick like YOLO thing
here like this
let me see if this
runs so thinking was um we just have a
runs so thinking was um we just have a
really tiny hidden
dims I'm curious to see if the uh if the
dims I'm curious to see if the uh if the
train graph
train graph
changes
substantially so this
substantially so this
about a little more than doubled the uh
about a little more than doubled the uh
number of parameters in the network here
number of parameters in the network here
it's still very small we'll still be
it's still very small we'll still be
able to run this on web but I'm curious
able to run this on web but I'm curious
to
to
see whether this uh makes a difference
see whether this uh makes a difference
we'll get the result for this in here in
we'll get the result for this in here in
just a few
just a few
minutes we'll take a look at it early on
minutes we'll take a look at it early on
as
as
well um for folks that are new around
well um for folks that are new around
here the mob is currently published it's
here the mob is currently published it's
in the dev
in the dev
Branch I'll link this here if you want
Branch I'll link this here if you want
to help me out go ahead and Star Puffer
to help me out go ahead and Star Puffer
helps a
helps a
ton you can also play it online same
ton you can also play it online same
game we have like some not particularly
game we have like some not particularly
well trained bots in here uh that we're
well trained bots in here uh that we're
going to try to improve on today but
going to try to improve on today but
like it's it's kind of like leag or DOTA
like it's it's kind of like leag or DOTA
right You've Got A qw and E scale it's
right You've Got A qw and E scale it's
different for every class and what's
different for every class and what's
this guy do he do
I think the clam is the one that has
I think the clam is the one that has
yeah this is this one has like a
retreat got like gale
force I'm going to try to get some
force I'm going to try to get some
reasonable policies trained for
these okay
these okay
so that looks different
so that looks different
already I don't know whether it's
already I don't know whether it's
meaningfully
meaningfully
different where are
different where are
our where the aggregated
our where the aggregated
metrics okay
environment the heck oh hold
on dire
Towers r
Victory dire
Victory
Victory
H we'll change the graph a
H we'll change the graph a
bit I don't know whether it's a
bit I don't know whether it's a
substantial change
Sol have this sort of
Sol have this sort of
cyclical Behavior
here the question is really about
here the question is really about
whether this is more
whether this is more
stable you doing box one I'm on box zero
stable you doing box one I'm on box zero
now Spencer you're good go do some
now Spencer you're good go do some
experiments I have but I have a there's
experiments I have but I have a there's
a puffer
a puffer
box like zero that I use uh as default
box like zero that I use uh as default
if I need more I'll tell
you but you should be
good yeah it would be good to get that
good yeah it would be good to get that
environment going as well I'm trying to
environment going as well I'm trying to
get the Moa into a good spot at the
moment we really just need these
moment we really just need these
environments to ship frankly like as
environments to ship frankly like as
soon as we ship uh the next puffer
update that's really the prerequisite
update that's really the prerequisite
for catapulting RL into modern
era we just need the m to be like known
era we just need the m to be like known
good with baselines
good with baselines
right they don't even have to be bug
right they don't even have to be bug
free you just have to be able to learn
free you just have to be able to learn
something interesting within them uh to
something interesting within them uh to
a point that like it's useful and we can
a point that like it's useful and we can
you know we can ship patches
thereafter but they need to be
thereafter but they need to be
stable pong is pretty much stable as is
stable pong is pretty much stable as is
right now connect for as soon as we have
right now connect for as soon as we have
a better opponent policy if Jack does
a better opponent policy if Jack does
that we'll be uh we'll be
that we'll be uh we'll be
good we need some sort of greedy thing
good we need some sort of greedy thing
for triple
for triple
Triad you know some sort of opponent for
Triad you know some sort of opponent for
go need to be
go need to be
fast Noah has a couple things on
fast Noah has a couple things on
breakout that I will just integrate
breakout that I will just integrate
whenever
whenever
mhm what bugs haven't heard of
mhm what bugs haven't heard of
him well
him well
the M's get to be
complicated I don't know if I'm going to
complicated I don't know if I'm going to
be happy or disappointed if this
be happy or disappointed if this
experiment
works this experiment working would just
works this experiment working would just
be the Run somehow being more stable
be the Run somehow being more stable
I don't even know if that's a reasonable
I don't even know if that's a reasonable
expectation do we look at losses
expectation do we look at losses
here the thing that made me suspicious
here the thing that made me suspicious
is like 32 hidden dim is really low oh
is like 32 hidden dim is really low oh
there's Jake not Jack
there's Jake not Jack
Jake end the weekend
Jake end the weekend
awesome yeah it doesn't have to be
awesome yeah it doesn't have to be
perfect we mainly just needs to we want
perfect we mainly just needs to we want
to be able to train like a decent
to be able to train like a decent
Connect 4 agent as well
1 2 3 4 5
1 2 3 4 5
six plus secret M that I'm working on
six plus secret M that I'm working on
makes seven wait no wait four 5 six
makes seven wait no wait four 5 six
seven makes eight plus go makes nine
seven makes eight plus go makes nine
plus pick any of the other Ms we finish
plus pick any of the other Ms we finish
one other one of the other Ms we've got
one other one of the other Ms we've got
TCG needs to get going
TCG needs to get going
to lots of
to lots of
stuff really I'm enjoying learning C
stuff really I'm enjoying learning C
it's really nice
it's really nice
frankly I swear it's like if you've been
frankly I swear it's like if you've been
working in higher level languages for a
working in higher level languages for a
while it's it's like all of modern
while it's it's like all of modern
software engineering is kind of just a
software engineering is kind of just a
lie C is just really easy and
lie C is just really easy and
comfortable and fast
I don't know if you're terminally online
I don't know if you're terminally online
on Twitter or not but um there are all
on Twitter or not but um there are all
these dumb posts about like akusha or
these dumb posts about like akusha or
whatever this like hallucinogen is just
whatever this like hallucinogen is just
ruining people's lives and like making
ruining people's lives and like making
them do dumb stuff well uh I didn't take
them do dumb stuff well uh I didn't take
any hallucinogens but I am going to say
any hallucinogens but I am going to say
like I ran a 50k and then 3 days after
like I ran a 50k and then 3 days after
that when I started coding I just just
that when I started coding I just just
basically went straight into C I went
basically went straight into C I went
from 10 years of python to doing
from 10 years of python to doing
everything in C so I don't know if
everything in C so I don't know if
there's a correlation
there maybe it's uh less masochistic
there maybe it's uh less masochistic
after you do something far more
masochistic but I've actually I've never
masochistic but I've actually I've never
been happier with Dev
been happier with Dev
like these M's just feel good to write
like these M's just feel good to write
MC
Advent of code with Cuda last year oh
geez I don't know we'll see maybe after
geez I don't know we'll see maybe after
the next athletic goal then I'll start
the next athletic goal then I'll start
doing
Cuda I'm considering trying to deadlift
Cuda I'm considering trying to deadlift
uh 405 for their first time in two years
uh 405 for their first time in two years
later today we'll see how that
goes I basically took two years off from
goes I basically took two years off from
doing very very serious lower body
doing very very serious lower body
strength training in order to do the
strength training in order to do the
running stuff and now I'm trying to get
running stuff and now I'm trying to get
them both at the same time so I can be
them both at the same time so I can be
hybrid big Tech stack minimal Tech stack
cycle
yeah I really like the minimal Tech
yeah I really like the minimal Tech
stack I really really don't like when
stack I really really don't like when
stuff is too complicated for you to know
stuff is too complicated for you to know
how everything works all at the same
how everything works all at the same
time and like Dev just slows down it's
time and like Dev just slows down it's
no longer enjoyable like you've got to
no longer enjoyable like you've got to
enjoy your work and like if
enjoy your work and like if
uh know if stuff gets too slow I just
uh know if stuff gets too slow I just
stop enjoying it and I stop being
stop enjoying it and I stop being
productive so it's like the focus on
productive so it's like the focus on
Simplicity in some way it's not just
Simplicity in some way it's not just
like a a choice it's like required in
like a a choice it's like required in
order for me to get the stuff
order for me to get the stuff
done to see have good neuronet training
done to see have good neuronet training
inference libraries like pytorch sensor
inference libraries like pytorch sensor
flow it has an inference Library cuz I
flow it has an inference Library cuz I
wrote
yaml for kubernetes in a few
yaml for kubernetes in a few
months uh you know probably just shoot
months uh you know probably just shoot
me before that
happens here here's puffer N.H 500 line
happens here here's puffer N.H 500 line
inference Library compatible with
inference Library compatible with
pytorch in
C can ignore the allocator stuff we
C can ignore the allocator stuff we
don't even use these you got weights you
don't even use these you got weights you
got an ability to load a flat P torch
got an ability to load a flat P torch
file you've got sigmoid re linear comms
file you've got sigmoid re linear comms
lstms one hot concatenate argmax with a
lstms one hot concatenate argmax with a
multi- discreete soft Max multi-
multi- discreete soft Max multi-
discreete sample you got a bunch of
discreete sample you got a bunch of
stuff less than 300 lines and then
stuff less than 300 lines and then
there's some bindings just for
convenience so it's kind of funny when
convenience so it's kind of funny when
it's like oh this but you don't have
it's like oh this but you don't have
this like library right you need like an
this like library right you need like an
inference Library you can just write one
inference Library you can just write one
it'll take you a couple days and you can
it'll take you a couple days and you can
just do
it this stupid con function was not easy
it this stupid con function was not easy
to
to
write the rest of it wasn't that
write the rest of it wasn't that
bad you've been productive I try to be I
bad you've been productive I try to be I
don't know the productivity comes in
don't know the productivity comes in
Cycles I got to really capitalize you
Cycles I got to really capitalize you
know when I'm like on I really got to
know when I'm like on I really got to
capitalize and get a lot done
capitalize and get a lot done
I'm not so sure about the rocket thing I
I'm not so sure about the rocket thing I
was doing yesterday it's you might have
was doing yesterday it's you might have
been right it's kind of a waste but hey
been right it's kind of a waste but hey
I mean I got a new potential
I mean I got a new potential
collaborator out of it so if I get to
collaborator out of it so if I get to
spend uh if I got to spend a Saturday
spend uh if I got to spend a Saturday
trying to like sit down and fix a rocket
trying to like sit down and fix a rocket
EMP with somebody new that'll be
fun I'm always down to do that
[Music]
where's our
experiment that was
funny saying no shame in switching well
funny saying no shame in switching well
I mean that's what it means right it's
I mean that's what it means right it's
like I don't know if it was if it's
like I don't know if it was if it's
worth the
worth the
effort like I essentially I'm going to
effort like I essentially I'm going to
do physics stuff at some point
um
um
but the question is essentially just how
but the question is essentially just how
much of a pain it is going to be to work
much of a pain it is going to be to work
with the physics libraries and such to
with the physics libraries and such to
get stuff working
nicely I did get box 2D running at 250k
nicely I did get box 2D running at 250k
steps per second though
steps per second though
and I think we can and that was on my
and I think we can and that was on my
local so we can go way faster than that
local so we can go way faster than that
probably get a
probably get a
million
million
here what do we think happened do we
here what do we think happened do we
think bigger neural networks are magic
think bigger neural networks are magic
or do we think RL on small neural
or do we think RL on small neural
networks is
saying take your
bets um
oh
interesting you see
that I think we might just have
magic it's still dropping towards the
magic it's still dropping towards the
end here but not anywhere near as
badly radiant assassin
level's
level's
higher a little
higher a little
bit but
dire is this dire
dire is this dire
assess oh
assess oh
yeah huh what about this dire
tank it still
tank it still
drops not Magic
let's see the bigger
model this one should be big enough to
model this one should be big enough to
learn something at
least so here's our new
model taking its sweet time
what about these
what about these
guys you're getting out of the
guys you're getting out of the
base they're not like hard running into
base they're not like hard running into
the wall at
the wall at
least here comes the
least here comes the
Assassin oh assassin
Assassin oh assassin
battle H you're under Tower my
friend probably Tower diving level one
friend probably Tower diving level one
is not the best strategy
H there goes the Tank tank versus burst
H there goes the Tank tank versus burst
under tower Tower diving level one not a
under tower Tower diving level one not a
good
idea but I mean this is closer to what
idea but I mean this is closer to what
we
we
want there're like some of these guys
want there're like some of these guys
are still stuck in
base I don't know why you would be stuck
base I don't know why you would be stuck
in base there's like no reason to be in
in base there's like no reason to be in
base there's nothing for you
there let's see if we can figure out
there let's see if we can figure out
um there's like a reward reason for
this like here's the radiant
support radiant
support reward
death okay look it just falls
death okay look it just falls
off you see apparently the support was
off you see apparently the support was
going out before and it stopped so
going out before and it stopped so
there's got to be some reason it learned
there's got to be some reason it learned
to stop going
out creeps killed CS here
it actually started at the at the uh the
it actually started at the at the uh the
start here it was actually
CSM
CSM
[Music]
[Music]
reward I mean the reward is just so
reward I mean the reward is just so
sparse right
it's not getting like a consistent
it's not getting like a consistent
signal or maybe it's the fact that this
signal or maybe it's the fact that this
is this is a tiny tiny
reward it shouldn't be tiny I think it's
reward it shouldn't be tiny I think it's
just
just
rare reward
rare reward
Tower it's not getting penalized for
Tower it's not getting penalized for
death I don't think
it actually should
it actually should
be reward death is negative
here is this not being
added hold on background
noise
e e
so um I just forgot to
do Target
log reward
death This should now be good
death This should now be good
[Music]
all
all
right baseship catching we got a little
right baseship catching we got a little
end working uh we need to run sweeps and
end working uh we need to run sweeps and
fix some stuff on it though one be free
fix some stuff on it though one be free
for those types of metric yeah I think I
for those types of metric yeah I think I
technically pay them a little
technically pay them a little
bit but
bit but
yeah W is pretty good they need to
yeah W is pretty good they need to
rewrite this thing faster at some point
rewrite this thing faster at some point
like that's the only complaint is it
like that's the only complaint is it
needs to be the UI just needs to be
needs to be the UI just needs to be
faster with when you have a bunch of
faster with when you have a bunch of
metrics and
stuff what if we did web dev and
C make all of wand be a Raab like a Raab
C make all of wand be a Raab like a Raab
UI that'd be
UI that'd be
fun okay so we have the this metric here
fun okay so we have the this metric here
um you know what I want to try let me
um you know what I want to try let me
try
try
something I wonder if the death reward
something I wonder if the death reward
is the thing that's SC it up cuz I
is the thing that's SC it up cuz I
wasn't logging it
right what if I just set this reward to
zero so now you're literally you just
zero so now you're literally you just
get a reward for getting XP and you get
get a reward for getting XP and you get
a reward for taking Towers yeah and then
a reward for taking Towers yeah and then
this is 01 so like 50 reward would give
this is 01 so like 50 reward would give
you 0.05 reward XP something like that
you 0.05 reward XP something like that
uh where's learning rate 05 yeah let's
uh where's learning rate 05 yeah let's
let's let's try
this because something is
this because something is
causing like some of the characters to
causing like some of the characters to
learn to stay in base and it could just
learn to stay in base and it could just
be that they're like well my character
be that they're like well my character
is weak and I die a lot so maybe I just
is weak and I die a lot so maybe I just
stop doing it you
know maybe they're smart and uh the
know maybe they're smart and uh the
rewards are dumb you
know thank you to our resident
know thank you to our resident
Advertiser bet here um yeah do Star
Advertiser bet here um yeah do Star
Puffer Leb if you uh if you're
Puffer Leb if you uh if you're
interested in the project at all it
interested in the project at all it
really does help a
really does help a
lot basically the only two channels
lot basically the only two channels
where uh I promote work and show stuff
where uh I promote work and show stuff
off we've got the puffer GitHub here and
off we've got the puffer GitHub here and
then also uh if you are doing RL
then also uh if you are doing RL
stuff I mean I do Post resources on X as
stuff I mean I do Post resources on X as
well for instance just
well for instance just
today this little quick start
today this little quick start
guide literally a one weekend guide to
guide literally a one weekend guide to
getting into reinforcement
getting into reinforcement
learning basically if you are new and
learning basically if you are new and
you do this stuff you and you have an
you do this stuff you and you have an
engineering background uh you will
engineering background uh you will
already be able to contribute usefully
already be able to contribute usefully
to RL and to puffer and to all these fun
projects find another
PhD
PhD
yeah well that's the fun
thing H you do get good support on this
thing H you do get good support on this
stuff contributors actually get quite a
stuff contributors actually get quite a
bit
of quite a bit of input
of quite a bit of input
on learning
on learning
stuff and people actually learn quite a
stuff and people actually learn quite a
bit very fast
here I wanted to make like some meme
here I wanted to make like some meme
right where like puffer Li contributors
right where like puffer Li contributors
like you know you type in GitHub you
like you know you type in GitHub you
start typing an issue it's already
start typing an issue it's already
answered you start typing in Discord
answered you start typing in Discord
it's already answered you like get tired
it's already answered you like get tired
and you like queue up a game of League
and you like queue up a game of League
like puffer has joined as your support
like puffer has joined as your support
but then I realized I'm too bad at that
but then I realized I'm too bad at that
game to actually do
game to actually do
that spending too much time freaking
that spending too much time freaking
writing all the code on this
thing yeah literally though you get like
thing yeah literally though you get like
a support thing with puffer you say okay
a support thing with puffer you say okay
I'm tired for the night nope
all the RL stuff but it's just
all the RL stuff but it's just
you
yeah do we have our new experiment open
here it's fun
okay
okay
so um is something happening
so um is something happening
here I can't tell
yet this could be
I
I
mean I can't think of any reason why
mean I can't think of any reason why
specific characters would stay in base
specific characters would stay in base
if you don't have a penalty for dying
if you don't have a penalty for dying
what's wrong with the Moa um I mean we
what's wrong with the Moa um I mean we
have stuff that's training but like
have stuff that's training but like
they're kind of weird right
they're kind of weird right
like they first they all start going
like they first they all start going
down mid and then some of the characters
down mid and then some of the characters
just decide that they're going to stop
just decide that they're going to stop
doing that and they stay in base and
doing that and they stay in base and
then like just the Assassin and the tank
then like just the Assassin and the tank
which are probably the two strongest
which are probably the two strongest
characters go down mid at each other so
characters go down mid at each other so
I think that
I think that
probably it's the death uh the death
probably it's the death uh the death
penalty is the
penalty is the
problem like the negative reward for
problem like the negative reward for
dying
post actually is doing very
post actually is doing very
well people like RL
guides negative rewards
guides negative rewards
yeah see oh I think this
yeah see oh I think this
is this looks better to me right this
is this looks better to me right this
looks more consistent already oh yeah
looks more consistent already oh yeah
there it is we fixed it
there it is we fixed it
folks you see that
folks you see that
we took away the penalty for
we took away the penalty for
dying and now the support will actually
dying and now the support will actually
play the game
[Music]
um I don't know about the hugging face
um I don't know about the hugging face
stuff is the hugging face course
stuff is the hugging face course
good I don't know how their code is
[Music]
[Music]
uh yeah I don't
uh yeah I don't
know the only thing is I don't know how
know the only thing is I don't know how
their code
is oh they use clean RL oh of course
is oh they use clean RL oh of course
they use clean RL because Costa was at
they use clean RL because Costa was at
hugging face for a while yeah okay yeah
hugging face for a while yeah okay yeah
totally then this is
totally then this is
good this is good
good this is good
this is a good because
Costa so the reason I wasn't sure is
Costa so the reason I wasn't sure is
because like some of the hugging face
because like some of the hugging face
engineering is a bit dodgy like it's
engineering is a bit dodgy like it's
just overbuilt and over
just overbuilt and over
complicated um but yeah if cost if they
complicated um but yeah if cost if they
use cleaner stuff it's
use cleaner stuff it's
great anybody else follow serpent AI was
great anybody else follow serpent AI was
building an RL yeah I think
this one
right so I looked at this
um I looked at this and I think that
um I looked at this and I think that
it's not going to be fast enough Jake
it's not going to be fast enough Jake
like the games aren't going to run fast
like the games aren't going to run fast
enough is they going to be the problem
do you know tiny grad yeah I know of
do you know tiny grad yeah I know of
tiny grad I haven't tried it yet because
tiny grad I haven't tried it yet because
it's newer
it's newer
um and I don't know about not having
um and I don't know about not having
fast eager mode and having to do
fast eager mode and having to do
everything compiled but I'm keeping my
everything compiled but I'm keeping my
eye on it it looks very nice we'll
eye on it it looks very nice we'll
probably end up buying some tiny boxes
probably end up buying some tiny boxes
in the future as
well it's definitely a cool project
puffer play is nice it plays as nice as
puffer play is nice it plays as nice as
it can play with
compile ooh so what happened here the
compile ooh so what happened here the
reward went back down
right this did way better but then it
right this did way better but then it
still
stopped how about this
I don't
know well this was from bigger
model oh yeah no this is better
it's almost
it's almost
trained we'll be able to watch this
trained we'll be able to watch this
model and see how this plays I think
model and see how this plays I think
this should be getting closer to what I
this should be getting closer to what I
was trying to do I just basically all I
was trying to do I just basically all I
want to do today is I want to train a
want to do today is I want to train a
basic model that run where the teams
basic model that run where the teams
will learn to at least run down mid at
will learn to at least run down mid at
each other and maybe like Farm some
camps I want to just like have a decent
camps I want to just like have a decent
enough model to put on the website just
enough model to put on the website just
like so that we know that the uh the
like so that we know that the uh the
environment is not completely broken
environment is not completely broken
that we're getting good logs and that we
that we're getting good logs and that we
can use this for
can use this for
research that's the main
goal anybody nope spam
yeah this looks
yeah this looks
better what about the
better what about the
support the support seems like it's
support the support seems like it's
didn't
learn man the support was
learn man the support was
learning why did the support
learning why did the support
stop I mean it didn't complete
stop I mean it didn't complete
completely
stop
stop
huh let's just see the the model maybe
huh let's just see the the model maybe
it's decent
enough 65 C
okay here's the new
okay here's the new
model let's see what these guys are
model let's see what these guys are
doing uh the Assassin is starting to get
doing uh the Assassin is starting to get
out of Base
out of Base
gu starting to get out of
Base I don't know what you're doing over
here okay assassin and tank are starting
here okay assassin and tank are starting
to do
things they're going to look Spazzy like
things they're going to look Spazzy like
this for a while early in training
this for a while early in training
especially without uh good hyper
especially without uh good hyper
parameters so that's fine the question
parameters so that's fine the question
is just do they go down okay yeah
is just do they go down okay yeah
there's our burst our burst is like
there's our burst our burst is like
farming waves in
mid tank is slowly getting there
mid tank is slowly getting there
maybe the walls are also one tile off in
maybe the walls are also one tile off in
the renderer which is why they're kind
the renderer which is why they're kind
of
glitching support and carry aren't
glitching support and carry aren't
really doing
really doing
much oh okay we have a we've got a tower
much oh okay we have a we've got a tower
fight here we've got two siing First
fight here we've got two siing First
Tower and
Tower and
then we've got a 2v2
here
here
oh that's legit
still not quite as good as I want uh as
still not quite as good as I want uh as
I'm looking
for but this is like closer to the right
for but this is like closer to the right
direction this is not like it's not
direction this is not like it's not
clearly being stupid
it's like looks like it's getting into
it's like looks like it's getting into
the right
direction interestingly you can
direction interestingly you can
see are there any instabilities in the
see are there any instabilities in the
train
run there might just be some
run there might just be some
instabilities in the
training oops
training oops
okay so here we can
okay so here we can
see
victories see your
level the policy loss going up like that
level the policy loss going up like that
is
is
sketchy and the policy loss going up
sketchy and the policy loss going up
like that is sketchy
like that is sketchy
I think
I think
why why it would be doing
this we just do we have too large of a
this we just do we have too large of a
learning rate like
learning rate like
what why would this be
what why would this be
happening you can see the training is
happening you can see the training is
just
not policy law should not be going up
not policy law should not be going up
like that even though that's very small
like that even though that's very small
it's consistent what about
it's consistent what about
value oh yeah look we have value lost
value oh yeah look we have value lost
Spike right
here let's go look at the clean RL
defaults for
flip
coefficient Yeah we actually have these
reasonable what do we have as batch size
reasonable what do we have as batch size
here
256k this could simply be too small
me
think wait num Ms is
think wait num Ms is
four how does that make sense
400 so
400 so
4K hold
on so we
have two that's probably too
short I think I did this for Speed and
short I think I did this for Speed and
then forgot to
then forgot to
to adjust
it4 2
34 let's see if this
works oh wait this is also a crazy ratio
works oh wait this is also a crazy ratio
isn't
it 256k to 16k like this is a crazy
it 256k to 16k like this is a crazy
ratio
what if we
do let's do like
do let's do like
64k how many updates is this no that's
64k how many updates is this no that's
still crazy that's 16 updates
I'm going to do
I'm going to do
this let's do like
this I bet you this this this fixes
this I bet you this this this fixes
stability let's
see this should at least improve
see this should at least improve
stability it might tank the training
stability it might tank the training
speed we'll
see for
[Music]
what do we think the train curves will
what do we think the train curves will
look
look
like for
this welcome YouTube
folks this was the policy I had before
folks this was the policy I had before
right yeah so I think we're already
right yeah so I think we're already
better than
better than
this how long do training take just a
this how long do training take just a
few minutes and it should be even
few minutes and it should be even
shorter we got to fix some stuff with
vectorization let's do just the last
vectorization let's do just the last
three runs I think or the last yeah
three runs I think or the last yeah
let's just take these off got too many
runs yeah so you can see
runs yeah so you can see
here the training speed is tanked
here the training speed is tanked
based on what I just
based on what I just
did oh wait this steps thing hold on the
did oh wait this steps thing hold on the
steps might be different I don't even
steps might be different I don't even
know why it is
know why it is
on steps for everything it should be
on steps for everything it should be
on
on
agent should be on agent
steps what the hell is wrong with this
steps what the hell is wrong with this
section
there okay so 50
[Music]
[Music]
mil actually it's weird cuz the dire
mil actually it's weird cuz the dire
level is not going up very quickly but
level is not going up very quickly but
radiant is about the same as it was
before what about
before what about
individual individual Rewards
usually radiant assassin is the easiest
usually radiant assassin is the easiest
to
learn okay so it's hard to say I think
learn okay so it's hard to say I think
it just takes it could just be taking
it just takes it could just be taking
longer to get
started which would make sense cuz
started which would make sense cuz
you're doing fewer
you're doing fewer
updates but um The Hope is that it'll be
updates but um The Hope is that it'll be
actually stable
as soon as we get something
as soon as we get something
stable uh I'm going to switch over to
stable uh I'm going to switch over to
just fixing figuring out what is wrong
just fixing figuring out what is wrong
with vectorization that way we can run
with vectorization that way we can run
this at a proper
this at a proper
speed I mean by proper speed I mean this
speed I mean by proper speed I mean this
is already running about a 100 times
is already running about a 100 times
faster than it would normally be in
faster than it would normally be in
Academia it's just not running at 300
Academia it's just not running at 300
times normal which is what we want
360,000
360,000
which I forget if I made this run at
which I forget if I made this run at
five steps per second at 10 steps per or
five steps per second at 10 steps per or
10 steps per second but it's either
10 steps per second but it's either
15,000 or 30,000 times realtime
speed it's still over it's still playing
speed it's still over it's still playing
like more it's still playing more games
like more it's still playing more games
of uh of this than I've played of League
of uh of this than I've played of League
every minute
so how much League have I played I
so how much League have I played I
couple hundred
hours not that
much oh look at
much oh look at
that this is starting to take
that this is starting to take
off right here
off right here
it's starting to take
it's starting to take
towers and get
XP we'll see whether it's
stable the only thing that would really
stable the only thing that would really
surprise me here is if this ends up
surprise me here is if this ends up
being both worse and less stable
where's the uh the
loss policy loss is actually
not well explain variance is
lower
lower
value our value is still clean
but this is not like perfectly
but this is not like perfectly
stable I mean it is entering a high
stable I mean it is entering a high
learning like a high learning Pace
learning like a high learning Pace
regime we will see this is still a whole
regime we will see this is still a whole
bunch of updates is the
bunch of updates is the
thing this is still a ton of
updates we might end up having to do a
updates we might end up having to do a
weight accumulation or no wait grading
weight accumulation or no wait grading
accumulation we'll see do you even need
accumulation we'll see do you even need
mini batches you need them because of
mini batches you need them because of
memory we might end up needing to do um
memory we might end up needing to do um
gradient
gradient
accumulation welcome YouTube
folks currently running experiments on
folks currently running experiments on
this MOA here trying to get some
this MOA here trying to get some
reasonable
policies I like this en
uh good question Nvidia
SMI 23%
SMI 23%
so we can probably go up a
so we can probably go up a
bit oh no wait duh it's like a
quarter well we still do need mini
quarter well we still do need mini
batches bet cuz then we could only go up
batches bet cuz then we could only go up
to like 250 K I think that's still too
to like 250 K I think that's still too
small for the
small for the
batch cuz like here I'll do a quick RL
batch cuz like here I'll do a quick RL
tutorial on
tutorial on
this this is a very important and not
this this is a very important and not
often made
often made
point with
point with
RL so the way that RL works right you're
RL so the way that RL works right you're
collecting your agent
collecting your agent
trajectories your agent trajectories
trajectories your agent trajectories
look like this right you have like
look like this right you have like
T1 T2
T1 T2
you know and then this is you you have
you know and then this is you you have
to collect a batch of data um so let's
to collect a batch of data um so let's
say that you're going to have 8,000
say that you're going to have 8,000
agents because you have 800 copies of
agents because you have 800 copies of
the environment which is what I have
the environment which is what I have
because that's what's effective for the
because that's what's effective for the
hardware then so I have 8K agents and I
hardware then so I have 8K agents and I
do
256k batch size well then when I go to
256k batch size well then when I go to
optimize this I'm not going to have a
optimize this I'm not going to have a
really long trajectory cuz I'm going to
really long trajectory cuz I'm going to
have on average 250
have on average 250
8K per
8K per
agent right and uh I don't know what's
agent right and uh I don't know what's
this
32 which is
32 which is
short so ideally if we have 8K
short so ideally if we have 8K
environments we would like to have
environments we would like to have
512k or uh a
512k or uh a
million batch size which is not going to
million batch size which is not going to
fit in memory which means you either
fit in memory which means you either
have to mini batch or you have to do
have to mini batch or you have to do
grading to
accumulation common screw
up are we looking
okay well value loss actually stayed
okay well value loss actually stayed
stable length
stable length
32 yeah the segments because you need to
32 yeah the segments because you need to
do generalized Advantage estimations
do generalized Advantage estimations
you're Computing reward across segments
you're Computing reward across segments
like that uh and it's just really that's
like that uh and it's just really that's
not long enough okay but look though we
not long enough okay but look though we
have this stable looking
have this stable looking
level
here episode length going down is
here episode length going down is
actually probably good
actually probably good
I want to look at some of these
rewards hey Spencer one second let
rewards hey Spencer one second let
me using latest go changes increasing
me using latest go changes increasing
size of board 5x five and up one each
size of board 5x five and up one each
time still solving M just taking
time still solving M just taking
longer increase Forex looks like just
longer increase Forex looks like just
taking longer to realize that bad does
taking longer to realize that bad does
figure it out eventually yeah that makes
figure it out eventually yeah that makes
total sense so get training to a million
total sense so get training to a million
steps per second right and we tune hyper
steps per second right and we tune hyper
parameters and then it figures that out
parameters and then it figures that out
quicker probably
right I don't know about this reward
right I don't know about this reward
here
is this guy not doing anything let me
is this guy not doing anything let me
see it's getting some
kills well it is actually taking more
kills well it is actually taking more
Towers it looks like
n this is not stable like
n this is not stable like
look it's not
look it's not
[Music]
[Music]
farming I don't think this is farming as
well yeah right
here let's go look at the policy anyways
here let's go look at the policy anyways
though
okay
what do we
think okay here's our
assassin we see our burst on the right
assassin we see our burst on the right
migrating out over to the rest of the
migrating out over to the rest of the
map what do we think over here up yep
map what do we think over here up yep
there 's their assassin and their
burst checkpoint we
got oh there's our tank farming some
got oh there's our tank farming some
camps that's
cool the training stability is very
cool the training stability is very
important
like hold
on radiant
on radiant
assassin yeah this should be
assassin yeah this should be
consistently going up
the fact that it stops
farming I kind of want
to I want to try something
crazy well actually is it
crazy well actually is it
crazy what I do for Atari
uh I'm going try
something
something
28 can you fit 256k in
28 can you fit 256k in
here and like
here and like
1024 can I fit this
looks like you can fit
looks like you can fit
this 1 million batch size
this 1 million batch size
250k this is with the bigger model as
250k this is with the bigger model as
well that's
nice 42% on the
nice 42% on the
n because we don't have vectorization so
n because we don't have vectorization so
we can actually uh shove this up to like
we can actually uh shove this up to like
500k pretty
easily main thing I'm looking for is
easily main thing I'm looking for is
stability of
training so like with the previous one
here if we go look at the
losses policy loss is not in a good spot
losses policy loss is not in a good spot
and explain
and explain
variances
yeah clip Frack is okay
yeah clip Frack is okay
but now the value loss is technically
but now the value loss is technically
okay but it is
increasing maybe this will be more
increasing maybe this will be more
stable cuz it doesn't look like we have
stable cuz it doesn't look like we have
a learning problem it looks like we've
a learning problem it looks like we've
got a stability
got a stability
problem we also should change the way
problem we also should change the way
that we're recording logs a
that we're recording logs a
bit we're recording too
frequently was there reward hold
frequently was there reward hold
on
reward yeah look the reward for XP is
reward yeah look the reward for XP is
just not consistent increasing
just not consistent increasing
here or
here or
here this
is
maybe just looks very
unstable I think we also probably have
unstable I think we also probably have
I mean we can manually do a couple of
I mean we can manually do a couple of
these parameters just for
these parameters just for
now I can probably guess decent
ones just to start us
off where's our
off where's our
run already have 60
mil okay
mil okay
so
now
now
okay there's some
XP we'll see if it gets to be
stable Lambda and Gamma are going to
stable Lambda and Gamma are going to
be interesting
probably will change a little
probably will change a little
bit the current parameters that we're
bit the current parameters that we're
using for
this gamma's
this gamma's
97 lambda's 995
I think that Lambda is a bit
nutty exact
interpretation Lambda probably goes to
interpretation Lambda probably goes to
0.
N5 97 is a reasonable
gamma um
see too early to say use the restroom
see too early to say use the restroom
grab more tea and uh we'll be back doing
grab more tea and uh we'll be back doing
more of
this
e
e
e
e e
H well that looks that's
H well that looks that's
something I don't know the thing is I
something I don't know the thing is I
don't know if it's going to actually
don't know if it's going to actually
be
be
hm a weird
hm a weird
curve what about this
one you
know this could be it this could just
know this could be it this could just
take way longer but be more stable I
take way longer but be more stable I
wouldn't be
surprised 200 mil train is not enough on
surprised 200 mil train is not enough on
this well we haven't messed hold on we
this well we haven't messed hold on we
haven't messed with J parameters yet
haven't messed with J parameters yet
so we still we're not out of
options we still have options
here but yeah presumably this is just it
here but yeah presumably this is just it
has so many fewer updates
right of course cuz like in reality we
right of course cuz like in reality we
don't actually need to have a batch size
don't actually need to have a batch size
this ridiculous right at least not early
this ridiculous right at least not early
in training uh the reason that we have a
in training uh the reason that we have a
batch size like this is because of
batch size like this is because of
Hardware
constraints so yeah it's just not going
constraints so yeah it's just not going
to be it's going to it's like oh 200
to be it's going to it's like oh 200
million samples should be enough but no
million samples should be enough but no
not with these settings because it's
not with these settings because it's
only like 200 uh it's 800 total gradient
only like 200 uh it's 800 total gradient
steps yeah it's not a
lot and it is starting to increase
lot and it is starting to increase
pretty much all the different
metrics so we'll do um
metrics so we'll do um
J G parameter
J G parameter
next we'll be
next we'll be
good change that to
0.95 and we'll run it for longer as
well and we'll see if that makes a
well and we'll see if that makes a
difference
difference
I think we're getting close
I think we're getting close
though to like finding something that
though to like finding something that
makes a relatively consistent
makes a relatively consistent
performance improvements I mean we're
performance improvements I mean we're
not looking for a crazy model right
not looking for a crazy model right
we're just trying to
we're just trying to
show the things run at each other down
show the things run at each other down
mid they like you expect that they
mid they like you expect that they
should learn to at least run at each
should learn to at least run at each
other down mid maybe take some camps and
other down mid maybe take some camps and
throw their abilities at each other
throw their abilities at each other
right
what happened to
what happened to
my what happened to my
runs that was weird okay
oh
oh
okay I mean it kind of did
okay I mean it kind of did
something I guess we just need to look
something I guess we just need to look
at
at
losses we can do that once we launch the
losses we can do that once we launch the
new one
new one
though
oops gamma goes to 095 from
oops gamma goes to 095 from
995 learning
rate learning rate
rate learning rate
increase probably learning rate can
increase probably learning rate can
increase do I want to risk doing both
increase do I want to risk doing both
these at once not
these at once not
really do you have a reward for damage
really do you have a reward for damage
dealt we have a reward for gaining
experience policy on I I'll tell you in
experience policy on I I'll tell you in
a second hold on got to sleep have a
a second hold on got to sleep have a
productive day thank you thanks for
productive day thank you thanks for
dropping by
dropping by
by feel free to stop by the Discord we
by feel free to stop by the Discord we
do uh if you want to get involved with
do uh if you want to get involved with
contributing we got a lot of Ms to build
on okay so this is now the je parameter
on okay so this is now the je parameter
uh I'm going to go pour this cup of tea
uh I'm going to go pour this cup of tea
and I'll tell you about um reward
and I'll tell you about um reward
shaping and how to do that be right
shaping and how to do that be right
[Music]
[Music]
back
e
e e
[Music]
[Music]
I forgot to unmute my
I forgot to unmute my
mic
mic
um let me go through
um let me go through
reward
reward
shaping yeah I just realized
shaping yeah I just realized
that let me talk about reward shaping
that let me talk about reward shaping
so you don't want to be in a spot where
so you don't want to be in a spot where
you're like manually tuning reward
you're like manually tuning reward
components for weeks on end for a hard
components for weeks on end for a hard
problem and like tune reward like tweak
problem and like tune reward like tweak
reward run experiment tweak reward run
reward run experiment tweak reward run
experiment that's a mess you want to be
experiment that's a mess you want to be
in a place where you have like a bunch
in a place where you have like a bunch
of different reward component weights
of different reward component weights
and you have a very fast environment and
and you have a very fast environment and
then you run a giant hyperparameter
then you run a giant hyperparameter
sweep that includes automatically tuning
sweep that includes automatically tuning
the weights of those
the weights of those
rewards um that's where you want to
rewards um that's where you want to
be and that's actually what I did
be and that's actually what I did
originally with
originally with
this the time that you start tuning
this the time that you start tuning
parameters at all like I'm doing at the
parameters at all like I'm doing at the
moment is basically when you have a new
moment is basically when you have a new
environment where the environment might
environment where the environment might
have bugs there might be other things
have bugs there might be other things
wrong and you're essentially just
wrong and you're essentially just
playing with it in order to try to
playing with it in order to try to
understand how it works and how it
understand how it works and how it
responds to stuff um you want to use
responds to stuff um you want to use
this sparingly but it's a good way to
this sparingly but it's a good way to
debug stuff um so yeah that's what I'm
debug stuff um so yeah that's what I'm
doing at the
doing at the
moment and I have a few different reward
moment and I have a few different reward
components for this project uh but
components for this project uh but
actually there are only two of them that
actually there are only two of them that
are enabled right now they get a reward
are enabled right now they get a reward
for getting experience that's
for getting experience that's
proportional to experience gained and
proportional to experience gained and
they get a a pretty high constant reward
they get a a pretty high constant reward
for taking a tower that's it
what do you tune against in the sweep
what do you tune against in the sweep
like a few
like a few
higher yeah you just come up with some
higher yeah you just come up with some
components of like yeah this is probably
components of like yeah this is probably
relevant right like if I think of a MOA
relevant right like if I think of a MOA
right it's like okay probably taking
right it's like okay probably taking
Towers like getting kills getting
Towers like getting kills getting
experience or gold or whatever stuff
experience or gold or whatever stuff
like that just come up with a few
like that just come up with a few
components and then let the uh the hyper
components and then let the uh the hyper
parameter sweep figure out how much they
parameter sweep figure out how much they
matter or
matter or
don't would you encourage people to do a
don't would you encourage people to do a
PhD in pure
PhD in pure
RL
RL
um if you were going to do a PhD already
um if you were going to do a PhD already
RL is a perfectly good area of research
RL is a perfectly good area of research
yeah
it's like it's going to be a valuable
it's like it's going to be a valuable
area um the alternative is you can go
area um the alternative is you can go
jump on the language model boat with
jump on the language model boat with
everybody else already doing
everybody else already doing
that but like we've got enough people
that but like we've got enough people
doing that already we don't have enough
doing that already we don't have enough
people working on smaller subfields of
people working on smaller subfields of
AI that like could potentially have a
AI that like could potentially have a
much larger proportional
impact I forgot to make this experiment
impact I forgot to make this experiment
run for
run for
longer uh it looks like it's doing
longer uh it looks like it's doing
something
though
though
yeah that's why I phrased it as if
yeah that's why I phrased it as if
you're going to do a
PhD can you tune hyper parameters for
PhD can you tune hyper parameters for
the rewards how can you compare yeah so
the rewards how can you compare yeah so
what you need is you need a success
what you need is you need a success
metric so like let's say that your
metric so like let's say that your
training something to play Breakout or
training something to play Breakout or
whatever the metric you're tuning
whatever the metric you're tuning
against is score in the game like
against is score in the game like
overall score you could have a reward
overall score you could have a reward
for hitting the ball back you can have
for hitting the ball back you can have
the reward like a negative reward for
the reward like a negative reward for
hitting the top you can do whatever you
hitting the top you can do whatever you
want but then the final thing you care
want but then the final thing you care
about is the score so that's what you
about is the score so that's what you
use to compare it gets harder in this
use to compare it gets harder in this
environment which is this MOA here right
environment which is this MOA here right
um in competitive games you need
um in competitive games you need
something like ELO which we have
something like ELO which we have
implemented it's just a bit of a pain
implemented it's just a bit of a pain
thinking about it currently doing time
thinking about it currently doing time
series Foundation
series Foundation
models plan on using those in decision
models plan on using those in decision
Transformer applied for drone
control do you have a ton of offline
control do you have a ton of offline
data decision Transformers for offline
data decision Transformers for offline
data
like there was online RL I believe
there's this
thing hard to find Labs doing pure
thing hard to find Labs doing pure
RL there are
few I mean look it depends on what your
few I mean look it depends on what your
priorities are right in my mind if
priorities are right in my mind if
there're a bunch of people doing a thing
there're a bunch of people doing a thing
I have no interest in doing it cuz like
I have no interest in doing it cuz like
it's going to get solved with or without
it's going to get solved with or without
me right I get interested in like Niche
me right I get interested in like Niche
long shot bet area is where like if I'm
long shot bet area is where like if I'm
right you can totally change
everything we can generate data yeah but
everything we can generate data yeah but
like online RL is a process for
like online RL is a process for
generating data it depends if you have a
simulator onlineer RL is very very
simulator onlineer RL is very very
powerful because your agent gets to
powerful because your agent gets to
expand its own distribution of data
offline RL is basically just supervised
offline RL is basically just supervised
learning right it's like it's imitation
learning right it's like it's imitation
learning plus a little bit that's
learning plus a little bit that's
all it's uh in my mind it's like an
all it's uh in my mind it's like an
entirely different thing like I like the
entirely different thing like I like the
portion of RL I care about I really
portion of RL I care about I really
don't even care about the specific
don't even care about the specific
algorithms for RL or the math or any of
algorithms for RL or the math or any of
it the portion of RL that I think is
it the portion of RL that I think is
most likely to be useful and interesting
most likely to be useful and interesting
is the part that you are gathering your
is the part that you are gathering your
own data and learning interactively
own data and learning interactively
you're learning in like this very
you're learning in like this very
natural trial and error way and that's
natural trial and error way and that's
something that's just not the case in
something that's just not the case in
the rest of all of AI so that's what I
the rest of all of AI so that's what I
see in
see in
it time will tell whether I'm
it time will tell whether I'm
right but it has already done some
right but it has already done some
pretty darn cool things it's done so
pretty darn cool things it's done so
like a thousandth of the scale of uh the
like a thousandth of the scale of uh the
rest of
AI it's interesting that this thing is
AI it's interesting that this thing is
getting XP just very slowly
getting XP just very slowly
is this actually worse than
is this actually worse than
before can't
tell it looks worse than
tell it looks worse than
before that's very weird
does it evaluate hold
on yeah neither of these are good to be
on yeah neither of these are good to be
honest neither of these are very good
Foundation models for a classical
Foundation models for a classical
problem but like why
though one of the great advantages of
though one of the great advantages of
reinforcement learning is it's for
reinforcement learning is it's for
settings where you have a fast simulator
settings where you have a fast simulator
you have unlimited data
you have unlimited data
your foundation model
your foundation model
cannot train on unlimited data it's too
cannot train on unlimited data it's too
big you run out of compute you can train
big you run out of compute you can train
RL on more data than all of gp4 on one
GPU compute vers
performance you don't need a lot of
performance you don't need a lot of
compute in RL you just need a fast
compute in RL you just need a fast
simulator
score some tiny boxes down the line what
score some tiny boxes down the line what
would you do with the GPU well we would
would you do with the GPU well we would
need to have a parallel GPU trainer by
need to have a parallel GPU trainer by
then essentially the plan is that
then essentially the plan is that
eventually RL is going to have enough
eventually RL is going to have enough
environments that run fast enough that
environments that run fast enough that
you can saturate all the gpus on a
you can saturate all the gpus on a
multi-gpu box just using the CPU cores
multi-gpu box just using the CPU cores
that are on that box for simulation so
that are on that box for simulation so
like let's say that I get if I really
like let's say that I get if I really
optimize each GPU
optimize each GPU
we could get um over a million train
we could get um over a million train
steps per second per GPU so with six of
steps per second per GPU so with six of
them we have 6 million train steps per
them we have 6 million train steps per
second per GPU and like at that pace you
second per GPU and like at that pace you
know you're training faster than all of
know you're training faster than all of
opening I5 is but on one little com like
opening I5 is but on one little com like
one little box instead of on a massive
cluster you just chunk through tons and
cluster you just chunk through tons and
tons of data
they're not useful until we have the uh
they're not useful until we have the uh
the multi-gpu training for
though which has not been a priority
though which has not been a priority
because like there's so much room for
because like there's so much room for
improvement even on single card and the
improvement even on single card and the
hardware is very cost
effective like even a lot of Industry
effective like even a lot of Industry
problems you can solve them on one
GPU just need a fast
Sim very weird how this
is might have to back up a little bit on
this cab base Sims no
this cab base Sims no
you can have Cuda Bas Sims if you want
you can have Cuda Bas Sims if you want
sure it'll work there just as well but
sure it'll work there just as well but
uh fast CPU Sims are good too we're
uh fast CPU Sims are good too we're
basically we can Implement stuff plenty
basically we can Implement stuff plenty
fast on CPU now the way I've been doing
fast on CPU now the way I've been doing
stuff with
stuff with
puffer how are you funding puffer is the
puffer how are you funding puffer is the
only a full-time
only a full-time
Dev puffer is my company I uh I finished
Dev puffer is my company I uh I finished
my PhD six months
my PhD six months
ago so I'm working on this full-time
ago so I'm working on this full-time
other people are contributing stuff uh
other people are contributing stuff uh
open source all the stuff is open source
open source all the stuff is open source
we just officially launched uh business
we just officially launched uh business
side of this a few weeks ago the plan is
side of this a few weeks ago the plan is
to be uh providing extended support and
to be uh providing extended support and
priority features and things like that
priority features and things like that
for
companies so the idea is hey are you a
companies so the idea is hey are you a
company trying to do RL for something
company trying to do RL for something
important and having a hard time of it
important and having a hard time of it
give puffer a
give puffer a
call we'll get you set up with puffer
call we'll get you set up with puffer
which is all open source and free you're
which is all open source and free you're
not going to be tied to any proprietary
not going to be tied to any proprietary
Tech but you get experienced eyes on the
Tech but you get experienced eyes on the
problem you get prioritized features for
problem you get prioritized features for
anything that you might need for your
anything that you might need for your
specific
problem that's the
problem that's the
idea you already get to use it in a real
idea you already get to use it in a real
live application
nope brand new company we have a couple
nope brand new company we have a couple
um couple potential clients I'm chatting
um couple potential clients I'm chatting
with at the moment uh we'll be building
with at the moment uh we'll be building
that side out more but a lot of this is
that side out more but a lot of this is
early stage like just building awesome
early stage like just building awesome
tech for RL and that's been going pretty
tech for RL and that's been going pretty
well like you can see all these on
well like you can see all these on
puffer GG these run very fast some of
puffer GG these run very fast some of
them are kind of complex we've got a
them are kind of complex we've got a
couple more in the works as well and
couple more in the works as well and
there's a lot of nice Tooling in Puffer
lot a lot of nice tooling and puffer for
lot a lot of nice tooling and puffer for
making stuff
making stuff
easier like this whole field of RL uh in
easier like this whole field of RL uh in
the dev branch of puffer right now is
the dev branch of puffer right now is
100 to a thousand times faster than it
100 to a thousand times faster than it
is in the rest of
is in the rest of
Academia and the idea is that when you
Academia and the idea is that when you
have all these this ability to test
have all these this ability to test
stuff so quickly on a number of
stuff so quickly on a number of
different problems some of which are
different problems some of which are
easy some of which are not so easy you
easy some of which are not so easy you
can be very very confident in the
can be very very confident in the
approaches that you're taking so like if
approaches that you're taking so like if
you decide that you need to do you have
you decide that you need to do you have
like a new algorithm or a new thing that
like a new algorithm or a new thing that
needs to be tested on your fancy
needs to be tested on your fancy
production environment that's going to
production environment that's going to
be slow well what you can do is you can
be slow well what you can do is you can
evaluate it comprehensively on a big
evaluate it comprehensively on a big
Suite of different tasks um and you can
Suite of different tasks um and you can
do that very
do that very
efficiently without needing a giant
cluster and then if your method is
cluster and then if your method is
actually good then you can then transfer
actually good then you can then transfer
that to
that to
prod and then you know that the actual
prod and then you know that the actual
the bigger run is worth doing
the bigger run is worth doing
the ability to test stuff like that
the ability to test stuff like that
really doesn't exist in RL right now and
really doesn't exist in RL right now and
uh it's a huge huge source of cost and
uh it's a huge huge source of cost and
time
time
sync obviously we do a bunch of other
sync obviously we do a bunch of other
stuff a bunch of other things with the
stuff a bunch of other things with the
puffer Tech but that's one of the big
puffer Tech but that's one of the big
ones right
ones right
now just came across your page looking
now just came across your page looking
to start L my computer can't handle it
to start L my computer can't handle it
saving but I also need to save a lot
saving but I also need to save a lot
because international student school
because international student school
fees yeah that's a rough one um
fees yeah that's a rough one um
I will say RL is pretty fast like you
I will say RL is pretty fast like you
can do like you can do environment side
can do like you can do environment side
work um without needing really any
work um without needing really any
compute resources it just depends on
compute resources it just depends on
engineering background and the
engineering background and the
like like some of these M's here this
like like some of these M's here this
one's built by a contributor this one's
one's built by a contributor this one's
built by a different contributor these
built by a different contributor these
two are built by yet another contributor
two are built by yet another contributor
this TCG I made a prototype of and now
this TCG I made a prototype of and now
we have contributors looking at it these
we have contributors looking at it these
two are mine
but it's a nice space to get
into we also occasionally provide
into we also occasionally provide
hardware for specific projects we've got
hardware for specific projects we've got
a little very small little cluster
here all right can I figure out what is
here all right can I figure out what is
wrong with this experiment now
what's your goal with puffer are you
what's your goal with puffer are you
planning on hiring I'm planning on
planning on hiring I'm planning on
hiring once we are profitable like once
hiring once we are profitable like once
we have revenue from uh a few clients
we have revenue from uh a few clients
and we need more people to handle more
and we need more people to handle more
of
them the goal yes also for multi-agent a
them the goal yes also for multi-agent a
lot of our stuff is multi-agent
lot of our stuff is multi-agent
um the primary goal for puffer is to
um the primary goal for puffer is to
revolutionize the field of reinforcement
revolutionize the field of reinforcement
learning in order to do that you know
learning in order to do that you know
the secondary goal there is to be a
the secondary goal there is to be a
small profitable industry lab that does
small profitable industry lab that does
open source
open source
work yeah that's the goal have like a
work yeah that's the goal have like a
small profitable industry lab that does
small profitable industry lab that does
a bunch of Open Source work and fixes
a bunch of Open Source work and fixes
the
the
field that's my goal for
puffer now it's very interesting to
puffer now it's very interesting to
see that with this run the actual the
see that with this run the actual the
skill usage is very
skill usage is very
good why is the reward kn good if the
good why is the reward kn good if the
skill usage is
skill usage is
good I'm
good I'm
confused this doesn't make
sense Towers is very
low for reference Yanick my um my thesis
low for reference Yanick my um my thesis
is on neural was on neural MMO so like
is on neural was on neural MMO so like
massively multi-agent is kind of my
massively multi-agent is kind of my
thing
thing
thing I've been making some single agent
thing I've been making some single agent
environments because you know a lot of
environments because you know a lot of
problems don't need
problems don't need
it but
it but
um yeah that's that's where I originally
um yeah that's that's where I originally
started and a lot of the stuff in puffer
started and a lot of the stuff in puffer
makes multi-agent just as easy as single
makes multi-agent just as easy as single
agent I built a lot of stuff explicitly
agent I built a lot of stuff explicitly
to handle multi-agent
well where is it using all these
well where is it using all these
abilities oh it's
abilities oh it's
farming wait How's It farming well this
farming wait How's It farming well this
is kind of crazy isn't
it why is the reward so low if it's
it why is the reward so low if it's
farming this
well I should look at this
policy I have a Quant project with
policy I have a Quant project with
ML did that an intership parameter
ML did that an intership parameter
optimization and PC to run it properly
optimization and PC to run it properly
someday takes me 4 hours to run one test
someday takes me 4 hours to run one test
and sometimes would fail at hour three
and sometimes would fail at hour three
yeah that's rough do you think companies
yeah that's rough do you think companies
like Riot use RL in back in for bounce
like Riot use RL in back in for bounce
test I know that they do is it hard even
test I know that they do is it hard even
too hard for them it is hard for them
too hard for them it is hard for them
but it's hard for them because they have
but it's hard for them because they have
uh they are using Ray no they're using
uh they are using Ray no they're using
rib for a lot of it at least they used
rib for a lot of it at least they used
to be I don't know if they're still
to be I don't know if they're still
doing it RB is a god aul Library I
doing it RB is a god aul Library I
actually tried to pitch them on um on
actually tried to pitch them on um on
doing something with puffer though that
doing something with puffer though that
was like I was still a PhD stage student
was like I was still a PhD stage student
and it was way earlier
stage I was originally going to make
stage I was originally going to make
puffer uh game focused but I decided it
puffer uh game focused but I decided it
would be better to have puffer be more
would be better to have puffer be more
broadly RL for whatever application and
broadly RL for whatever application and
we still use games a lot but mainly we
we still use games a lot but mainly we
use we use games for RL more than we use
use we use games for RL more than we use
RL for games if that makes sense we use
RL for games if that makes sense we use
games as tests for reinforcement
games as tests for reinforcement
learning cuz they're fun to implement
learning cuz they're fun to implement
they are very very fast and uh they're
they are very very fast and uh they're
very easy to interpret which many other
very easy to interpret which many other
types of Sims are not so we'll add more
types of Sims are not so we'll add more
specific industry simulators as we go
specific industry simulators as we go
forward but games are a really nice core
forward but games are a really nice core
test
set rip
set rip
Rita yeah I don't actually know if
Rita yeah I don't actually know if
they're still doing stuff
um not entirely sure
I'm pretty happy with how puffer's gone
I'm pretty happy with how puffer's gone
so far though like we have actually sped
so far though like we have actually sped
up reinforcement learning 100 to a th000
up reinforcement learning 100 to a th000
fold we have a variety of environments
fold we have a variety of environments
some of which are already nice and
some of which are already nice and
stable others of which are still in
stable others of which are still in
production but are looking
production but are looking
good we've gotten a nice community of
good we've gotten a nice community of
users and contributors it's a very fast
users and contributors it's a very fast
growing project um we've solved a ton of
growing project um we've solved a ton of
the problems that were virtually
the problems that were virtually
impossible just a few months ago it's
impossible just a few months ago it's
been going
been going
well I'd say we're definitely on Pace
let's see what this guy
is fun to get Farming C stuff
up if you found the Pu recor is getting
up if you found the Pu recor is getting
settled in regarding rppo cm is mostly
settled in regarding rppo cm is mostly
it's n work uh it's n work because
it's n work uh it's n work because
there's no point of doing algorithm work
there's no point of doing algorithm work
when everything is this slow in
when everything is this slow in
RL like you can't tell if one algorithm
RL like you can't tell if one algorithm
is better than another like you can't
is better than another like you can't
run enough tests like literally like
run enough tests like literally like
we're going to end up redoing the last
we're going to end up redoing the last
10 years worth of orl research because
10 years worth of orl research because
the majority of Publications are wrong
the majority of Publications are wrong
it's actually that
bad what are these guys
doing okay so they're
doing okay so they're
farming working I'd be up for working on
farming working I'd be up for working on
a more busy
environment envin Cuda for European
environment envin Cuda for European
space agen torso decomposition challenge
space agen torso decomposition challenge
be a lot slower than most
be a lot slower than most
M's yeah M speed is the tough
M's yeah M speed is the tough
one like resources go up proportionally
one like resources go up proportionally
if M are
slow so this guy's just
farming is it easy to write a game I
farming is it easy to write a game I
made an environment for German card game
made an environment for German card game
although it was made for gymnasium yeah
although it was made for gymnasium yeah
very easy
um I mean no easier than like no easier
um I mean no easier than like no easier
or harder than it would be to write on
or harder than it would be to write on
its own normally like we have this here
its own normally like we have this here
I made a basic template for a card game
I made a basic template for a card game
that we're going to be expanding on kind
that we're going to be expanding on kind
of Magic the Gathering right we can play
of Magic the Gathering right we can play
a land do this we can like attack let's
a land do this we can like attack let's
see play this this
see play this this
swing um uh
swing um uh
this and this two four
this and this two four
six and I think we got a
six and I think we got a
block and
block and
four two
four two
two and I
two and I
win yeah so you can look at the code for
win yeah so you can look at the code for
these they're on uh the GitHub St the
these they're on uh the GitHub St the
puffer it's in Dev
we have to do RL for that one still but
we have to do RL for that one still but
it'll be very easy to
it'll be very easy to
bind well I thought for Speed you'd
bind well I thought for Speed you'd
write it in yeah we write our M's in
C but like it's
C but like it's
easy so here's the Moa the MOBA that
easy so here's the Moa the MOBA that
I've been working on right now here's
I've been working on right now here's
the entire source for it it's 2,000
the entire source for it it's 2,000
lines it's C just pure
lines it's C just pure
c um where's the
c um where's the
TCG the TCG prototype that you just
saw
TCG yeah TCG is like 500
TCG yeah TCG is like 500
lines I technically have a LinkedIn
lines I technically have a LinkedIn
though actually it's kind of funny I've
though actually it's kind of funny I've
stopped updating it cuz all the business
stopped updating it cuz all the business
stuff these days comes off of
stuff these days comes off of
X funny
X funny
enough like literally all of the
enough like literally all of the
uh all the business stuff comes off of X
uh all the business stuff comes off of X
these
days Jake going to look at building
days Jake going to look at building
industry adjacent Ms that are open
industry adjacent Ms that are open
source after I get a baseline done
source after I get a baseline done
either that or TCG yeah industry Ms are
either that or TCG yeah industry Ms are
good next time I log into LinkedIn I
good next time I log into LinkedIn I
have to like update everything H that
have to like update everything H that
site is a mess I haven't updated like
site is a mess I haven't updated like
any of my my profiles on stuff other
any of my my profiles on stuff other
than x I'm actually I'm live on X as
than x I'm actually I'm live on X as
well well right now it's multi streamed
well well right now it's multi streamed
this is the
this is the
xlink I do Post quite a bit of stuff on
xlink I do Post quite a bit of stuff on
here about reinfor it's all like RL
here about reinfor it's all like RL
stuff right it's a professional
account I try not to get bored and post
account I try not to get bored and post
random stuff too
often all right what are these guys
often all right what are these guys
doing so this guy got level
doing so this guy got level
three oh it's just he's just chilling
three oh it's just he's just chilling
around base and like farming
huh it's not necessarily
bad it's just hasn't optimized well it's
bad it's just hasn't optimized well it's
been stable at
least here let me just whoops let me
least here let me just whoops let me
make a longer run
and then we'll do some stuff in the
and then we'll do some stuff in the
meantime while this uh this while this
meantime while this uh this while this
works actually let's make your
commit piix some logs thanks Dylan uni
commit piix some logs thanks Dylan uni
trying to have reach for future
trying to have reach for future
opportunities need to be more active on
opportunities need to be more active on
X yeah X is really good for
ML yeah we do uh all all of the stuff is
ML yeah we do uh all all of the stuff is
on like the open source stuff is on
on like the open source stuff is on
discord.gg puffer
discord.gg puffer
um I mean we have people that have just
um I mean we have people that have just
joined like in the last few weeks it's a
joined like in the last few weeks it's a
really good way to learn this stuff
really good way to learn this stuff
quickly because you do a lot of
quickly because you do a lot of
engineering side stuff building
engineering side stuff building
environments you learn some RL in the
environments you learn some RL in the
process of doing that you get a lot of
process of doing that you get a lot of
feedback both from myself and from all
feedback both from myself and from all
the other people working on it it's like
the other people working on it it's like
a very fun and fast-paced thing and like
a very fun and fast-paced thing and like
it's not a giant code base it's a very
it's not a giant code base it's a very
small code base it's very easy to work
small code base it's very easy to work
on like a small specific like
on like a small specific like
environment or whatever um
yeah you even get
yeah you even get
um people that contribute like
um people that contribute like
environments also get cluster access
environments also get cluster access
once they like if they're like actively
once they like if they're like actively
contributing
stuff bet here who is star Zerg in the
stuff bet here who is star Zerg in the
chat works on uh Pokemon reinforcement
chat works on uh Pokemon reinforcement
learning we've got Spencer who was here
learning we've got Spencer who was here
earlier is done is currently working on
earlier is done is currently working on
go uh BET's doing Enduro stuff as well
go uh BET's doing Enduro stuff as well
at the moment what else is in here uh
at the moment what else is in here uh
Noah has a breakout and clone Nathan's
Noah has a breakout and clone Nathan's
got like this MMO combat M that he's
got like this MMO combat M that he's
been working on lots and lots of
stuff let's see if we can figure out
stuff let's see if we can figure out
what the heck is wrong with
what the heck is wrong with
vectorization
here I got a bit frustrated with RL so
here I got a bit frustrated with RL so
much comes down to how you design your
much comes down to how you design your
neural
neural
network example for 20
network example for 20
48 yeah but the thing is
48 yeah but the thing is
like I have the experience on that side
like I have the experience on that side
of things um and you can really just
of things um and you can really just
automate all of the experiments if the
automate all of the experiments if the
en is fast like for 2048 I could very
en is fast like for 2048 I could very
easily make that environment run a
easily make that environment run a
million plus steps per second per CPU
million plus steps per second per CPU
core and at that point you can just like
core and at that point you can just like
you can run tens of billions of steps
you can run tens of billions of steps
worth of experiments and you don't have
worth of experiments and you don't have
to think about anything at that point
to think about anything at that point
because you just run all the experiments
because you just run all the experiments
like the performance engineering side
like the performance engineering side
makes everything else
easy let me see if I can figure out
easy let me see if I can figure out
multiprocessing while we're doing this
multiprocessing while we're doing this
why it's like freezing for the Moa
it's freezing for the mobile on the
it's freezing for the mobile on the
bigger
machine well we'll see if it freezes
here in the meantime we've got our
puffer and here's our latest
run we'll see how this
run we'll see how this
Compares so many hypers to worry about
Compares so many hypers to worry about
you need autoo yeah we have that though
you need autoo yeah we have that though
we have automated hyper parameter Sweep
we have automated hyper parameter Sweep
with a good algorithm we have carbs
with a good algorithm we have carbs
integration it's much better than your
integration it's much better than your
typical randomer Bay
search these are already things that
search these are already things that
I've thought about and solved in
puffer okay so here we can see this is
puffer okay so here we can see this is
frozen right
so the question is why is this Frozen
one cores at
Max very cool project thank
you I wouldn't be working on this full
you I wouldn't be working on this full
time right if I didn't think that there
time right if I didn't think that there
was the ability to really just change an
was the ability to really just change an
entire field
yeah no that's not Yan kiler no way
yeah no that's not Yan kiler no way
that' be funny
though we've had some funny stream
though we've had some funny stream
things
things
happen we had uh Eugene hop in
happen we had uh Eugene hop in
NYU Professor hop in stream uh just in
NYU Professor hop in stream uh just in
time to see puffer lib solve one of his
time to see puffer lib solve one of his
RL uh one of his RL simulators like a
RL uh one of his RL simulators like a
100 times faster than it was solved
[Music]
before why is this stuck I'm trying to
before why is this stuck I'm trying to
think why where this could be stuck
should accumulate some stream clip for
should accumulate some stream clip for
marketing pretty cool you're working in
marketing pretty cool you're working in
public like this think is really needed
public like this think is really needed
yeah I mean I figure like I can be I can
yeah I mean I figure like I can be I can
work in silence or I can stream it and
work in silence or I can stream it and
have a bunch of people see it and like
have a bunch of people see it and like
this has been a great way to get people
this has been a great way to get people
interested in contributing as well it's
interested in contributing as well it's
like yeah you can literally just be um
like yeah you can literally just be um
deving cool environments and like people
deving cool environments and like people
will show up on stream and just be like
will show up on stream and just be like
hey I wrote this environment thing for
hey I wrote this environment thing for
puffer like can you go look at the code
puffer like can you go look at the code
for it sure I'll go do code review
for it sure I'll go do code review
live heck uh in the evenings I'm often
live heck uh in the evenings I'm often
in the Discord voice of uh you know the
in the Discord voice of uh you know the
puffer Discord voice like checking on
puffer Discord voice like checking on
code review for people's mends and
code review for people's mends and
giving us suggestions on stuff and
giving us suggestions on stuff and
whatnot
trying to think how this could
trying to think how this could
possibly be
possibly be
[Music]
[Music]
hanging because
like what's the worker process
do if
infos get native
buff equal
buff is it okay if I join the voice if
buff is it okay if I join the voice if
I'm not yeah you can totally join it's
I'm not yeah you can totally join it's
open might try to do a 2048 puffer lip
open might try to do a 2048 puffer lip
version so the fun thing with puffer is
version so the fun thing with puffer is
you can just use it if you have a
you can just use it if you have a
gymnasium M you can use it with puffer
gymnasium M you can use it with puffer
instantly and then if you want to make
instantly and then if you want to make
it faster right then we give you lots of
it faster right then we give you lots of
different options for how to make it
different options for how to make it
faster with
faster with
puffer all the M's are only on GitHub or
puffer all the M's are only on GitHub or
is there a separate place to search for
is there a separate place to search for
M's we have them on GitHub we have one
M's we have them on GitHub we have one
repo for the time being they're just in
repo for the time being they're just in
uh the first party environments are an
ocean the fun thing about writing the
ocean the fun thing about writing the
M's the way that we do is you get a web
M's the way that we do is you get a web
build for free
build for free
like you don't have to do anything
like you don't have to do anything
special to get these on web cuz they're
special to get these on web cuz they're
written in C with rib so
written in C with rib so
like you just compile them for web to
like you just compile them for web to
web assembly and you're done and then
web assembly and you're done and then
it's like hey I wrote breakout but I can
it's like hey I wrote breakout but I can
also play it online and like hey I wrote
also play it online and like hey I wrote
snake but also I can play it online and
snake but also I can play it online and
in fact I can take my hands off the
in fact I can take my hands off the
keyboard and the RL will play all the
snakes so we got some fun demos like
snakes so we got some fun demos like
that yeah but I'd write it and see you
that yeah but I'd write it and see you
don't have to
don't have to
I mean it depends on how familiar you
I mean it depends on how familiar you
are on lowlevel stuff generally like if
are on lowlevel stuff generally like if
you write it in Python it'll be faster
you write it in Python it'll be faster
and puffer than it'll be anywhere else
and puffer than it'll be anywhere else
if you want it to be fast then you can
if you want it to be fast then you can
write it in scon which is very much like
write it in scon which is very much like
python but it's very fast and then if
python but it's very fast and then if
you want to be able to play it on the
you want to be able to play it on the
web and have it be fast and have it be a
web and have it be fast and have it be a
standalone then you go to
see looks like for 9 by9 this is for go
see looks like for 9 by9 this is for go
when I cut Max steps per epis episode to
when I cut Max steps per epis episode to
100 from 200 it is learning
100 from 200 it is learning
better almost like it had too much
better almost like it had too much
leeway to make bad
moves Max deps per
episode something's weird there Spencer
episode something's weird there Spencer
if it's getting a reward for bad moves
if it's getting a reward for bad moves
if it's getting a negative reward for
if it's getting a negative reward for
bad mov something's weird
bad mov something's weird
there you're actually writing UI I I
there you're actually writing UI I I
mean
mean
here let me show you how simple this
here let me show you how simple this
is because people do not understand when
is because people do not understand when
they see this stuff like it's actually a
they see this stuff like it's actually a
lot of this is very easy to get
lot of this is very easy to get
into like here let's look at um what
into like here let's look at um what
pong
pong
breakout one of these here's pong this
breakout one of these here's pong this
is 300 some odd lines this is all the
is 300 some odd lines this is all the
code
here is the UI at the bottom the UI is a
here is the UI at the bottom the UI is a
struct a little make function and this
struct a little make function and this
is the render function right here it's
is the render function right here it's
like 100 lines of code it runs on
like 100 lines of code it runs on
desktop you can compile it to web
desktop you can compile it to web
assembly and it runs on web that's
it so it's actually incredibly easy
what on Earth is this
wait how do I
adjust semors
oh cuz I set the seore down
here yeah there's nothing that should be
here yeah there's nothing that should be
able to Loop
here render the eval in a second waiting
here render the eval in a second waiting
for it to finish episode return has been
for it to finish episode return has been
slowly increasing episode length has
slowly increasing episode length has
been slowly decreasing all right
been slowly decreasing all right
something is weird there but that's fine
something is weird there but that's fine
for
for
now there's definitely something weird
now there's definitely something weird
there it should be able to learn to
there it should be able to learn to
prune inv valid moves very easily my
prune inv valid moves very easily my
guess is that there's something that's
guess is that there's something that's
not being handled
not being handled
correctly there's probably like a
correctly there's probably like a
specific invalid move or like
specific invalid move or like
um there's probably some move that it's
um there's probably some move that it's
not getting penalized for that it's like
not getting penalized for that it's like
able to spam or something weird like
able to spam or something weird like
that
TR think
TR think
why this would be
why this would be
possible that like
wait a
second yeah it's the main process that's
spinning how is only the main process
spinning that doesn't make sense does
it there's one process that's spinning
it there's one process that's spinning
at
at
e e
top I by top
4499 just chilling and receive
not running anything
I don't even know why there are this
I don't even know why there are this
many processes there shouldn't be this
many processes there shouldn't be this
many of them
let's see this uh progress here oh look
let's see this uh progress here oh look
at
at
that we get uh training
that we get uh training
here and then it
crashes stability is a big problem
what happened here value function
spiked policy law
spiked policy law
spiked clip crack didn't
spike is this just like too big learning
spike is this just like too big learning
rate what the hell
there was one Spike
here oh invalid map value hold on
here oh invalid map value hold on
there it
is we found
something invalid MTH
something invalid MTH
value there's some like bug
value there's some like bug
thing let's fix let's fix something real
quick we're going to see if we can fix
quick we're going to see if we can fix
that
is I'm going use a rest from real quick
is I'm going use a rest from real quick
I'll be right back we'll see if we can't
I'll be right back we'll see if we can't
find that bug it' be really good to have
find that bug it' be really good to have
this thing multiprocess
this thing multiprocess
correctly be right
back
e
e
e e
[Music]
don't doubt that something may be screwy
don't doubt that something may be screwy
but what winning 80 to 90% random
but what winning 80 to 90% random
watching
watching
render yeah we'll
render yeah we'll
see we'll see uh what it's doing that's
see we'll see uh what it's doing that's
good though that's
progress this stck
progress this stck
now no it's not
now no it's not
stuck this one though invalid map value
stuck this one though invalid map value
and it's this is now Frozen right yeah
and it's this is now Frozen right yeah
so it froze at 10.2 with this invalid
so it froze at 10.2 with this invalid
map value
message
12412 which what we're going to do
there
okay
so it found a
255 how did it
255 how did it
find a 250
find a 250
5 map
grid map game map numpy
and it gets M
copied gam map.
numpy right
right it's in resources now
right it should be in resources
cannot load
read
read
file I make this
binary gu this is binary
unsign
charar
um uh
and what's the script that I use to save
this nice bites
so here you have this convert
so here you have this convert
map and then it gets saved like this
right go to
right go to
map oh we don't even have DOTA map do
map oh we don't even have DOTA map do
we okay
I don't know how it's possible it's
I don't know how it's possible it's
equal to 255 unless I have the
equal to 255 unless I have the
dimensions
wrong 128 by 128
so this is 128 by
128 to the exact size
respawn
respawn
Towers respawn agents
I mean there could be something Jank
I mean there could be something Jank
going on
trying to see
trying to see
how the grid would get messed
up it had a value of
255 the only other place I know where
255 the only other place I know where
I'm filling stuff with 255 a
bunch and there is this AI path thing
bunch and there is this AI path thing
here
right this gets filled with
255s wait we had another clue didn't we
we had another another
clue I was dumb I ignored
clue I was dumb I ignored
it I lose it oh no wait
1242 well you shouldn't be able to be at
1242 well you shouldn't be able to be at
124 but that's still a valid map value
map offset
know what we should
do load up um
void
test
bugs let's do
this for
allocate
let's see
that right
there might need to look
at I need to look at that
that could be it
there tempting to free
reallocated mooba
I just do like
this I'm essentially trying to figure
this I'm essentially trying to figure
out there's something in here that's
out there's something in here that's
screwing up in multiprocessing and I
screwing up in multiprocessing and I
don't know what it is I don't know why
don't know what it is I don't know why
only screws up in multi prosing but I'm
only screws up in multi prosing but I'm
hoping I can find it with um some
hoping I can find it with um some
compile
compile
tools okay we're leaking tons of
stuff um for
okay
oh this needs to call free
MOA okay and
MOA okay and
now this goes away
now we're leaking tons of stuff
wait
wait
net con re
con flat
I don't know what happened
there sometimes you need to do this type
there sometimes you need to do this type
of work for a bit in order to fix stuff
of work for a bit in order to fix stuff
it's
it's
fine read
fine read
file for
load
weights
for the reason I'm doing this is because
for the reason I'm doing this is because
I'm I fear that there's like some weird
I'm I fear that there's like some weird
memory corruption thing happening uh
memory corruption thing happening uh
that I'm not seeing because of all of
that I'm not seeing because of all of
this
Terminals and truncations
okay so these are good and then here's
okay so these are good and then here's
the big
the big
one I guess the uh the line moved hold
one I guess the uh the line moved hold
on
allocate log
buffer this needs to be free log
buffer okay now we should have no
buffer okay now we should have no
more memory
problems
perfect and
furthermore we now have a clean slate to
furthermore we now have a clean slate to
look at this
problem compute
observations array
subscript how is 484
this eror does not make sense to
me I don't understand this error because
me I don't understand this error because
like 44 is less than 512 last I checked
Gent
that's a [__] warning
but I see that that could potentially
but I see that that could potentially
be
be
okay so
510 there's 26 elements though
unless I'm off by one or something but I
unless I'm off by one or something but I
don't think
so yeah that's fine
that was the only thing I could think
that was the only thing I could think
of what about ob's
map 11 by 11 by4 is this still the OB
map 11 by 11 by4 is this still the OB
size did I mess something up
size did I mess something up
there still 11 by 11 by4
[Music]
[Music]
right and then this gives you 8
right and then this gives you 8
11 by 11 by 4 + 26 right
and the other thing is like
where is this the only place hold on
where is this the only place hold on
what what compile flags do I
what what compile flags do I
have I have all of these
have I have all of these
I have all of these
flags I'm just trying to figure out
flags I'm just trying to figure out
how how it's possible for something on
how how it's possible for something on
the map to be invalid
the map to be invalid
there especially as a 255
like the map is getting corrupted
like the map is getting corrupted
somehow I don't know if this is actually
somehow I don't know if this is actually
the bug oh wait no it's totally the bug
the bug oh wait no it's totally the bug
look cuz you have an exit one
look cuz you have an exit one
here you see
here you see
this so yeah this will silently
crash what if I just delete this
crash what if I just delete this
what if I just delete this line
let's see if that gets stuck while we go
let's see if that gets stuck while we go
look at our
look at our
uh our new run
uh our new run
here w
here w
we look at that
something
something
happened radiant
level they're very weird train curves
carry what was happening with this run
carry what was happening with this run
here well I mean this looks good to
here well I mean this looks good to
me I would like to go grab this
me I would like to go grab this
policy see what happened with it and
policy see what happened with it and
actually this one as well
yeah there two policies for us to look
at are we stuck
at are we stuck
here how are we going to be stuck here
it's very weird here let's go grab our
it's very weird here let's go grab our
um our
experiments from uh the main machine
experiments from uh the main machine
here
let's see so we want
probably like 100
right
okay I lose the SCP term that I was
okay I lose the SCP term that I was
using
using
before yeah
okay so this is the previous run that we
okay so this is the previous run that we
did
uh they don't seem to be doing
anything I get the wrong
one think so
according to this this model went
nuts unlike every
metric I guess uh 150 Maybe
yeah it was a very
quick let's try this
one I'm not seeing anything different oh
one I'm not seeing anything different oh
no these guys are coming
no these guys are coming
hold
on whole team is coming we getting
stuck it's not look particularly good
though I would like to at least see the
though I would like to at least see the
behavior that got those scores
okay so now it's different
Meandering down a side lane
interesting there's the tank
engage I
engage I
mean that's a three man going down
mean that's a three man going down
fourman going down a side
fourman going down a side
lane this guy's
lane this guy's
stuck these guys are getting there
stuck these guys are getting there
slowly
about to have a team fight here
about to have a team fight here
right
no okay
no okay
interesting I don't really know what to
interesting I don't really know what to
think of this
one let me see if
which model did I copy
before okay for
okay so here's the new
okay so here's the new
model was trained for
longer I
longer I
mean that looks good
that's a way better model that's what we
that's a way better model that's what we
were going for
today we got to fix the multiprocessing
today we got to fix the multiprocessing
thing so we can do these runs fast
thing so we can do these runs fast
I want to get like a cool screenshot of
I want to get like a cool screenshot of
a team
fight that's nice
for e
M
M
new this is going to be mobile
weights bin
okay
so this
what
for for
just loading the new policy in it's not
just loading the new policy in it's not
a completely automated process
yet here so now I'm assassin I control
yet here so now I'm assassin I control
this guy uh I have like standard MOBA
this guy uh I have like standard MOBA
controls I've got my team with me come
controls I've got my team with me come
on these are my RL teammates they're
on these are my RL teammates they're
kind of slow come on guys you guys are
kind of slow come on guys you guys are
like rank plastic four or
like rank plastic four or
something I'm literally going to have to
something I'm literally going to have to
go farm something while I wait because
go farm something while I wait because
you guys are so slow
on except I can't really Farm very well
on except I can't really Farm very well
at low level here we'll do
this got kind of a a dash strike
somebody
Mana Tower
Mana Tower
okay we counter their assassin cool I
okay we counter their assassin cool I
mean this is like a little MOA now they
mean this is like a little MOA now they
actually have a look there's their
carry oh he stunned me he actually got
carry oh he stunned me he actually got
me with a stun that's freaking
cool go
cool go
regen yeah solid
regen yeah solid
oh Das strike
there we go got him all right that's
solid put this here
I want to push some of these to the web
Maybe e
why is there nothing in
here oh EMCC command not found that's
here oh EMCC command not found that's
fine um
upper net not found
now I have to
do how do I include
do how do I include
theh this m script in
I
slet poet. H not
found do I just need a dash ey puffer
found do I just need a dash ey puffer
lib
oh there we go
we're going to update the
we're going to update the
website bunch of assets for
okay okay so here's our
website uh Connect 4 does
website uh Connect 4 does
not any of these
work uhoh
file not
found oh this
found oh this
works and take over for the puffer
right pong
right pong
Works puffer Triad works
mobile
mobile
work so the Moa does not
work so the Moa does not
work and Connect 4 does not
work and Connect 4 does not
work fure out why that
work fure out why that
is file not
found okay
what's wrong with this
is there no game map. wome is that the
is there no game map. wome is that the
problem hold on for
h
what's this game.
what's this game.
data two Megs
nothing shouldn't even need this though
nothing shouldn't even need this though
why does it have this much it's probably
why does it have this much it's probably
because we're loading all the assets
because we're loading all the assets
yeah so I have to improve
yeah so I have to improve
that um they should be able to load
though yeah this exact
file for
128 no difference between this and the
128 no difference between this and the
other one
right I don't even have a policy loaded
right I don't even have a policy loaded
in this one oh
in this one oh
dope
dope
LP that was
dumb bu connect for for
web what
web what
and MOA is the one that doesn't work now
right
demo the demo is what we want right
okay so the
okay so the
Moa does work
Moa does work
locally so we actually do have some sort
locally so we actually do have some sort
of issue
of issue
here it would
seem do we get some sort of error
seem do we get some sort of error
here stack overflow
oh
yeah I had some flag here for this
yeah I had some flag here for this
didn't I
didn't I
I did have some flag for
this push some nice fixes
initial memory
how about
this do like this
what am I doing that's like crazy stack
size I think I was doing anything crazy
size I think I was doing anything crazy
stack
size could just be like initial memory
size could just be like initial memory
whatever this flag
was I think that this one was
required
required
mobile okay
still know
there we
go do we have our
go do we have our
team come on
team come on
come on
come on
puffers yeah we got our
team and they actually do stuff now
right that's
right that's
solid that's very solid
oops
status
status
okay those are some nice
improvements we got to get the uh
improvements we got to get the uh
Connect
Connect
4 thing faster so we can uh watch that
4 thing faster so we can uh watch that
play be
interesting but yeah that's the better
interesting but yeah that's the better
MOA
MOA
opponent not an amazing MOA opponent by
opponent not an amazing MOA opponent by
any means but you know we at least we
any means but you know we at least we
got something reasonable that I think we
got something reasonable that I think we
can work with and we can convert that
can work with and we can convert that
into much better MO opponents over time
into much better MO opponents over time
uh we need to figure out this
uh we need to figure out this
vectorization
vectorization
Shenanigans thing happening at the
Shenanigans thing happening at the
moment
though like what's going on
here should also commit the mo prams
here should also commit the mo prams
before we lose
them
them
MOA um
that's
fixed we
fixed we
freeze no
does this fix
does this fix
it the thing that we
changed for
we fix this
we're going to see if this actually runs
billion
look stable to
me 500k
me 500k
train very
train very
nice okay so there's some weird Edge
nice okay so there's some weird Edge
case thing that we have not caught
case thing that we have not caught
correctly at least now it it doesn't
correctly at least now it it doesn't
like hard fail um we'll see if it screws
like hard fail um we'll see if it screws
up training or anything
few issues remaining with environment
few issues remaining with environment
speed and the
speed and the
like that we need to
fix I'm leave this here for
fix I'm leave this here for
now it's 5:00 P p.m. be right back I'm
now it's 5:00 P p.m. be right back I'm
going to use a
going to use a
restroom I'm going to come back I'm
restroom I'm going to come back I'm
going to see if I can do some per fixes
going to see if I can do some per fixes
on the
on the
MOBA get this thing a little bit faster
MOBA get this thing a little bit faster
and then we should be good and I don't
and then we should be good and I don't
know if we'll run a sweep or how we'll
know if we'll run a sweep or how we'll
treat this but we will do some sort of
treat this but we will do some sort of
experiments overnight on this be right
experiments overnight on this be right
[Music]
back
e
e
e e
is the Run still
good let's
see ooh
see ooh
uh that's
weird oh it's fine we didn't uh we
weird oh it's fine we didn't uh we
didn't
rebuild that's my
rebuild that's my
bad
uh yeah I just didn't rebuild it
all right we'll see if that's stable in
all right we'll see if that's stable in
a
second e
[Music]
we're stuck at 10.2 still aren't
we're stuck at 10.2 still aren't
we how do that
we how do that
work we got the 44 million over here so
work we got the 44 million over here so
how's this
happen there's no exit
here I mean
we going to get stuck at 10.2
there we
there we
go all right
go all right
well we're not stuck at 10.2 we're stuck
well we're not stuck at 10.2 we're stuck
at
at
12.3 big
12.3 big
Improvement why the heck does it work
Improvement why the heck does it work
here I ran it with multiprocessing on
there are no other possible places it
there are no other possible places it
should be able to be stuck
here
here
weird maybe we uh we figure this out in
weird maybe we uh we figure this out in
the process of doing a little bit of
the process of doing a little bit of
perf
profiling and there's the main annoyance
profiling and there's the main annoyance
at the moment I think if we fix this
at the moment I think if we fix this
everything else is good
fix perf in the meantime as
well all
well all
right be right back and then we'll fix
right be right back and then we'll fix
this I don't know what's up with it
though
e e
let's
see
for
for e
this is 600,000 steps per
second h
is the python wrapper
slow
for for
I don't know why it needs to load that
and this is my
local so it's plenty fast or should be
local so it's plenty fast or should be
plenty
fast there's no reason for it to be slow
fast there's no reason for it to be slow
600k on the slow box should be like 2
600k on the slow box should be like 2
million on the past box
so we're dropping perf somewhere
hm
h e
it's somehow all on the
step is this actually compile
Flags this might literally be compile
Flags this might literally be compile
Flags
no way it should be 43% like that
I didn't do that yet that's fine
it's literally just
dash2 why is it so much
slower for
there's just simply no way that this
there's just simply no way that this
should be 44%
compute for
there's simply no way
is this scon just being terrible or like
is this scon just being terrible or like
what
I don't
I don't
understand uh what's the what the hell
understand uh what's the what the hell
is wrong with this
I swear it stands for I don't know what
I swear it stands for I don't know what
the
the
[__] I don't know maybe before we solve
[__] I don't know maybe before we solve
AGI we can solve
AGI we can solve
um
um
indenting or pasting in Vim that would
indenting or pasting in Vim that would
be
great whatever
Okay so
either the perf test is wrong or it's
either the perf test is wrong or it's
like something screwy here let's
like something screwy here let's
see okay
see okay
12 1.2 million
right is my perf test
wrong 10
seconds end minus start
wait no this is steps yeah times 10 cuz
wait no this is steps yeah times 10 cuz
agents and that's how I did it up here
right did you write your own C version
right did you write your own C version
of linear LS layer plus lstm
of linear LS layer plus lstm
yeah we have comms as
yeah we have comms as
well you want to play with them
now available on Discord dot well not
now available on Discord dot well not
discord. GP puffer just puffer Dogg
discord. GP puffer just puffer Dogg
there you go so you can play this guy
there you go so you can play this guy
and your teammates will come after you
and your teammates will come after you
using their little CN lstm policy there
using their little CN lstm policy there
you go and eventually they'll fight in
mid come on
mid come on
puffers here there's the other team
puffers here there's the other team
coming here's our team
coming here's our team
going let's here this guy's strong right
going let's here this guy's strong right
let's uh save the
let's uh save the
oops I got to get back to the fight to
help Dash strike the
carry yeah there you go
is this actually 10
seconds yeah that's 10
seconds 1.2
mil do I have to time it from
python that we have to do next
still gives me 800k
still gives me
still gives me
800k
so 800k would actually be
40% no wait
yeah there should be less than 40%
compute at that speed
I also don't know why this freezes
I don't even know how it's possible it's
I don't even know how it's possible it's
still 26% with two of these
still 26% with two of these
environments now there it goes Frozen
environments now there it goes Frozen
again
I actually can't think of anything that
I actually can't think of anything that
would cause a process like this to
would cause a process like this to
freeze
especially not something that would
especially not something that would
cause it to freeze multiprocess and not
normally like
t- San what's
that red
sanitizer there's not even anything
sanitizer there's not even anything
happening
across but like I'm not doing anything
across but like I'm not doing anything
that's
that's
actually multi-threaded or anything like
actually multi-threaded or anything like
that
I mean I can put this in but like I'm
I mean I can put this in but like I'm
not even using
not even using
threads unless something like I don't
threads unless something like I don't
even have dependencies that could be
even have dependencies that could be
using threads that I'm aware
of is there an F sanitize all
incompatible it's
frozen yeah well the thing is like it
frozen yeah well the thing is like it
runs the end runs native it doesn't run
runs the end runs native it doesn't run
with
with
multiprocessing like it'll run 10
multiprocessing like it'll run 10
million steps and then freeze
I don't know why like I have no idea
I don't know why like I have no idea
what the heck could be causing that you
know does it work multi-threaded how am
know does it work multi-threaded how am
I supposed to
know I mean I'm not doing anything I can
know I mean I'm not doing anything I can
think of that would make it not work
think of that would make it not work
mult
threaded it's multiprocess though
regardless objects are inherited between
regardless objects are inherited between
processes
incorrectly but like we're making the
environments we're making the
environments we're making the
environments
environments
on the subprocess anyways
on the subprocess anyways
right standard
vectorization the fail in
vectorization the fail in
cereal I don't know we don't really
cereal I don't know we don't really
support like cereal doesn't really work
support like cereal doesn't really work
at the moment for
at the moment for
um puffer native M I got to fix
um puffer native M I got to fix
that and I can run it
yeah have this
warning let's see if it fails
it's also running way slower than the
it's also running way slower than the
perf tests indicate it should be
running look looks like it's
running I mean I actually can't think of
running I mean I actually can't think of
anything that would cause this at
all e
now this doesn't
hang
for e
this is only on a net
they work without computer
observations let's see
Frozen at 10.2 without even Computing
Frozen at 10.2 without even Computing
obs
very small at least
I can't see how it would possibly be
I can't see how it would possibly be
this
Frozen at
7.2 well there's no error
7.2 well there's no error
print you changed it yeah that doesn't
print you changed it yeah that doesn't
matter it's not deterministic when it
matter it's not deterministic when it
freezes
not always just
commonly now fren at
3.1
for e
pass path buffer and paths
I don't
know I don't think I use
it yeah I don't set terminals
it yeah I don't set terminals
anywhere so it shouldn't be able to
anywhere so it shouldn't be able to
be screwed with
3 * 8 * 12 *
and then we have this
is using unsigned Char for terminals
is using unsigned Char for terminals
correct
that's for
that for
I'm like trying to think what the hell
I'm like trying to think what the hell
this could be
I mean is it like some memory bug that's
I mean is it like some memory bug that's
not getting caught because of
um let me try
something what if I do
this for
okay Giga slow
build Giga slow
build
for
e e
the hell
that's going to make it take
forever I I think I just have the
forever I I think I just have the
thing oh you know what this is
thing oh you know what this is
here there
static libus on let's see about that
dude what the [__] how do I get this
dude what the [__] how do I get this
these
flags
for
e
e e
can I just do a dress
can I just do a dress
sanitizer will this
sanitizer will this
work how about just this one and I have
work how about just this one and I have
one sanitizer
one sanitizer
scon what do I got to do for one
sanitizer why is it always that the C
sanitizer why is it always that the C
works and then the [__] python
works and then the [__] python
binding somehow screws it
up yeah no iand detect
whatever re BRB rewriting all of modern
whatever re BRB rewriting all of modern
software and
C
for e
that do anything
what am I supposed to do with this
yeah this doesn't
work as some [__]
I'm just like I don't know what the hell
I'm just like I don't know what the hell
this could possibly be
hey
welcome
like what's possibly different with this
multiprocess e
I'm trying to think like how I can even
I'm trying to think like how I can even
debug this
okay idea
does it
does it
crash when I do one end even with just
crash when I do one end even with just
one M
one M
multiprocess trying to get
multiprocess trying to get
multiprocessing working on the latest
multiprocessing working on the latest
it's something screwy with uh the Moa
it's something screwy with uh the Moa
it's not
it's not
multi-processing it's just randomly
multi-processing it's just randomly
hanging welcome
hanging welcome
Spencer I'm going to jump off of this do
Spencer I'm going to jump off of this do
some stuff for like half an hour and
some stuff for like half an hour and
then uh I'll check in on go or whatever
then uh I'll check in on go or whatever
in a bit I just want to try a couple
in a bit I just want to try a couple
last
last
things I will set up some experiments to
things I will set up some experiments to
run regardless it's just obnoxious cuz
run regardless it's just obnoxious cuz
like I mean look it's hanging even
there I don't understand how it's
there I don't understand how it's
possible that the exact same code
possible that the exact same code
doesn't work in a subprocess
waiting on Jimmy Johns
puffer
en it's a puffen
so
so
here we do with this right
typ OB
typ OB
type
actions um
thanks bet Star Puffer indeed star repo
thanks bet Star Puffer indeed star repo
helps me very
much e
i' would be willing to be less human if
i' would be willing to be less human if
I didn't have to [__] deal with this
I didn't have to [__] deal with this
[__] [__]
[__] [__]
hell all right well we found something
hell all right well we found something
that causes the same hanging Behavior
that causes the same hanging Behavior
which is passing bad buffer or passing
which is passing bad buffer or passing
different buffer actually that's weird
let me think about
this let me try one other
thing
for
e
e e
this has to be
it it's got to be Memory corruption on
it it's got to be Memory corruption on
actions
what e
this is a very evil bug I see it
[__] gem I
swear e
that is [__]
evil memory
evil memory
corruption on python to scon on data
transfer yeah this is the same thing
transfer yeah this is the same thing
that you were dealing with with actions
that you were dealing with with actions
it's [__]
evil we need I need to add some guard
evil we need I need to add some guard
checks to the new
checks to the new
API that's evil evil
that's like unbelievably
evil half a million
evil half a million
train on the
Moa I'm trying to think what I even want
Moa I'm trying to think what I even want
to run for sweeps
we're not doing the fixes tonight we
we're not doing the fixes tonight we
know what it is we know we have to add
know what it is we know we have to add
those checks we know it produces
hangs the other M's good it depends on
hangs the other M's good it depends on
the
will'll make it architecturally
will'll make it architecturally
impossible to have that bug
again get rid of this
again get rid of this
this
we'll just do this for
now we'll see if this produces anything
now we'll see if this produces anything
um anything
noteworthy for
see how that goes
okay well we figured out the evil evil
okay well we figured out the evil evil
bug that's the last really evil bug with
bug that's the last really evil bug with
the new uh
the new uh
API couple more things to do but we got
API couple more things to do but we got
at least a reasonably competent MOBA
at least a reasonably competent MOBA
model trained
model trained
today and deployed
it's not amazing or anything but you do
it's not amazing or anything but you do
actually get the agents fighting each
actually get the agents fighting each
other in mid which is what we
wanted we deployed a bunch of other ones
what's the record GIF
thing screen to
GIF thought I had that installed
oh maybe I have the portable
one maybe
not for
how does software literally not
oh okay it does work
[__] why does this not
work I don't understand why this does
work I don't understand why this does
not show up in the stupid
bar for
oops
that's a convenient little UI
there we
go for
how many games of break how many games
how many games of break how many games
of uh breakout does it play
I mean we can see episode length
right
right
16,000 times real Time That's crazy
how did you pick the name
how did you pick the name
puffer it's like the puffer fish up
puffer it's like the puffer fish up
there you see
him you can play with the puffer too at
him you can play with the puffer too at
puffer
puffer
Dogg you just hold shift you can take
Dogg you just hold shift you can take
over for the train agent and see if you
over for the train agent and see if you
can do any
better well why the puffer fish I mean
better well why the puffer fish I mean
what would you do if you were going to
what would you do if you were going to
start a company that did like
start a company that did like
complicated Tooling in a niche domain
complicated Tooling in a niche domain
that's really hard to explain it's like
that's really hard to explain it's like
I'm not not going to have a logo that
I'm not not going to have a logo that
has anything to do with that no here
has anything to do with that no here
have a puffer fish it's funny and it's
memeable this actually feels like a fair
memeable this actually feels like a fair
game as well as of pong it doesn't feel
game as well as of pong it doesn't feel
[__] like the original Atari games
[__] like the original Atari games
do with all the rappers and [__] like
do with all the rappers and [__] like
you actually have very precise control
here puffer fish ball is funny yeah we
here puffer fish ball is funny yeah we
did it for breakout as well oops you can
did it for breakout as well oops you can
hold shift for this one
hold shift for this one
too this one is
harder I got to get nowhere to like fix
harder I got to get nowhere to like fix
some stuff on this or I'm probably I'm
some stuff on this or I'm probably I'm
going to have to do it he's linked me
going to have to do it he's linked me
the code um
yeah exactly so I'm probably going to
yeah exactly so I'm probably going to
have to do
have to do
it big deal unless you want to but it's
it big deal unless you want to but it's
not really a huge
not really a huge
deal so we got this one right uh we also
deal so we got this one right uh we also
have this Connect 4 one where we need a
have this Connect 4 one where we need a
better agent versus this I think Jack is
better agent versus this I think Jack is
going to do that
Enduro going to be a
Enduro going to be a
meme yeah got to finish
meme yeah got to finish
that we upgraded the graphics on Triad a
that we upgraded the graphics on Triad a
little bit as well I got to update the
little bit as well I got to update the
thumbnails
probably but yeah there you
probably but yeah there you
go let me make sure my Wanda Bay weeps
go let me make sure my Wanda Bay weeps
are good
looks good to
me
me
cool we have our carb sweep
cool all right I'm going to call it
cool all right I'm going to call it
there
there
um you
um you
can try out this stuff at puffer G you
can try out this stuff at puffer G you
can get all the code at puffer ai.
can get all the code at puffer ai.
github.io right here is the
github.io right here is the
GitHub go ahead and start the GitHub if
GitHub go ahead and start the GitHub if
you haven't already please actually do
you haven't already please actually do
that it really does help me out a lot um
that it really does help me out a lot um
that and followers on X are the only
that and followers on X are the only
really two growth metrics I track for
really two growth metrics I track for
the project you can also join us on
the project you can also join us on
discord.gg puffer if you want to get
discord.gg puffer if you want to get
involved with contributing to the
involved with contributing to the
project and developing some of these
project and developing some of these
environments you really just need an
environments you really just need an
engineering background as all um the
engineering background as all um the
reinforcement learning side of things
reinforcement learning side of things
you kind of pick up along the way no big
you kind of pick up along the way no big
deal um yeah so I'm going to go hop off
deal um yeah so I'm going to go hop off
of this I'm going to do a couple things
of this I'm going to do a couple things
and then I'll probably jump into the
and then I'll probably jump into the
Discord voice for a bit to help
Discord voice for a bit to help
troubleshoot uh whatever problems people
troubleshoot uh whatever problems people
have on custom M thanks all and
