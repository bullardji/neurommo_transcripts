Kind: captions
Language: en
folks we're
back I uh I think I'm going to just
back I uh I think I'm going to just
reset a little
reset a little
bit and do some experimental engineering
bit and do some experimental engineering
stuff with
stuff with
puffer
puffer
um I've been running support for you
um I've been running support for you
know a few different projects in the
know a few different projects in the
background and um if I have to deal with
background and um if I have to deal with
one more piece of like absolutely
one more piece of like absolutely
deranged research code um
deranged research code um
I think I'm going to
I think I'm going to
snap
snap
so we're just going to do some cool
so we're just going to do some cool
engineering right now that's what we're
engineering right now that's what we're
going to
do it's
do it's
like the only thing I'll say is it is
like the only thing I'll say is it is
astounding to me how willingly um even
astounding to me how willingly um even
very good
very good
scientists will just throw
scientists will just throw
away
away
99.9% of their computer
99.9% of their computer
yeah we'll just you know buy all this
yeah we'll just you know buy all this
expensive Hardware run it at
expensive Hardware run it at
0.1% of what it should be running at and
0.1% of what it should be running at and
then wonder why none of our stuff
works drives me
works drives me
bonkers but enough of
bonkers but enough of
that we're going to do some cool
stuff I do want to just briefly check on
stuff I do want to just briefly check on
the experiment that I ran from
before just briefly check on
this okay so this is interesting right
this okay so this is interesting right
because we have this one this one and is
because we have this one this one and is
it this one
it this one
so we'll see whether these intersect or
so we'll see whether these intersect or
not um this is with the optimized
not um this is with the optimized
hypers to go like
hypers to go like
this we'll see whether this stays above
this we'll see whether this stays above
uh the other curve it's interesting that
uh the other curve it's interesting that
it like has this fast growth at the
it like has this fast growth at the
start we'll see if it maintains
start we'll see if it maintains
it and
um yeah this is very very clean
um yeah this is very very clean
though so we're expecting about a 4.5
though so we're expecting about a 4.5
out of this I
believe
cool make sure I don't have
cool make sure I don't have
any reasonable messages from reasonable
any reasonable messages from reasonable
people on Discord I do
people on Discord I do
not okay so this is what uh I had
not okay so this is what uh I had
planned for right now um I've been
planned for right now um I've been
thinking about doing something like this
thinking about doing something like this
for a
for a
while there's a lot of scyon code in
while there's a lot of scyon code in
Puffer
Puffer
and it's pretty much all identical as
and it's pretty much all identical as
well every environment needs a scon
well every environment needs a scon
binding as well as a python binding and
binding as well as a python binding and
the code is
the code is
like it's kind of gross so what I want
like it's kind of gross so what I want
to do today is I just want to look at
to do today is I just want to look at
some different binding options and see
some different binding options and see
if I can think of anything that would
if I can think of anything that would
replace um that that
replace um that that
binding just do that for a little bit
binding just do that for a little bit
you know
what's the built-in one with
what's the built-in one with
python is it C
types it's just
uh Comm
I believe C types is the built-in
I believe C types is the built-in
one yeah C types is the built-in one no
compilation commit to calling
compilation commit to calling
pre-compiled C libraries less
pre-compiled C libraries less
efficient why is it less
efficient high
efficient high
performance and python C
API why is C
API why is C
types
Earth ah
Earth ah
every call involves interpreting the
signature compiled
bindings is there a
bindings is there a
built
built
in I
python C
API direct access to python
objects compiled into shared
libraries no runtime overhead
libraries no runtime overhead
direct memory
access
access
okay compare to high 11 for here C
expens highest possible performance
nearly identical once
compiled we don't like
C++ but these Pi objects are totally
gross give me example what
look like
I ire rate
only to
only to
just
buffer you can Leverage The numpy API
so you get two Pi
objects I don't like this total mess
here parse the input arguments
yeah this is a
mess there is a lot of high object
mess there is a lot of high object
mess
here
syon
memory start it's here see start
there
there
way to
add
arrays okay so this
arrays okay so this
is yeah this is
fine
fine
validation 1D double contiguous same
validation 1D double contiguous same
length
yeah that's just a massive amount of
yeah that's just a massive amount of
stupid code let me see if I can figure
stupid code let me see if I can figure
out why the API is like that and if
out why the API is like that and if
grock is just
grock is just
stupid
stupid
um so you get this Pi object
API I see you can only pass like this
API I see you can only pass like this
really
this the only way to use
this the only way to use
Python
Python
with my object R
with my object R
signature and I write
functions specific Sig
functions specific Sig
so void unpacking
python C API design enforces
this e
okay so you can pass
okay so you can pass
one one thing to the signature I
guess and know this is them making
guess and know this is them making
wrapper garbage
okay so the fast call thing
okay so the fast call thing
here this is Star Source this API is
here this is Star Source this API is
kind of gross because you don't get
kind of gross because you don't get
signatures
signatures
directly so syon must be doing something
directly so syon must be doing something
like this under the hood
right
e e
so what is
so what is
this extension
module it's a very odd API
this is like trying to write Python and
this is like trying to write Python and
see
I Bine lets you define the
signatures
e
e
e e
see this is just
awful this is
awful this is
awful required for python object
awful required for python object
integration
method table for the
type yeah know this code is absolutely
type yeah know this code is absolutely
terrible I don't understand is this that
terrible I don't understand is this that
Gro is stupid or is this that the python
Gro is stupid or is this that the python
API is
API is
stupid none of this should be required
welcome YouTube folks I'm currently
welcome YouTube folks I'm currently
seeing if I can find an alternative to
scon the goal would be to make a general
scon the goal would be to make a general
purpose
purpose
wrapper that um essentially just takes
wrapper that um essentially just takes
your C environment and then runs a bunch
your C environment and then runs a bunch
of copies of it for
you and I'm currently trying to figure
you and I'm currently trying to figure
out why the python API is this
out why the python API is this
bad or if it's just grock being really
dumb like I didn't ask for this
right P type object what is
this e
this Cod is
terrible why
terrible why
is
is
there don't
there don't
C here
C for
array increment type
it's funny because this is like
it's funny because this is like
absolutely trivial in
absolutely trivial in
purec and somehow with the python API
purec and somehow with the python API
now it's hard how's that make any sense
right e
in okay e
well this code is freaking
well this code is freaking
horrible is that
horrible is that
Teto yeah do you have a good solution
Teto yeah do you have a good solution
for this um C is like so nice and easy
for this um C is like so nice and easy
and then as soon as you try to do
and then as soon as you try to do
anything python related it's awful I
anything python related it's awful I
currently have like this massive amount
currently have like this massive amount
of scyon code where every single
of scyon code where every single
environment in puffer lib needs like a
environment in puffer lib needs like a
hundred lines of scon that just like
hundred lines of scon that just like
redo the entire header for some reason
redo the entire header for some reason
cuz scyon and then it redefines all the
cuz scyon and then it redefines all the
methods as they are in C and then you
methods as they are in C and then you
need to do the same thing again in
need to do the same thing again in
Python I've like looked at this I've
Python I've like looked at this I've
looked at pbind but I don't want to open
looked at pbind but I don't want to open
the door to C++
the door to C++
nonsense
um I think C types is proba too slow
um I think C types is proba too slow
it's such a
mess like what is
this what in the heck
I they not showing the message or it's
I they not showing the message or it's
emotes which take forever to
load
load
ah also X needs to fix their streaming
ah also X needs to fix their streaming
stuff it's kind of a mess as
well it's like X doesn't show you view
well it's like X doesn't show you view
account and lags and stuff uh twitch has
account and lags and stuff uh twitch has
a ton of bots you have to ban like three
a ton of bots you have to ban like three
or four Bots a day and then YouTube has
or four Bots a day and then YouTube has
too high latency I I don't
know the thing that's tough here is I
know the thing that's tough here is I
can't tell if this is just grock being
can't tell if this is just grock being
incredibly stupid or if this is the
incredibly stupid or if this is the
python API being stupid
can't stream on my
monitor okay this is almost reasonable I
monitor okay this is almost reasonable I
don't know why this isn't an
INT array increment okay this is a c
INT array increment okay this is a c
type and knit
incrementer this takes a pi object
array does a bunch of error
checking that's like way better at least
free any existing
oh now it's storing is a global
shoot
shoot
um I don't like that either
do people actually use this thing
do people actually use this thing
directly
is there like a pie bind but fur C
okay this is
like less insane
I can just use it and with
C is this good though
and is it fast
okay this is
okay this is
C plus plus
class yeah but then it does all this
class yeah but then it does all this
this nonsense
I swear it's like the second you move
I swear it's like the second you move
away from just like pure
C stuff just goes insane
okay this is fine all
right Pi bind array of D why the hell is
right Pi bind array of D why the hell is
this an array of
double like no
stop
for
e e
go back to the python API
what e
can't even do all the checking on in
it e
okay this is now
C e
okay so here's the
cast clean up
Returns the pointer as a python end
is this the best way to do
it it's not
terrible
e e
little
tricky to figure out how you do
this e
I'm trying to think how you would do
I'm trying to think how you would do
this n to like bind whatever
m for
the ideal signature here is that you
the ideal signature here is that you
bind me
think it's freaking Bots
I'm trying to think if what I'm what I
I'm trying to think if what I'm what I
want to do is even
possible I want to make it so you don't
possible I want to make it so you don't
have to write a per n like binding you
have to write a per n like binding you
just need to
just need to
specify essentially what the functions
are
e
e
e e
so here's the
environment so yeah this would be like
environment so yeah this would be like
what our functions would look like
okay so something like this
okay so something like this
works if you can handle the types of
works if you can handle the types of
different M's
for
e
e
e e
okay so example you have a couple these
okay so example you have a couple these
headers and
headers and
[Music]
[Music]
then yeah so this is what you would
then yeah so this is what you would
expect
this is fine
this is all just air
this is all just air
checking so you make this wrapper
thing and then they had to Hash include
thing and then they had to Hash include
both of
both of
them pound
them pound
include for
this would then build one one big
this would then build one one big
extension it's the annoying
extension it's the annoying
thing and we have to deal with name
thing and we have to deal with name
space issues
space issues
right let me think about that
this actually lets you do
this actually lets you do
um fun function poter
allocate void star this could be void
allocate void star this could be void
Star as
well is there a way to do this like how
well is there a way to do this like how
I'm thinking or is this
I'm thinking or is this
dumb because you do end up needing this
dumb because you do end up needing this
like big table right now
okay
okay
idea I have an idea here
let's say that we are willing to have a
let's say that we are willing to have a
very small piece of per n code and we
very small piece of per n code and we
don't want it all in one
file
e e
okay so something like this is totally
okay so something like this is totally
fine right you have a relatively short
fine right you have a relatively short
piece of code that says how to bind nn
and then this is like let's say that you
and then this is like let's say that you
have a specific n
have a specific n
a
right
right
H
A.C that's interesting
why do you need this Pion NBA
yeah okay so this is getting closer to
yeah okay so this is getting closer to
what I
what I
wanted this actually feels like this has
wanted this actually feels like this has
potential
for e
every extension must Define an
every extension must Define an
initialization
function oh fair
enough
e
e
e
e
e e
B okay so I don't want to
B okay so I don't want to
redefine with nb. h
ah hang on I think this might have
ah hang on I think this might have
messed it up a little
bit so this is this environment table
function pointers to be defined in
M.C
M.C
o that's really bad though
yeah that's real
yeah that's real
bad but the thing is the macro isn't
bad but the thing is the macro isn't
even better because the macro is just
even better because the macro is just
hiding
this
e e
specific
specific
files okay so this has this is just an
files okay so this has this is just an
environment
right A
right A
C this is really like enve binding. C or
C this is really like enve binding. C or
whatever so this is clean now right this
whatever so this is clean now right this
doesn't need to do
anything
e e
yeah that's going to screw some stuff up
yeah that's going to screw some stuff up
right
yeah I don't like this piece here
so this is going to be super
gross e
if they all have the same signature I
if they all have the same signature I
think I have the problem
think I have the problem
solved is there a way I can do that
not
really for
so here's our end binding
you know this is a file
you know this is a file
but we only need this
but we only need this
once and
then allocate has extra args
n
n
A.H
okay extra arcs
oh you know
what if I do
what if I do
this and I can just set the extra R CU I
this and I can just set the extra R CU I
don't need to modify this
signature
e
e e
e e
h for
doesn't need length
either e
and this no longer
needs I guess this still does
needs I guess this still does
need an init
need an init
function cuz yeah you sometimes set um
h
for e
net
e
e e
oops they get stuck
yeah we don't need all this stuff in
yeah we don't need all this stuff in
here this
wrapper
e
e
e
e
e e
this is now like working with an
this is now like working with an
exceptionally stupid Junior engineer so
exceptionally stupid Junior engineer so
it's getting
it's getting
better but for anything I have remotely
better but for anything I have remotely
any experience doing at all like I
any experience doing at all like I
haven't used the python
haven't used the python
API it doesn't do much because it writes
API it doesn't do much because it writes
such bad
code
e
e e
okay so this thing is still a
mess
e e
okay cool now we have our validation in
okay cool now we have our validation in
here
okay then we can clean this up further
okay then we can clean this up further
but at least this is
better
e
e e
I mean this is like actually not even
I mean this is like actually not even
like dealing with a stupid Junior
like dealing with a stupid Junior
engineer this is dealing like with an
engineer this is dealing like with an
exceptionally stupid Junior
exceptionally stupid Junior
engineer the only reason I'm doing this
engineer the only reason I'm doing this
is because I haven't used the freaking
is because I haven't used the freaking
python API before and I imagine that
python API before and I imagine that
compiling stuff's going to be a pain um
you are not authorized to use this
service okay
well I might be able to take it from
well I might be able to take it from
here
here
anyways oh is X down yeah X doesn't
anyways oh is X down yeah X doesn't
freaking
freaking
load that's crazy
load that's crazy
is my stream on X down as well or is it
is my stream on X down as well or is it
just the
uh doesn't look like it's
down I mean this is pretty close though
so this is n
so this is n
binding. let start on
this
for
e
e
e e
h
h
thanks
thanks
Teto uh I assume that the UI like broke
Teto uh I assume that the UI like broke
or something because I no longer see the
or something because I no longer see the
stream number
live all right
I mean this is basically there
I mean this is basically there
right the only thing is that this kind
right the only thing is that this kind
of calls a
of calls a
knit a little bit early
right yeah so this kind of calls a n a
right yeah so this kind of calls a n a
little bit early
let get rid of this
let get rid of this
first we don't need these length
grams
for
e e
hang
hang
on oh CU it's a p array object uh that's
on oh CU it's a p array object uh that's
kind of
kind of
gross okay so we'll keep it like this
gross okay so we'll keep it like this
for now I guess
that's
better
for e
do I have any no argument Ms I can use
do I have any no argument Ms I can use
to test with
well you still have to set the uh
well you still have to set the uh
size was it size row and column or
size was it size row and column or
whatever
this
this
size so maybe we'll do squared as our
size so maybe we'll do squared as our
first
one for
with this
now you have to Define
um it's a little tricky
um it's a little tricky
because the init method
because the init method
right already calls a nit
oh I guess it's cuz this observations
oh I guess it's cuz this observations
array is already set
array is already set
up it just needs size afterwards so
up it just needs size afterwards so
maybe I can do it here
let me just put
size size is 11
okay
for
e
e e
oops okay
I just want to see how uh this was bound
I just want to see how uh this was bound
initially it's probably way up
here yeah it's probably like way up here
for e
does this
does this
transfer to human brain organoids a
transfer to human brain organoids a
reinforcement learning using these
lips oh I thought my screen was screwed
lips oh I thought my screen was screwed
up that's a funny
up that's a funny
name I I don't even know how you would
name I I don't even know how you would
Define that
right you can't run code on
right you can't run code on
brains right
organic neural
organic neural
networks is that even a
thing is this like trying to make cells
thing is this like trying to make cells
that behave as neural nuts or is
this so this is trying to make physical
cells can you run code on
them Che
them Che
electrodes huh I didn't even know that
electrodes huh I didn't even know that
was a
thing well the issue is going to be that
thing well the issue is going to be that
you can't really run code on them
you can't really run code on them
right I can't like download pytorch and
right I can't like download pytorch and
or
GCC I mean if you want to see the type
GCC I mean if you want to see the type
of stuff I develop
of stuff I develop
right we do like ultra high performance
right we do like ultra high performance
test environments for reinforcement
test environments for reinforcement
learning
learning
everything from like really simple
everything from like really simple
classic stuff just way faster up to like
classic stuff just way faster up to like
you know new types of interesting tasks
you know new types of interesting tasks
this is like a miniature version of DOTA
this is like a miniature version of DOTA
we've got this like miniature
we've got this like miniature
MMO and they're all very very fast um so
MMO and they're all very very fast um so
like general purpose reinforcement
like general purpose reinforcement
learning techniques but I don't know how
learning techniques but I don't know how
you run code on cells right
theying
form the
basis the
basis the
neural that seems like you're using a
neural that seems like you're using a
language model to train cell outputs not
language model to train cell outputs not
the other way around
right I mean yeah if you have if
right I mean yeah if you have if
technically right like if you have
technically right like if you have
something that responds to stimuli you
something that responds to stimuli you
should be able to optimize it but I
should be able to optimize it but I
don't know how any of that works in
don't know how any of that works in
practice when you're dealing with like
practice when you're dealing with like
you know physical cells that can't run
you know physical cells that can't run
code
[Music]
mhm for
okay we get some
errors
for e
I'm really surprised you can actually do
I'm really surprised you can actually do
that with a username on
X I guess they allow
X I guess they allow
Unicode you can put otes in your name so
Unicode you can put otes in your name so
I guess it makes sense that's still
I guess it makes sense that's still
funny though
that's like crazy that's even in the
that's like crazy that's even in the
spec like if you're clever can't you
spec like if you're clever can't you
even like you can make your username
even like you can make your username
cover the whole chat panel as well right
cover the whole chat panel as well right
I've seen people do
I've seen people do
that that's
crazy I'm surprised they haven't
crazy I'm surprised they haven't
filtered modifiers by
now all
right the thing I'm trying to do at the
right the thing I'm trying to do at the
moment is I'm trying to get a way better
moment is I'm trying to get a way better
way of binding all of these different
way of binding all of these different
CNS to uh to puffer lip so that you
CNS to uh to puffer lip so that you
don't have to go through scon and write
don't have to go through scon and write
a whole bunch of intermediate Jank the
a whole bunch of intermediate Jank the
idea is going to be that before this you
idea is going to be that before this you
had to write like a 100 lines of code to
had to write like a 100 lines of code to
get your M to work with puffer lib and
get your M to work with puffer lib and
after this you should have to write like
five at username has blocked
you that's funny
implicit definition of
Step close
and I'm going to look into this we may
and I'm going to look into this we may
be able to use it yeah I mean I've never
be able to use it yeah I mean I've never
even like remotely thought of that
even like remotely thought of that
domain uh we do have really nice hyper
domain uh we do have really nice hyper
simple RL tools I have no idea how you
simple RL tools I have no idea how you
just how code in general interacts with
just how code in general interacts with
that
stuff I don't know like what with what
stuff I don't know like what with what
frequency can cells even respond to
stuff because we basically can give you
stuff because we basically can give you
data
data
at millions of steps per second
at millions of steps per second
like traditional silicon chips Excel
like traditional silicon chips Excel
highs speeded
highs speeded
calculations so particularly adapt to
calculations so particularly adapt to
handling complex
handling complex
tasks voice
recognition wait wait you don't have you
recognition wait wait you don't have you
don't have cells in a Petri dish
don't have cells in a Petri dish
learning voice recognition do you
is that actually a
thing activation function swap or not
thing activation function swap or not
they're just suggest they're
they're just suggest they're
not uh Jason we've been using G lately
not uh Jason we've been using G lately
in some of our Nets I don't know if it
in some of our Nets I don't know if it
makes a huge
makes a huge
difference yeah
difference yeah
yes well I mean if that actually works
yes well I mean if that actually works
and like there's a high bar for it
and like there's a high bar for it
working like but if that actually just
working like but if that actually just
works that it can just like learn that
works that it can just like learn that
then we probably shouldn't be here just
then we probably shouldn't be here just
doing pure like scaling
doing pure like scaling
Transformers with like 99% of the money
Transformers with like 99% of the money
there probably should be some more
there probably should be some more
investigation into that in fact there
investigation into that in fact there
probably should be
anyways do we actually understand like
anyways do we actually understand like
the mechanism by which these things like
the mechanism by which these things like
learn and update themselves or is it
learn and update themselves or is it
still like pretty well like pretty not
understood cuz my impression was like
understood cuz my impression was like
yeah there's some brain inspired
yeah there's some brain inspired
neuronet design stuff but we actually
neuronet design stuff but we actually
don't really know how the hell it works
don't really know how the hell it works
so like we can't really build neuron
so like we can't really build neuron
Nets that do that because we don't
Nets that do that because we don't
understand how it
works is that not the case I mean it
works is that not the case I mean it
doesn't really matter for any of the
doesn't really matter for any of the
stuff I'm doing right all like the stuff
stuff I'm doing right all like the stuff
I'm doing is mostly like just how do we
I'm doing is mostly like just how do we
learn how do we get this stuff working
learn how do we get this stuff working
on just absolutely ludicrous amounts of
on just absolutely ludicrous amounts of
data very very fast like here I posted
data very very fast like here I posted
this the other day
um
um
so this is just the dashboard from a
so this is just the dashboard from a
completed run this is 107 billion steps
completed run this is 107 billion steps
of training data in about 5050 hours on
of training data in about 5050 hours on
one GPU for context that is like more
one GPU for context that is like more
data than is used to train all of gp4
data than is used to train all of gp4
for instance um and this is like playing
for instance um and this is like playing
2,000 years worth of
2,000 years worth of
games so you know all the stuff I'm
games so you know all the stuff I'm
doing is kind of general purpose in that
doing is kind of general purpose in that
sense like we could decide that all our
sense like we could decide that all our
models and algorithms are stupid
models and algorithms are stupid
tomorrow and my stuff would still be
tomorrow and my stuff would still be
useful for whatever we replace it
useful for whatever we replace it
with they're non-deterministic systems
with they're non-deterministic systems
right I thought you may running
right I thought you may running
Quantum there's no Quantum anything here
Quantum there's no Quantum anything here
this
this
is I mean the goal of what this is right
is I mean the goal of what this is right
is like reinforcement learning is really
is like reinforcement learning is really
slow because people wrote really slow
slow because people wrote really slow
code we make it run a thousand times
code we make it run a thousand times
faster and then we do a whole bunch of
faster and then we do a whole bunch of
comprehensive research on what works and
comprehensive research on what works and
what doesn't which we can now actually
what doesn't which we can now actually
do because we can run experiments fast
do because we can run experiments fast
enough to actually get those
enough to actually get those
results that's mostly what I do with
results that's mostly what I do with
puffer and a nutshell and you know we've
puffer and a nutshell and you know we've
got all the demos on the website
see reset cep
act like Quantum
act like Quantum
systems how is that
systems how is that
possible that doesn't seem physically
possible that doesn't seem physically
possible
Right like neurons are not Quantum
Right like neurons are not Quantum
entangled particles
is intuition
is intuition
co-processing yeah but intuition
co-processing yeah but intuition
is so there's a difference between
is so there's a difference between
nondeterminism and what Quantum does
nondeterminism and what Quantum does
right non-determinism just means random
right non-determinism just means random
non-deterministic in the context of
non-deterministic in the context of
algorithms
algorithms
means that you're kind of effectively
means that you're kind of effectively
evaluating all possible choices at the
evaluating all possible choices at the
same
same
time right there's a huge difference
time right there's a huge difference
between those
things like
things like
intuition is just pattern
intuition is just pattern
recognition right
recognition right
pattern recognition is learnable that
pattern recognition is learnable that
doesn't even require
doesn't even require
non-determinism we don't know and yet
non-determinism we don't know and yet
they act like Quantum particles in some
ways I would be really hardpressed to
ways I would be really hardpressed to
believe that like you know there's some
believe that like you know there's some
fundamental theory of conscious and
fundamental theory of conscious and
actually all the neurons are quantum
actually all the neurons are quantum
entangled or something like that I hadd
entangled or something like that I hadd
be like really hard pressed to believe
be like really hard pressed to believe
that I mean that would be an awesome
that I mean that would be an awesome
some day for Humanity but I doubt it so
some day for Humanity but I doubt it so
I don't know how they behave like that I
I don't know how they behave like that I
would imagine it's just very good
would imagine it's just very good
pattern
pattern
recognition without conscious awareness
recognition without conscious awareness
I don't know what that acronym
is
and yeah that would like so so cool but
and yeah that would like so so cool but
I doubt
it I would imagine there probably it's
it I would imagine there probably it's
just like some vastly better learning
just like some vastly better learning
algorithm that what we have now that we
algorithm that what we have now that we
haven't been able to explore because
haven't been able to explore because
like gpus don't efficiently Implement
like gpus don't efficiently Implement
learning the same way that the brain
learning the same way that the brain
does it's probably something like that
does it's probably something like that
sorry steps it's like a black
sorry steps it's like a black
box conscious it's not stateless though
box conscious it's not stateless though
it's
it's
stateful you don't so like you get
stateful you don't so like you get
inputs you learn from that that that
inputs you learn from that that that
doesn't seem different
doesn't seem different
we don't know how they're making
we don't know how they're making
Association steps within the
Association steps within the
process yet they
process yet they
do it's accurate and fat well anything's
do it's accurate and fat well anything's
faster than an llm so that's like
faster than an llm so that's like
sure
sure
um don't know how they're making steps
um don't know how they're making steps
within the process why it's because it's
within the process why it's because it's
stateful right you don't know how it's
stateful right you don't know how it's
stateful but like when you give it an
stateful but like when you give it an
input it the thing doesn't remain
input it the thing doesn't remain
unchanged it learns actively
I
I
don't nobody's ever really explained to
don't nobody's ever really explained to
me how Quantum has any relevance to
me how Quantum has any relevance to
anything except like yeah there's some
anything except like yeah there's some
crazy thing where you can like I don't
crazy thing where you can like I don't
think it's actually doing like um it's
think it's actually doing like um it's
not actually being like a
not actually being like a
non-deterministic touring machine but it
non-deterministic touring machine but it
kind of acts like it does in some ways I
kind of acts like it does in some ways I
don't really know the details of Quantum
don't really know the details of Quantum
I haven't really seen anything from
there and it's also not required for
there and it's also not required for
like huge huge huge huge amounts of
like huge huge huge huge amounts of
technical advancement it's not gated
technical advancement it's not gated
behind Quantum necessarily like there
behind Quantum necessarily like there
might be a whole bunch of stuff we can
might be a whole bunch of stuff we can
solve uh that we don't know it's even
solve uh that we don't know it's even
possible right now if that actually
possible right now if that actually
works but like I don't know in my view
works but like I don't know in my view
right I have I have pretty well in my
right I have I have pretty well in my
sites um a massive increase to our
sites um a massive increase to our
capabilities in general purpose learning
capabilities in general purpose learning
just with what I'm doing
here yeah you can't measure reasoning
here yeah you can't measure reasoning
right like it's a fuzzy term that's the
problem e
frustrating pre going to tap in again
frustrating pre going to tap in again
once we have yeah sure feel free I
once we have yeah sure feel free I
stream pretty much all my Dev this is
stream pretty much all my Dev this is
kind of like just watch reinforcement
kind of like just watch reinforcement
learning progress being made live
learning progress being made live
sometimes it's cool algorithm stuff
sometimes it's cool algorithm stuff
sometimes it's lowlevel in for Dev but
sometimes it's lowlevel in for Dev but
progress is made nonetheless
that actually
that actually
builds huh
progress is made
nonetheless I mean this week has been
nonetheless I mean this week has been
ridiculously good for RL with some of
ridiculously good for RL with some of
the things we've come up
with
for e
word
oh okay it's just uh we'll fix the path
later
later
oops cannot
oops cannot
import and drawing ah I see you do need
import and drawing ah I see you do need
to link rib still which is a little
annoying
for e
okay that's not
bad seg
bad seg
fault but wait now I can actually
fault but wait now I can actually
compile with address sanitizer can't I
compile with address sanitizer can't I
cuz this is
cuz this is
this is just running C
now where is my have
sanitize
e
for
e
e
e e
ooh that's actually really solid look at
ooh that's actually really solid look at
that debugging now works through the
that debugging now works through the
en
for
e
e
e e
answering some messages on this
answering some messages on this
side we do a little bit of support while
side we do a little bit of support while
we do a little bit of
Dev well this got set correctly so why
Dev well this got set correctly so why
didn't that get set
correctly ah that'll do
it that'll do
it
for
e
e e
let me see if I can finish uh finish
let me see if I can finish uh finish
these stops here call
reset for
no attribute and reset
cool ah so I didn't do reset at
cool ah so I didn't do reset at
all that will do it
this actually should go up
top for
so this actually work this actually
so this actually work this actually
works that's
crazy so this is no
crazy so this is no
scyon C
scyon C
environment no scyon se environment that
environment no scyon se environment that
is
awesome and it's only
150 lines of like general purpose bind
150 lines of like general purpose bind
code okay I'm going to figure out from
code okay I'm going to figure out from
here how I make this work more
here how I make this work more
broadly um I'm going to take a couple
broadly um I'm going to take a couple
quick minutes though there's the
quick minutes though there's the
restroom I'm going to grab a drink and
restroom I'm going to grab a drink and
then I'm going to think about how we
then I'm going to think about how we
handle more variable args and then I
handle more variable args and then I
maybe get a perf test going I'll be
maybe get a perf test going I'll be
right
back
e
e
e
e
e e
okay we're
back this is going to be
back this is going to be
cool but I have to figure out how to
cool but I have to figure out how to
handle variable
arcs you clearly need to be able to
arcs you clearly need to be able to
Define
Define
a
a
function
right you are going to need a little bit
right you are going to need a little bit
of pbind for this I don't think there's
of pbind for this I don't think there's
any way around it or not pbind a pi
object so the issue here is this line
object so the issue here is this line
This envin net for
this doesn't change at the very
this doesn't change at the very
least right this doesn't
change so if I call this
change so if I call this
basinet and let's say that you have to
basinet and let's say that you have to
Define
net so you call base in it
net so you call base in it
like
this okay let's do this first
Undeclared here not a
Undeclared here not a
function okay
this
this
works this still works
okay that's cool
pong from void pointer
no pyong
oh this returns an
oh this returns an
INT wait pyong
INT wait pyong
from oh it's a pi object
cool
cool
so this is not terrible
and this gives you the m
seg Vault lovely
still like false
base
base
inet should give you an mstar
ah wait a nit M requires at least five
arguments
for e
that seems suspicious but we will go
that seems suspicious but we will go
with that for
now
for e
I mean this will work for
everything you can literally even do um
everything you can literally even do um
what is it default in it for
so you can even do
so you can even do
this and now you have a default
this and now you have a default
nit I think most environments are going
nit I think most environments are going
to need arcs
though you you could 100% do this with
though you you could 100% do this with
macros but it's going to be
stupid
e e
may I can see this
working you know because like in this
working you know because like in this
case you can delete this inet right
cuz Square doesn't have one
right got some time code review yeah I
right got some time code review yeah I
can do that you want to see what I've
can do that you want to see what I've
been doing it's pretty
been doing it's pretty
cool uh this
build yeah it does
build yeah it does
so this is so far what a binding would
so this is so far what a binding would
look like if uh the thing I'm doing
look like if uh the thing I'm doing
works this is what you would have to
works this is what you would have to
write for a
binding instead of all the
scon yeah this would replace scon and it
scon yeah this would replace scon and it
fixes debugging through scon you can get
fixes debugging through scon you can get
full stack traces all the way down to
full stack traces all the way down to
C and it compiles instantly
let me jump on
Discord hey yo how's it going chilling
Discord hey yo how's it going chilling
just charging my car right now
let me go ahead and drop a link yeah
let me go ahead and drop a link yeah
it's 150 lines at the moment I still
it's 150 lines at the moment I still
have to do like the loop over M and
have to do like the loop over M and
stuff code but let's say that this thing
stuff code but let's say that this thing
gets to two or 300 lines and then it
gets to two or 300 lines and then it
replaces like 2500 lines worth of stupid
replaces like 2500 lines worth of stupid
binding code right
now and if you need to do like any kind
now and if you need to do like any kind
of I guess weirdness on The Binding
of I guess weirdness on The Binding
would we just do that on on the python
would we just do that on on the python
side now no you can still do it and this
side now no you can still do it and this
is still
is still
C oh yeah it's just C so if you have any
C oh yeah it's just C so if you have any
weirdness you can do it in the python
weirdness you can do it in the python
side or the C side okay so like yeah for
side or the C side okay so like yeah for
like memory allocation stuff
yeah Okay cool so I'm gonna see how this
yeah Okay cool so I'm gonna see how this
goes but I don't know this seems like
goes but I don't know this seems like
this could be uh this could definitely
this could be uh this could definitely
be something
be something
good is it like some python
good is it like some python
Library no it's the built-in python cap
Library no it's the built-in python cap
API oh yeah
API oh yeah
well well it's the thing is it took me
well well it's the thing is it took me
forever I how to do this cuz it's like
forever I how to do this cuz it's like
the way they expect you to do stuff is
the way they expect you to do stuff is
really stupid I literally it took me
really stupid I literally it took me
like half an hour or 40 minutes whatever
like half an hour or 40 minutes whatever
with grock for it to just like give me
with grock for it to just like give me
some code that wasn't completely
some code that wasn't completely
disgusting and then I had to change St
disgusting and then I had to change St
so I don't know what it is but like
so I don't know what it is but like
nobody uses this thing because all the
nobody uses this thing because all the
code sucks
code sucks
sure I could I can see
that
anyways where are we starting all right
anyways where are we starting all right
so uh let's just probably start with
so uh let's just probably start with
just theh file and really kind of what I
just theh file and really kind of what I
wanted to do is like kind of do a review
wanted to do is like kind of do a review
with you before we go into multimap
with you before we go into multimap
stuff yes okay so and just kind of like
stuff yes okay so and just kind of like
go ahead and just like kind of walk you
go ahead and just like kind of walk you
through how I set up the the grid and
through how I set up the the grid and
collisions and stuff to be at a decent
collisions and stuff to be at a decent
speed right now we're at like 730,000 to
speed right now we're at like 730,000 to
830,000
830,000
um train speed it just depends on how
um train speed it just depends on how
many active agents there
are and the and if you do have the graph
are and the and if you do have the graph
or the the dashboard like is it all time
or the the dashboard like is it all time
spent in the environment or what yeah
spent in the environment or what yeah
it's it's say right now environment
it's it's say right now environment
speed is it kind of it ranges based on
speed is it kind of it ranges based on
how many what's it
how many what's it
called
called
um how many parallel M's are running for
um how many parallel M's are running for
some reason I think there's like some
some reason I think there's like some
overhead based on if you have like an
overhead based on if you have like an
optimal
optimal
number wait I see this train
number wait I see this train
here yeah so this is the default in Dev
here yeah so this is the default in Dev
at the moment is two workers two M's bat
at the moment is two workers two M's bat
size
size
one and then if you go to the m side of
one and then if you go to the m side of
num M so that that 128
num M so that that 128
works pretty well because on the on the
works pretty well because on the on the
map that I was training at we had eight
map that I was training at we had eight
active agents and that for some reason
active agents and that for some reason
ended up being faster than 256 even
ended up being faster than 256 even
though 256 would equal it out to
4096 faster in steps per second or
4096 faster in steps per second or
training
training
speed uh what' you say like faster steps
speed uh what' you say like faster steps
per second faster steps per second
per second faster steps per second
training
training
speed interesting sorry like faster yeah
speed interesting sorry like faster yeah
yeah ont train speed yeah
yeah ont train speed yeah
mhm interesting well we'll be able to
mhm interesting well we'll be able to
look at that no big deal
look at that no big deal
um cool so we go back to here yeah and
um cool so we go back to here yeah and
so I was actually able to get a training
so I was actually able to get a training
with your latest Dev changes um pretty
with your latest Dev changes um pretty
much only thing I had to change was the
much only thing I had to change was the
batch size the batch size
batch size the batch size
it yeah I I just changed it to be like
it yeah I I just changed it to be like
130,000 in the four to ratio yeah and
130,000 in the four to ratio yeah and
it'll do grading accumulation over that
it'll do grading accumulation over that
mini batch now and even has like the
mini batch now and even has like the
cosign and kneeling that you did mhm
cosign and kneeling that you did mhm
that's
that's
good um when I tried other Maps I know
good um when I tried other Maps I know
it didn't full solve other Maps it got
it didn't full solve other Maps it got
like 80% on one of the other maps and
like 80% on one of the other maps and
then I haven't tried the third one yet
then I haven't tried the third one yet
well it's going to get easier when we
well it's going to get easier when we
have a bunch of maps but yeah I mean I
have a bunch of maps but yeah I mean I
figured it's just like an entropy thing
figured it's just like an entropy thing
and it just happens to not it just
and it just happens to not it just
didn't run in that direction and didn't
didn't run in that direction and didn't
see it and it got too many negative
see it and it got too many negative
rewards before I could ever find it yeah
rewards before I could ever find it yeah
I mean you'll be able to run sweeps once
I mean you'll be able to run sweeps once
this thing I mean uh you'll be able to
this thing I mean uh you'll be able to
run sweeps I I'm pretty damn confident
run sweeps I I'm pretty damn confident
than the RL at this point um the new
than the RL at this point um the new
changes were very very
changes were very very
good yeah so far I'm pretty happy with
good yeah so far I'm pretty happy with
speed I mean if it could be up to a
speed I mean if it could be up to a
million that'd be great I have an idea
million that'd be great I have an idea
it'll be I'm pretty confident like
it'll be I'm pretty confident like
what's the bottleneck to get to 1
what's the bottleneck to get to 1
million what's the M percent
million what's the M percent
time M percent time it's like two to 5%
time M percent time it's like two to 5%
oh so you are actually Bal Laing on
oh so you are actually Bal Laing on
policy yeah a lot of it is on uh it's
policy yeah a lot of it is on uh it's
probably the road points
probably the road points
encoder it's just like there's just a
encoder it's just like there's just a
lot of points
lot of points
yeah okay well we'll look at that we'll
yeah okay well we'll look at that we'll
figure something out for that it's weird
figure something out for that it's weird
because it does drastically change on
because it does drastically change on
the N percentage time based on how many
the N percentage time based on how many
M you have going
on um that's normal though it should get
on um that's normal though it should get
better with more M so something screw
better with more M so something screw
there like if I have like kind of a
there like if I have like kind of a
smaller M on this one that has five
smaller M on this one that has five
active agents it says M times at like 1%
active agents it says M times at like 1%
but if I were to like shoot it up to
but if I were to like shoot it up to
more ends then it would increase for
more ends then it would increase for
some reason which I think is just the
some reason which I think is just the
overhead it's possible that the net is
overhead it's possible that the net is
just bigger like the B the optimal batch
just bigger like the B the optimal batch
size is going to depend on the um the
size is going to depend on the um the
network architecture as well sure so
network architecture as well sure so
don't worry about that we've got which I
don't worry about that we've got which I
just did like a super simple Network
just did like a super simple Network
architecture I basically just did like a
architecture I basically just did like a
well yeah linear I haven't timed like
well yeah linear I haven't timed like
ped entity encoders
ped entity encoders
before ah so maybe we'll have to fiddle
before ah so maybe we'll have to fiddle
with that that's no big deal though I
with that that's no big deal though I
can
can
help um yeah I just want to make sure
help um yeah I just want to make sure
that we actually get like know the
that we actually get like know the
sooner we get stuff where it's like hey
sooner we get stuff where it's like hey
guys you should consider this Sim
guys you should consider this Sim
because it's way faster than yours and
because it's way faster than yours and
it's actually like a quarter of the code
it's actually like a quarter of the code
or
whatever yeah I think I only really took
whatever yeah I think I only really took
Liberty in two places away from their
Liberty in two places away from their
standard
standard
implementation one or I guess three one
implementation one or I guess three one
was what we talked about but doing the
was what we talked about but doing the
grid style Collision instead of bounding
grid style Collision instead of bounding
instead of the what is it bounding
instead of the what is it bounding
volume
volume
hierarchy the other was the stepping of
hierarchy the other was the stepping of
the Dynamics I wasn't certain how their
the Dynamics I wasn't certain how their
action range was negative pi to Pi it
action range was negative pi to Pi it
just mathematically didn't make sense to
just mathematically didn't make sense to
me so I made negative one to one
me so I made negative one to one
negative pi to Pi should be it can turn
negative pi to Pi should be it can turn
180° in either
direction right if you see how if you
direction right if you see how if you
see how they the equations that they use
see how they the equations that they use
to to step through the Dynamics it
to to step through the Dynamics it
doesn't make sense how pi to Pi because
doesn't make sense how pi to Pi because
of the Tage or whatever yeah okay yeah
of the Tage or whatever yeah okay yeah
fine that could we can ask him and if
fine that could we can ask him and if
not like ask him in the slack and if not
not like ask him in the slack and if not
it's probably a
it's probably a
bug
bug
yeah but cuz yeah the second I switch
yeah but cuz yeah the second I switch
it's negative 1 to one like the the
it's negative 1 to one like the the
actions actually made sense like half
actions actually made sense like half
the actions went One Direction the other
the actions went One Direction the other
half went the other direction at
half went the other direction at
increasing degrees
increasing degrees
of the
of the
turn okay we
turn okay we
might we'll see how this goes we might
might we'll see how this goes we might
want breaking it apart into another this
want breaking it apart into another this
is I'm seeing right here this is like
is I'm seeing right here this is like
um what would you even call
um what would you even call
this it's not a
this it's not a
point a vector or something I don't know
point a vector or something I don't know
we we like whatever the standard name is
we we like whatever the standard name is
for position velocity information like
for position velocity information like
this
this
um well I guess you have gold position
um well I guess you have gold position
but not
but not
velocity something there are a lot of
velocity something there are a lot of
these yeah I mean there's going to be a
these yeah I mean there's going to be a
lot of those because there's
lot of those because there's
trajectories and then there's current
trajectories and then there's current
and then there's goal effectively well
and then there's goal effectively well
might have to compress some struck
might have to compress some struck
because it's presumably you're going to
because it's presumably you're going to
be getting information from like the
be getting information from like the
same point you need the X Y and Z at the
same point you need the X Y and Z at the
same time
same time
right you really only need the
right you really only need the
trajectory information to get the first
trajectory information to get the first
point okay then X Y and Z like you're
point okay then X Y and Z like you're
GNA need and then like yeah you you
GNA need and then like yeah you you
don't like go get the x of every point
don't like go get the x of every point
right like you go it like for a point
right like you go it like for a point
you get the X Y and Z though
you get the X Y and Z though
right when you access it I'm like for a
right when you access it I'm like for a
point yeah yeah what I'm doing is I'm
point yeah yeah what I'm doing is I'm
setting you set the XYZ based off of the
setting you set the XYZ based off of the
first point of the TR trajectory XYZ to
first point of the TR trajectory XYZ to
set up the spawn
set up the spawn
yeah but when you're doing stuff in
yeah but when you're doing stuff in
general right when you're doing stuff in
general right when you're doing stuff in
general like you're going to go access
general like you're going to go access
the X the Y and the Z you're not going
the X the Y and the Z you're not going
to go access all the x's and all the Y's
to go access all the x's and all the Y's
and all the Z's right no no no you only
and all the Z's right no no no you only
access like the current so in that case
access like the current so in that case
then even putting into a struct should
then even putting into a struct should
actually improve uh memory continuity as
well
well
right well would it change anything
right well would it change anything
because if you have the X through the VZ
because if you have the X through the VZ
doesn't it all sit in the same space
doesn't it all sit in the same space
like in contiguous
like in contiguous
memory based on how it's aligned in the
memory based on how it's aligned in the
struct uh okay for this one yes but what
struct uh okay for this one yes but what
about
about
here I guess these ones these ones
here I guess these ones these ones
don't no because they're in their
don't no because they're in their
pointers yes you understand this right
pointers yes you understand this right
and also how's there a single x y and
and also how's there a single x y and
z Oh cuz this is one car it's one entity
z Oh cuz this is one car it's one entity
okay this is one car okay that's not as
okay this is one car okay that's not as
bad then that's yeah one entity type or
bad then that's yeah one entity type or
one entity with you know however many
one entity with you know however many
types for the entirety of the the thing
types for the entirety of the the thing
so I mean we just depending on the usage
so I mean we just depending on the usage
patterns we'll figure out what struct
patterns we'll figure out what struct
what needs to be a struct and what
what needs to be a struct and what
doesn't sure sure
sure I think definitely like this is an
sure I think definitely like this is an
end where if we keep it nice and clean
end where if we keep it nice and clean
for them it'll make it a lot easier
for them it'll make it a lot easier
because you know they don't they don't
because you know they don't they don't
know like they don't have people who are
know like they don't have people who are
is familiar with lower level Dev
is familiar with lower level Dev
fair enough I I will say the grid
fair enough I I will say the grid
Collision stuff is a little bit of a a
Collision stuff is a little bit of a a
mind but it does work and it is
mind but it does work and it is
simple if you can understand like all of
simple if you can understand like all of
the arrays that are in place map so this
the arrays that are in place map so this
is the map
is the map
binary yeah so in the if you want to
binary yeah so in the if you want to
start on the python file you you could
start on the python file you you could
look at that before going to map binary
look at that before going to map binary
because before did this change no it
because before did this change no it
hasn't changed since we looked at it
hasn't changed since we looked at it
okay so yeah this is like your just
okay so yeah this is like your just
you're dumping a whole bunch of data
you're dumping a whole bunch of data
into a binary file and then you're
into a binary file and then you're
reading yep you're very carefully
reading yep you're very carefully
reading it knowing that this yeah if you
reading it knowing that this yeah if you
mess with anything in here it it will
mess with anything in here it it will
nuke the file for sure like yes we
nuke the file for sure like yes we
should
should
probably figure something out for that
probably figure something out for that
um yeah we'll have to look at this
um yeah we'll have to look at this
because this is
because this is
like yeah it's delicate yeah I and I see
like yeah it's delicate yeah I and I see
why you have it because it's like yeah
why you have it because it's like yeah
this is how you would do it but
this is how you would do it but
I mean iast yeah this is kind of similar
I mean iast yeah this is kind of similar
to like um my my loading code for
to like um my my loading code for
pytorch
pytorch
models right because I do the same thing
models right because I do the same thing
where I have to load layer by layer and
where I have to load layer by layer and
if you scroll anything you're just
if you scroll anything you're just
you're boned and there's nothing you can
you're boned and there's nothing you can
do about it and you won't get an error
do about it and you won't get an error
yeah it's actually extremely annoying if
yeah it's actually extremely annoying if
something's wrong because you just kind
something's wrong because you just kind
of have to go like line by line and and
of have to go like line by line and and
pray that the one thing you put in is
pray that the one thing you put in is
the right order well we have tests for
the right order well we have tests for
this right so what I do is I like I
this right so what I do is I like I
write a test that you'd write a
write a test that you'd write a
test you'd actually you should look at
test you'd actually you should look at
how I do my uh my pie torch test because
how I do my uh my pie torch test because
you could do something similar here
you could do something similar here
right so you like you essentially you
right so you like you essentially you
write a test that you dump the file from
write a test that you dump the file from
python you load it in C and then you
python you load it in C and then you
make sure that the elements you know
make sure that the elements you know
element by element in C it's the same as
element by element in C it's the same as
in Python once you've loaded it back in
in Python once you've loaded it back in
and then you're
and then you're
good so this is like one of the I I
good so this is like one of the I I
think you see I don't write a lot of
think you see I don't write a lot of
tests this is like the only type of
tests this is like the only type of
thing I will write a test for cuz
thing I will write a test for cuz
otherwise you're just
otherwise you're just
screwed yeah
okay you do not need to save the the on
okay you do not need to save the the on
line or whatever for the continues
let's
see so set active agents you like those
see so set active agents you like those
inside of actual uh brackets yeah
inside of actual uh brackets yeah
because it's like they're easy to just
because it's like they're easy to just
miss
miss
them I know I've gone back and forth on
them I know I've gone back and forth on
it but I like I think now it's just I
it but I like I think now it's just I
use brackets everywhere now that's fine
use brackets everywhere now that's fine
that's nothing Chang
that's nothing Chang
yeah so this just so that next thing
yeah so this just so that next thing
just checks to make sure that in the
just checks to make sure that in the
trajectory that we're only taking uh
trajectory that we're only taking uh
entities that are cons that are spawned
entities that are cons that are spawned
from the start so they don't you don't
from the start so they don't you don't
take an entity that spawns like in the
take an entity that spawns like in the
middle of the
middle of the
trajectory it's a it's it's a thing I
trajectory it's a it's it's a thing I
went over with them and slack because
went over with them and slack because
there's cases where like entities can
there's cases where like entities can
just like appear out of nowhere yeah and
just like appear out of nowhere yeah and
as well I don't write a lot of comments
as well I don't write a lot of comments
this is the type of thing I'd write a
this is the type of thing I'd write a
comment right okay when it's like a like
comment right okay when it's like a like
you can't understand what the hell this
you can't understand what the hell this
is for like because this is dependent on
is for like because this is dependent on
the
the
data yeah okay relative
2D uhhuh and
then and then they scale the size just
then and then they scale the size just
down by a little bit okay
so why do we have malx in here does this
so why do we have malx in here does this
get called doesn't this get called a
get called doesn't this get called a
bunch it gets called one time at an N at
bunch it gets called one time at an N at
a net
a net
oh give agent count
oh give agent count
times cuz you just did okay
times cuz you just did okay
whatever I would have done it outside
whatever I would have done it outside
but it's not a big deal
this is now where you get into Collision
this is now where you get into Collision
land no this makes sense this is the
land no this makes sense this is the
coordinates on the grid of a
point
yeah count * 2 +
1 so I'm with in each grid cell mhm I'm
1 so I'm with in each grid cell mhm I'm
saving the count of how many entities
saving the count of how many entities
are actually in there okay and then
are actually in there okay and then
giving it the entity and the geometry
giving it the entity and the geometry
index the geometry index is relative to
index the geometry index is relative to
the road and how it's set up because the
the road and how it's set up because the
road objects have a in Geometry array
road objects have a in Geometry array
that is just a bunch of XYZ points so
that is just a bunch of XYZ points so
you don't want to have to iterate
you don't want to have to iterate
through all of the geometry inside of
through all of the geometry inside of
the road object if it's inside th grid
the road object if it's inside th grid
cell you want to save the actual exact
cell you want to save the actual exact
line
line
segment of where it I guess of the
segment of where it I guess of the
position of that road segment so when
position of that road segment so when
you check grid cell 45 you know that it
you check grid cell 45 you know that it
is Road segment 5 and geometry 409,000
is Road segment 5 and geometry 409,000
or
or
something so it's it's an optimization
something so it's it's an optimization
to not have to loop again by just adding
to not have to loop again by just adding
one more object to the grid cells
one more object to the grid cells
parameter
okay and then the count is there just to
okay and then the count is there just to
make sure I get perfect memory
make sure I get perfect memory
allocation in the next
step in the next
step in the next
step when you initialize the grid
step when you initialize the grid
map or the next next function
map or the next next function
whatever okay so I let me see if I can
whatever okay so I let me see if I can
get this so This is called when at the
get this so This is called when at the
start a nid grid map is called at the
start a nid grid map is called at the
start correct
top left and bottom right points to the
top left and bottom right points to the
map this somehow has top left and bottom
map this somehow has top left and bottom
right points of the map in it wait why
right points of the map in it wait why
is this you you find it so you reading
is this you you find it so you reading
through yeah so that's just like setting
through yeah so that's just like setting
up whatever the a current point is
up whatever the a current point is
that's relative to itself and then I
that's relative to itself and then I
Loop throughout the whole thing to find
Loop throughout the whole thing to find
the dimensions of the universe yep
the dimensions of the universe yep
that's fine
can this change when more stuff
spawns can what can this change when
spawns can what can this change when
more stuff spawns
more stuff spawns
in ah so so the way that is set
in ah so so the way that is set
up nothing should be spawning in which
up nothing should be spawning in which
is why in the beginning you set it up
is why in the beginning you set it up
such that only entities that exist from
such that only entities that exist from
the beginning are going to be in uh we
the beginning are going to be in uh we
will reevaluate for Tokyo puff
will reevaluate for Tokyo puff
mode yes we can re you can reevaluate
mode yes we can re you can reevaluate
for Tokyo
for Tokyo
puff is there a map of all of Tokyo is
puff is there a map of all of Tokyo is
that a thing yes it is so that's why I
that a thing yes it is so that's why I
brought it up that's actually a thing
brought it up that's actually a thing
yeah yeah Japan the Country released it
yeah yeah Japan the Country released it
via the department of like
via the department of like
Transportation or whatever the
Transportation or whatever the
could you imagine if we did that though
could you imagine if we did that though
dud it' be sick Tokyo puff can you yeah
dud it' be sick Tokyo puff can you yeah
I know it would be freaking
I know it would be freaking
awesome it's basically building GTA 6
awesome it's basically building GTA 6
before GTA 6 exists or whatever well
before GTA 6 exists or whatever well
everything is before GTA 6 exist
that's but it's not far off I mean
that's but it's not far off I mean
realistically if you just dropped like a
realistically if you just dropped like a
million cars inside
million cars inside
it that's G to be so freaking cool
it that's G to be so freaking cool
man okay yeah dude just let let project
man okay yeah dude just let let project
Tokyo puff evolve all right it's like
Tokyo puff evolve all right it's like
it's it's in
it's it's in
range now if we do this grid style
range now if we do this grid style
initialization of my caching let's not
initialization of my caching let's not
don't tell n don't tell NYU until we
don't tell n don't tell NYU until we
actually have something cuz they're
actually have something cuz they're
going to be like what the
going to be like what the
hell that' be
hell that' be
awesome yeah I mean that's a
awesome yeah I mean that's a
yeah Tokyo we can we can knock that up
yeah Tokyo we can we can knock that up
in part part
in part part
four
four
yeah well no I mean don't tell them
yeah well no I mean don't tell them
because they're going to just be like
because they're going to just be like
what like you know they would have to
what like you know they would have to
build a whole another end with the way
build a whole another end with the way
they have it in Madrona I'm sure um oh
they have it in Madrona I'm sure um oh
yeah I mean yeah map the grid cell thing
yeah I mean yeah map the grid cell thing
may or may not be totally screwed by the
may or may not be totally screwed by the
way like I think you just use like
way like I think you just use like
larger grid cells and you're probably
larger grid cells and you're probably
fine well that's that's good to know
fine well that's that's good to know
because I mean the grid cell I think is
because I mean the grid cell I think is
reasonably fast
reasonably fast
enough yeah I wouldn't I wouldn't be
enough yeah I wouldn't I wouldn't be
surprised if you can just use larger
surprised if you can just use larger
grid cells like we might also just have
grid cells like we might also just have
to have a list of like active cells or
to have a list of like active cells or
something so what we might do is if a
something so what we might do is if a
grid cell has nothing in it you don't
grid cell has nothing in it you don't
have to process it right sure yeah you
have to process it right sure yeah you
can do that so we can probably I think I
can do that so we can probably I think I
talked about this architecture with you
talked about this architecture with you
before
before
anyways yeah I don't think adding the
anyways yeah I don't think adding the
more maps that was going to make it
more maps that was going to make it
substantially harder to refactor because
substantially harder to refactor because
in my mind the more maps thing should
in my mind the more maps thing should
not be very much Cod at all I think it's
not be very much Cod at all I think it's
just a matter of doing the map to binary
just a matter of doing the map to binary
file yep one time for all maps ahead of
file yep one time for all maps ahead of
time yep and you literally have example
time yep and you literally have example
like you have example of this in the
like you have example of this in the
puffer grid
puffer grid
right I think I did it for Tower climb
right I think I did it for Tower climb
too yeah um I tried to make sure there's
too yeah um I tried to make sure there's
example code of
example code of
everything yeah CU I did multimap for
everything yeah CU I did multimap for
Tower climb and it was
Tower climb and it was
fine I just wasn't certain about exactly
fine I just wasn't certain about exactly
how I do it for this one for multi map
how I do it for this one for multi map
because I'm like writing to a file and I
because I'm like writing to a file and I
don't know if we wanted to write like
don't know if we wanted to write like
10,000 binary
files why does it have to write to a
files why does it have to write to a
file
file
I
I
mean because it it's reading from the
mean because it it's reading from the
file I mean I guess you could argue it
file I mean I guess you could argue it
you could just send it directly into an
you could just send it directly into an
array or something but you could I think
array or something but you could I think
we don't need
we don't need
um well you can do it like this for now
um well you can do it like this for now
let's say we we we'll see that that
let's say we we we'll see that that
that's one of the reasons why I want
that's one of the reasons why I want
that's also pretty easy to swap because
that's also pretty easy to swap because
it's like the save and load logic is
it's like the save and load logic is
going to be the same it's just going to
going to be the same it's just going to
be fad versus
be fad versus
index M so that's not a big
deal okay so this was my clever
deal okay so this was my clever
way yeah so this is now my yeah this is
way yeah so this is now my yeah this is
my clever way of getting the nearest
points by say so I'm cash I'm going to
points by say so I'm cash I'm going to
cach in each grid
cach in each grid
cell the vision
cell the vision
of if you're at that cell of your of all
of if you're at that cell of your of all
the nearest
entities because all of the road objects
entities because all of the road objects
are static and they never change out the
are static and they never change out the
whole point you can do it one time and
whole point you can do it one time and
store your vision for every cell ahead
store your vision for every cell ahead
of
time store your vision for every
time store your vision for every
cell yeah so at every location on the
cell yeah so at every location on the
grid
grid
M you can store what road objects you
M you can store what road objects you
see and save them in the order of the
see and save them in the order of the
closest ones by adding them into it in
closest ones by adding them into it in
the order of the spir of a spiral
the order of the spir of a spiral
pattern around yourself if you index oh
pattern around yourself if you index oh
I've done that before okay yeah I've
I've done that before okay yeah I've
done that
done that
before so this is just creating the
before so this is just creating the
spiral offset but this spiral offset's
spiral offset but this spiral offset's
only one grid cell
only one grid cell
right or do you
right or do you
multiply oh okay Max wait
Max offsets is the vision range
squared is this an example this is it
is I I have some code at the bottom did
is I I have some code at the bottom did
I or did I take it out I think I took it
I or did I take it out I think I took it
out I had a print file thing at the end
out I had a print file thing at the end
there I think I took it out one percent
there I think I took it out one percent
four okay steps to take steps take plus
four okay steps to take steps take plus
yeah
okay spiral C code is actually like
okay spiral C code is actually like
slightly more annoying than you would
slightly more annoying than you would
think it is to get right oh it's
think it is to get right oh it's
extremely annoying yeah I've done this
extremely annoying yeah I've done this
several times and it's just like this
several times and it's just like this
it's like this like you know CS
it's like this like you know CS
101 like thing yeah but it's just like
101 like thing yeah but it's just like
it's actually really annoying to get it
it's actually really annoying to get it
right cuz like you're like thinking in
right cuz like you're like thinking in
your head like is it that much like yes
your head like is it that much like yes
intuitively when you read it it actually
intuitively when you read it it actually
does make sense how it's a spiral yeah
does make sense how it's a spiral yeah
it's I I've written that function
it's I I've written that function
several times it's extremely
several times it's extremely
annoying
H all right yeah here's all the caching
H all right yeah here's all the caching
of the Spiral at each
of the Spiral at each
cell and so I save the XY position yeah
cell and so I save the XY position yeah
I'm caching the
spiral but then the entities all move
spiral but then the entities all move
the next step don't
the next step don't
they none of the road objects none of
they none of the road objects none of
the road segments do okay so your
the road segments do okay so your
cash and then you
cash and then you
move so then when you move cells you
move so then when you move cells you
have to but you don't have to rec
have to but you don't have to rec
recompute Road positions until you move
recompute Road positions until you move
cells okay and you don't even actually
cells okay and you don't even actually
have to recalculate Road position oh are
have to recalculate Road position oh are
yes you do sorry at when you're
yes you do sorry at when you're
Computing observations you you can
Computing observations you you can
compute Road you have to compute the
compute Road you have to compute the
road observation every step as always
road observation every step as always
but you don't have to compute which road
but you don't have to compute which road
segments are near
you
you
co yeah if you sort these one thing you
co yeah if you sort these one thing you
could try for a perf hack is just like
could try for a perf hack is just like
reduce it to 32 the nearest 32 points or
reduce it to 32 the nearest 32 points or
whatever oh yeah I've already changed
whatever oh yeah I've already changed
the vision range if you go from uh M 21
the vision range if you go from uh M 21
by 21 which is their range cuz each cell
by 21 which is their range cuz each cell
is uh five so 5 m is one grid Square so
is uh five so 5 m is one grid Square so
21 by 21 creates a 20 creates 10 on
21 by 21 creates a 20 creates 10 on
either side of your Center Point
either side of your Center Point
M which is equivalent to a 50 m radius 5
M which is equivalent to a 50 m radius 5
time 10 if you drop it to 11 by 11 it
time 10 if you drop it to 11 by 11 it
already it adds 100,000 steps per second
already it adds 100,000 steps per second
to it yeah okay
cool at some point I'm going to have to
cool at some point I'm going to have to
actually like help help you like really
actually like help help you like really
get into this and see what we can
get into this and see what we can
optimize
optimize
um but so far I think we're in a good
um but so far I think we're in a good
spot because I don't think that the map
spot because I don't think that the map
logic is going to dramatically
logic is going to dramatically
complicate this this is about as
complicate this this is about as
optimized as I wanted it for
optimized as I wanted it for
now if I wanted to optimize it even
now if I wanted to optimize it even
farther You could argue I could place
farther You could argue I could place
the parked cars inside of the cach as
the parked cars inside of the cach as
well it just makes indexing a little
well it just makes indexing a little
annoying you could also just use four
annoying you could also just use four
course
course
mate instead of
mate instead of
two also just use some more
two also just use some more
course oh okay yeah I think your Net's
course oh okay yeah I think your Net's
the slow piece
anyways yeah and the actual M logic
anyways yeah and the actual M logic
speed is up to like 1.2 million steps
speed is up to like 1.2 million steps
per second then you're
fine I mean if you get over 1.2 mil
fine I mean if you get over 1.2 mil
right like yeah you're going to have to
right like yeah you're going to have to
use four cores or whatever but still
use four cores or whatever but still
fine you're not going to have it on one
fine you're not going to have it on one
core I've realized anyways you're not
core I've realized anyways you're not
going to get away from multiprocessing
going to get away from multiprocessing
cuz you need the asnc factor so you're
cuz you need the asnc factor so you're
going to have two cors Le
anyways also the bigger networks as the
anyways also the bigger networks as the
networks get bigger it's fine to have
networks get bigger it's fine to have
smaller batches um where's the result
smaller batches um where's the result
that I had I just I have a 3 million
that I had I just I have a 3 million
peram Network training right now which
peram Network training right now which
is that's a big boy yeah it's big for
is that's a big boy yeah it's big for
puffer but it's still fast you still get
puffer but it's still fast you still get
4 500k train speed with
4 500k train speed with
that oh wow really yeah it doesn't
that oh wow really yeah it doesn't
actually hurt you that
actually hurt you that
much
huh and it's actually it's going to get
huh and it's actually it's going to get
better when we have the
509s have you gotten yours yet I haven't
509s have you gotten yours yet I haven't
gotten any update from main gear yet as
gotten any update from main gear yet as
to where my uh Sunday it's going to be
to where my uh Sunday it's going to be
delivered this Sunday oh
delivered this Sunday oh
nice I know you ordered yours like few
nice I know you ordered yours like few
months ahead of mine I don't it's going
months ahead of mine I don't it's going
to be a while and then I have to figure
to be a while and then I have to figure
out if I order all of them or not
out if I order all of them or not
immediately
immediately
thereafter cuz the facility is going to
thereafter cuz the facility is going to
be done but
um so these two new ones are the three
mil those are nice graphs yeah they're
mil those are nice graphs yeah they're
really clean curves right with the new
really clean curves right with the new
stuff mhm so this is
stuff mhm so this is
muan this is a 100 billion steps 107
muan this is a 100 billion steps 107
billion are you still doing coign and
billion are you still doing coign and
kneeling on this are you just doing flat
kneeling on this are you just doing flat
yeah it is coine and Ne I don't know if
yeah it is coine and Ne I don't know if
it needs to
be what made you jump on the annealing
be what made you jump on the annealing
train because before you were like hard
train because before you were like hard
against it we've had linear uh it was
against it we've had linear uh it was
the breakout result requiring linear
the breakout result requiring linear
analing to do anything
and then is it okay well if we're going
and then is it okay well if we're going
to do a
to do a
kneeling may as well do a better job
kneeling may as well do a better job
yeah cosign anding is like the default
yeah cosign anding is like the default
across everything in modern AI these
across everything in modern AI these
days so and then this is a new one it's
days so and then this is a new one it's
actually very tricky to optimize really
actually very tricky to optimize really
hard Ms like this because look this is
hard Ms like this because look this is
six billion steps and it looks like
six billion steps and it looks like
they're Crossing it looked way better
they're Crossing it looked way better
before this
before this
right so it's kind of sketch
right so it's kind of sketch
yeah I can see
yeah I can see
that I have some cool graphs though yeah
that I have some cool graphs though yeah
okay so the wrong code where's your code
okay so the wrong code where's your code
there we
go okay so this is your caching code
go okay so this is your caching code
correct so I basically I do I read it
correct so I basically I do I read it
one time and then I store it the next
one time and then I store it the next
time in this Loop so I can have the
time in this Loop so I can have the
optimal memory
allocation okay let me see what this is
allocation okay let me see what this is
cach neighbor
offsets so this is
offsets so this is
you getting the cell count correct which
you getting the cell count correct which
is
when does this get
when does this get
called the next cell mean the next line
called the next cell mean the next line
no but when does
no but when does
this cash one time in an it right after
this cash one time in an it right after
an
an
it oh I see so for every cell you go and
it oh I see so for every cell you go and
you do the spiral around it yep okay
you do the spiral around it yep okay
yeah now that's
yeah now that's
reasonable get neighbor so I'm happy
reasonable get neighbor so I'm happy
with this you added like an extra 60 70
with this you added like an extra 60 70
lines an initial perf optimization you
lines an initial perf optimization you
know we'll see whether we come up with a
know we'll see whether we come up with a
better one after but this one will more
better one after but this one will more
be more than enough to get us like on
be more than enough to get us like on
par with the current GPU Drive project
par with the current GPU Drive project
and not allar actually way faster than
and not allar actually way faster than
the current GPU Drive project I think
the current GPU Drive project I think
that's the state of
that's the state of
this right I'll have to think about
this right I'll have to think about
whether this whether this scales to
whether this whether this scales to
Tokyo
Tokyo
puff uh we'll have to think about that
puff uh we'll have to think about that
but this will this will do GPU drive
but this will this will do GPU drive
just
fine okay you have
fine okay you have
yourit you pass
this do your
this do your
inits free
inits free
[Music]
[Music]
initialized
okay this is the move logic with the tan
okay this is the move logic with the tan
Shenanigans yeah let me let me link you
Shenanigans yeah let me let me link you
the the thing so
the the thing so
I mean you can see what I did yeah I'm
I mean you can see what I did yeah I'm
not going they I'm not going to worry
not going they I'm not going to worry
about the Dynamics model until they
about the Dynamics model until they
complain about
complain about
it
okay that is
okay that is
fine intersection code where does it
fine intersection code where does it
spend all the time at the moment is it
spend all the time at the moment is it
in the Collision
in the Collision
checks mostly Collision check yeah
checks mostly Collision check yeah
because it's
because it's
uh I haven't done a recent profile but
uh I haven't done a recent profile but
it's because it's going through every
it's because it's going through every
single vehicle entity every single
single vehicle entity every single
step
step
yep check neighbors is basically a mini
yep check neighbors is basically a mini
version of the Spiral but only for a 3X3
version of the Spiral but only for a 3X3
around yourself
mhm it's only called for
Collision but it does it every single
Collision but it does it every single
car so we're going to get a little
car so we're going to get a little
concerned with like being overly reliant
concerned with like being overly reliant
on the spiral pattern at some point um
on the spiral pattern at some point um
I'm trying to think if that's going
I'm trying to think if that's going
to honestly that might just scale to
to honestly that might just scale to
everything for all I
know the only thing that I think is like
know the only thing that I think is like
possible there is
um I guess we'll have to see how much
um I guess we'll have to see how much
data is in like the big ass Tokyo map or
data is in like the big ass Tokyo map or
whatever eventually
whatever eventually
yeah all it comes down to is how many
yeah all it comes down to is how many
entities are going to be in a
Cell yeah and that can techically be
Cell yeah and that can techically be
dynamic it can technically that could be
dynamic it can technically that could be
dynamic it's just like memory IND
Direction and then you got some annoying
Direction and then you got some annoying
geometry from 9th grade um in here yeah
geometry from 9th grade um in here yeah
it's it's really annoying how like the
it's it's really annoying how like the
ninth grade geometry is actually
hard when you have you think I remember
hard when you have you think I remember
this stuff I had to freaking I had to
this stuff I had to freaking I had to
chat gbt my way to Victory on this stuff
chat gbt my way to Victory on this stuff
and then you got to make sure that it
and then you got to make sure that it
doesn't get it
doesn't get it
wrong yeah I mean luckily that's why
wrong yeah I mean luckily that's why
visualization helps a lot like
visualization helps a lot like
like all I did was just draw a line from
like all I did was just draw a line from
where it was supposed to go and then if
where it was supposed to go and then if
it's in the middle of nowhere clearly my
it's in the middle of nowhere clearly my
math is wrong somewhere
yeah Collision boxes as a debug tool are
yeah Collision boxes as a debug tool are
really
good hello hey Aaron we're on stream by
good hello hey Aaron we're on stream by
the way yeah yeah no worries um I just
the way yeah yeah no worries um I just
want to let you know I've got that sweep
want to let you know I've got that sweep
running mhm um I hit a couple of the
running mhm um I hit a couple of the
weird pain points on the sweep we can
weird pain points on the sweep we can
chat about it tomorrow as as when we ALS
chat about it tomorrow as as when we ALS
look at all these results sounds good
look at all these results sounds good
we have uh I have now run 300 billion
we have uh I have now run 300 billion
steps worth of neural MMO three
experiments
experiments
wow
um we should figure out a way to speed
um we should figure out a way to speed
up my eval because getting the right
up my eval because getting the right
eval at the end is taking
eval at the end is taking
forever oh yeah that's easy I can fix
forever oh yeah that's easy I can fix
that's
easy yeah it's probably point it's just
easy yeah it's probably point it's just
bundling too many points together just
bundling too many points together just
increase the uh the eval interval you'll
increase the uh the eval interval you'll
be
be
good no no no uh I'm doing a custom eval
good no no no uh I'm doing a custom eval
cuz I need to I want to eval over all of
cuz I need to I want to eval over all of
the tasks
oh okay yeah I can figure something out
oh okay yeah I can figure something out
with that yeah I figure I figure we'll
with that yeah I figure I figure we'll
chat about all this stuff tomorrow once
chat about all this stuff tomorrow once
we also have some graphs okay sounds
we also have some graphs okay sounds
good thanks for the update
good thanks for the update
yep see you later later
Aon it's kind of nice when you just like
Aon it's kind of nice when you just like
hang around on Discord and stream all
hang around on Discord and stream all
day it's like yeah just updates come in
day it's like yeah just updates come in
whenever it's like how do we schedule a
whenever it's like how do we schedule a
thing oh we just always
thing oh we just always
here um yeah it it's it's pretty good
here um yeah it it's it's pretty good
system
where are you now you on are you on
where are you now you on are you on
vehicle collisions I'm looking at this
vehicle collisions I'm looking at this
whatever this
whatever this
is okay so there's four lines to a
is okay so there's four lines to a
rectangle right so it's checking to see
rectangle right so it's checking to see
if each line segment is coll colliding
if each line segment is coll colliding
with another four lines of the other
car let's
see
see
okay that was probably fun to
okay that was probably fun to
write oh yeah really fun
now but I expected you had to have to do
now but I expected you had to have to do
some stuff like this like I mean it's
some stuff like this like I mean it's
it's a midsize
project I'll say medium
project I'll say medium
large well it'll be large by the time
large well it'll be large by the time
you have Tokyo puff in there
you have Tokyo puff in there
Tokyo papa is like a grand scale project
Tokyo papa is like a grand scale project
are you sure it's not going to just end
are you sure it's not going to just end
up being like 2K Total
Lines okay fine maybe the lines won't be
Lines okay fine maybe the lines won't be
that much but in terms of how it sounds
that much but in terms of how it sounds
and what it does
and what it does
yeah it's pretty funny when I tell
yeah it's pretty funny when I tell
people with neural MMO that there's like
people with neural MMO that there's like
a Dynamic economy in
there they're like oh this looks like a
there they're like oh this looks like a
pretty cool end yeah it's like this it's
pretty cool end yeah it's like this it's
like oh and there's a dynamic con where
like oh and there's a dynamic con where
you can buy and trade stuff with the
you can buy and trade stuff with the
other agents they're like
what yeah and even then your line of
what yeah and even then your line of
cone is I think still maybe even less
cone is I think still maybe even less
than this no it's not it's like 2,800
than this no it's not it's like 2,800
for
for
nuro oh okay never mind now nuro is
nuro oh okay never mind now nuro is
big I think Nur currently has the seat
big I think Nur currently has the seat
for the hardest like the hardest fast
for the hardest like the hardest fast
and you can use I guess except for go go
and you can use I guess except for go go
is like you need you kind of need search
is like you need you kind of need search
design for it
design for it
yeah I I think you have to have search
yeah I I think you have to have search
to solve
that well okay yeah maybe you're right
that well okay yeah maybe you're right
maybe toky puff will only be like double
maybe toky puff will only be like double
the size of the current M I don't think
the size of the current M I don't think
it needs to be that much larger the only
it needs to be that much larger the only
thing I could think of is if the
thing I could think of is if the
freaking data files massive which I'm
freaking data files massive which I'm
sure it
is yeah memory will be
is yeah memory will be
a but it's possible that we just like
a but it's possible that we just like
have to pre-compute a bunch of stuff on
have to pre-compute a bunch of stuff on
that file anyways right so it might just
that file anyways right so it might just
be that we have a pre-processing
be that we have a pre-processing
script oh there's for sure going to have
script oh there's for sure going to have
to be a pre-processing CU it's and the
to be a pre-processing CU it's and the
pre-processing unfortunately may take
pre-processing unfortunately may take
like
like
forever well we'll just do it and we'll
forever well we'll just do it and we'll
upload it
upload it
somewhere
yeah you know the puffer color scheme is
yeah you know the puffer color scheme is
going to suit that really well right
going to suit that really well right
like this freaking sci-fi Tokyo whatever
like this freaking sci-fi Tokyo whatever
yeah it's going to be sick it's going to
yeah it's going to be sick it's going to
be yeah it's going to be good
yeah pick which I should tell Captain I
yeah pick which I should tell Captain I
fix this box
yeah so I took all of the max values
yeah so I took all of the max values
from the GPU Drive um constants so those
from the GPU Drive um constants so those
are just copy pasted in terms of
normalization yeah so these checks were
normalization yeah so these checks were
total pain in the ass one can tell um oh
total pain in the ass one can tell um oh
wait no this is OBS never mind we're out
wait no this is OBS never mind we're out
of Collis cool yeah we're in computer
of Collis cool yeah we're in computer
observations
observations
now um the the one one of the
now um the the one one of the
differences that I took here as opposed
differences that I took here as opposed
to them at the moment is I did not
to them at the moment is I did not
include the other types of road or what
include the other types of road or what
are they called like map objects inside
are they called like map objects inside
of observations and inside my Collision
of observations and inside my Collision
checks because I felt that there was no
checks because I felt that there was no
point in having like your lanes in there
point in having like your lanes in there
until you actually were using Lanes as a
until you actually were using Lanes as a
part of your Collision checks cuz right
part of your Collision checks cuz right
now it's just Road edges and and I
now it's just Road edges and and I
talked to them about it they said that
talked to them about it they said that
they really only put in the other stuff
they really only put in the other stuff
because they were doing some imitation
because they were doing some imitation
learning at first and then eventually
learning at first and then eventually
they want to do Lane stuff but
they want to do Lane stuff but
that it's just a part of their OBS like
that it's just a part of their OBS like
at this point for no point yep you're
at this point for no point yep you're
good no wor
good no wor
there like eventually adding Lanes is
there like eventually adding Lanes is
like a 30 minute change it's like not a
problem yeah it'll be funny to figure
problem yeah it'll be funny to figure
out if we can get like you know are you
out if we can get like you know are you
driving
legally there's probably a pretty simple
legally there's probably a pretty simple
way I would imagine to man to get it to
way I would imagine to man to get it to
stay in the lane
mhm it's probably more of a reward
mhm it's probably more of a reward
tuning thing than
tuning thing than
anything oh is Tokyo is going to be uh
anything oh is Tokyo is going to be uh
the physics is going to become 3D though
the physics is going to become 3D though
is the only other thing with
is the only other thing with
that uh that's fine you just add one
that uh that's fine you just add one
more parameter to the uh Collision to
more parameter to the uh Collision to
the grid Collision grid just
the grid Collision grid just
XYZ we can just add some ramps in there
XYZ we can just add some ramps in there
for
for
fun I mean in the this data set does
fun I mean in the this data set does
have Z they just didn't use
have Z they just didn't use
it yeah but I think the Collision checks
it yeah but I think the Collision checks
right um the Collision the box now can
right um the Collision the box now can
be angled in
be angled in
3D yeah the physics gets
3D yeah the physics gets
annoying or I guess not even physics
annoying or I guess not even physics
just
just
geometry I I'd have to grock that I
geometry I I'd have to grock that I
don't really know how to
don't really know how to
do whatever Vector math that is off the
do whatever Vector math that is off the
top of my head
top of my head
well we can just make it not like pitch
well we can just make it not like pitch
or
whatever okay reset
91 yeah so my logging is a little weird
91 yeah so my logging is a little weird
I will admit
I will admit
but be because
but be because
okay here's what
okay here's what
happens I don't have masking right
happens I don't have masking right
so when you reach the
so when you reach the
goal you no longer get another reward
goal you no longer get another reward
after it and you don't get penalized for
after it and you don't get penalized for
collisions afterwards anymore because
collisions afterwards anymore because
theoretically you're teleported away to
theoretically you're teleported away to
Infinity land
mhm yeah it's rough cuz we're going to
mhm yeah it's rough cuz we're going to
need masking at some point in this but
need masking at some point in this but
it's
it's
fine fine to do it like this for now
fine fine to do it like this for now
you're still going to be doing pretty
you're still going to be doing pretty
well yeah that that was a huge stop
well yeah that that was a huge stop
train that can stop training from
train that can stop training from
working though um if it gets too
sparse yeah I mean we'll just have to
sparse yeah I mean we'll just have to
see how well this does on Multi map mean
see how well this does on Multi map mean
it it maybe it can just figure it out I
it it maybe it can just figure it out I
don't know yeah
Sor I'm going to unplug my car
all
all
right we're
GOI oh you're in render now okay yeah I
GOI oh you're in render now okay yeah I
think
think
like I don't know what you wanted me to
like I don't know what you wanted me to
review because like yeah the Collision
review because like yeah the Collision
logic is a little tough yeah there's
logic is a little tough yeah there's
some caching but like I don't see how
some caching but like I don't see how
the map logic is going to make any of
the map logic is going to make any of
that harder
um okay this is a Kamehameha right here
um okay this is a Kamehameha right here
but holy Kamehameha B man it's pretty
deep but it's render
deep but it's render
code I'm going to have to make a
code I'm going to have to make a
freaking script that goes through the
freaking script that goes through the
code base and adds like aski Kamehameha
code base and adds like aski Kamehameha
to any of these in
comments yeah I mean I don't know it's
comments yeah I mean I don't know it's
it's it's looping over each a active
it's it's looping over each a active
agents observations to then draw the
agents observations to then draw the
lines the spider web themselves
out you can probably also seven there
out you can probably also seven there
are also seven nested if statements
are also seven nested if statements
but
but
whatever I'm not going to get on your
whatever I'm not going to get on your
case for that right now so the map stuff
case for that right now so the map stuff
is what you wanted to really talk about
is what you wanted to really talk about
right yeah so I I was not really certain
right yeah so I I was not really certain
how to go about it because okay
how to go about it because okay
so I was originally thinking like okay
so I was originally thinking like okay
you probably don't want to write 10,000
you probably don't want to write 10,000
plus binary files at once and then store
plus binary files at once and then store
them in a folder CU I felt like that was
them in a folder CU I felt like that was
dumb you could just do that for
dumb you could just do that for
now
now
I mean I guess you
could are you fine with that I mean it's
could are you fine with that I mean it's
a little Jank do it for now it'll take
a little Jank do it for now it'll take
you like it'll take you a few minutes to
you like it'll take you a few minutes to
do that and because you're literally
do that and because you're literally
just calling your load code with a
just calling your load code with a
random index and you're
random index and you're
done um and then did should I follow the
done um and then did should I follow the
same way that they did for swapping
same way that they did for swapping
between levels because there's going to
between levels because there's going to
be some overhead every time you create
be some overhead every time you create
the cash but they did it every 2 million
the cash but they did it every 2 million
steps I think they resampled
steps I think they resampled
everyone how would you want resampling
everyone how would you want resampling
to go on the levels cuz you wouldn't
to go on the levels cuz you wouldn't
want it to be every single 91 steps cuz
want it to be every single 91 steps cuz
then the caching would nuke your
performance yeah so that's going to be
performance yeah so that's going to be
the thing that is probably going to
the thing that is probably going to
require some architecture changes at
require some architecture changes at
some point
I mean the way I did
I mean the way I did
it these Maps aren't huge right how much
it these Maps aren't huge right how much
memory these things take
up I've never actually checked how big
up I've never actually checked how big
is the file
I can check that real quick
MH 283
MH 283
kilobytes and then with the caching
kilobytes and then with the caching
stuff is the cache pretty big how big is
stuff is the cache pretty big how big is
that
that
object
ah I guess I could go based off of Max
ah I guess I could go based off of Max
size so let me just take a look at the
size so let me just take a look at the
code real
quick H how big is the
[Music]
cash okay so your grid cells just the
cash okay so your grid cells just the
grid cell count then the slots per cell
grid cell count then the slots per cell
how much is this Max entities per cell *
how much is this Max entities per cell *
2 + 1 so that's 21 times the grid cell
2 + 1 so that's 21 times the grid cell
so I think the grid is like 40 by it's
so I think the grid is like 40 by it's
like 50 by 50 so 2500
like 50 by 50 so 2500
time 20 so the
time 20 so the
50,000 ins of just grid cells 50,000 ins
50,000 ins of just grid cells 50,000 ins
so that's
so that's
just and then at each
cell you have
a vision range spiral of n squar of
a vision range spiral of n squar of
whoever your vision
whoever your vision
is
is
times Max entities times
times Max entities times
two so you actually do
two so you actually do
have like a ton of yeah that's
have like a ton of yeah that's
going to be like any megabytes at
going to be like any megabytes at
least I think I think it will be in the
least I think I think it will be in the
megabyte range I don't think it gets to
megabyte range I don't think it gets to
the gigabyte range but it may get close
the gigabyte range but it may get close
if your map is really big yeah well and
if your map is really big yeah well and
that's going to be an issue because like
that's going to be an issue because like
there are a lot of maps right it's like
there are a lot of maps right it's like
100k Maps or
100k Maps or
something I I thought it was smaller
something I I thought it was smaller
than that but maybe I forget how many
than that but maybe I forget how many
they had they had a lot of them um so
they had they had a lot of them um so
yeah I think it's at least 10K so what I
yeah I think it's at least 10K so what I
was going to try to see it's like oh can
was going to try to see it's like oh can
we just compute it for everything and
we just compute it for everything and
then just like hash the entire M
then just like hash the entire M
state but um
state but um
oh yeah that that's probably going to be
oh yeah that that's probably going to be
too much
[Music]
how many M are you using right now
how many M are you using right now
you're using like 128 M or whatever yeah
you're using like 128 M or whatever yeah
I'm using 128 right
I'm using 128 right
now okay so as a first order of business
now okay so as a first order of business
can you just like train on 128
M just randomly pick a map on in it
M just randomly pick a map on in it
randomly pick 100 just randomly pick 128
randomly pick 100 just randomly pick 128
Maps
Maps
yeah and then what just so every time I
yeah and then what just so every time I
go to
go to
it
it
write the file and then re and then
write the file and then re and then
upload it again literally all you have
upload it again literally all you have
to do is like pick 12s
to do is like pick 12s
over the no man just pick 128 Maps run
over the no man just pick 128 Maps run
your pre-processing script and then your
your pre-processing script and then your
C just loads it and you're
C just loads it and you're
done oh you're saying just just try it
done oh you're saying just just try it
out for 128 maps in in one go yeah I
out for 128 maps in in one go yeah I
mean you just yeah just run your
mean you just yeah just run your
pre-processing script to dump the 128
pre-processing script to dump the 128
maps and then you can load them in right
maps and then you can load them in right
just pick you know index one two 3 four
just pick you know index one two 3 four
whatever yeah just attach that to the
whatever yeah just attach that to the
name of the file yeah yeah and you're
name of the file yeah yeah and you're
done and then you'll be able to train on
done and then you'll be able to train on
128 you be able to get an idea of what
128 you be able to get an idea of what
happens when we do
that yeah I could do that
that yeah I could do that
mhm and then you know if we figure out
mhm and then you know if we figure out
what's screw with the batch sizes we do
what's screw with the batch sizes we do
like 256 or whatever um and then if you
like 256 or whatever um and then if you
have two workers you know we potentially
have two workers you know we potentially
can add an offset or something so that
can add an offset or something so that
it's 500 maps and now we're already kind
it's 500 maps and now we're already kind
of getting to something
of getting to something
reasonable okay so here's where I have a
reasonable okay so here's where I have a
another um
another um
[Music]
[Music]
mhm one
sec uh okay so if you go to my python
sec uh okay so if you go to my python
file here's where multimap I have an an
file here's where multimap I have an an
issue
with um observation size is dependent on
with um observation size is dependent on
how many of the active number cars there
how many of the active number cars there
are
are
which for this map is 67 num
which for this map is 67 num
OBS line
24 so it's based off of your it's based
24 so it's based off of your it's based
off of yourself plus the other amount of
off of yourself plus the other amount of
cars times the features times 200 is the
cars times the features times 200 is the
max you can see all the other
cars you can see potentially see all the
cars you can see potentially see all the
other cars what the hell's the point of
other cars what the hell's the point of
the Spiral if you can see all the other
the Spiral if you can see all the other
cars do not get them in the
cars do not get them in the
spiral you don't you no no no no no if
spiral you don't you no no no no no if
it's in the spiral you get them
it's in the spiral you get them
otherwise they're just a bunch of
otherwise they're just a bunch of
negative
ones so what is the maximum allowed
ones so what is the maximum allowed
number of Agents do we want to set is
number of Agents do we want to set is
the question just pick a number and take
the question just pick a number and take
the nearest nend
right I mean I can I can just blank face
right I mean I can I can just blank face
pick a number I guess I mean take 32 or
pick a number I guess I mean take 32 or
something they're not going to have more
something they're not going to have more
than 32 cars around you
anyways
anyways
right
uh
uh
mean I think you have more than 32 cars
mean I think you have more than 32 cars
and a I guess it's the radius is more
and a I guess it's the radius is more
than
than
3x3 cuz the radius is 50 m by 50 m what
3x3 cuz the radius is 50 m by 50 m what
what's isn't it don't you have the
what's isn't it don't you have the
spiral thing for nearest anyways
spiral thing for nearest anyways
right yeah it is okay so just stop when
right yeah it is okay so just stop when
you hit 32
you hit 32
done yeah I mean I can totally do that
done yeah I mean I can totally do that
it just matters if if we're going to
it just matters if if we're going to
lose any performance that's all I guess
lose any performance that's all I guess
we can just we see and then you know
we can just we see and then you know
what the really cool thing is with the
what the really cool thing is with the
the renderer is that you're going to
the renderer is that you're going to
actually be able to draw which cars that
actually be able to draw which cars that
it can see and which ones it can't if we
it can see and which ones it can't if we
need to debug
need to debug
it uh yeah I can actually I mean I think
it uh yeah I can actually I mean I think
you already saw
you already saw
that like you had the really cool OBS
that like you had the really cool OBS
thing well we can just you know we can
thing well we can just you know we can
just add some indicator if it can't see
just add some indicator if it can't see
the cars cuz it's hit Max like
um yeah I just shared my screen so you
um yeah I just shared my screen so you
can
can
see what
see what
uh how it does it so if I I just have it
uh how it does it so if I I just have it
pick a smaller number that's totally
pick a smaller number that's totally
fine if it hits the number it's
fine if it hits the number it's
filled and once it's filled there
filled and once it's filled there
matters like
matters like
yeah like arguably the cars yeah like
yeah like arguably the cars yeah like
these cars on the right arguably don't
matter and like these cars don't matter
matter and like these cars don't matter
we're we're going to be able to optimize
we're we're going to be able to optimize
a ton of this stuff like it doesn't
a ton of this stuff like it doesn't
matter just for now pick a number you'll
matter just for now pick a number you'll
be good it'll
be good it'll
learn all right that's fine yeah that's
learn all right that's fine yeah that's
fine your OBS is now a fixed size right
fine your OBS is now a fixed size right
yep yep and 200 Road points is probably
yep yep and 200 Road points is probably
too big that's probably killing your net
too big that's probably killing your net
perf
right there's a quite a bit of Road
right there's a quite a bit of Road
points but I mean I mean you probably
points but I mean I mean you probably
don't need this road Point like up the
don't need this road Point like up the
top it's they're sorted roughly by
top it's they're sorted roughly by
nearest anyways right correct it's
nearest anyways right correct it's
always sort of by nearest because you
always sort of by nearest because you
get you they're cashed in a spiral you
get you they're cashed in a spiral you
can literally drive just fine with the
can literally drive just fine with the
nearest 10 of
them I'll pick a number I think 10's too
them I'll pick a number I think 10's too
small yeah I think it's too small as
small yeah I think it's too small as
well for like Max perf but I 200 is
well for like Max perf but I 200 is
nutty like you'd be fine with 64 or
nutty like you'd be fine with 64 or
whatever and you'll be training at 1.5
whatever and you'll be training at 1.5
SPS and you'll be
SPS and you'll be
done for sure would definitely probably
done for sure would definitely probably
get to a million SPS if I if I picked
get to a million SPS if I if I picked
like 60 or something like you said like
like 60 or something like you said like
64 and 32 on 6432 call a day let's like
64 and 32 on 6432 call a day let's like
let's see this thing running on let's
let's see this thing running on let's
see this thing running on a bunch of M's
see this thing running on a bunch of M's
these Maps don't have buildings in them
these Maps don't have buildings in them
do they no no buildings damn that'd be
do they no no buildings damn that'd be
so
so
nice yeah it' be great for rendering if
nice yeah it' be great for rendering if
you could have like a little bit of like
we could add
we could add
some for the purposes of social media
some for the purposes of social media
sure I could randomly Place buildings
sure I could randomly Place buildings
there like man there are so many like
there like man there are so many like
City gen algorithms like that you could
City gen algorithms like that you could
just grab you just put it everywhere
just grab you just put it everywhere
that's not
that's not
Road not Road and not parked car for
Road not Road and not parked car for
whatever reason that these parked cars
whatever reason that these parked cars
exist I even know why those are
exist I even know why those are
there it's just some I don't know dude I
there it's just some I don't know dude I
think just a matter of the data set
think just a matter of the data set
mhm they just like
exist technically some of these cars
exist technically some of these cars
originally are supposed to be agents but
originally are supposed to be agents but
we filter them out because their goal is
we filter them out because their goal is
like one inch from themselves
like one inch from themselves
MH so they they set the filter to be you
MH so they they set the filter to be you
only determine an car to be an active
only determine an car to be an active
agent if they're greater than two meters
agent if they're greater than two meters
away in distance to goal from Spawn
away in distance to goal from Spawn
yeah I think we're gonna have to do way
yeah I think we're gonna have to do way
longer than 9 second I mean that's
longer than 9 second I mean that's
ridiculous
ridiculous
right it is but if you also think about
right it is but if you also think about
it I don't know how many major driving
it I don't know how many major driving
interactions last maybe longer than 15
interactions last maybe longer than 15
seconds yeah but it's lame right like in
seconds yeah but it's lame right like in
terms of like in terms of like unique
terms of like in terms of like unique
things you're doing while you drive yeah
things you're doing while you drive yeah
it's lame though I mean even like a 4-
it's lame though I mean even like a 4-
second stop sign doesn't even take that
second stop sign doesn't even take that
long like like a fourway stops sign if
long like like a fourway stops sign if
every single car is there but I want to
every single car is there but I want to
watch the agents just drive around
watch the agents just drive around
constantly
constantly
yeah I see that I mean I also like
yeah I see that I mean I also like
watching the rware robots permanently
watching the rware robots permanently
solve putting boxes inside of its goal
solve putting boxes inside of its goal
you know if we wanted to actually do
you know if we wanted to actually do
something in that industry I would
something in that industry I would
literally just like we just make that
literally just like we just make that
thing be able to have continuous
thing be able to have continuous
movement and then Jazz up the render to
movement and then Jazz up the render to
be like 3D actual warehouse and boom
be like 3D actual warehouse and boom
there you
go yeah yeah that's literally all you
go yeah yeah that's literally all you
would do and then you'd be like boom
would do and then you'd be like boom
okay now we have realistic Warehouse
okay now we have realistic Warehouse
area just like freaking making the
area just like freaking making the
renderer half decent yeah instead of not
renderer half decent yeah instead of not
like some Jank ass little yeah 2D
like some Jank ass little yeah 2D
colored box yeah for sure that's
colored box yeah for sure that's
actually probably going to be a thing
actually probably going to be a thing
that happens by the way at some point in
that happens by the way at some point in
the future with puffer is like we just
the future with puffer is like we just
actually start caring way more about
actually start caring way more about
making the M's look like what they
making the M's look like what they
actually
are hey man I I I see that I mean I set
are hey man I I I see that I mean I set
this the tone going forward with with
this the tone going forward with with
Tower climb I mean that's like Graphics
Tower climb I mean that's like Graphics
the out of itself
the out of itself
yeah that's cool um but yeah I I would
yeah that's cool um but yeah I I would
like to have permanent cars and also
like to have permanent cars and also
having goals pick new goals after you
having goals pick new goals after you
hit a
hit a
goal which is why it'd be great to have
goal which is why it'd be great to have
a larger map so you can have
a larger map so you can have
indefinitely
indefinitely
running um car
running um car
simulation and you can even track like
simulation and you can even track like
traffic patterns at that point yeah
traffic patterns at that point yeah
would be cool etiquette for you get
would be cool etiquette for you get
co-author I don't know what you're
co-author I don't know what you're
asking
asking
Jason uh yeah like why is there no there
Jason uh yeah like why is there no there
cars on like the vast majority of that
cars on like the vast majority of that
map I don't know man it's just like the
map I don't know man it's just like the
data like I don't even know why they
data like I don't even know why they
like this even exists over
here I like literally if you were to
here I like literally if you were to
just do max distance like you know just
just do max distance like you know just
you get rewarded for going max speed and
you get rewarded for going max speed and
not hitting anything and you would just
not hitting anything and you would just
spawn cars randomly you could already do
spawn cars randomly you could already do
stuff with
stuff with
that right
that right
yeah I mean I think what even if we get
yeah I mean I think what even if we get
like the new plan data set like I think
like the new plan data set like I think
that they've been working talking with
that they've been working talking with
those guys about I think their maps are
those guys about I think their maps are
decently large okay cool well we will do
decently large okay cool well we will do
something get just get the thing
something get just get the thing
training on 128 or whatever maps for now
training on 128 or whatever maps for now
so that like you know there's like a
so that like you know there's like a
reasonable policy and then uh yeah we'll
reasonable policy and then uh yeah we'll
go from
go from
there okay so get a 128 policy going do
there okay so get a 128 policy going do
do the simple dumb approach of just
do the simple dumb approach of just
uploading all the maps at once and then
uploading all the maps at once and then
um you should notice that training is a
um you should notice that training is a
lot easier than it was a week ago with
lot easier than it was a week ago with
the new algorithms and
the new algorithms and
stuff I have it in there unless you put
stuff I have it in there unless you put
something in like yesterday no muan is
something in like yesterday no muan is
there by default now what are your
there by default now what are your
policy still not
policy still not
training no my policies do train I sh
training no my policies do train I sh
that result over on Discord well I think
that result over on Discord well I think
that you'll have not too much trouble
that you'll have not too much trouble
getting working on more maps then
getting working on more maps then
because the new algorithm is a lot less
because the new algorithm is a lot less
fiddly than uh just Adam
fiddly than uh just Adam
I actually think new M more maps will be
I actually think new M more maps will be
easier surprisingly like I think just
easier surprisingly like I think just
the data diversity will will just be
the data diversity will will just be
helpful as opposed to like it randomly
helpful as opposed to like it randomly
trying to figure out that like oh
trying to figure out that like oh
there's a goal like over here and all
there's a goal like over here and all
the other agents goals are over here it
the other agents goals are over here it
should be like it definitely should be
should be like it definitely should be
easier but unless I have an N bug which
easier but unless I have an N bug which
is possible but I mean I think it looks
is possible but I mean I think it looks
pretty clean thus far that's good that
pretty clean thus far that's good that
help you at some point with this render
help you at some point with this render
as well
this is just to like find out if things
this is just to like find out if things
work all right we haven't jazzed it up
work all right we haven't jazzed it up
yet yeah have to go we're gonna have to
yet yeah have to go we're gonna have to
go license the car models from the car
go license the car models from the car
companies oh yeah we we'll go talk to
companies oh yeah we we'll go talk to
Tesla okay and get like a
Tesla okay and get like a
little little car model what if we even
little little car model what if we even
then just get like car Partnerships via
then just get like car Partnerships via
like ads for other car companies to just
like ads for other car companies to just
have their things run in here yeah
have their things run in here yeah
that's even better now we don't pay them
that's even better now we don't pay them
for licensing you pay us for Market
for licensing you pay us for Market
yeah exactly isn't it funny how you can
yeah exactly isn't it funny how you can
just flip the thing and just have the
just flip the thing and just have the
same
same
exact you pay us we pay you you pay us
exact you pay us we pay you you pay us
we pay
we pay
you and then uh I do want to add first
you and then uh I do want to add first
person mode in here and drop the camera
person mode in here and drop the camera
in the perspective of the car oh yeah
in the perspective of the car oh yeah
that'll be that'll be fun to play with
that'll be that'll be fun to play with
and it'll be cool to to demo onl you can
and it'll be cool to to demo onl you can
also do um you can also do like the
also do um you can also do like the
third person racing
third person racing
perspective yeah where you just like
perspective yeah where you just like
right on the tail of the car but a
right on the tail of the car but a
little bit above it prob that's probably
little bit above it prob that's probably
even cooler if you get a decent car
even cooler if you get a decent car
model CU then you actually see the
model CU then you actually see the
car sure sure sure sure yeah that's how
car sure sure sure sure yeah that's how
all the racing games are right now are
all the racing games are right now are
any of them even first person is that a
any of them even first person is that a
thing I think you can always swap into
thing I think you can always swap into
first person mode but I think most games
first person mode but I think most games
are played as a as a user from that like
are played as a as a user from that like
just behind third person mode
just behind third person mode
yeah I'll go look at track Mania or
yeah I'll go look at track Mania or
something yeah yeah all right cool but
something yeah yeah all right cool but
Okie do yeah that works
Okie do yeah that works
Spencer
Spencer
um once we get the policy going on 128
um once we get the policy going on 128
and it seems decent is that something
and it seems decent is that something
that we want to present to the NYU group
that we want to present to the NYU group
or at what point do we want to be like
or at what point do we want to be like
hey this is like in a good place for you
hey this is like in a good place for you
guys to use or at what point do you feel
guys to use or at what point do you feel
like they're gonna want to be able to
like they're gonna want to be able to
train on all their Maps but no this is
train on all their Maps but no this is
okay we're only two hops away now yeah
okay we're only two hops away now yeah
sure yeah 128 and then 10,000 why not
sure yeah 128 and then 10,000 why not
well I think that you we probably will
well I think that you we probably will
have to just revisit the state size and
have to just revisit the state size and
uh the best way to do it is that your
uh the best way to do it is that your
state load is like a mem copy or like a
state load is like a mem copy or like a
small number of me copies right you can
small number of me copies right you can
look at how I did this with the grid en
look at how I did this with the grid en
because I have a full example in a
because I have a full example in a
simpler M there for
you I was having a hard time trying to
you I was having a hard time trying to
figure out how I would use any mem
figure out how I would use any mem
copies here but
copies here but
well you make what you do is you make a
well you make what you do is you make a
struct that's the state right the game
struct that's the state right the game
State okay and then and that like that
State okay and then and that like that
just has data and then you make like a
just has data and then you make like a
load state or save state that just
load state or save state that just
copies the data from one struck to
copies the data from one struck to
another
another
right so then you just end up with a
right so then you just end up with a
struck that has the state of every end
struck that has the state of every end
at
at
initialization and then in order to load
initialization and then in order to load
M just copy it yeah
okay Bas yeah that's
okay Bas yeah that's
that's I can kind of Follow that
that's I can kind of Follow that
yeah but I guess who's in each okay
yeah but I guess who's in each okay
here's where I get a little loss if each
here's where I get a little loss if each
one has their own end is that all
one has their own end is that all
happening in the scon then so that it's
happening in the scon then so that it's
shared
shared
amongst everybody The Struck definitions
amongst everybody The Struck definitions
and like the load State Save State all
and like the load State Save State all
those methods that goes in C and then
those methods that goes in C and then
the actual array of levels goes in syon
the actual array of levels goes in syon
this is in the grid example code so if I
this is in the grid example code so if I
just pull up the grid example code right
here where's it
ocean is is that what I did for to
ocean is is that what I did for to
remember literally you have an example
remember literally you have an example
right here so levels is an array of
right here so levels is an array of
States yeah and then here you can see
States yeah and then here you can see
get state so I get uh I get the state
get state so I get uh I get the state
for all the different M's and I save it
for all the different M's and I save it
to levels
and then there's a set
and then there's a set
State
State
natural and then all the other stuff get
natural and then all the other stuff get
State set State like all the state stuff
State set State like all the state stuff
is in
is in
s all right I did the same thing with
s all right I did the same thing with
Tower climb too I was just confirming
Tower climb too I was just confirming
that
that
I yeah but the grid will probably be
I yeah but the grid will probably be
even easier to even read what even what
even easier to even read what even what
I own did for
I own did for
myself that's
myself that's
it that's right
it that's right
yeah yeah I that's that's a thing I
yeah yeah I that's that's a thing I
could just make a struct that's the
could just make a struct that's the
state at initialization
state at initialization
post that's what I would
suggest yeah don't don't bother with
suggest yeah don't don't bother with
that yet just get the 128 training yeah
that yet just get the 128 training yeah
get the 128 going I mean I mean I'll
get the 128 going I mean I mean I'll
probably be able to get the 128 going
probably be able to get the 128 going
this by this weekend realistically you
this by this weekend realistically you
don't have your box is working
don't have your box is working
right yeah my box is good unless unless
right yeah my box is good unless unless
it just nuked itself like now thankfully
it just nuked itself like now thankfully
everybody's freaking messaging me with
everybody's freaking messaging me with
hardware issues all the time all right
hardware issues all the time all right
we're good
we're good
co okay do all right uh I will see you
co okay do all right uh I will see you
later and let you know how 128 goes see
later and let you know how 128 goes see
you Spencer thanks like good progress on
you Spencer thanks like good progress on
the
the
end okay that was
end okay that was
cool Spen has made really good progress
cool Spen has made really good progress
I'm going to take a minute um I'm going
I'm going to take a minute um I'm going
to take a minute walk around a second
to take a minute walk around a second
use the restroom all that and then I
use the restroom all that and then I
will be back we're going to do a couple
will be back we're going to do a couple
just example training runs on stuff and
just example training runs on stuff and
then that'll be it it will be dinner and
then that'll be it it will be dinner and
then tomorrow will
then tomorrow will
be uh probably all day infrastructure
be uh probably all day infrastructure
work on puffer and that'll all be live
work on puffer and that'll all be live
be right
back
e
e
e
e
e
e
e
e
e e
okay here's a plan about 40 minutes to
okay here's a plan about 40 minutes to
fiddle with some
fiddle with some
experiments and then dinner I'm getting
hungry e
ah wait I need to do
ah wait I need to do
um I need to grab their latest Branch I
um I need to grab their latest Branch I
think
can work off of that
okay e
we'll let that run
h e
my guess is I just like deleted some of
my guess is I just like deleted some of
their losses or
something so basically I'm just uh I did
something so basically I'm just uh I did
emerge into this repo with all our new
emerge into this repo with all our new
Dev features and uh trains a little
Dev features and uh trains a little
worse than before H so I probably broke
worse than before H so I probably broke
a couple things I mean this is it was
a couple things I mean this is it was
like a big merge so it was kind of
like a big merge so it was kind of
expected frankly I was surprised the
expected frankly I was surprised the
training worked like reasonably well at
training worked like reasonably well at
all um on their first go so see if I can
all um on their first go so see if I can
spot you know any discrepancies real
spot you know any discrepancies real
quick get a couple runs going we'll go
quick get a couple runs going we'll go
from there
okay
apparently this is supposed to do stuff
we don't have episode reward in here
yet okay so that actually trains quite
slow ah no it gets faster though okay
slow ah no it gets faster though okay
let's move on
so while I'm waiting for this let me go
so while I'm waiting for this let me go
look at uh their
original code here
why did they merge this into
main oh no they didn't that's me that's
main oh no they didn't that's me that's
my
Branch never mind
[Music]
okay so what do they do with their
losses oh oh yeah they got a whole bunch
losses oh oh yeah they got a whole bunch
of these so they got Kickstarter chos
of these so they got Kickstarter chos
value they got this L2 as
well
e
e
e e
this is now with their regularization
this is now with their regularization
added back in
let me see what else could be different
let me see what else could be different
in the
meantime so they don't use this
meantime so they don't use this
Kickstart thing
that's like the
that's like the
main thing I was expecting
oh
oh
okay it's probably just this isn't it
yeah yeah yeah okay that's that's
yeah yeah yeah okay that's that's
definitely
it
e
e
e
e
e
e
e
e
e e
how does this thing not freaking
work
e e
there we go
I think I should sweep L2
regularization
e
e
e e
how many steps is this
okay we'll let this run a little
longer this should do very nicely
though almost six we'll give this a few
though almost six we'll give this a few
minutes
minutes
then and uh
then and uh
may as well check on my other runs in
may as well check on my other runs in
the
the
meanwhile now that is something I can do
meanwhile now that is something I can do
because this
because this
guy this guy's not doing so hot
guy this guy's not doing so hot
right yeah this guy's not doing so
hot
e
e
e
e
for e
you go double check how much L2 they
you go double check how much L2 they
were
were
using it makes that much of a difference
using it makes that much of a difference
for them
um well they have no
L2 so I don't know how that made any
L2 so I don't know how that made any
difference for
him
for e
yeah these um these are
yeah these um these are
zeros so they're not actually doing
L2 so what do I run on neural MMO
then I basically just get to run an
then I basically just get to run an
ablation of some sort
right
e e
yeah it's stuck at
one still lower but not much
lower
for e
this one has
this one has
0.9 0.9
0.9 0.9
0.999 20 - 12
okay we'll double check the betas then
now these have the same
now these have the same
prams these muon prams are the
same does seem kind of stuck
oh you screwed this up totally didn't
you U maybe
you U maybe
not H
whatever
32k
for
e e
I'm trying to think what else I could
I'm trying to think what else I could
have
broken for
this is the wrong
this is the wrong
one I got his experiment by mistake
we'll see if the mini batch makes a
difference makes it a little faster
I think what else I could have
I think what else I could have
broken it's kind of rare to like break
broken it's kind of rare to like break
something and have it like still mostly
something and have it like still mostly
train usually either full break it or
train usually either full break it or
you
don't it's annoying
changed Optimizer changed I
guess I mean to be fair I don't know how
guess I mean to be fair I don't know how
they had it working
they had it working
before like I tried to reproduce their
before like I tried to reproduce their
result and I
couldn't e
think if there's anything else that they
think if there's anything else that they
might have done
config average
config average
reward they do
this I don't see it in here
anywhere they don't use either of these
losses have this weight flipping
nope they're not using that
either do they have vene nealing
either do they have vene nealing
on they have an Neal the
false but that shouldn't matter
e e
this is just rank
logging I did this correctly right in
logging I did this correctly right in
theirs let's go check the lstm state
yeah that that wouldn't work at
yeah that that wouldn't work at
all without this
right
for e
I did add reward
I did add reward
clipping did they have reward
clipping they do not have reward
clipping we'll try that next
but I want to see if this gets any
better e
okay we'll see where this gets
okay we'll see where this gets
to man
is this
is this
scammer
yep hey this is cool
2 million not enough
though it's a tiny tiny amount of data
I'm trying to think if it makes sense
I'm trying to think if it makes sense
that this would be a reward thing right
I remember this being a thing in
I remember this being a thing in
breakout the other
way it could be that the rewards are
way it could be that the rewards are
just horribly
just horribly
scaled and
scaled and
um you know that could be a thing
we'll have to see
plus hang on he sent me another
plus hang on he sent me another
ARG I already had it
though we going to level out
again just take longer to get
there we'll try this thing next oops
there we'll try this thing next oops
wrong language
we'll let this finish
we'll let this finish
250 and then I'll just run the other
250 and then I'll just run the other
thing and I'll go get dinner
non-tensor data within tensor
deck what the
heck that was weird
huh X AI has acquired
X that's a weird one
surprised you can even do that that's
surprised you can even do that that's
interesting
e e
that's
that's
annoying okay this is what we'll do set
annoying okay this is what we'll do set
this to clip Rewards
e
e
e e
e
yeah
e
e e
maybe that's a clue why train is
slower oh it could be the stupid
slower oh it could be the stupid
gradient variance thing
for e
reward clipping doesn't seem to make a
reward clipping doesn't seem to make a
big
difference it's
difference it's
weird very
weird so we're not going to get anything
weird so we're not going to get anything
out of reward clipping it looks like
and that should be there
anyways I can double check the lstm
state it'd be really weird if it were
state it'd be really weird if it were
doing this well without lstm State
doing this well without lstm State
though
oh okay
is this going to be stuck again
damn
it yeah that's crazy that it does that
it yeah that's crazy that it does that
it does a little better without reward
it does a little better without reward
clipping
though well I still should check the
though well I still should check the
lstm states
what's the default supposed to
do minutes
so like 100 Mil steps supposed to be
so like 100 Mil steps supposed to be
pretty
pretty
low 200 gets to like 1.
low 200 gets to like 1.
25ish 250
25ish 250
mil we're not that far off and we only
mil we're not that far off and we only
have to get up to
here wouldn't it be funny if it were
here wouldn't it be funny if it were
just
clipping it' be surprising but guess
clipping it' be surprising but guess
stranger things have happened
stranger things have happened
I do know that that specific
I do know that that specific
parameter is quite
sensitive what else would cause it to
stall learning rate
params for sure
I'm trying to think if there's any
I'm trying to think if there's any
specific
specific
bug that does this but I think it's more
bug that does this but I think it's more
likely just hypers and
likely just hypers and
stuff I mean I guess I could have
stuff I mean I guess I could have
technically
broken if I broke indexing though it
broken if I broke indexing though it
would be like Giga broken wouldn't
it it wouldn't do anywhere near this
it it wouldn't do anywhere near this
well
it wouldn't be certainly like close to
it wouldn't be certainly like close to
where they original is it's a little
under honestly doesn't look too far off
under honestly doesn't look too far off
from
theirs
e e
that definitely did something at the
that definitely did something at the
very least
the thing is the curve shape is
off
e
e e
let me see if I missed any of their
let me see if I missed any of their
other normalization
stuff e
I do the schedule
I do the schedule
step I think I did
right
e e
e
okay I think I'm just going to uh keep
okay I think I'm just going to uh keep
running a couple of these in the
running a couple of these in the
background and figure it out slowly
yeah I got to just play with their
yeah I got to just play with their
thing
thing
okay
okay
uh Neptune
run early gamma has potential
run early gamma has potential
here okay I'm going to go get dinner I
here okay I'm going to go get dinner I
may not be back after I will be live all
may not be back after I will be live all
day tomorrow most likely streaming
day tomorrow most likely streaming
infrastructure Dev on uh on puffer so if
infrastructure Dev on uh on puffer so if
you're interested in that swing by
you're interested in that swing by
tomorrow and otherwise puffer doai all
tomorrow and otherwise puffer doai all
my stuff's here star the GitHub to help
my stuff's here star the GitHub to help
us out really really helps us out a lot
us out really really helps us out a lot
you can join the Discord to get involved
you can join the Discord to get involved
you can follow me on X for more content
you can follow me on X for more content
thanks

Kind: captions
Language: en
folks we're
back I uh I think I'm going to just
back I uh I think I'm going to just
reset a little
reset a little
bit and do some experimental engineering
bit and do some experimental engineering
stuff with
stuff with
puffer
puffer
um I've been running support for you
um I've been running support for you
know a few different projects in the
know a few different projects in the
background and um if I have to deal with
background and um if I have to deal with
one more piece of like absolutely
one more piece of like absolutely
deranged research code um
deranged research code um
I think I'm going to
I think I'm going to
snap
snap
so we're just going to do some cool
so we're just going to do some cool
engineering right now that's what we're
engineering right now that's what we're
going to
do it's
do it's
like the only thing I'll say is it is
like the only thing I'll say is it is
astounding to me how willingly um even
astounding to me how willingly um even
very good
very good
scientists will just throw
scientists will just throw
away
away
99.9% of their computer
99.9% of their computer
yeah we'll just you know buy all this
yeah we'll just you know buy all this
expensive Hardware run it at
expensive Hardware run it at
0.1% of what it should be running at and
0.1% of what it should be running at and
then wonder why none of our stuff
works drives me
works drives me
bonkers but enough of
bonkers but enough of
that we're going to do some cool
stuff I do want to just briefly check on
stuff I do want to just briefly check on
the experiment that I ran from
before just briefly check on
this okay so this is interesting right
this okay so this is interesting right
because we have this one this one and is
because we have this one this one and is
it this one
it this one
so we'll see whether these intersect or
so we'll see whether these intersect or
not um this is with the optimized
not um this is with the optimized
hypers to go like
hypers to go like
this we'll see whether this stays above
this we'll see whether this stays above
uh the other curve it's interesting that
uh the other curve it's interesting that
it like has this fast growth at the
it like has this fast growth at the
start we'll see if it maintains
start we'll see if it maintains
it and
um yeah this is very very clean
um yeah this is very very clean
though so we're expecting about a 4.5
though so we're expecting about a 4.5
out of this I
believe
cool make sure I don't have
cool make sure I don't have
any reasonable messages from reasonable
any reasonable messages from reasonable
people on Discord I do
people on Discord I do
not okay so this is what uh I had
not okay so this is what uh I had
planned for right now um I've been
planned for right now um I've been
thinking about doing something like this
thinking about doing something like this
for a
for a
while there's a lot of scyon code in
while there's a lot of scyon code in
Puffer
Puffer
and it's pretty much all identical as
and it's pretty much all identical as
well every environment needs a scon
well every environment needs a scon
binding as well as a python binding and
binding as well as a python binding and
the code is
the code is
like it's kind of gross so what I want
like it's kind of gross so what I want
to do today is I just want to look at
to do today is I just want to look at
some different binding options and see
some different binding options and see
if I can think of anything that would
if I can think of anything that would
replace um that that
replace um that that
binding just do that for a little bit
binding just do that for a little bit
you know
what's the built-in one with
what's the built-in one with
python is it C
types it's just
uh Comm
I believe C types is the built-in
I believe C types is the built-in
one yeah C types is the built-in one no
compilation commit to calling
compilation commit to calling
pre-compiled C libraries less
pre-compiled C libraries less
efficient why is it less
efficient high
efficient high
performance and python C
API why is C
API why is C
types
Earth ah
Earth ah
every call involves interpreting the
signature compiled
bindings is there a
bindings is there a
built
built
in I
python C
API direct access to python
objects compiled into shared
libraries no runtime overhead
libraries no runtime overhead
direct memory
access
access
okay compare to high 11 for here C
expens highest possible performance
nearly identical once
compiled we don't like
C++ but these Pi objects are totally
gross give me example what
look like
I ire rate
only to
only to
just
buffer you can Leverage The numpy API
so you get two Pi
objects I don't like this total mess
here parse the input arguments
yeah this is a
mess there is a lot of high object
mess there is a lot of high object
mess
here
syon
memory start it's here see start
there
there
way to
add
arrays okay so this
arrays okay so this
is yeah this is
fine
fine
validation 1D double contiguous same
validation 1D double contiguous same
length
yeah that's just a massive amount of
yeah that's just a massive amount of
stupid code let me see if I can figure
stupid code let me see if I can figure
out why the API is like that and if
out why the API is like that and if
grock is just
grock is just
stupid
stupid
um so you get this Pi object
API I see you can only pass like this
API I see you can only pass like this
really
this the only way to use
this the only way to use
Python
Python
with my object R
with my object R
signature and I write
functions specific Sig
functions specific Sig
so void unpacking
python C API design enforces
this e
okay so you can pass
okay so you can pass
one one thing to the signature I
guess and know this is them making
guess and know this is them making
wrapper garbage
okay so the fast call thing
okay so the fast call thing
here this is Star Source this API is
here this is Star Source this API is
kind of gross because you don't get
kind of gross because you don't get
signatures
signatures
directly so syon must be doing something
directly so syon must be doing something
like this under the hood
right
e e
so what is
so what is
this extension
module it's a very odd API
this is like trying to write Python and
this is like trying to write Python and
see
I Bine lets you define the
signatures
e
e
e e
see this is just
awful this is
awful this is
awful required for python object
awful required for python object
integration
method table for the
type yeah know this code is absolutely
type yeah know this code is absolutely
terrible I don't understand is this that
terrible I don't understand is this that
Gro is stupid or is this that the python
Gro is stupid or is this that the python
API is
API is
stupid none of this should be required
welcome YouTube folks I'm currently
welcome YouTube folks I'm currently
seeing if I can find an alternative to
scon the goal would be to make a general
scon the goal would be to make a general
purpose
purpose
wrapper that um essentially just takes
wrapper that um essentially just takes
your C environment and then runs a bunch
your C environment and then runs a bunch
of copies of it for
you and I'm currently trying to figure
you and I'm currently trying to figure
out why the python API is this
out why the python API is this
bad or if it's just grock being really
dumb like I didn't ask for this
right P type object what is
this e
this Cod is
terrible why
terrible why
is
is
there don't
there don't
C here
C for
array increment type
it's funny because this is like
it's funny because this is like
absolutely trivial in
absolutely trivial in
purec and somehow with the python API
purec and somehow with the python API
now it's hard how's that make any sense
right e
in okay e
well this code is freaking
well this code is freaking
horrible is that
horrible is that
Teto yeah do you have a good solution
Teto yeah do you have a good solution
for this um C is like so nice and easy
for this um C is like so nice and easy
and then as soon as you try to do
and then as soon as you try to do
anything python related it's awful I
anything python related it's awful I
currently have like this massive amount
currently have like this massive amount
of scyon code where every single
of scyon code where every single
environment in puffer lib needs like a
environment in puffer lib needs like a
hundred lines of scon that just like
hundred lines of scon that just like
redo the entire header for some reason
redo the entire header for some reason
cuz scyon and then it redefines all the
cuz scyon and then it redefines all the
methods as they are in C and then you
methods as they are in C and then you
need to do the same thing again in
need to do the same thing again in
Python I've like looked at this I've
Python I've like looked at this I've
looked at pbind but I don't want to open
looked at pbind but I don't want to open
the door to C++
the door to C++
nonsense
um I think C types is proba too slow
um I think C types is proba too slow
it's such a
mess like what is
this what in the heck
I they not showing the message or it's
I they not showing the message or it's
emotes which take forever to
load
load
ah also X needs to fix their streaming
ah also X needs to fix their streaming
stuff it's kind of a mess as
well it's like X doesn't show you view
well it's like X doesn't show you view
account and lags and stuff uh twitch has
account and lags and stuff uh twitch has
a ton of bots you have to ban like three
a ton of bots you have to ban like three
or four Bots a day and then YouTube has
or four Bots a day and then YouTube has
too high latency I I don't
know the thing that's tough here is I
know the thing that's tough here is I
can't tell if this is just grock being
can't tell if this is just grock being
incredibly stupid or if this is the
incredibly stupid or if this is the
python API being stupid
can't stream on my
monitor okay this is almost reasonable I
monitor okay this is almost reasonable I
don't know why this isn't an
INT array increment okay this is a c
INT array increment okay this is a c
type and knit
incrementer this takes a pi object
array does a bunch of error
checking that's like way better at least
free any existing
oh now it's storing is a global
shoot
shoot
um I don't like that either
do people actually use this thing
do people actually use this thing
directly
is there like a pie bind but fur C
okay this is
like less insane
I can just use it and with
C is this good though
and is it fast
okay this is
okay this is
C plus plus
class yeah but then it does all this
class yeah but then it does all this
this nonsense
I swear it's like the second you move
I swear it's like the second you move
away from just like pure
C stuff just goes insane
okay this is fine all
right Pi bind array of D why the hell is
right Pi bind array of D why the hell is
this an array of
double like no
stop
for
e e
go back to the python API
what e
can't even do all the checking on in
it e
okay this is now
C e
okay so here's the
cast clean up
Returns the pointer as a python end
is this the best way to do
it it's not
terrible
e e
little
tricky to figure out how you do
this e
I'm trying to think how you would do
I'm trying to think how you would do
this n to like bind whatever
m for
the ideal signature here is that you
the ideal signature here is that you
bind me
think it's freaking Bots
I'm trying to think if what I'm what I
I'm trying to think if what I'm what I
want to do is even
possible I want to make it so you don't
possible I want to make it so you don't
have to write a per n like binding you
have to write a per n like binding you
just need to
just need to
specify essentially what the functions
are
e
e
e e
so here's the
environment so yeah this would be like
environment so yeah this would be like
what our functions would look like
okay so something like this
okay so something like this
works if you can handle the types of
works if you can handle the types of
different M's
for
e
e
e e
okay so example you have a couple these
okay so example you have a couple these
headers and
headers and
[Music]
[Music]
then yeah so this is what you would
then yeah so this is what you would
expect
this is fine
this is all just air
this is all just air
checking so you make this wrapper
thing and then they had to Hash include
thing and then they had to Hash include
both of
both of
them pound
them pound
include for
this would then build one one big
this would then build one one big
extension it's the annoying
extension it's the annoying
thing and we have to deal with name
thing and we have to deal with name
space issues
space issues
right let me think about that
this actually lets you do
this actually lets you do
um fun function poter
allocate void star this could be void
allocate void star this could be void
Star as
well is there a way to do this like how
well is there a way to do this like how
I'm thinking or is this
I'm thinking or is this
dumb because you do end up needing this
dumb because you do end up needing this
like big table right now
okay
okay
idea I have an idea here
let's say that we are willing to have a
let's say that we are willing to have a
very small piece of per n code and we
very small piece of per n code and we
don't want it all in one
file
e e
okay so something like this is totally
okay so something like this is totally
fine right you have a relatively short
fine right you have a relatively short
piece of code that says how to bind nn
and then this is like let's say that you
and then this is like let's say that you
have a specific n
have a specific n
a
right
right
H
A.C that's interesting
why do you need this Pion NBA
yeah okay so this is getting closer to
yeah okay so this is getting closer to
what I
what I
wanted this actually feels like this has
wanted this actually feels like this has
potential
for e
every extension must Define an
every extension must Define an
initialization
function oh fair
enough
e
e
e
e
e e
B okay so I don't want to
B okay so I don't want to
redefine with nb. h
ah hang on I think this might have
ah hang on I think this might have
messed it up a little
bit so this is this environment table
function pointers to be defined in
M.C
M.C
o that's really bad though
yeah that's real
yeah that's real
bad but the thing is the macro isn't
bad but the thing is the macro isn't
even better because the macro is just
even better because the macro is just
hiding
this
e e
specific
specific
files okay so this has this is just an
files okay so this has this is just an
environment
right A
right A
C this is really like enve binding. C or
C this is really like enve binding. C or
whatever so this is clean now right this
whatever so this is clean now right this
doesn't need to do
anything
e e
yeah that's going to screw some stuff up
yeah that's going to screw some stuff up
right
yeah I don't like this piece here
so this is going to be super
gross e
if they all have the same signature I
if they all have the same signature I
think I have the problem
think I have the problem
solved is there a way I can do that
not
really for
so here's our end binding
you know this is a file
you know this is a file
but we only need this
but we only need this
once and
then allocate has extra args
n
n
A.H
okay extra arcs
oh you know
what if I do
what if I do
this and I can just set the extra R CU I
this and I can just set the extra R CU I
don't need to modify this
signature
e
e e
e e
h for
doesn't need length
either e
and this no longer
needs I guess this still does
needs I guess this still does
need an init
need an init
function cuz yeah you sometimes set um
h
for e
net
e
e e
oops they get stuck
yeah we don't need all this stuff in
yeah we don't need all this stuff in
here this
wrapper
e
e
e
e
e e
this is now like working with an
this is now like working with an
exceptionally stupid Junior engineer so
exceptionally stupid Junior engineer so
it's getting
it's getting
better but for anything I have remotely
better but for anything I have remotely
any experience doing at all like I
any experience doing at all like I
haven't used the python
haven't used the python
API it doesn't do much because it writes
API it doesn't do much because it writes
such bad
code
e
e e
okay so this thing is still a
mess
e e
okay cool now we have our validation in
okay cool now we have our validation in
here
okay then we can clean this up further
okay then we can clean this up further
but at least this is
better
e
e e
I mean this is like actually not even
I mean this is like actually not even
like dealing with a stupid Junior
like dealing with a stupid Junior
engineer this is dealing like with an
engineer this is dealing like with an
exceptionally stupid Junior
exceptionally stupid Junior
engineer the only reason I'm doing this
engineer the only reason I'm doing this
is because I haven't used the freaking
is because I haven't used the freaking
python API before and I imagine that
python API before and I imagine that
compiling stuff's going to be a pain um
you are not authorized to use this
service okay
well I might be able to take it from
well I might be able to take it from
here
here
anyways oh is X down yeah X doesn't
anyways oh is X down yeah X doesn't
freaking
freaking
load that's crazy
load that's crazy
is my stream on X down as well or is it
is my stream on X down as well or is it
just the
uh doesn't look like it's
down I mean this is pretty close though
so this is n
so this is n
binding. let start on
this
for
e
e
e e
h
h
thanks
thanks
Teto uh I assume that the UI like broke
Teto uh I assume that the UI like broke
or something because I no longer see the
or something because I no longer see the
stream number
live all right
I mean this is basically there
I mean this is basically there
right the only thing is that this kind
right the only thing is that this kind
of calls a
of calls a
knit a little bit early
right yeah so this kind of calls a n a
right yeah so this kind of calls a n a
little bit early
let get rid of this
let get rid of this
first we don't need these length
grams
for
e e
hang
hang
on oh CU it's a p array object uh that's
on oh CU it's a p array object uh that's
kind of
kind of
gross okay so we'll keep it like this
gross okay so we'll keep it like this
for now I guess
that's
better
for e
do I have any no argument Ms I can use
do I have any no argument Ms I can use
to test with
well you still have to set the uh
well you still have to set the uh
size was it size row and column or
size was it size row and column or
whatever
this
this
size so maybe we'll do squared as our
size so maybe we'll do squared as our
first
one for
with this
now you have to Define
um it's a little tricky
um it's a little tricky
because the init method
because the init method
right already calls a nit
oh I guess it's cuz this observations
oh I guess it's cuz this observations
array is already set
array is already set
up it just needs size afterwards so
up it just needs size afterwards so
maybe I can do it here
let me just put
size size is 11
okay
for
e
e e
oops okay
I just want to see how uh this was bound
I just want to see how uh this was bound
initially it's probably way up
here yeah it's probably like way up here
for e
does this
does this
transfer to human brain organoids a
transfer to human brain organoids a
reinforcement learning using these
lips oh I thought my screen was screwed
lips oh I thought my screen was screwed
up that's a funny
up that's a funny
name I I don't even know how you would
name I I don't even know how you would
Define that
right you can't run code on
right you can't run code on
brains right
organic neural
organic neural
networks is that even a
thing is this like trying to make cells
thing is this like trying to make cells
that behave as neural nuts or is
this so this is trying to make physical
cells can you run code on
them Che
them Che
electrodes huh I didn't even know that
electrodes huh I didn't even know that
was a
thing well the issue is going to be that
thing well the issue is going to be that
you can't really run code on them
you can't really run code on them
right I can't like download pytorch and
right I can't like download pytorch and
or
GCC I mean if you want to see the type
GCC I mean if you want to see the type
of stuff I develop
of stuff I develop
right we do like ultra high performance
right we do like ultra high performance
test environments for reinforcement
test environments for reinforcement
learning
learning
everything from like really simple
everything from like really simple
classic stuff just way faster up to like
classic stuff just way faster up to like
you know new types of interesting tasks
you know new types of interesting tasks
this is like a miniature version of DOTA
this is like a miniature version of DOTA
we've got this like miniature
we've got this like miniature
MMO and they're all very very fast um so
MMO and they're all very very fast um so
like general purpose reinforcement
like general purpose reinforcement
learning techniques but I don't know how
learning techniques but I don't know how
you run code on cells right
theying
form the
basis the
basis the
neural that seems like you're using a
neural that seems like you're using a
language model to train cell outputs not
language model to train cell outputs not
the other way around
right I mean yeah if you have if
right I mean yeah if you have if
technically right like if you have
technically right like if you have
something that responds to stimuli you
something that responds to stimuli you
should be able to optimize it but I
should be able to optimize it but I
don't know how any of that works in
don't know how any of that works in
practice when you're dealing with like
practice when you're dealing with like
you know physical cells that can't run
you know physical cells that can't run
code
[Music]
mhm for
okay we get some
errors
for e
I'm really surprised you can actually do
I'm really surprised you can actually do
that with a username on
X I guess they allow
X I guess they allow
Unicode you can put otes in your name so
Unicode you can put otes in your name so
I guess it makes sense that's still
I guess it makes sense that's still
funny though
that's like crazy that's even in the
that's like crazy that's even in the
spec like if you're clever can't you
spec like if you're clever can't you
even like you can make your username
even like you can make your username
cover the whole chat panel as well right
cover the whole chat panel as well right
I've seen people do
I've seen people do
that that's
crazy I'm surprised they haven't
crazy I'm surprised they haven't
filtered modifiers by
now all
right the thing I'm trying to do at the
right the thing I'm trying to do at the
moment is I'm trying to get a way better
moment is I'm trying to get a way better
way of binding all of these different
way of binding all of these different
CNS to uh to puffer lip so that you
CNS to uh to puffer lip so that you
don't have to go through scon and write
don't have to go through scon and write
a whole bunch of intermediate Jank the
a whole bunch of intermediate Jank the
idea is going to be that before this you
idea is going to be that before this you
had to write like a 100 lines of code to
had to write like a 100 lines of code to
get your M to work with puffer lib and
get your M to work with puffer lib and
after this you should have to write like
five at username has blocked
you that's funny
implicit definition of
Step close
and I'm going to look into this we may
and I'm going to look into this we may
be able to use it yeah I mean I've never
be able to use it yeah I mean I've never
even like remotely thought of that
even like remotely thought of that
domain uh we do have really nice hyper
domain uh we do have really nice hyper
simple RL tools I have no idea how you
simple RL tools I have no idea how you
just how code in general interacts with
just how code in general interacts with
that
stuff I don't know like what with what
stuff I don't know like what with what
frequency can cells even respond to
stuff because we basically can give you
stuff because we basically can give you
data
data
at millions of steps per second
at millions of steps per second
like traditional silicon chips Excel
like traditional silicon chips Excel
highs speeded
highs speeded
calculations so particularly adapt to
calculations so particularly adapt to
handling complex
handling complex
tasks voice
recognition wait wait you don't have you
recognition wait wait you don't have you
don't have cells in a Petri dish
don't have cells in a Petri dish
learning voice recognition do you
is that actually a
thing activation function swap or not
thing activation function swap or not
they're just suggest they're
they're just suggest they're
not uh Jason we've been using G lately
not uh Jason we've been using G lately
in some of our Nets I don't know if it
in some of our Nets I don't know if it
makes a huge
makes a huge
difference yeah
difference yeah
yes well I mean if that actually works
yes well I mean if that actually works
and like there's a high bar for it
and like there's a high bar for it
working like but if that actually just
working like but if that actually just
works that it can just like learn that
works that it can just like learn that
then we probably shouldn't be here just
then we probably shouldn't be here just
doing pure like scaling
doing pure like scaling
Transformers with like 99% of the money
Transformers with like 99% of the money
there probably should be some more
there probably should be some more
investigation into that in fact there
investigation into that in fact there
probably should be
anyways do we actually understand like
anyways do we actually understand like
the mechanism by which these things like
the mechanism by which these things like
learn and update themselves or is it
learn and update themselves or is it
still like pretty well like pretty not
understood cuz my impression was like
understood cuz my impression was like
yeah there's some brain inspired
yeah there's some brain inspired
neuronet design stuff but we actually
neuronet design stuff but we actually
don't really know how the hell it works
don't really know how the hell it works
so like we can't really build neuron
so like we can't really build neuron
Nets that do that because we don't
Nets that do that because we don't
understand how it
works is that not the case I mean it
works is that not the case I mean it
doesn't really matter for any of the
doesn't really matter for any of the
stuff I'm doing right all like the stuff
stuff I'm doing right all like the stuff
I'm doing is mostly like just how do we
I'm doing is mostly like just how do we
learn how do we get this stuff working
learn how do we get this stuff working
on just absolutely ludicrous amounts of
on just absolutely ludicrous amounts of
data very very fast like here I posted
data very very fast like here I posted
this the other day
um
um
so this is just the dashboard from a
so this is just the dashboard from a
completed run this is 107 billion steps
completed run this is 107 billion steps
of training data in about 5050 hours on
of training data in about 5050 hours on
one GPU for context that is like more
one GPU for context that is like more
data than is used to train all of gp4
data than is used to train all of gp4
for instance um and this is like playing
for instance um and this is like playing
2,000 years worth of
2,000 years worth of
games so you know all the stuff I'm
games so you know all the stuff I'm
doing is kind of general purpose in that
doing is kind of general purpose in that
sense like we could decide that all our
sense like we could decide that all our
models and algorithms are stupid
models and algorithms are stupid
tomorrow and my stuff would still be
tomorrow and my stuff would still be
useful for whatever we replace it
useful for whatever we replace it
with they're non-deterministic systems
with they're non-deterministic systems
right I thought you may running
right I thought you may running
Quantum there's no Quantum anything here
Quantum there's no Quantum anything here
this
this
is I mean the goal of what this is right
is I mean the goal of what this is right
is like reinforcement learning is really
is like reinforcement learning is really
slow because people wrote really slow
slow because people wrote really slow
code we make it run a thousand times
code we make it run a thousand times
faster and then we do a whole bunch of
faster and then we do a whole bunch of
comprehensive research on what works and
comprehensive research on what works and
what doesn't which we can now actually
what doesn't which we can now actually
do because we can run experiments fast
do because we can run experiments fast
enough to actually get those
enough to actually get those
results that's mostly what I do with
results that's mostly what I do with
puffer and a nutshell and you know we've
puffer and a nutshell and you know we've
got all the demos on the website
see reset cep
act like Quantum
act like Quantum
systems how is that
systems how is that
possible that doesn't seem physically
possible that doesn't seem physically
possible
Right like neurons are not Quantum
Right like neurons are not Quantum
entangled particles
is intuition
is intuition
co-processing yeah but intuition
co-processing yeah but intuition
is so there's a difference between
is so there's a difference between
nondeterminism and what Quantum does
nondeterminism and what Quantum does
right non-determinism just means random
right non-determinism just means random
non-deterministic in the context of
non-deterministic in the context of
algorithms
algorithms
means that you're kind of effectively
means that you're kind of effectively
evaluating all possible choices at the
evaluating all possible choices at the
same
same
time right there's a huge difference
time right there's a huge difference
between those
things like
things like
intuition is just pattern
intuition is just pattern
recognition right
recognition right
pattern recognition is learnable that
pattern recognition is learnable that
doesn't even require
doesn't even require
non-determinism we don't know and yet
non-determinism we don't know and yet
they act like Quantum particles in some
ways I would be really hardpressed to
ways I would be really hardpressed to
believe that like you know there's some
believe that like you know there's some
fundamental theory of conscious and
fundamental theory of conscious and
actually all the neurons are quantum
actually all the neurons are quantum
entangled or something like that I hadd
entangled or something like that I hadd
be like really hard pressed to believe
be like really hard pressed to believe
that I mean that would be an awesome
that I mean that would be an awesome
some day for Humanity but I doubt it so
some day for Humanity but I doubt it so
I don't know how they behave like that I
I don't know how they behave like that I
would imagine it's just very good
would imagine it's just very good
pattern
pattern
recognition without conscious awareness
recognition without conscious awareness
I don't know what that acronym
is
and yeah that would like so so cool but
and yeah that would like so so cool but
I doubt
it I would imagine there probably it's
it I would imagine there probably it's
just like some vastly better learning
just like some vastly better learning
algorithm that what we have now that we
algorithm that what we have now that we
haven't been able to explore because
haven't been able to explore because
like gpus don't efficiently Implement
like gpus don't efficiently Implement
learning the same way that the brain
learning the same way that the brain
does it's probably something like that
does it's probably something like that
sorry steps it's like a black
sorry steps it's like a black
box conscious it's not stateless though
box conscious it's not stateless though
it's
it's
stateful you don't so like you get
stateful you don't so like you get
inputs you learn from that that that
inputs you learn from that that that
doesn't seem different
doesn't seem different
we don't know how they're making
we don't know how they're making
Association steps within the
Association steps within the
process yet they
process yet they
do it's accurate and fat well anything's
do it's accurate and fat well anything's
faster than an llm so that's like
faster than an llm so that's like
sure
sure
um don't know how they're making steps
um don't know how they're making steps
within the process why it's because it's
within the process why it's because it's
stateful right you don't know how it's
stateful right you don't know how it's
stateful but like when you give it an
stateful but like when you give it an
input it the thing doesn't remain
input it the thing doesn't remain
unchanged it learns actively
I
I
don't nobody's ever really explained to
don't nobody's ever really explained to
me how Quantum has any relevance to
me how Quantum has any relevance to
anything except like yeah there's some
anything except like yeah there's some
crazy thing where you can like I don't
crazy thing where you can like I don't
think it's actually doing like um it's
think it's actually doing like um it's
not actually being like a
not actually being like a
non-deterministic touring machine but it
non-deterministic touring machine but it
kind of acts like it does in some ways I
kind of acts like it does in some ways I
don't really know the details of Quantum
don't really know the details of Quantum
I haven't really seen anything from
there and it's also not required for
there and it's also not required for
like huge huge huge huge amounts of
like huge huge huge huge amounts of
technical advancement it's not gated
technical advancement it's not gated
behind Quantum necessarily like there
behind Quantum necessarily like there
might be a whole bunch of stuff we can
might be a whole bunch of stuff we can
solve uh that we don't know it's even
solve uh that we don't know it's even
possible right now if that actually
possible right now if that actually
works but like I don't know in my view
works but like I don't know in my view
right I have I have pretty well in my
right I have I have pretty well in my
sites um a massive increase to our
sites um a massive increase to our
capabilities in general purpose learning
capabilities in general purpose learning
just with what I'm doing
here yeah you can't measure reasoning
here yeah you can't measure reasoning
right like it's a fuzzy term that's the
problem e
frustrating pre going to tap in again
frustrating pre going to tap in again
once we have yeah sure feel free I
once we have yeah sure feel free I
stream pretty much all my Dev this is
stream pretty much all my Dev this is
kind of like just watch reinforcement
kind of like just watch reinforcement
learning progress being made live
learning progress being made live
sometimes it's cool algorithm stuff
sometimes it's cool algorithm stuff
sometimes it's lowlevel in for Dev but
sometimes it's lowlevel in for Dev but
progress is made nonetheless
that actually
that actually
builds huh
progress is made
nonetheless I mean this week has been
nonetheless I mean this week has been
ridiculously good for RL with some of
ridiculously good for RL with some of
the things we've come up
with
for e
word
oh okay it's just uh we'll fix the path
later
later
oops cannot
oops cannot
import and drawing ah I see you do need
import and drawing ah I see you do need
to link rib still which is a little
annoying
for e
okay that's not
bad seg
bad seg
fault but wait now I can actually
fault but wait now I can actually
compile with address sanitizer can't I
compile with address sanitizer can't I
cuz this is
cuz this is
this is just running C
now where is my have
sanitize
e
for
e
e
e e
ooh that's actually really solid look at
ooh that's actually really solid look at
that debugging now works through the
that debugging now works through the
en
for
e
e
e e
answering some messages on this
answering some messages on this
side we do a little bit of support while
side we do a little bit of support while
we do a little bit of
Dev well this got set correctly so why
Dev well this got set correctly so why
didn't that get set
correctly ah that'll do
it that'll do
it
for
e
e e
let me see if I can finish uh finish
let me see if I can finish uh finish
these stops here call
reset for
no attribute and reset
cool ah so I didn't do reset at
cool ah so I didn't do reset at
all that will do it
this actually should go up
top for
so this actually work this actually
so this actually work this actually
works that's
crazy so this is no
crazy so this is no
scyon C
scyon C
environment no scyon se environment that
environment no scyon se environment that
is
awesome and it's only
150 lines of like general purpose bind
150 lines of like general purpose bind
code okay I'm going to figure out from
code okay I'm going to figure out from
here how I make this work more
here how I make this work more
broadly um I'm going to take a couple
broadly um I'm going to take a couple
quick minutes though there's the
quick minutes though there's the
restroom I'm going to grab a drink and
restroom I'm going to grab a drink and
then I'm going to think about how we
then I'm going to think about how we
handle more variable args and then I
handle more variable args and then I
maybe get a perf test going I'll be
maybe get a perf test going I'll be
right
back
e
e
e
e
e e
okay we're
back this is going to be
back this is going to be
cool but I have to figure out how to
cool but I have to figure out how to
handle variable
arcs you clearly need to be able to
arcs you clearly need to be able to
Define
Define
a
a
function
right you are going to need a little bit
right you are going to need a little bit
of pbind for this I don't think there's
of pbind for this I don't think there's
any way around it or not pbind a pi
object so the issue here is this line
object so the issue here is this line
This envin net for
this doesn't change at the very
this doesn't change at the very
least right this doesn't
change so if I call this
change so if I call this
basinet and let's say that you have to
basinet and let's say that you have to
Define
net so you call base in it
net so you call base in it
like
this okay let's do this first
Undeclared here not a
Undeclared here not a
function okay
this
this
works this still works
okay that's cool
pong from void pointer
no pyong
oh this returns an
oh this returns an
INT wait pyong
INT wait pyong
from oh it's a pi object
cool
cool
so this is not terrible
and this gives you the m
seg Vault lovely
still like false
base
base
inet should give you an mstar
ah wait a nit M requires at least five
arguments
for e
that seems suspicious but we will go
that seems suspicious but we will go
with that for
now
for e
I mean this will work for
everything you can literally even do um
everything you can literally even do um
what is it default in it for
so you can even do
so you can even do
this and now you have a default
this and now you have a default
nit I think most environments are going
nit I think most environments are going
to need arcs
though you you could 100% do this with
though you you could 100% do this with
macros but it's going to be
stupid
e e
may I can see this
working you know because like in this
working you know because like in this
case you can delete this inet right
cuz Square doesn't have one
right got some time code review yeah I
right got some time code review yeah I
can do that you want to see what I've
can do that you want to see what I've
been doing it's pretty
been doing it's pretty
cool uh this
build yeah it does
build yeah it does
so this is so far what a binding would
so this is so far what a binding would
look like if uh the thing I'm doing
look like if uh the thing I'm doing
works this is what you would have to
works this is what you would have to
write for a
binding instead of all the
scon yeah this would replace scon and it
scon yeah this would replace scon and it
fixes debugging through scon you can get
fixes debugging through scon you can get
full stack traces all the way down to
full stack traces all the way down to
C and it compiles instantly
let me jump on
Discord hey yo how's it going chilling
Discord hey yo how's it going chilling
just charging my car right now
let me go ahead and drop a link yeah
let me go ahead and drop a link yeah
it's 150 lines at the moment I still
it's 150 lines at the moment I still
have to do like the loop over M and
have to do like the loop over M and
stuff code but let's say that this thing
stuff code but let's say that this thing
gets to two or 300 lines and then it
gets to two or 300 lines and then it
replaces like 2500 lines worth of stupid
replaces like 2500 lines worth of stupid
binding code right
now and if you need to do like any kind
now and if you need to do like any kind
of I guess weirdness on The Binding
of I guess weirdness on The Binding
would we just do that on on the python
would we just do that on on the python
side now no you can still do it and this
side now no you can still do it and this
is still
is still
C oh yeah it's just C so if you have any
C oh yeah it's just C so if you have any
weirdness you can do it in the python
weirdness you can do it in the python
side or the C side okay so like yeah for
side or the C side okay so like yeah for
like memory allocation stuff
yeah Okay cool so I'm gonna see how this
yeah Okay cool so I'm gonna see how this
goes but I don't know this seems like
goes but I don't know this seems like
this could be uh this could definitely
this could be uh this could definitely
be something
be something
good is it like some python
good is it like some python
Library no it's the built-in python cap
Library no it's the built-in python cap
API oh yeah
API oh yeah
well well it's the thing is it took me
well well it's the thing is it took me
forever I how to do this cuz it's like
forever I how to do this cuz it's like
the way they expect you to do stuff is
the way they expect you to do stuff is
really stupid I literally it took me
really stupid I literally it took me
like half an hour or 40 minutes whatever
like half an hour or 40 minutes whatever
with grock for it to just like give me
with grock for it to just like give me
some code that wasn't completely
some code that wasn't completely
disgusting and then I had to change St
disgusting and then I had to change St
so I don't know what it is but like
so I don't know what it is but like
nobody uses this thing because all the
nobody uses this thing because all the
code sucks
code sucks
sure I could I can see
that
anyways where are we starting all right
anyways where are we starting all right
so uh let's just probably start with
so uh let's just probably start with
just theh file and really kind of what I
just theh file and really kind of what I
wanted to do is like kind of do a review
wanted to do is like kind of do a review
with you before we go into multimap
with you before we go into multimap
stuff yes okay so and just kind of like
stuff yes okay so and just kind of like
go ahead and just like kind of walk you
go ahead and just like kind of walk you
through how I set up the the grid and
through how I set up the the grid and
collisions and stuff to be at a decent
collisions and stuff to be at a decent
speed right now we're at like 730,000 to
speed right now we're at like 730,000 to
830,000
830,000
um train speed it just depends on how
um train speed it just depends on how
many active agents there
are and the and if you do have the graph
are and the and if you do have the graph
or the the dashboard like is it all time
or the the dashboard like is it all time
spent in the environment or what yeah
spent in the environment or what yeah
it's it's say right now environment
it's it's say right now environment
speed is it kind of it ranges based on
speed is it kind of it ranges based on
how many what's it
how many what's it
called
called
um how many parallel M's are running for
um how many parallel M's are running for
some reason I think there's like some
some reason I think there's like some
overhead based on if you have like an
overhead based on if you have like an
optimal
optimal
number wait I see this train
number wait I see this train
here yeah so this is the default in Dev
here yeah so this is the default in Dev
at the moment is two workers two M's bat
at the moment is two workers two M's bat
size
size
one and then if you go to the m side of
one and then if you go to the m side of
num M so that that 128
num M so that that 128
works pretty well because on the on the
works pretty well because on the on the
map that I was training at we had eight
map that I was training at we had eight
active agents and that for some reason
active agents and that for some reason
ended up being faster than 256 even
ended up being faster than 256 even
though 256 would equal it out to
4096 faster in steps per second or
4096 faster in steps per second or
training
training
speed uh what' you say like faster steps
speed uh what' you say like faster steps
per second faster steps per second
per second faster steps per second
training
training
speed interesting sorry like faster yeah
speed interesting sorry like faster yeah
yeah ont train speed yeah
yeah ont train speed yeah
mhm interesting well we'll be able to
mhm interesting well we'll be able to
look at that no big deal
look at that no big deal
um cool so we go back to here yeah and
um cool so we go back to here yeah and
so I was actually able to get a training
so I was actually able to get a training
with your latest Dev changes um pretty
with your latest Dev changes um pretty
much only thing I had to change was the
much only thing I had to change was the
batch size the batch size
batch size the batch size
it yeah I I just changed it to be like
it yeah I I just changed it to be like
130,000 in the four to ratio yeah and
130,000 in the four to ratio yeah and
it'll do grading accumulation over that
it'll do grading accumulation over that
mini batch now and even has like the
mini batch now and even has like the
cosign and kneeling that you did mhm
cosign and kneeling that you did mhm
that's
that's
good um when I tried other Maps I know
good um when I tried other Maps I know
it didn't full solve other Maps it got
it didn't full solve other Maps it got
like 80% on one of the other maps and
like 80% on one of the other maps and
then I haven't tried the third one yet
then I haven't tried the third one yet
well it's going to get easier when we
well it's going to get easier when we
have a bunch of maps but yeah I mean I
have a bunch of maps but yeah I mean I
figured it's just like an entropy thing
figured it's just like an entropy thing
and it just happens to not it just
and it just happens to not it just
didn't run in that direction and didn't
didn't run in that direction and didn't
see it and it got too many negative
see it and it got too many negative
rewards before I could ever find it yeah
rewards before I could ever find it yeah
I mean you'll be able to run sweeps once
I mean you'll be able to run sweeps once
this thing I mean uh you'll be able to
this thing I mean uh you'll be able to
run sweeps I I'm pretty damn confident
run sweeps I I'm pretty damn confident
than the RL at this point um the new
than the RL at this point um the new
changes were very very
changes were very very
good yeah so far I'm pretty happy with
good yeah so far I'm pretty happy with
speed I mean if it could be up to a
speed I mean if it could be up to a
million that'd be great I have an idea
million that'd be great I have an idea
it'll be I'm pretty confident like
it'll be I'm pretty confident like
what's the bottleneck to get to 1
what's the bottleneck to get to 1
million what's the M percent
million what's the M percent
time M percent time it's like two to 5%
time M percent time it's like two to 5%
oh so you are actually Bal Laing on
oh so you are actually Bal Laing on
policy yeah a lot of it is on uh it's
policy yeah a lot of it is on uh it's
probably the road points
probably the road points
encoder it's just like there's just a
encoder it's just like there's just a
lot of points
lot of points
yeah okay well we'll look at that we'll
yeah okay well we'll look at that we'll
figure something out for that it's weird
figure something out for that it's weird
because it does drastically change on
because it does drastically change on
the N percentage time based on how many
the N percentage time based on how many
M you have going
on um that's normal though it should get
on um that's normal though it should get
better with more M so something screw
better with more M so something screw
there like if I have like kind of a
there like if I have like kind of a
smaller M on this one that has five
smaller M on this one that has five
active agents it says M times at like 1%
active agents it says M times at like 1%
but if I were to like shoot it up to
but if I were to like shoot it up to
more ends then it would increase for
more ends then it would increase for
some reason which I think is just the
some reason which I think is just the
overhead it's possible that the net is
overhead it's possible that the net is
just bigger like the B the optimal batch
just bigger like the B the optimal batch
size is going to depend on the um the
size is going to depend on the um the
network architecture as well sure so
network architecture as well sure so
don't worry about that we've got which I
don't worry about that we've got which I
just did like a super simple Network
just did like a super simple Network
architecture I basically just did like a
architecture I basically just did like a
well yeah linear I haven't timed like
well yeah linear I haven't timed like
ped entity encoders
ped entity encoders
before ah so maybe we'll have to fiddle
before ah so maybe we'll have to fiddle
with that that's no big deal though I
with that that's no big deal though I
can
can
help um yeah I just want to make sure
help um yeah I just want to make sure
that we actually get like know the
that we actually get like know the
sooner we get stuff where it's like hey
sooner we get stuff where it's like hey
guys you should consider this Sim
guys you should consider this Sim
because it's way faster than yours and
because it's way faster than yours and
it's actually like a quarter of the code
it's actually like a quarter of the code
or
whatever yeah I think I only really took
whatever yeah I think I only really took
Liberty in two places away from their
Liberty in two places away from their
standard
standard
implementation one or I guess three one
implementation one or I guess three one
was what we talked about but doing the
was what we talked about but doing the
grid style Collision instead of bounding
grid style Collision instead of bounding
instead of the what is it bounding
instead of the what is it bounding
volume
volume
hierarchy the other was the stepping of
hierarchy the other was the stepping of
the Dynamics I wasn't certain how their
the Dynamics I wasn't certain how their
action range was negative pi to Pi it
action range was negative pi to Pi it
just mathematically didn't make sense to
just mathematically didn't make sense to
me so I made negative one to one
me so I made negative one to one
negative pi to Pi should be it can turn
negative pi to Pi should be it can turn
180° in either
direction right if you see how if you
direction right if you see how if you
see how they the equations that they use
see how they the equations that they use
to to step through the Dynamics it
to to step through the Dynamics it
doesn't make sense how pi to Pi because
doesn't make sense how pi to Pi because
of the Tage or whatever yeah okay yeah
of the Tage or whatever yeah okay yeah
fine that could we can ask him and if
fine that could we can ask him and if
not like ask him in the slack and if not
not like ask him in the slack and if not
it's probably a
it's probably a
bug
bug
yeah but cuz yeah the second I switch
yeah but cuz yeah the second I switch
it's negative 1 to one like the the
it's negative 1 to one like the the
actions actually made sense like half
actions actually made sense like half
the actions went One Direction the other
the actions went One Direction the other
half went the other direction at
half went the other direction at
increasing degrees
increasing degrees
of the
of the
turn okay we
turn okay we
might we'll see how this goes we might
might we'll see how this goes we might
want breaking it apart into another this
want breaking it apart into another this
is I'm seeing right here this is like
is I'm seeing right here this is like
um what would you even call
um what would you even call
this it's not a
this it's not a
point a vector or something I don't know
point a vector or something I don't know
we we like whatever the standard name is
we we like whatever the standard name is
for position velocity information like
for position velocity information like
this
this
um well I guess you have gold position
um well I guess you have gold position
but not
but not
velocity something there are a lot of
velocity something there are a lot of
these yeah I mean there's going to be a
these yeah I mean there's going to be a
lot of those because there's
lot of those because there's
trajectories and then there's current
trajectories and then there's current
and then there's goal effectively well
and then there's goal effectively well
might have to compress some struck
might have to compress some struck
because it's presumably you're going to
because it's presumably you're going to
be getting information from like the
be getting information from like the
same point you need the X Y and Z at the
same point you need the X Y and Z at the
same time
same time
right you really only need the
right you really only need the
trajectory information to get the first
trajectory information to get the first
point okay then X Y and Z like you're
point okay then X Y and Z like you're
GNA need and then like yeah you you
GNA need and then like yeah you you
don't like go get the x of every point
don't like go get the x of every point
right like you go it like for a point
right like you go it like for a point
you get the X Y and Z though
you get the X Y and Z though
right when you access it I'm like for a
right when you access it I'm like for a
point yeah yeah what I'm doing is I'm
point yeah yeah what I'm doing is I'm
setting you set the XYZ based off of the
setting you set the XYZ based off of the
first point of the TR trajectory XYZ to
first point of the TR trajectory XYZ to
set up the spawn
set up the spawn
yeah but when you're doing stuff in
yeah but when you're doing stuff in
general right when you're doing stuff in
general right when you're doing stuff in
general like you're going to go access
general like you're going to go access
the X the Y and the Z you're not going
the X the Y and the Z you're not going
to go access all the x's and all the Y's
to go access all the x's and all the Y's
and all the Z's right no no no you only
and all the Z's right no no no you only
access like the current so in that case
access like the current so in that case
then even putting into a struct should
then even putting into a struct should
actually improve uh memory continuity as
well
well
right well would it change anything
right well would it change anything
because if you have the X through the VZ
because if you have the X through the VZ
doesn't it all sit in the same space
doesn't it all sit in the same space
like in contiguous
like in contiguous
memory based on how it's aligned in the
memory based on how it's aligned in the
struct uh okay for this one yes but what
struct uh okay for this one yes but what
about
about
here I guess these ones these ones
here I guess these ones these ones
don't no because they're in their
don't no because they're in their
pointers yes you understand this right
pointers yes you understand this right
and also how's there a single x y and
and also how's there a single x y and
z Oh cuz this is one car it's one entity
z Oh cuz this is one car it's one entity
okay this is one car okay that's not as
okay this is one car okay that's not as
bad then that's yeah one entity type or
bad then that's yeah one entity type or
one entity with you know however many
one entity with you know however many
types for the entirety of the the thing
types for the entirety of the the thing
so I mean we just depending on the usage
so I mean we just depending on the usage
patterns we'll figure out what struct
patterns we'll figure out what struct
what needs to be a struct and what
what needs to be a struct and what
doesn't sure sure
sure I think definitely like this is an
sure I think definitely like this is an
end where if we keep it nice and clean
end where if we keep it nice and clean
for them it'll make it a lot easier
for them it'll make it a lot easier
because you know they don't they don't
because you know they don't they don't
know like they don't have people who are
know like they don't have people who are
is familiar with lower level Dev
is familiar with lower level Dev
fair enough I I will say the grid
fair enough I I will say the grid
Collision stuff is a little bit of a a
Collision stuff is a little bit of a a
mind but it does work and it is
mind but it does work and it is
simple if you can understand like all of
simple if you can understand like all of
the arrays that are in place map so this
the arrays that are in place map so this
is the map
is the map
binary yeah so in the if you want to
binary yeah so in the if you want to
start on the python file you you could
start on the python file you you could
look at that before going to map binary
look at that before going to map binary
because before did this change no it
because before did this change no it
hasn't changed since we looked at it
hasn't changed since we looked at it
okay so yeah this is like your just
okay so yeah this is like your just
you're dumping a whole bunch of data
you're dumping a whole bunch of data
into a binary file and then you're
into a binary file and then you're
reading yep you're very carefully
reading yep you're very carefully
reading it knowing that this yeah if you
reading it knowing that this yeah if you
mess with anything in here it it will
mess with anything in here it it will
nuke the file for sure like yes we
nuke the file for sure like yes we
should
should
probably figure something out for that
probably figure something out for that
um yeah we'll have to look at this
um yeah we'll have to look at this
because this is
because this is
like yeah it's delicate yeah I and I see
like yeah it's delicate yeah I and I see
why you have it because it's like yeah
why you have it because it's like yeah
this is how you would do it but
this is how you would do it but
I mean iast yeah this is kind of similar
I mean iast yeah this is kind of similar
to like um my my loading code for
to like um my my loading code for
pytorch
pytorch
models right because I do the same thing
models right because I do the same thing
where I have to load layer by layer and
where I have to load layer by layer and
if you scroll anything you're just
if you scroll anything you're just
you're boned and there's nothing you can
you're boned and there's nothing you can
do about it and you won't get an error
do about it and you won't get an error
yeah it's actually extremely annoying if
yeah it's actually extremely annoying if
something's wrong because you just kind
something's wrong because you just kind
of have to go like line by line and and
of have to go like line by line and and
pray that the one thing you put in is
pray that the one thing you put in is
the right order well we have tests for
the right order well we have tests for
this right so what I do is I like I
this right so what I do is I like I
write a test that you'd write a
write a test that you'd write a
test you'd actually you should look at
test you'd actually you should look at
how I do my uh my pie torch test because
how I do my uh my pie torch test because
you could do something similar here
you could do something similar here
right so you like you essentially you
right so you like you essentially you
write a test that you dump the file from
write a test that you dump the file from
python you load it in C and then you
python you load it in C and then you
make sure that the elements you know
make sure that the elements you know
element by element in C it's the same as
element by element in C it's the same as
in Python once you've loaded it back in
in Python once you've loaded it back in
and then you're
and then you're
good so this is like one of the I I
good so this is like one of the I I
think you see I don't write a lot of
think you see I don't write a lot of
tests this is like the only type of
tests this is like the only type of
thing I will write a test for cuz
thing I will write a test for cuz
otherwise you're just
otherwise you're just
screwed yeah
okay you do not need to save the the on
okay you do not need to save the the on
line or whatever for the continues
let's
see so set active agents you like those
see so set active agents you like those
inside of actual uh brackets yeah
inside of actual uh brackets yeah
because it's like they're easy to just
because it's like they're easy to just
miss
miss
them I know I've gone back and forth on
them I know I've gone back and forth on
it but I like I think now it's just I
it but I like I think now it's just I
use brackets everywhere now that's fine
use brackets everywhere now that's fine
that's nothing Chang
that's nothing Chang
yeah so this just so that next thing
yeah so this just so that next thing
just checks to make sure that in the
just checks to make sure that in the
trajectory that we're only taking uh
trajectory that we're only taking uh
entities that are cons that are spawned
entities that are cons that are spawned
from the start so they don't you don't
from the start so they don't you don't
take an entity that spawns like in the
take an entity that spawns like in the
middle of the
middle of the
trajectory it's a it's it's a thing I
trajectory it's a it's it's a thing I
went over with them and slack because
went over with them and slack because
there's cases where like entities can
there's cases where like entities can
just like appear out of nowhere yeah and
just like appear out of nowhere yeah and
as well I don't write a lot of comments
as well I don't write a lot of comments
this is the type of thing I'd write a
this is the type of thing I'd write a
comment right okay when it's like a like
comment right okay when it's like a like
you can't understand what the hell this
you can't understand what the hell this
is for like because this is dependent on
is for like because this is dependent on
the
the
data yeah okay relative
2D uhhuh and
then and then they scale the size just
then and then they scale the size just
down by a little bit okay
so why do we have malx in here does this
so why do we have malx in here does this
get called doesn't this get called a
get called doesn't this get called a
bunch it gets called one time at an N at
bunch it gets called one time at an N at
a net
a net
oh give agent count
oh give agent count
times cuz you just did okay
times cuz you just did okay
whatever I would have done it outside
whatever I would have done it outside
but it's not a big deal
this is now where you get into Collision
this is now where you get into Collision
land no this makes sense this is the
land no this makes sense this is the
coordinates on the grid of a
point
yeah count * 2 +
1 so I'm with in each grid cell mhm I'm
1 so I'm with in each grid cell mhm I'm
saving the count of how many entities
saving the count of how many entities
are actually in there okay and then
are actually in there okay and then
giving it the entity and the geometry
giving it the entity and the geometry
index the geometry index is relative to
index the geometry index is relative to
the road and how it's set up because the
the road and how it's set up because the
road objects have a in Geometry array
road objects have a in Geometry array
that is just a bunch of XYZ points so
that is just a bunch of XYZ points so
you don't want to have to iterate
you don't want to have to iterate
through all of the geometry inside of
through all of the geometry inside of
the road object if it's inside th grid
the road object if it's inside th grid
cell you want to save the actual exact
cell you want to save the actual exact
line
line
segment of where it I guess of the
segment of where it I guess of the
position of that road segment so when
position of that road segment so when
you check grid cell 45 you know that it
you check grid cell 45 you know that it
is Road segment 5 and geometry 409,000
is Road segment 5 and geometry 409,000
or
or
something so it's it's an optimization
something so it's it's an optimization
to not have to loop again by just adding
to not have to loop again by just adding
one more object to the grid cells
one more object to the grid cells
parameter
okay and then the count is there just to
okay and then the count is there just to
make sure I get perfect memory
make sure I get perfect memory
allocation in the next
step in the next
step in the next
step when you initialize the grid
step when you initialize the grid
map or the next next function
map or the next next function
whatever okay so I let me see if I can
whatever okay so I let me see if I can
get this so This is called when at the
get this so This is called when at the
start a nid grid map is called at the
start a nid grid map is called at the
start correct
top left and bottom right points to the
top left and bottom right points to the
map this somehow has top left and bottom
map this somehow has top left and bottom
right points of the map in it wait why
right points of the map in it wait why
is this you you find it so you reading
is this you you find it so you reading
through yeah so that's just like setting
through yeah so that's just like setting
up whatever the a current point is
up whatever the a current point is
that's relative to itself and then I
that's relative to itself and then I
Loop throughout the whole thing to find
Loop throughout the whole thing to find
the dimensions of the universe yep
the dimensions of the universe yep
that's fine
can this change when more stuff
spawns can what can this change when
spawns can what can this change when
more stuff spawns
more stuff spawns
in ah so so the way that is set
in ah so so the way that is set
up nothing should be spawning in which
up nothing should be spawning in which
is why in the beginning you set it up
is why in the beginning you set it up
such that only entities that exist from
such that only entities that exist from
the beginning are going to be in uh we
the beginning are going to be in uh we
will reevaluate for Tokyo puff
will reevaluate for Tokyo puff
mode yes we can re you can reevaluate
mode yes we can re you can reevaluate
for Tokyo
for Tokyo
puff is there a map of all of Tokyo is
puff is there a map of all of Tokyo is
that a thing yes it is so that's why I
that a thing yes it is so that's why I
brought it up that's actually a thing
brought it up that's actually a thing
yeah yeah Japan the Country released it
yeah yeah Japan the Country released it
via the department of like
via the department of like
Transportation or whatever the
Transportation or whatever the
could you imagine if we did that though
could you imagine if we did that though
dud it' be sick Tokyo puff can you yeah
dud it' be sick Tokyo puff can you yeah
I know it would be freaking
I know it would be freaking
awesome it's basically building GTA 6
awesome it's basically building GTA 6
before GTA 6 exists or whatever well
before GTA 6 exists or whatever well
everything is before GTA 6 exist
that's but it's not far off I mean
that's but it's not far off I mean
realistically if you just dropped like a
realistically if you just dropped like a
million cars inside
million cars inside
it that's G to be so freaking cool
it that's G to be so freaking cool
man okay yeah dude just let let project
man okay yeah dude just let let project
Tokyo puff evolve all right it's like
Tokyo puff evolve all right it's like
it's it's in
it's it's in
range now if we do this grid style
range now if we do this grid style
initialization of my caching let's not
initialization of my caching let's not
don't tell n don't tell NYU until we
don't tell n don't tell NYU until we
actually have something cuz they're
actually have something cuz they're
going to be like what the
going to be like what the
hell that' be
hell that' be
awesome yeah I mean that's a
awesome yeah I mean that's a
yeah Tokyo we can we can knock that up
yeah Tokyo we can we can knock that up
in part part
in part part
four
four
yeah well no I mean don't tell them
yeah well no I mean don't tell them
because they're going to just be like
because they're going to just be like
what like you know they would have to
what like you know they would have to
build a whole another end with the way
build a whole another end with the way
they have it in Madrona I'm sure um oh
they have it in Madrona I'm sure um oh
yeah I mean yeah map the grid cell thing
yeah I mean yeah map the grid cell thing
may or may not be totally screwed by the
may or may not be totally screwed by the
way like I think you just use like
way like I think you just use like
larger grid cells and you're probably
larger grid cells and you're probably
fine well that's that's good to know
fine well that's that's good to know
because I mean the grid cell I think is
because I mean the grid cell I think is
reasonably fast
reasonably fast
enough yeah I wouldn't I wouldn't be
enough yeah I wouldn't I wouldn't be
surprised if you can just use larger
surprised if you can just use larger
grid cells like we might also just have
grid cells like we might also just have
to have a list of like active cells or
to have a list of like active cells or
something so what we might do is if a
something so what we might do is if a
grid cell has nothing in it you don't
grid cell has nothing in it you don't
have to process it right sure yeah you
have to process it right sure yeah you
can do that so we can probably I think I
can do that so we can probably I think I
talked about this architecture with you
talked about this architecture with you
before
before
anyways yeah I don't think adding the
anyways yeah I don't think adding the
more maps that was going to make it
more maps that was going to make it
substantially harder to refactor because
substantially harder to refactor because
in my mind the more maps thing should
in my mind the more maps thing should
not be very much Cod at all I think it's
not be very much Cod at all I think it's
just a matter of doing the map to binary
just a matter of doing the map to binary
file yep one time for all maps ahead of
file yep one time for all maps ahead of
time yep and you literally have example
time yep and you literally have example
like you have example of this in the
like you have example of this in the
puffer grid
puffer grid
right I think I did it for Tower climb
right I think I did it for Tower climb
too yeah um I tried to make sure there's
too yeah um I tried to make sure there's
example code of
example code of
everything yeah CU I did multimap for
everything yeah CU I did multimap for
Tower climb and it was
Tower climb and it was
fine I just wasn't certain about exactly
fine I just wasn't certain about exactly
how I do it for this one for multi map
how I do it for this one for multi map
because I'm like writing to a file and I
because I'm like writing to a file and I
don't know if we wanted to write like
don't know if we wanted to write like
10,000 binary
files why does it have to write to a
files why does it have to write to a
file
file
I
I
mean because it it's reading from the
mean because it it's reading from the
file I mean I guess you could argue it
file I mean I guess you could argue it
you could just send it directly into an
you could just send it directly into an
array or something but you could I think
array or something but you could I think
we don't need
we don't need
um well you can do it like this for now
um well you can do it like this for now
let's say we we we'll see that that
let's say we we we'll see that that
that's one of the reasons why I want
that's one of the reasons why I want
that's also pretty easy to swap because
that's also pretty easy to swap because
it's like the save and load logic is
it's like the save and load logic is
going to be the same it's just going to
going to be the same it's just going to
be fad versus
be fad versus
index M so that's not a big
deal okay so this was my clever
deal okay so this was my clever
way yeah so this is now my yeah this is
way yeah so this is now my yeah this is
my clever way of getting the nearest
points by say so I'm cash I'm going to
points by say so I'm cash I'm going to
cach in each grid
cach in each grid
cell the vision
cell the vision
of if you're at that cell of your of all
of if you're at that cell of your of all
the nearest
entities because all of the road objects
entities because all of the road objects
are static and they never change out the
are static and they never change out the
whole point you can do it one time and
whole point you can do it one time and
store your vision for every cell ahead
store your vision for every cell ahead
of
time store your vision for every
time store your vision for every
cell yeah so at every location on the
cell yeah so at every location on the
grid
grid
M you can store what road objects you
M you can store what road objects you
see and save them in the order of the
see and save them in the order of the
closest ones by adding them into it in
closest ones by adding them into it in
the order of the spir of a spiral
the order of the spir of a spiral
pattern around yourself if you index oh
pattern around yourself if you index oh
I've done that before okay yeah I've
I've done that before okay yeah I've
done that
done that
before so this is just creating the
before so this is just creating the
spiral offset but this spiral offset's
spiral offset but this spiral offset's
only one grid cell
only one grid cell
right or do you
right or do you
multiply oh okay Max wait
Max offsets is the vision range
squared is this an example this is it
is I I have some code at the bottom did
is I I have some code at the bottom did
I or did I take it out I think I took it
I or did I take it out I think I took it
out I had a print file thing at the end
out I had a print file thing at the end
there I think I took it out one percent
there I think I took it out one percent
four okay steps to take steps take plus
four okay steps to take steps take plus
yeah
okay spiral C code is actually like
okay spiral C code is actually like
slightly more annoying than you would
slightly more annoying than you would
think it is to get right oh it's
think it is to get right oh it's
extremely annoying yeah I've done this
extremely annoying yeah I've done this
several times and it's just like this
several times and it's just like this
it's like this like you know CS
it's like this like you know CS
101 like thing yeah but it's just like
101 like thing yeah but it's just like
it's actually really annoying to get it
it's actually really annoying to get it
right cuz like you're like thinking in
right cuz like you're like thinking in
your head like is it that much like yes
your head like is it that much like yes
intuitively when you read it it actually
intuitively when you read it it actually
does make sense how it's a spiral yeah
does make sense how it's a spiral yeah
it's I I've written that function
it's I I've written that function
several times it's extremely
several times it's extremely
annoying
H all right yeah here's all the caching
H all right yeah here's all the caching
of the Spiral at each
of the Spiral at each
cell and so I save the XY position yeah
cell and so I save the XY position yeah
I'm caching the
spiral but then the entities all move
spiral but then the entities all move
the next step don't
the next step don't
they none of the road objects none of
they none of the road objects none of
the road segments do okay so your
the road segments do okay so your
cash and then you
cash and then you
move so then when you move cells you
move so then when you move cells you
have to but you don't have to rec
have to but you don't have to rec
recompute Road positions until you move
recompute Road positions until you move
cells okay and you don't even actually
cells okay and you don't even actually
have to recalculate Road position oh are
have to recalculate Road position oh are
yes you do sorry at when you're
yes you do sorry at when you're
Computing observations you you can
Computing observations you you can
compute Road you have to compute the
compute Road you have to compute the
road observation every step as always
road observation every step as always
but you don't have to compute which road
but you don't have to compute which road
segments are near
you
you
co yeah if you sort these one thing you
co yeah if you sort these one thing you
could try for a perf hack is just like
could try for a perf hack is just like
reduce it to 32 the nearest 32 points or
reduce it to 32 the nearest 32 points or
whatever oh yeah I've already changed
whatever oh yeah I've already changed
the vision range if you go from uh M 21
the vision range if you go from uh M 21
by 21 which is their range cuz each cell
by 21 which is their range cuz each cell
is uh five so 5 m is one grid Square so
is uh five so 5 m is one grid Square so
21 by 21 creates a 20 creates 10 on
21 by 21 creates a 20 creates 10 on
either side of your Center Point
either side of your Center Point
M which is equivalent to a 50 m radius 5
M which is equivalent to a 50 m radius 5
time 10 if you drop it to 11 by 11 it
time 10 if you drop it to 11 by 11 it
already it adds 100,000 steps per second
already it adds 100,000 steps per second
to it yeah okay
cool at some point I'm going to have to
cool at some point I'm going to have to
actually like help help you like really
actually like help help you like really
get into this and see what we can
get into this and see what we can
optimize
optimize
um but so far I think we're in a good
um but so far I think we're in a good
spot because I don't think that the map
spot because I don't think that the map
logic is going to dramatically
logic is going to dramatically
complicate this this is about as
complicate this this is about as
optimized as I wanted it for
optimized as I wanted it for
now if I wanted to optimize it even
now if I wanted to optimize it even
farther You could argue I could place
farther You could argue I could place
the parked cars inside of the cach as
the parked cars inside of the cach as
well it just makes indexing a little
well it just makes indexing a little
annoying you could also just use four
annoying you could also just use four
course
course
mate instead of
mate instead of
two also just use some more
two also just use some more
course oh okay yeah I think your Net's
course oh okay yeah I think your Net's
the slow piece
anyways yeah and the actual M logic
anyways yeah and the actual M logic
speed is up to like 1.2 million steps
speed is up to like 1.2 million steps
per second then you're
fine I mean if you get over 1.2 mil
fine I mean if you get over 1.2 mil
right like yeah you're going to have to
right like yeah you're going to have to
use four cores or whatever but still
use four cores or whatever but still
fine you're not going to have it on one
fine you're not going to have it on one
core I've realized anyways you're not
core I've realized anyways you're not
going to get away from multiprocessing
going to get away from multiprocessing
cuz you need the asnc factor so you're
cuz you need the asnc factor so you're
going to have two cors Le
anyways also the bigger networks as the
anyways also the bigger networks as the
networks get bigger it's fine to have
networks get bigger it's fine to have
smaller batches um where's the result
smaller batches um where's the result
that I had I just I have a 3 million
that I had I just I have a 3 million
peram Network training right now which
peram Network training right now which
is that's a big boy yeah it's big for
is that's a big boy yeah it's big for
puffer but it's still fast you still get
puffer but it's still fast you still get
4 500k train speed with
4 500k train speed with
that oh wow really yeah it doesn't
that oh wow really yeah it doesn't
actually hurt you that
actually hurt you that
much
huh and it's actually it's going to get
huh and it's actually it's going to get
better when we have the
509s have you gotten yours yet I haven't
509s have you gotten yours yet I haven't
gotten any update from main gear yet as
gotten any update from main gear yet as
to where my uh Sunday it's going to be
to where my uh Sunday it's going to be
delivered this Sunday oh
delivered this Sunday oh
nice I know you ordered yours like few
nice I know you ordered yours like few
months ahead of mine I don't it's going
months ahead of mine I don't it's going
to be a while and then I have to figure
to be a while and then I have to figure
out if I order all of them or not
out if I order all of them or not
immediately
immediately
thereafter cuz the facility is going to
thereafter cuz the facility is going to
be done but
um so these two new ones are the three
mil those are nice graphs yeah they're
mil those are nice graphs yeah they're
really clean curves right with the new
really clean curves right with the new
stuff mhm so this is
stuff mhm so this is
muan this is a 100 billion steps 107
muan this is a 100 billion steps 107
billion are you still doing coign and
billion are you still doing coign and
kneeling on this are you just doing flat
kneeling on this are you just doing flat
yeah it is coine and Ne I don't know if
yeah it is coine and Ne I don't know if
it needs to
be what made you jump on the annealing
be what made you jump on the annealing
train because before you were like hard
train because before you were like hard
against it we've had linear uh it was
against it we've had linear uh it was
the breakout result requiring linear
the breakout result requiring linear
analing to do anything
and then is it okay well if we're going
and then is it okay well if we're going
to do a
to do a
kneeling may as well do a better job
kneeling may as well do a better job
yeah cosign anding is like the default
yeah cosign anding is like the default
across everything in modern AI these
across everything in modern AI these
days so and then this is a new one it's
days so and then this is a new one it's
actually very tricky to optimize really
actually very tricky to optimize really
hard Ms like this because look this is
hard Ms like this because look this is
six billion steps and it looks like
six billion steps and it looks like
they're Crossing it looked way better
they're Crossing it looked way better
before this
before this
right so it's kind of sketch
right so it's kind of sketch
yeah I can see
yeah I can see
that I have some cool graphs though yeah
that I have some cool graphs though yeah
okay so the wrong code where's your code
okay so the wrong code where's your code
there we
go okay so this is your caching code
go okay so this is your caching code
correct so I basically I do I read it
correct so I basically I do I read it
one time and then I store it the next
one time and then I store it the next
time in this Loop so I can have the
time in this Loop so I can have the
optimal memory
allocation okay let me see what this is
allocation okay let me see what this is
cach neighbor
offsets so this is
offsets so this is
you getting the cell count correct which
you getting the cell count correct which
is
when does this get
when does this get
called the next cell mean the next line
called the next cell mean the next line
no but when does
no but when does
this cash one time in an it right after
this cash one time in an it right after
an
an
it oh I see so for every cell you go and
it oh I see so for every cell you go and
you do the spiral around it yep okay
you do the spiral around it yep okay
yeah now that's
yeah now that's
reasonable get neighbor so I'm happy
reasonable get neighbor so I'm happy
with this you added like an extra 60 70
with this you added like an extra 60 70
lines an initial perf optimization you
lines an initial perf optimization you
know we'll see whether we come up with a
know we'll see whether we come up with a
better one after but this one will more
better one after but this one will more
be more than enough to get us like on
be more than enough to get us like on
par with the current GPU Drive project
par with the current GPU Drive project
and not allar actually way faster than
and not allar actually way faster than
the current GPU Drive project I think
the current GPU Drive project I think
that's the state of
that's the state of
this right I'll have to think about
this right I'll have to think about
whether this whether this scales to
whether this whether this scales to
Tokyo
Tokyo
puff uh we'll have to think about that
puff uh we'll have to think about that
but this will this will do GPU drive
but this will this will do GPU drive
just
fine okay you have
fine okay you have
yourit you pass
this do your
this do your
inits free
inits free
[Music]
[Music]
initialized
okay this is the move logic with the tan
okay this is the move logic with the tan
Shenanigans yeah let me let me link you
Shenanigans yeah let me let me link you
the the thing so
the the thing so
I mean you can see what I did yeah I'm
I mean you can see what I did yeah I'm
not going they I'm not going to worry
not going they I'm not going to worry
about the Dynamics model until they
about the Dynamics model until they
complain about
complain about
it
okay that is
okay that is
fine intersection code where does it
fine intersection code where does it
spend all the time at the moment is it
spend all the time at the moment is it
in the Collision
in the Collision
checks mostly Collision check yeah
checks mostly Collision check yeah
because it's
because it's
uh I haven't done a recent profile but
uh I haven't done a recent profile but
it's because it's going through every
it's because it's going through every
single vehicle entity every single
single vehicle entity every single
step
step
yep check neighbors is basically a mini
yep check neighbors is basically a mini
version of the Spiral but only for a 3X3
version of the Spiral but only for a 3X3
around yourself
mhm it's only called for
Collision but it does it every single
Collision but it does it every single
car so we're going to get a little
car so we're going to get a little
concerned with like being overly reliant
concerned with like being overly reliant
on the spiral pattern at some point um
on the spiral pattern at some point um
I'm trying to think if that's going
I'm trying to think if that's going
to honestly that might just scale to
to honestly that might just scale to
everything for all I
know the only thing that I think is like
know the only thing that I think is like
possible there is
um I guess we'll have to see how much
um I guess we'll have to see how much
data is in like the big ass Tokyo map or
data is in like the big ass Tokyo map or
whatever eventually
whatever eventually
yeah all it comes down to is how many
yeah all it comes down to is how many
entities are going to be in a
Cell yeah and that can techically be
Cell yeah and that can techically be
dynamic it can technically that could be
dynamic it can technically that could be
dynamic it's just like memory IND
Direction and then you got some annoying
Direction and then you got some annoying
geometry from 9th grade um in here yeah
geometry from 9th grade um in here yeah
it's it's really annoying how like the
it's it's really annoying how like the
ninth grade geometry is actually
hard when you have you think I remember
hard when you have you think I remember
this stuff I had to freaking I had to
this stuff I had to freaking I had to
chat gbt my way to Victory on this stuff
chat gbt my way to Victory on this stuff
and then you got to make sure that it
and then you got to make sure that it
doesn't get it
doesn't get it
wrong yeah I mean luckily that's why
wrong yeah I mean luckily that's why
visualization helps a lot like
visualization helps a lot like
like all I did was just draw a line from
like all I did was just draw a line from
where it was supposed to go and then if
where it was supposed to go and then if
it's in the middle of nowhere clearly my
it's in the middle of nowhere clearly my
math is wrong somewhere
yeah Collision boxes as a debug tool are
yeah Collision boxes as a debug tool are
really
good hello hey Aaron we're on stream by
good hello hey Aaron we're on stream by
the way yeah yeah no worries um I just
the way yeah yeah no worries um I just
want to let you know I've got that sweep
want to let you know I've got that sweep
running mhm um I hit a couple of the
running mhm um I hit a couple of the
weird pain points on the sweep we can
weird pain points on the sweep we can
chat about it tomorrow as as when we ALS
chat about it tomorrow as as when we ALS
look at all these results sounds good
look at all these results sounds good
we have uh I have now run 300 billion
we have uh I have now run 300 billion
steps worth of neural MMO three
experiments
experiments
wow
um we should figure out a way to speed
um we should figure out a way to speed
up my eval because getting the right
up my eval because getting the right
eval at the end is taking
eval at the end is taking
forever oh yeah that's easy I can fix
forever oh yeah that's easy I can fix
that's
easy yeah it's probably point it's just
easy yeah it's probably point it's just
bundling too many points together just
bundling too many points together just
increase the uh the eval interval you'll
increase the uh the eval interval you'll
be
be
good no no no uh I'm doing a custom eval
good no no no uh I'm doing a custom eval
cuz I need to I want to eval over all of
cuz I need to I want to eval over all of
the tasks
oh okay yeah I can figure something out
oh okay yeah I can figure something out
with that yeah I figure I figure we'll
with that yeah I figure I figure we'll
chat about all this stuff tomorrow once
chat about all this stuff tomorrow once
we also have some graphs okay sounds
we also have some graphs okay sounds
good thanks for the update
good thanks for the update
yep see you later later
Aon it's kind of nice when you just like
Aon it's kind of nice when you just like
hang around on Discord and stream all
hang around on Discord and stream all
day it's like yeah just updates come in
day it's like yeah just updates come in
whenever it's like how do we schedule a
whenever it's like how do we schedule a
thing oh we just always
thing oh we just always
here um yeah it it's it's pretty good
here um yeah it it's it's pretty good
system
where are you now you on are you on
where are you now you on are you on
vehicle collisions I'm looking at this
vehicle collisions I'm looking at this
whatever this
whatever this
is okay so there's four lines to a
is okay so there's four lines to a
rectangle right so it's checking to see
rectangle right so it's checking to see
if each line segment is coll colliding
if each line segment is coll colliding
with another four lines of the other
car let's
see
see
okay that was probably fun to
okay that was probably fun to
write oh yeah really fun
now but I expected you had to have to do
now but I expected you had to have to do
some stuff like this like I mean it's
some stuff like this like I mean it's
it's a midsize
project I'll say medium
project I'll say medium
large well it'll be large by the time
large well it'll be large by the time
you have Tokyo puff in there
you have Tokyo puff in there
Tokyo papa is like a grand scale project
Tokyo papa is like a grand scale project
are you sure it's not going to just end
are you sure it's not going to just end
up being like 2K Total
Lines okay fine maybe the lines won't be
Lines okay fine maybe the lines won't be
that much but in terms of how it sounds
that much but in terms of how it sounds
and what it does
and what it does
yeah it's pretty funny when I tell
yeah it's pretty funny when I tell
people with neural MMO that there's like
people with neural MMO that there's like
a Dynamic economy in
there they're like oh this looks like a
there they're like oh this looks like a
pretty cool end yeah it's like this it's
pretty cool end yeah it's like this it's
like oh and there's a dynamic con where
like oh and there's a dynamic con where
you can buy and trade stuff with the
you can buy and trade stuff with the
other agents they're like
what yeah and even then your line of
what yeah and even then your line of
cone is I think still maybe even less
cone is I think still maybe even less
than this no it's not it's like 2,800
than this no it's not it's like 2,800
for
for
nuro oh okay never mind now nuro is
nuro oh okay never mind now nuro is
big I think Nur currently has the seat
big I think Nur currently has the seat
for the hardest like the hardest fast
for the hardest like the hardest fast
and you can use I guess except for go go
and you can use I guess except for go go
is like you need you kind of need search
is like you need you kind of need search
design for it
design for it
yeah I I think you have to have search
yeah I I think you have to have search
to solve
that well okay yeah maybe you're right
that well okay yeah maybe you're right
maybe toky puff will only be like double
maybe toky puff will only be like double
the size of the current M I don't think
the size of the current M I don't think
it needs to be that much larger the only
it needs to be that much larger the only
thing I could think of is if the
thing I could think of is if the
freaking data files massive which I'm
freaking data files massive which I'm
sure it
is yeah memory will be
is yeah memory will be
a but it's possible that we just like
a but it's possible that we just like
have to pre-compute a bunch of stuff on
have to pre-compute a bunch of stuff on
that file anyways right so it might just
that file anyways right so it might just
be that we have a pre-processing
be that we have a pre-processing
script oh there's for sure going to have
script oh there's for sure going to have
to be a pre-processing CU it's and the
to be a pre-processing CU it's and the
pre-processing unfortunately may take
pre-processing unfortunately may take
like
like
forever well we'll just do it and we'll
forever well we'll just do it and we'll
upload it
upload it
somewhere
yeah you know the puffer color scheme is
yeah you know the puffer color scheme is
going to suit that really well right
going to suit that really well right
like this freaking sci-fi Tokyo whatever
like this freaking sci-fi Tokyo whatever
yeah it's going to be sick it's going to
yeah it's going to be sick it's going to
be yeah it's going to be good
yeah pick which I should tell Captain I
yeah pick which I should tell Captain I
fix this box
yeah so I took all of the max values
yeah so I took all of the max values
from the GPU Drive um constants so those
from the GPU Drive um constants so those
are just copy pasted in terms of
normalization yeah so these checks were
normalization yeah so these checks were
total pain in the ass one can tell um oh
total pain in the ass one can tell um oh
wait no this is OBS never mind we're out
wait no this is OBS never mind we're out
of Collis cool yeah we're in computer
of Collis cool yeah we're in computer
observations
observations
now um the the one one of the
now um the the one one of the
differences that I took here as opposed
differences that I took here as opposed
to them at the moment is I did not
to them at the moment is I did not
include the other types of road or what
include the other types of road or what
are they called like map objects inside
are they called like map objects inside
of observations and inside my Collision
of observations and inside my Collision
checks because I felt that there was no
checks because I felt that there was no
point in having like your lanes in there
point in having like your lanes in there
until you actually were using Lanes as a
until you actually were using Lanes as a
part of your Collision checks cuz right
part of your Collision checks cuz right
now it's just Road edges and and I
now it's just Road edges and and I
talked to them about it they said that
talked to them about it they said that
they really only put in the other stuff
they really only put in the other stuff
because they were doing some imitation
because they were doing some imitation
learning at first and then eventually
learning at first and then eventually
they want to do Lane stuff but
they want to do Lane stuff but
that it's just a part of their OBS like
that it's just a part of their OBS like
at this point for no point yep you're
at this point for no point yep you're
good no wor
good no wor
there like eventually adding Lanes is
there like eventually adding Lanes is
like a 30 minute change it's like not a
problem yeah it'll be funny to figure
problem yeah it'll be funny to figure
out if we can get like you know are you
out if we can get like you know are you
driving
legally there's probably a pretty simple
legally there's probably a pretty simple
way I would imagine to man to get it to
way I would imagine to man to get it to
stay in the lane
mhm it's probably more of a reward
mhm it's probably more of a reward
tuning thing than
tuning thing than
anything oh is Tokyo is going to be uh
anything oh is Tokyo is going to be uh
the physics is going to become 3D though
the physics is going to become 3D though
is the only other thing with
is the only other thing with
that uh that's fine you just add one
that uh that's fine you just add one
more parameter to the uh Collision to
more parameter to the uh Collision to
the grid Collision grid just
the grid Collision grid just
XYZ we can just add some ramps in there
XYZ we can just add some ramps in there
for
for
fun I mean in the this data set does
fun I mean in the this data set does
have Z they just didn't use
have Z they just didn't use
it yeah but I think the Collision checks
it yeah but I think the Collision checks
right um the Collision the box now can
right um the Collision the box now can
be angled in
be angled in
3D yeah the physics gets
3D yeah the physics gets
annoying or I guess not even physics
annoying or I guess not even physics
just
just
geometry I I'd have to grock that I
geometry I I'd have to grock that I
don't really know how to
don't really know how to
do whatever Vector math that is off the
do whatever Vector math that is off the
top of my head
top of my head
well we can just make it not like pitch
well we can just make it not like pitch
or
whatever okay reset
91 yeah so my logging is a little weird
91 yeah so my logging is a little weird
I will admit
I will admit
but be because
but be because
okay here's what
okay here's what
happens I don't have masking right
happens I don't have masking right
so when you reach the
so when you reach the
goal you no longer get another reward
goal you no longer get another reward
after it and you don't get penalized for
after it and you don't get penalized for
collisions afterwards anymore because
collisions afterwards anymore because
theoretically you're teleported away to
theoretically you're teleported away to
Infinity land
mhm yeah it's rough cuz we're going to
mhm yeah it's rough cuz we're going to
need masking at some point in this but
need masking at some point in this but
it's
it's
fine fine to do it like this for now
fine fine to do it like this for now
you're still going to be doing pretty
you're still going to be doing pretty
well yeah that that was a huge stop
well yeah that that was a huge stop
train that can stop training from
train that can stop training from
working though um if it gets too
sparse yeah I mean we'll just have to
sparse yeah I mean we'll just have to
see how well this does on Multi map mean
see how well this does on Multi map mean
it it maybe it can just figure it out I
it it maybe it can just figure it out I
don't know yeah
Sor I'm going to unplug my car
all
all
right we're
GOI oh you're in render now okay yeah I
GOI oh you're in render now okay yeah I
think
think
like I don't know what you wanted me to
like I don't know what you wanted me to
review because like yeah the Collision
review because like yeah the Collision
logic is a little tough yeah there's
logic is a little tough yeah there's
some caching but like I don't see how
some caching but like I don't see how
the map logic is going to make any of
the map logic is going to make any of
that harder
um okay this is a Kamehameha right here
um okay this is a Kamehameha right here
but holy Kamehameha B man it's pretty
deep but it's render
deep but it's render
code I'm going to have to make a
code I'm going to have to make a
freaking script that goes through the
freaking script that goes through the
code base and adds like aski Kamehameha
code base and adds like aski Kamehameha
to any of these in
comments yeah I mean I don't know it's
comments yeah I mean I don't know it's
it's it's looping over each a active
it's it's looping over each a active
agents observations to then draw the
agents observations to then draw the
lines the spider web themselves
out you can probably also seven there
out you can probably also seven there
are also seven nested if statements
are also seven nested if statements
but
but
whatever I'm not going to get on your
whatever I'm not going to get on your
case for that right now so the map stuff
case for that right now so the map stuff
is what you wanted to really talk about
is what you wanted to really talk about
right yeah so I I was not really certain
right yeah so I I was not really certain
how to go about it because okay
how to go about it because okay
so I was originally thinking like okay
so I was originally thinking like okay
you probably don't want to write 10,000
you probably don't want to write 10,000
plus binary files at once and then store
plus binary files at once and then store
them in a folder CU I felt like that was
them in a folder CU I felt like that was
dumb you could just do that for
dumb you could just do that for
now
now
I mean I guess you
could are you fine with that I mean it's
could are you fine with that I mean it's
a little Jank do it for now it'll take
a little Jank do it for now it'll take
you like it'll take you a few minutes to
you like it'll take you a few minutes to
do that and because you're literally
do that and because you're literally
just calling your load code with a
just calling your load code with a
random index and you're
random index and you're
done um and then did should I follow the
done um and then did should I follow the
same way that they did for swapping
same way that they did for swapping
between levels because there's going to
between levels because there's going to
be some overhead every time you create
be some overhead every time you create
the cash but they did it every 2 million
the cash but they did it every 2 million
steps I think they resampled
steps I think they resampled
everyone how would you want resampling
everyone how would you want resampling
to go on the levels cuz you wouldn't
to go on the levels cuz you wouldn't
want it to be every single 91 steps cuz
want it to be every single 91 steps cuz
then the caching would nuke your
performance yeah so that's going to be
performance yeah so that's going to be
the thing that is probably going to
the thing that is probably going to
require some architecture changes at
require some architecture changes at
some point
I mean the way I did
I mean the way I did
it these Maps aren't huge right how much
it these Maps aren't huge right how much
memory these things take
up I've never actually checked how big
up I've never actually checked how big
is the file
I can check that real quick
MH 283
MH 283
kilobytes and then with the caching
kilobytes and then with the caching
stuff is the cache pretty big how big is
stuff is the cache pretty big how big is
that
that
object
ah I guess I could go based off of Max
ah I guess I could go based off of Max
size so let me just take a look at the
size so let me just take a look at the
code real
quick H how big is the
[Music]
cash okay so your grid cells just the
cash okay so your grid cells just the
grid cell count then the slots per cell
grid cell count then the slots per cell
how much is this Max entities per cell *
how much is this Max entities per cell *
2 + 1 so that's 21 times the grid cell
2 + 1 so that's 21 times the grid cell
so I think the grid is like 40 by it's
so I think the grid is like 40 by it's
like 50 by 50 so 2500
like 50 by 50 so 2500
time 20 so the
time 20 so the
50,000 ins of just grid cells 50,000 ins
50,000 ins of just grid cells 50,000 ins
so that's
so that's
just and then at each
cell you have
a vision range spiral of n squar of
a vision range spiral of n squar of
whoever your vision
whoever your vision
is
is
times Max entities times
times Max entities times
two so you actually do
two so you actually do
have like a ton of yeah that's
have like a ton of yeah that's
going to be like any megabytes at
going to be like any megabytes at
least I think I think it will be in the
least I think I think it will be in the
megabyte range I don't think it gets to
megabyte range I don't think it gets to
the gigabyte range but it may get close
the gigabyte range but it may get close
if your map is really big yeah well and
if your map is really big yeah well and
that's going to be an issue because like
that's going to be an issue because like
there are a lot of maps right it's like
there are a lot of maps right it's like
100k Maps or
100k Maps or
something I I thought it was smaller
something I I thought it was smaller
than that but maybe I forget how many
than that but maybe I forget how many
they had they had a lot of them um so
they had they had a lot of them um so
yeah I think it's at least 10K so what I
yeah I think it's at least 10K so what I
was going to try to see it's like oh can
was going to try to see it's like oh can
we just compute it for everything and
we just compute it for everything and
then just like hash the entire M
then just like hash the entire M
state but um
state but um
oh yeah that that's probably going to be
oh yeah that that's probably going to be
too much
[Music]
how many M are you using right now
how many M are you using right now
you're using like 128 M or whatever yeah
you're using like 128 M or whatever yeah
I'm using 128 right
I'm using 128 right
now okay so as a first order of business
now okay so as a first order of business
can you just like train on 128
M just randomly pick a map on in it
M just randomly pick a map on in it
randomly pick 100 just randomly pick 128
randomly pick 100 just randomly pick 128
Maps
Maps
yeah and then what just so every time I
yeah and then what just so every time I
go to
go to
it
it
write the file and then re and then
write the file and then re and then
upload it again literally all you have
upload it again literally all you have
to do is like pick 12s
to do is like pick 12s
over the no man just pick 128 Maps run
over the no man just pick 128 Maps run
your pre-processing script and then your
your pre-processing script and then your
C just loads it and you're
C just loads it and you're
done oh you're saying just just try it
done oh you're saying just just try it
out for 128 maps in in one go yeah I
out for 128 maps in in one go yeah I
mean you just yeah just run your
mean you just yeah just run your
pre-processing script to dump the 128
pre-processing script to dump the 128
maps and then you can load them in right
maps and then you can load them in right
just pick you know index one two 3 four
just pick you know index one two 3 four
whatever yeah just attach that to the
whatever yeah just attach that to the
name of the file yeah yeah and you're
name of the file yeah yeah and you're
done and then you'll be able to train on
done and then you'll be able to train on
128 you be able to get an idea of what
128 you be able to get an idea of what
happens when we do
that yeah I could do that
that yeah I could do that
mhm and then you know if we figure out
mhm and then you know if we figure out
what's screw with the batch sizes we do
what's screw with the batch sizes we do
like 256 or whatever um and then if you
like 256 or whatever um and then if you
have two workers you know we potentially
have two workers you know we potentially
can add an offset or something so that
can add an offset or something so that
it's 500 maps and now we're already kind
it's 500 maps and now we're already kind
of getting to something
of getting to something
reasonable okay so here's where I have a
reasonable okay so here's where I have a
another um
another um
[Music]
[Music]
mhm one
sec uh okay so if you go to my python
sec uh okay so if you go to my python
file here's where multimap I have an an
file here's where multimap I have an an
issue
with um observation size is dependent on
with um observation size is dependent on
how many of the active number cars there
how many of the active number cars there
are
are
which for this map is 67 num
which for this map is 67 num
OBS line
24 so it's based off of your it's based
24 so it's based off of your it's based
off of yourself plus the other amount of
off of yourself plus the other amount of
cars times the features times 200 is the
cars times the features times 200 is the
max you can see all the other
cars you can see potentially see all the
cars you can see potentially see all the
other cars what the hell's the point of
other cars what the hell's the point of
the Spiral if you can see all the other
the Spiral if you can see all the other
cars do not get them in the
cars do not get them in the
spiral you don't you no no no no no if
spiral you don't you no no no no no if
it's in the spiral you get them
it's in the spiral you get them
otherwise they're just a bunch of
otherwise they're just a bunch of
negative
ones so what is the maximum allowed
ones so what is the maximum allowed
number of Agents do we want to set is
number of Agents do we want to set is
the question just pick a number and take
the question just pick a number and take
the nearest nend
right I mean I can I can just blank face
right I mean I can I can just blank face
pick a number I guess I mean take 32 or
pick a number I guess I mean take 32 or
something they're not going to have more
something they're not going to have more
than 32 cars around you
anyways
anyways
right
uh
uh
mean I think you have more than 32 cars
mean I think you have more than 32 cars
and a I guess it's the radius is more
and a I guess it's the radius is more
than
than
3x3 cuz the radius is 50 m by 50 m what
3x3 cuz the radius is 50 m by 50 m what
what's isn't it don't you have the
what's isn't it don't you have the
spiral thing for nearest anyways
spiral thing for nearest anyways
right yeah it is okay so just stop when
right yeah it is okay so just stop when
you hit 32
you hit 32
done yeah I mean I can totally do that
done yeah I mean I can totally do that
it just matters if if we're going to
it just matters if if we're going to
lose any performance that's all I guess
lose any performance that's all I guess
we can just we see and then you know
we can just we see and then you know
what the really cool thing is with the
what the really cool thing is with the
the renderer is that you're going to
the renderer is that you're going to
actually be able to draw which cars that
actually be able to draw which cars that
it can see and which ones it can't if we
it can see and which ones it can't if we
need to debug
need to debug
it uh yeah I can actually I mean I think
it uh yeah I can actually I mean I think
you already saw
you already saw
that like you had the really cool OBS
that like you had the really cool OBS
thing well we can just you know we can
thing well we can just you know we can
just add some indicator if it can't see
just add some indicator if it can't see
the cars cuz it's hit Max like
um yeah I just shared my screen so you
um yeah I just shared my screen so you
can
can
see what
see what
uh how it does it so if I I just have it
uh how it does it so if I I just have it
pick a smaller number that's totally
pick a smaller number that's totally
fine if it hits the number it's
fine if it hits the number it's
filled and once it's filled there
filled and once it's filled there
matters like
matters like
yeah like arguably the cars yeah like
yeah like arguably the cars yeah like
these cars on the right arguably don't
matter and like these cars don't matter
matter and like these cars don't matter
we're we're going to be able to optimize
we're we're going to be able to optimize
a ton of this stuff like it doesn't
a ton of this stuff like it doesn't
matter just for now pick a number you'll
matter just for now pick a number you'll
be good it'll
be good it'll
learn all right that's fine yeah that's
learn all right that's fine yeah that's
fine your OBS is now a fixed size right
fine your OBS is now a fixed size right
yep yep and 200 Road points is probably
yep yep and 200 Road points is probably
too big that's probably killing your net
too big that's probably killing your net
perf
right there's a quite a bit of Road
right there's a quite a bit of Road
points but I mean I mean you probably
points but I mean I mean you probably
don't need this road Point like up the
don't need this road Point like up the
top it's they're sorted roughly by
top it's they're sorted roughly by
nearest anyways right correct it's
nearest anyways right correct it's
always sort of by nearest because you
always sort of by nearest because you
get you they're cashed in a spiral you
get you they're cashed in a spiral you
can literally drive just fine with the
can literally drive just fine with the
nearest 10 of
them I'll pick a number I think 10's too
them I'll pick a number I think 10's too
small yeah I think it's too small as
small yeah I think it's too small as
well for like Max perf but I 200 is
well for like Max perf but I 200 is
nutty like you'd be fine with 64 or
nutty like you'd be fine with 64 or
whatever and you'll be training at 1.5
whatever and you'll be training at 1.5
SPS and you'll be
SPS and you'll be
done for sure would definitely probably
done for sure would definitely probably
get to a million SPS if I if I picked
get to a million SPS if I if I picked
like 60 or something like you said like
like 60 or something like you said like
64 and 32 on 6432 call a day let's like
64 and 32 on 6432 call a day let's like
let's see this thing running on let's
let's see this thing running on let's
see this thing running on a bunch of M's
see this thing running on a bunch of M's
these Maps don't have buildings in them
these Maps don't have buildings in them
do they no no buildings damn that'd be
do they no no buildings damn that'd be
so
so
nice yeah it' be great for rendering if
nice yeah it' be great for rendering if
you could have like a little bit of like
we could add
we could add
some for the purposes of social media
some for the purposes of social media
sure I could randomly Place buildings
sure I could randomly Place buildings
there like man there are so many like
there like man there are so many like
City gen algorithms like that you could
City gen algorithms like that you could
just grab you just put it everywhere
just grab you just put it everywhere
that's not
that's not
Road not Road and not parked car for
Road not Road and not parked car for
whatever reason that these parked cars
whatever reason that these parked cars
exist I even know why those are
exist I even know why those are
there it's just some I don't know dude I
there it's just some I don't know dude I
think just a matter of the data set
think just a matter of the data set
mhm they just like
exist technically some of these cars
exist technically some of these cars
originally are supposed to be agents but
originally are supposed to be agents but
we filter them out because their goal is
we filter them out because their goal is
like one inch from themselves
like one inch from themselves
MH so they they set the filter to be you
MH so they they set the filter to be you
only determine an car to be an active
only determine an car to be an active
agent if they're greater than two meters
agent if they're greater than two meters
away in distance to goal from Spawn
away in distance to goal from Spawn
yeah I think we're gonna have to do way
yeah I think we're gonna have to do way
longer than 9 second I mean that's
longer than 9 second I mean that's
ridiculous
ridiculous
right it is but if you also think about
right it is but if you also think about
it I don't know how many major driving
it I don't know how many major driving
interactions last maybe longer than 15
interactions last maybe longer than 15
seconds yeah but it's lame right like in
seconds yeah but it's lame right like in
terms of like in terms of like unique
terms of like in terms of like unique
things you're doing while you drive yeah
things you're doing while you drive yeah
it's lame though I mean even like a 4-
it's lame though I mean even like a 4-
second stop sign doesn't even take that
second stop sign doesn't even take that
long like like a fourway stops sign if
long like like a fourway stops sign if
every single car is there but I want to
every single car is there but I want to
watch the agents just drive around
watch the agents just drive around
constantly
constantly
yeah I see that I mean I also like
yeah I see that I mean I also like
watching the rware robots permanently
watching the rware robots permanently
solve putting boxes inside of its goal
solve putting boxes inside of its goal
you know if we wanted to actually do
you know if we wanted to actually do
something in that industry I would
something in that industry I would
literally just like we just make that
literally just like we just make that
thing be able to have continuous
thing be able to have continuous
movement and then Jazz up the render to
movement and then Jazz up the render to
be like 3D actual warehouse and boom
be like 3D actual warehouse and boom
there you
go yeah yeah that's literally all you
go yeah yeah that's literally all you
would do and then you'd be like boom
would do and then you'd be like boom
okay now we have realistic Warehouse
okay now we have realistic Warehouse
area just like freaking making the
area just like freaking making the
renderer half decent yeah instead of not
renderer half decent yeah instead of not
like some Jank ass little yeah 2D
like some Jank ass little yeah 2D
colored box yeah for sure that's
colored box yeah for sure that's
actually probably going to be a thing
actually probably going to be a thing
that happens by the way at some point in
that happens by the way at some point in
the future with puffer is like we just
the future with puffer is like we just
actually start caring way more about
actually start caring way more about
making the M's look like what they
making the M's look like what they
actually
are hey man I I I see that I mean I set
are hey man I I I see that I mean I set
this the tone going forward with with
this the tone going forward with with
Tower climb I mean that's like Graphics
Tower climb I mean that's like Graphics
the out of itself
the out of itself
yeah that's cool um but yeah I I would
yeah that's cool um but yeah I I would
like to have permanent cars and also
like to have permanent cars and also
having goals pick new goals after you
having goals pick new goals after you
hit a
hit a
goal which is why it'd be great to have
goal which is why it'd be great to have
a larger map so you can have
a larger map so you can have
indefinitely
indefinitely
running um car
running um car
simulation and you can even track like
simulation and you can even track like
traffic patterns at that point yeah
traffic patterns at that point yeah
would be cool etiquette for you get
would be cool etiquette for you get
co-author I don't know what you're
co-author I don't know what you're
asking
asking
Jason uh yeah like why is there no there
Jason uh yeah like why is there no there
cars on like the vast majority of that
cars on like the vast majority of that
map I don't know man it's just like the
map I don't know man it's just like the
data like I don't even know why they
data like I don't even know why they
like this even exists over
here I like literally if you were to
here I like literally if you were to
just do max distance like you know just
just do max distance like you know just
you get rewarded for going max speed and
you get rewarded for going max speed and
not hitting anything and you would just
not hitting anything and you would just
spawn cars randomly you could already do
spawn cars randomly you could already do
stuff with
stuff with
that right
that right
yeah I mean I think what even if we get
yeah I mean I think what even if we get
like the new plan data set like I think
like the new plan data set like I think
that they've been working talking with
that they've been working talking with
those guys about I think their maps are
those guys about I think their maps are
decently large okay cool well we will do
decently large okay cool well we will do
something get just get the thing
something get just get the thing
training on 128 or whatever maps for now
training on 128 or whatever maps for now
so that like you know there's like a
so that like you know there's like a
reasonable policy and then uh yeah we'll
reasonable policy and then uh yeah we'll
go from
go from
there okay so get a 128 policy going do
there okay so get a 128 policy going do
do the simple dumb approach of just
do the simple dumb approach of just
uploading all the maps at once and then
uploading all the maps at once and then
um you should notice that training is a
um you should notice that training is a
lot easier than it was a week ago with
lot easier than it was a week ago with
the new algorithms and
the new algorithms and
stuff I have it in there unless you put
stuff I have it in there unless you put
something in like yesterday no muan is
something in like yesterday no muan is
there by default now what are your
there by default now what are your
policy still not
policy still not
training no my policies do train I sh
training no my policies do train I sh
that result over on Discord well I think
that result over on Discord well I think
that you'll have not too much trouble
that you'll have not too much trouble
getting working on more maps then
getting working on more maps then
because the new algorithm is a lot less
because the new algorithm is a lot less
fiddly than uh just Adam
fiddly than uh just Adam
I actually think new M more maps will be
I actually think new M more maps will be
easier surprisingly like I think just
easier surprisingly like I think just
the data diversity will will just be
the data diversity will will just be
helpful as opposed to like it randomly
helpful as opposed to like it randomly
trying to figure out that like oh
trying to figure out that like oh
there's a goal like over here and all
there's a goal like over here and all
the other agents goals are over here it
the other agents goals are over here it
should be like it definitely should be
should be like it definitely should be
easier but unless I have an N bug which
easier but unless I have an N bug which
is possible but I mean I think it looks
is possible but I mean I think it looks
pretty clean thus far that's good that
pretty clean thus far that's good that
help you at some point with this render
help you at some point with this render
as well
this is just to like find out if things
this is just to like find out if things
work all right we haven't jazzed it up
work all right we haven't jazzed it up
yet yeah have to go we're gonna have to
yet yeah have to go we're gonna have to
go license the car models from the car
go license the car models from the car
companies oh yeah we we'll go talk to
companies oh yeah we we'll go talk to
Tesla okay and get like a
Tesla okay and get like a
little little car model what if we even
little little car model what if we even
then just get like car Partnerships via
then just get like car Partnerships via
like ads for other car companies to just
like ads for other car companies to just
have their things run in here yeah
have their things run in here yeah
that's even better now we don't pay them
that's even better now we don't pay them
for licensing you pay us for Market
for licensing you pay us for Market
yeah exactly isn't it funny how you can
yeah exactly isn't it funny how you can
just flip the thing and just have the
just flip the thing and just have the
same
same
exact you pay us we pay you you pay us
exact you pay us we pay you you pay us
we pay
we pay
you and then uh I do want to add first
you and then uh I do want to add first
person mode in here and drop the camera
person mode in here and drop the camera
in the perspective of the car oh yeah
in the perspective of the car oh yeah
that'll be that'll be fun to play with
that'll be that'll be fun to play with
and it'll be cool to to demo onl you can
and it'll be cool to to demo onl you can
also do um you can also do like the
also do um you can also do like the
third person racing
third person racing
perspective yeah where you just like
perspective yeah where you just like
right on the tail of the car but a
right on the tail of the car but a
little bit above it prob that's probably
little bit above it prob that's probably
even cooler if you get a decent car
even cooler if you get a decent car
model CU then you actually see the
model CU then you actually see the
car sure sure sure sure yeah that's how
car sure sure sure sure yeah that's how
all the racing games are right now are
all the racing games are right now are
any of them even first person is that a
any of them even first person is that a
thing I think you can always swap into
thing I think you can always swap into
first person mode but I think most games
first person mode but I think most games
are played as a as a user from that like
are played as a as a user from that like
just behind third person mode
just behind third person mode
yeah I'll go look at track Mania or
yeah I'll go look at track Mania or
something yeah yeah all right cool but
something yeah yeah all right cool but
Okie do yeah that works
Okie do yeah that works
Spencer
Spencer
um once we get the policy going on 128
um once we get the policy going on 128
and it seems decent is that something
and it seems decent is that something
that we want to present to the NYU group
that we want to present to the NYU group
or at what point do we want to be like
or at what point do we want to be like
hey this is like in a good place for you
hey this is like in a good place for you
guys to use or at what point do you feel
guys to use or at what point do you feel
like they're gonna want to be able to
like they're gonna want to be able to
train on all their Maps but no this is
train on all their Maps but no this is
okay we're only two hops away now yeah
okay we're only two hops away now yeah
sure yeah 128 and then 10,000 why not
sure yeah 128 and then 10,000 why not
well I think that you we probably will
well I think that you we probably will
have to just revisit the state size and
have to just revisit the state size and
uh the best way to do it is that your
uh the best way to do it is that your
state load is like a mem copy or like a
state load is like a mem copy or like a
small number of me copies right you can
small number of me copies right you can
look at how I did this with the grid en
look at how I did this with the grid en
because I have a full example in a
because I have a full example in a
simpler M there for
you I was having a hard time trying to
you I was having a hard time trying to
figure out how I would use any mem
figure out how I would use any mem
copies here but
copies here but
well you make what you do is you make a
well you make what you do is you make a
struct that's the state right the game
struct that's the state right the game
State okay and then and that like that
State okay and then and that like that
just has data and then you make like a
just has data and then you make like a
load state or save state that just
load state or save state that just
copies the data from one struck to
copies the data from one struck to
another
another
right so then you just end up with a
right so then you just end up with a
struck that has the state of every end
struck that has the state of every end
at
at
initialization and then in order to load
initialization and then in order to load
M just copy it yeah
okay Bas yeah that's
okay Bas yeah that's
that's I can kind of Follow that
that's I can kind of Follow that
yeah but I guess who's in each okay
yeah but I guess who's in each okay
here's where I get a little loss if each
here's where I get a little loss if each
one has their own end is that all
one has their own end is that all
happening in the scon then so that it's
happening in the scon then so that it's
shared
shared
amongst everybody The Struck definitions
amongst everybody The Struck definitions
and like the load State Save State all
and like the load State Save State all
those methods that goes in C and then
those methods that goes in C and then
the actual array of levels goes in syon
the actual array of levels goes in syon
this is in the grid example code so if I
this is in the grid example code so if I
just pull up the grid example code right
here where's it
ocean is is that what I did for to
ocean is is that what I did for to
remember literally you have an example
remember literally you have an example
right here so levels is an array of
right here so levels is an array of
States yeah and then here you can see
States yeah and then here you can see
get state so I get uh I get the state
get state so I get uh I get the state
for all the different M's and I save it
for all the different M's and I save it
to levels
and then there's a set
and then there's a set
State
State
natural and then all the other stuff get
natural and then all the other stuff get
State set State like all the state stuff
State set State like all the state stuff
is in
is in
s all right I did the same thing with
s all right I did the same thing with
Tower climb too I was just confirming
Tower climb too I was just confirming
that
that
I yeah but the grid will probably be
I yeah but the grid will probably be
even easier to even read what even what
even easier to even read what even what
I own did for
I own did for
myself that's
myself that's
it that's right
it that's right
yeah yeah I that's that's a thing I
yeah yeah I that's that's a thing I
could just make a struct that's the
could just make a struct that's the
state at initialization
state at initialization
post that's what I would
suggest yeah don't don't bother with
suggest yeah don't don't bother with
that yet just get the 128 training yeah
that yet just get the 128 training yeah
get the 128 going I mean I mean I'll
get the 128 going I mean I mean I'll
probably be able to get the 128 going
probably be able to get the 128 going
this by this weekend realistically you
this by this weekend realistically you
don't have your box is working
don't have your box is working
right yeah my box is good unless unless
right yeah my box is good unless unless
it just nuked itself like now thankfully
it just nuked itself like now thankfully
everybody's freaking messaging me with
everybody's freaking messaging me with
hardware issues all the time all right
hardware issues all the time all right
we're good
we're good
co okay do all right uh I will see you
co okay do all right uh I will see you
later and let you know how 128 goes see
later and let you know how 128 goes see
you Spencer thanks like good progress on
you Spencer thanks like good progress on
the
the
end okay that was
end okay that was
cool Spen has made really good progress
cool Spen has made really good progress
I'm going to take a minute um I'm going
I'm going to take a minute um I'm going
to take a minute walk around a second
to take a minute walk around a second
use the restroom all that and then I
use the restroom all that and then I
will be back we're going to do a couple
will be back we're going to do a couple
just example training runs on stuff and
just example training runs on stuff and
then that'll be it it will be dinner and
then that'll be it it will be dinner and
then tomorrow will
then tomorrow will
be uh probably all day infrastructure
be uh probably all day infrastructure
work on puffer and that'll all be live
work on puffer and that'll all be live
be right
back
e
e
e
e
e
e
e
e
e e
okay here's a plan about 40 minutes to
okay here's a plan about 40 minutes to
fiddle with some
fiddle with some
experiments and then dinner I'm getting
hungry e
ah wait I need to do
ah wait I need to do
um I need to grab their latest Branch I
um I need to grab their latest Branch I
think
can work off of that
okay e
we'll let that run
h e
my guess is I just like deleted some of
my guess is I just like deleted some of
their losses or
something so basically I'm just uh I did
something so basically I'm just uh I did
emerge into this repo with all our new
emerge into this repo with all our new
Dev features and uh trains a little
Dev features and uh trains a little
worse than before H so I probably broke
worse than before H so I probably broke
a couple things I mean this is it was
a couple things I mean this is it was
like a big merge so it was kind of
like a big merge so it was kind of
expected frankly I was surprised the
expected frankly I was surprised the
training worked like reasonably well at
training worked like reasonably well at
all um on their first go so see if I can
all um on their first go so see if I can
spot you know any discrepancies real
spot you know any discrepancies real
quick get a couple runs going we'll go
quick get a couple runs going we'll go
from there
okay
apparently this is supposed to do stuff
we don't have episode reward in here
yet okay so that actually trains quite
slow ah no it gets faster though okay
slow ah no it gets faster though okay
let's move on
so while I'm waiting for this let me go
so while I'm waiting for this let me go
look at uh their
original code here
why did they merge this into
main oh no they didn't that's me that's
main oh no they didn't that's me that's
my
Branch never mind
[Music]
okay so what do they do with their
losses oh oh yeah they got a whole bunch
losses oh oh yeah they got a whole bunch
of these so they got Kickstarter chos
of these so they got Kickstarter chos
value they got this L2 as
well
e
e
e e
this is now with their regularization
this is now with their regularization
added back in
let me see what else could be different
let me see what else could be different
in the
meantime so they don't use this
meantime so they don't use this
Kickstart thing
that's like the
that's like the
main thing I was expecting
oh
oh
okay it's probably just this isn't it
yeah yeah yeah okay that's that's
yeah yeah yeah okay that's that's
definitely
it
e
e
e
e
e
e
e
e
e e
how does this thing not freaking
work
e e
there we go
I think I should sweep L2
regularization
e
e
e e
how many steps is this
okay we'll let this run a little
longer this should do very nicely
though almost six we'll give this a few
though almost six we'll give this a few
minutes
minutes
then and uh
then and uh
may as well check on my other runs in
may as well check on my other runs in
the
the
meanwhile now that is something I can do
meanwhile now that is something I can do
because this
because this
guy this guy's not doing so hot
guy this guy's not doing so hot
right yeah this guy's not doing so
hot
e
e
e
e
for e
you go double check how much L2 they
you go double check how much L2 they
were
were
using it makes that much of a difference
using it makes that much of a difference
for them
um well they have no
L2 so I don't know how that made any
L2 so I don't know how that made any
difference for
him
for e
yeah these um these are
yeah these um these are
zeros so they're not actually doing
L2 so what do I run on neural MMO
then I basically just get to run an
then I basically just get to run an
ablation of some sort
right
e e
yeah it's stuck at
one still lower but not much
lower
for e
this one has
this one has
0.9 0.9
0.9 0.9
0.999 20 - 12
okay we'll double check the betas then
now these have the same
now these have the same
prams these muon prams are the
same does seem kind of stuck
oh you screwed this up totally didn't
you U maybe
you U maybe
not H
whatever
32k
for
e e
I'm trying to think what else I could
I'm trying to think what else I could
have
broken for
this is the wrong
this is the wrong
one I got his experiment by mistake
we'll see if the mini batch makes a
difference makes it a little faster
I think what else I could have
I think what else I could have
broken it's kind of rare to like break
broken it's kind of rare to like break
something and have it like still mostly
something and have it like still mostly
train usually either full break it or
train usually either full break it or
you
don't it's annoying
changed Optimizer changed I
guess I mean to be fair I don't know how
guess I mean to be fair I don't know how
they had it working
they had it working
before like I tried to reproduce their
before like I tried to reproduce their
result and I
couldn't e
think if there's anything else that they
think if there's anything else that they
might have done
config average
config average
reward they do
this I don't see it in here
anywhere they don't use either of these
losses have this weight flipping
nope they're not using that
either do they have vene nealing
either do they have vene nealing
on they have an Neal the
false but that shouldn't matter
e e
this is just rank
logging I did this correctly right in
logging I did this correctly right in
theirs let's go check the lstm state
yeah that that wouldn't work at
yeah that that wouldn't work at
all without this
right
for e
I did add reward
I did add reward
clipping did they have reward
clipping they do not have reward
clipping we'll try that next
but I want to see if this gets any
better e
okay we'll see where this gets
okay we'll see where this gets
to man
is this
is this
scammer
yep hey this is cool
2 million not enough
though it's a tiny tiny amount of data
I'm trying to think if it makes sense
I'm trying to think if it makes sense
that this would be a reward thing right
I remember this being a thing in
I remember this being a thing in
breakout the other
way it could be that the rewards are
way it could be that the rewards are
just horribly
just horribly
scaled and
scaled and
um you know that could be a thing
we'll have to see
plus hang on he sent me another
plus hang on he sent me another
ARG I already had it
though we going to level out
again just take longer to get
there we'll try this thing next oops
there we'll try this thing next oops
wrong language
we'll let this finish
we'll let this finish
250 and then I'll just run the other
250 and then I'll just run the other
thing and I'll go get dinner
non-tensor data within tensor
deck what the
heck that was weird
huh X AI has acquired
X that's a weird one
surprised you can even do that that's
surprised you can even do that that's
interesting
e e
that's
that's
annoying okay this is what we'll do set
annoying okay this is what we'll do set
this to clip Rewards
e
e
e e
e
yeah
e
e e
maybe that's a clue why train is
slower oh it could be the stupid
slower oh it could be the stupid
gradient variance thing
for e
reward clipping doesn't seem to make a
reward clipping doesn't seem to make a
big
difference it's
difference it's
weird very
weird so we're not going to get anything
weird so we're not going to get anything
out of reward clipping it looks like
and that should be there
anyways I can double check the lstm
state it'd be really weird if it were
state it'd be really weird if it were
doing this well without lstm State
doing this well without lstm State
though
oh okay
is this going to be stuck again
damn
it yeah that's crazy that it does that
it yeah that's crazy that it does that
it does a little better without reward
it does a little better without reward
clipping
though well I still should check the
though well I still should check the
lstm states
what's the default supposed to
do minutes
so like 100 Mil steps supposed to be
so like 100 Mil steps supposed to be
pretty
pretty
low 200 gets to like 1.
low 200 gets to like 1.
25ish 250
25ish 250
mil we're not that far off and we only
mil we're not that far off and we only
have to get up to
here wouldn't it be funny if it were
here wouldn't it be funny if it were
just
clipping it' be surprising but guess
clipping it' be surprising but guess
stranger things have happened
stranger things have happened
I do know that that specific
I do know that that specific
parameter is quite
sensitive what else would cause it to
stall learning rate
params for sure
I'm trying to think if there's any
I'm trying to think if there's any
specific
specific
bug that does this but I think it's more
bug that does this but I think it's more
likely just hypers and
likely just hypers and
stuff I mean I guess I could have
stuff I mean I guess I could have
technically
broken if I broke indexing though it
broken if I broke indexing though it
would be like Giga broken wouldn't
it it wouldn't do anywhere near this
it it wouldn't do anywhere near this
well
it wouldn't be certainly like close to
it wouldn't be certainly like close to
where they original is it's a little
under honestly doesn't look too far off
under honestly doesn't look too far off
from
theirs
e e
that definitely did something at the
that definitely did something at the
very least
the thing is the curve shape is
off
e
e e
let me see if I missed any of their
let me see if I missed any of their
other normalization
stuff e
I do the schedule
I do the schedule
step I think I did
right
e e
e
okay I think I'm just going to uh keep
okay I think I'm just going to uh keep
running a couple of these in the
running a couple of these in the
background and figure it out slowly
yeah I got to just play with their
yeah I got to just play with their
thing
thing
okay
okay
uh Neptune
run early gamma has potential
run early gamma has potential
here okay I'm going to go get dinner I
here okay I'm going to go get dinner I
may not be back after I will be live all
may not be back after I will be live all
day tomorrow most likely streaming
day tomorrow most likely streaming
infrastructure Dev on uh on puffer so if
infrastructure Dev on uh on puffer so if
you're interested in that swing by
you're interested in that swing by
tomorrow and otherwise puffer doai all
tomorrow and otherwise puffer doai all
my stuff's here star the GitHub to help
my stuff's here star the GitHub to help
us out really really helps us out a lot
us out really really helps us out a lot
you can join the Discord to get involved
you can join the Discord to get involved
you can follow me on X for more content
you can follow me on X for more content
thanks
