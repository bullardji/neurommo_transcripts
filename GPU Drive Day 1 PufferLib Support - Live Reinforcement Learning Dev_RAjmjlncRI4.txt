Kind: captions
Language: en
we're
back got some good questions
answered time to
answered time to
fix this
integration
integration
yeah I know I'm going off the rails here
yeah I know I'm going off the rails here
all right
all right
uh cool yeah the stream works so I have
uh cool yeah the stream works so I have
a text file with
a text file with
some some stuff on it yeah their m is
some some stuff on it yeah their m is
really fast I'm going to have to do some
really fast I'm going to have to do some
work to get it to be this fast um and
work to get it to be this fast um and
then also Deany is currently fixing a
then also Deany is currently fixing a
small bug um but in the meantime we have
small bug um but in the meantime we have
stuff to
stuff to
do so what I've been
do so what I've been
told what I have been
told what I have been
told uh there is a mask thing that I
told uh there is a mask thing that I
have to
set let me see where mask gets set
from be and receive
from be and receive
masks buff. masks okay so here here I
masks buff. masks okay so here here I
have to assign uh I have to assign masks
have to assign uh I have to assign masks
to the
to the
buffer that's
fine that should be no
fine that should be no
problemo um
problemo um
so OBS to numpy
we also need to do this mask
we also need to do this mask
thing
uh just do OBS and
mask let me make sure hold on let me
mask let me make sure hold on let me
grab this
grab this
window cuz I need to check I need to
window cuz I need to check I need to
leave the DMS open because in case uh
leave the DMS open because in case uh
bug is
fixed all
right
there so the first thing we need to do
there so the first thing we need to do
is figure out this mask um I've been
is figure out this mask um I've been
told it is self so mask
s.m. cont
s.m. cont
agent cont agent
agent cont agent
mask. numpy
mask. numpy
times self. nope not
duns m. dead agent mask.
duns m. dead agent mask.
numpy okay now we have the mask right
I think I can just do self. buff. mask
I think I can just do self. buff. mask
right self. buff.
right self. buff.
mask
equals
equals
yeah like this so I haven't I haven't
yeah like this so I haven't I haven't
made a buffer up here but when puffer
made a buffer up here but when puffer
vectorization runs it will be made for
vectorization runs it will be made for
me
and then that should be picked up
and then that should be picked up
automatically for
us I've also been told that
us I've also been told that
um I should look
um I should look
for I should look specifically
for I should look specifically
for scenes that have uh a reasonable
for scenes that have uh a reasonable
number of
number of
Agents scene config is scene
Agents scene config is scene
config K unique scenes
config K unique scenes
K unique
n selection
discipline I do need to filter for
these scene config
these scene config
let me see if I can
let me see if I can
find let me see if I can find
that
that
758 um where was the
758 um where was the
driver I thought I had a tab with it
start the repo folks helps out the
start the repo folks helps out the
project
um so many
um so many
branches a lot of
work so I was looking at this for this
work so I was looking at this for this
scene
config which is pi
Drive
config scene config what's in
config scene config what's in
here okay literally just a data class
here okay literally just a data class
cool um are there options to
filter you get path
filter you get path
data num
data num
worlds selection discipline
worlds selection discipline
is K unique
scenes
interesting exact
n okay so there's definitely something
n okay so there's definitely something
here
of course we can count with and without
of course we can count with and without
for
now because this is how they load
now because this is how they load
it so we should be able to match that
it so we should be able to match that
for now though unfortunately there's a
for now though unfortunately there's a
little there's a thing with how puffer
little there's a thing with how puffer
handles processing that's going to make
handles processing that's going to make
it a little harder
I would really like to set this to 32
I would really like to set this to 32
but we'll we'll come back to
but we'll we'll come back to
that
um see if this
Runs run it a few
Runs run it a few
times this bug is the the one that's
times this bug is the the one that's
being fixed right
being fixed right
now come
on there it
on there it
goes dead agent mask no attribute it's
goes dead agent mask no attribute it's
like dead agent mask or something silly
like dead agent mask or something silly
right
cont agent mask
exists does dead agent mask not
exists does dead agent mask not
exist
uhoh am I missing something in here
uhoh am I missing something in here
controlled agent mask it dos
Max agent
Max agent
count
count
[Music]
[Music]
normalize one
normalize one
code
render unwrapped and
render unwrapped and
visualizer so there is no dead uh I
visualizer so there is no dead uh I
don't see dead agent mask in here
don't see dead agent mask in here
anywhere so that's fine I can do this
anywhere so that's fine I can do this
for now and then I'm assuming this is
for now and then I'm assuming this is
like this gets created later or
something I was told that
something I was told that
these self.
these self.
buff no attribute
mask uh
really should be a mask
this bug will be gone in a few
minutes we'll just deal with it for now
really am I just getting
unlucky what do I do do I just reduce
unlucky what do I do do I just reduce
the number of M's to make it less likely
the number of M's to make it less likely
to
happen if I just do one world is it
happen if I just do one world is it
going to be like really unlikely for
going to be like really unlikely for
this to happen
yeah it's masks I'm just
dumb buff.
masks kind that works
then we have a breakpoint and
step
nice um now is there a dead agent
masks no
cont agent mask
I think we'll leave it like this for now
I think we'll leave it like this for now
this should still give us quite a bit um
this should still give us quite a bit um
let's just do let's do something for fun
so holy hell
do you see this it controls two
do you see this it controls two
agents
agents
jeez that's going to be
rough okay it's what I thought so at the
rough okay it's what I thought so at the
beginning of the episode none of the
beginning of the episode none of the
agents are
dead you can initialize it from the anai
so we'll just
do self. live
agent uh nump pi.
agent uh nump pi.
ons
ons
Bull and then
dead agent
mask like I cannot reproduce
it yeah let me get her the error
oh got it
yeah e
we've got a Repro of the
error
error
nice uh let's see if we can find the
nice uh let's see if we can find the
dead agent mask in the meantime
is it going to be really slow
is it going to be really slow
though it only has one
m and this particular m is like two
m and this particular m is like two
agents so I'll set this up to 10 and
agents so I'll set this up to 10 and
I'll just deal with the
I'll deal with
I'll deal with
this I want to see if I can find where
this I want to see if I can find where
the dead agent mask
is maybe I can just find it in their
Source it's B3
wrapper uhoh
oh they're using it for
duns yeah it's not from the
duns yeah it's not from the
okay I see what you mean by this this is
okay I see what you mean by this this is
fine it's because they're using duns in
fine it's because they're using duns in
kind of a weird
way yeah but that's fine
right this will mean you missed the last
right this will mean you missed the last
time
time
step though that's not a huge
deal yeah so what we'll do do
is
so live agent mask
equals
terminal
terminal
terminal and then this is
terminal and then this is
times self. live agent
times self. live agent
mask and this is already
mask and this is already
numpy perfect
does this now work
not seeing it failing
yet if I run it with multiprocessing
yet if I run it with multiprocessing
well that'll just make it fail right
well that'll just make it fail right
surely one of the M's won't work
so I think I need to get the uh I need
so I think I need to get the uh I need
to wait until I have the this bug fix I
think maybe I can find this egg
think maybe I can find this egg
fault that'd be funny
GPU Drive environment.
py well this is different this is me
py well this is different this is me
being stupid
here we
here we
go
go
uh M
torch dpu
torch dpu
Drive P
Drive P
GPU GPU Drive m m
forch encode Road points of
OBS oh if this is all the if this is the
OBS oh if this is all the if this is the
whole bug
whole bug
right then all I have to do
right then all I have to do
[Music]
is OBS of
I just do
this no because this happens in the
this no because this happens in the
inette right
do we have the m in here
somewhere scene world where is it self.
Sim point
Sim
dur Sim dot do we have
dur Sim dot do we have
cont controlled State
cont controlled State
tensor tensor
okay and where's this break
point
so I think it's something like
so I think it's something like
uh
uh
Road types of
do this
work can't reprod hold on
oops let me get
oops let me get
the files
H where do I put this paast
pin been so long since I have had to
pin been so long since I have had to
past pin
past pin
something for
hold on where do I get
this paast
bin there we go
does this fix it
uh this is not
uh this is not
rvel batch
equals re
shape what's up with the uh The Masks
shape what's up with the uh The Masks
hold on
s.m. cont agent
s.m. cont agent
mask
mask
tape why the heck can't I just out rvel
tape why the heck can't I just out rvel
this I should be able to
this I should be able to
right oh I I bet it's cuz uh this thing
right oh I I bet it's cuz uh this thing
has to
has to
be
be
rvel
rvel
Ravel I'll try
this seriously cannot be broadcast oh do
this seriously cannot be broadcast oh do
rvel Dumbo
ah this broke my terminal
shoot speed fixing
this if I just don't set this buff mask
this if I just don't set this buff mask
it'll be way faster
right yeah let me just run it a couple
right yeah let me just run it a couple
times
oops not this one
right e
cool so this is the the environment
cool so this is the the environment
working now it's very nice
um this should be enough for
um this should be enough for
us to be able to start doing a few
us to be able to start doing a few
things with this en I'd
say multiprocessing
say multiprocessing
work or is this still going to be
slow e
definitely something screwy with trying
definitely something screwy with trying
to vectorize this though I think that's
to vectorize this though I think that's
very odd
very odd
no I should totally be able to just
no I should totally be able to just
factorize
factorize
this the whole point of
this the whole point of
puffer
um clean puff
um clean puff
RL let's just open up receive Maybe
in order to
vectorize you need to use box
vectorize you need to use box
four I brought box four back
four I brought box four back
up no wait I didn't right I uh I did
up no wait I didn't right I uh I did
tell them to bring it back up but the
tell them to bring it back up but the
guy wasn't there
guy wasn't there
today so I did do my I did do my
today so I did do my I did do my
homework bet but um the guy wasn't there
homework bet but um the guy wasn't there
so rip he's going to be there tomorrow
can we replace guy with a robot that's
can we replace guy with a robot that's
not his job I don't have a guy on
not his job I don't have a guy on
payroll whose job it is just to press
payroll whose job it is just to press
buttons on boxes like there's a guy that
buttons on boxes like there's a guy that
works there on the property that like
works there on the property that like
you know is there sometimes with on
you know is there sometimes with on
different hours that like will just re
different hours that like will just re
like you know hey can you reboot this
like you know hey can you reboot this
stuff when it goes
[Music]
[Music]
down we've been doing some real cool
down we've been doing some real cool
stuff though
stuff though
today definitely something broken in V
today definitely something broken in V
very very odd um for something to be
very very odd um for something to be
broken in
V I assume I'm just not getting Trace
V I assume I'm just not getting Trace
backs or something
because I should be
because I should be
uh I should be fine here
let me think what this would possibly
be oh
be oh
also where did my DMs
also where did my DMs
go we go
is this on dev
is this on dev
Branch uh I don't know if I've committed
Branch uh I don't know if I've committed
it yet but yeah it will
be will be on dev
be will be on dev
Branch the goal here is um some buddies
Branch the goal here is um some buddies
at NYU released a really awesome
at NYU released a really awesome
multi-agent driving Sim and uh we're
multi-agent driving Sim and uh we're
doing Day One
support for
when is day one this is day one it was
when is day one this is day one it was
released today therefore today is day
one I can just figure out why whoops
one I can just figure out why whoops
let's not DM that
let's not DM that
um if I can just figure out why this
um if I can just figure out why this
won't vck that'd be great
m
trying to think why this would not work
trying to think why this would not work
in
Beck I can't think of anything
Beck I can't think of anything
fundamental unless it's eating an
fundamental unless it's eating an
error e
yeah yeah yeah let's look at VEC well
yeah yeah yeah let's look at VEC well
there's not going to be much to look
at because the multiprocessing is going
at because the multiprocessing is going
to be
it's going to give you like this worker
it's going to give you like this worker
function
right and you're not going to be able to
right and you're not going to be able to
do much from
do much from
here because this is in a
subprocess right
it's so weird that this
doesn't yeah it's very
doesn't yeah it's very
weird can you not make multiple of these
weird can you not make multiple of these
or something on the
or something on the
[Music]
same okay let's not just sit here
same okay let's not just sit here
there's got to be something we can do
there's got to be something we can do
right
one one one
one one one
go there's one environment on one
go there's one environment on one
process does it do
it apparently
it apparently
not still stuck so something about the
not still stuck so something about the
multiprocessing is just
multiprocessing is just
blocking it from working it could be a
blocking it from working it could be a
path issue
path issue
maybe be a path
maybe be a path
issue run Cal yeah it works in Cal
issue run Cal yeah it works in Cal
look even with all these M it'll work in
cereal there you go 35k train not too
cereal there you go 35k train not too
bad on the startup time
either should be way faster than this
either should be way faster than this
though with VC
though with VC
um got to be something I'm
um got to be something I'm
missing it is working
missing it is working
yes working
yes working
I'm a little suspicious with this CH
I'm a little suspicious with this CH
dur
dur
this thing
here try
multiprocessing is there anything up
multiprocessing is there anything up
nope there's nothing up there either
would it be something with the render
would it be something with the render
config or something trying to like open
config or something trying to like open
p game on
subprocesses let's
see it's also possible they've never
see it's also possible they've never
tested this on a sub process
what do we think what are our thoughts
what do we think what are our thoughts
on this ablate stuff oh yeah thanks why
on this ablate stuff oh yeah thanks why
didn't I think of that I got to do the
didn't I think of that I got to do the
ablat of
stuff a blate stuff he says ablate
stuff where's the post the
repo no repo yeah here
so Pi by top I don't don't how does that
so Pi by top I don't don't how does that
tell
me I think it's py game it's trying to
me I think it's py game it's trying to
initialize P game is going to be my
initialize P game is going to be my
guess
here can I just pass render config equal
here can I just pass render config equal
none is that a thing I can do
enable batch
enable batch
renderer incompatible okay so it doesn't
renderer incompatible okay so it doesn't
like doesn't like this
renderer m torch
it's got to be Pi game somewhere
right m.v is
LF this looks like it only calls on get
LF this looks like it only calls on get
render
render
though initialize
though initialize
simulator so this should be fine I
simulator so this should be fine I
thought what was happening is that they
thought what was happening is that they
were initializing the um
were initializing the um
I thought that they would be like
I thought that they would be like
initializing the renderer and Pi game on
initializing the renderer and Pi game on
a subprocess or
a subprocess or
something do you need the agent masking
something do you need the agent masking
it's not added at the moment and no you
it's not added at the moment and no you
wouldn't need the agent masking for
wouldn't need the agent masking for
this it's just going to make it
slower what happens if I just I leave r
slower what happens if I just I leave r
mode like this but instead of doing uh
mode like this but instead of doing uh
render mode where is
render mode where is
it render
it render
mode H for
mode H for
fish does that do
it this is single
it this is single
core yeah it works single
core the option
oh I see
all SCS
multiprocessing back end
and
and
nothing I was hoping that the render
nothing I was hoping that the render
mode would just make it work um if it's
mode would just make it work um if it's
not like loading P game but
not like loading P game but
no looks like
no looks like
not kind of weird
I wouldn't think that this would mess it
I wouldn't think that this would mess it
up I really
wouldn't exec
wouldn't exec
mode CPU
enable batch
renderer for
set up
rendering set
rendering set
up does this get
called that's probably the function I
want aha
want aha
gotcha exactly what I expected
gotcha if I comment you
out this is going to be a legendary call
out this is going to be a legendary call
if I get
it go away
visualizer really I thought this would
visualizer really I thought this would
work
dang I really thought that would
dang I really thought that would
work it's almost always like you're
work it's almost always like you're
doing some dumb render thing and it
doing some dumb render thing and it
messes it
messes it
up GPU Drive torch M right yeah this is
up GPU Drive torch M right yeah this is
what I'm using
I think I got to open up the remote
I think I got to open up the remote
debugger for this
unfortunately been so long since I've
unfortunately been so long since I've
used this
it's hanging as well it's not crashing
it's hanging as well it's not crashing
which is even weirder
remote
pdb
what oh it's a minimal containers is
what oh it's a minimal containers is
why are you using C aren't you using
CPU what do you mean on aren't you using
CPU what do you mean on aren't you using
CPU do you need render mode args but
CPU do you need render mode args but
drone is a different render back
end
44 all right accepted
connection okay the SIM initializes
okay so that actually works
not getting
not getting
reset it's getting made but not getting
reset it's getting made but not getting
reset is that a
thing can't be
thing can't be
right can't
be I can't do use
be I can't do use
GPU I I don't have madona compiled with
GPU I I don't have madona compiled with
Cuda man
could be I still
could be I still
think I am doing that right now do you
think I am doing that right now do you
see what I'm doing I'm doing I have a
see what I'm doing I'm doing I have a
remote debugger set up I don't bring
remote debugger set up I don't bring
this out very often but um
this out very often but um
this is the heavy debug
this is the heavy debug
tool this is when you have utterly
tool this is when you have utterly
cursed
cursed
Shenanigans they're driving you
Shenanigans they're driving you
mad when you bring these
out am I
dumb wait am I actually stupid
no it's not this is
fine right
wait self DOD
if I do this here does this do anything
different okay the fact that I don't get
different okay the fact that I don't get
the remote pdb prompt means it's not
the remote pdb prompt means it's not
getting
here so why would it not be getting
here so why would it not be getting
here it's possible I missed API stuff
here it's possible I missed API stuff
right this could very well be not even a
right this could very well be not even a
madona issue or anything this could just
madona issue or anything this could just
be a me being dumb
issue this is going to be so cool once
issue this is going to be so cool once
we get it working
was this the thing that was driving you
was this the thing that was driving you
and whoever crazy here I'll change it to
and whoever crazy here I'll change it to
1.0
1.0
whatever doesn't make a
difference though probably I shouldn't
difference though probably I shouldn't
touch code that's this deep but
whatever uh
m. reset
right and I'm just going to call a
seral I'm just going to call reset here
okay yeah this is all fine
still
still
no how early do I have to go in
here here
here here
is this too
late
really actually wait a
really actually wait a
second so if I go here
is there a lock
file how about this
waiting for connection right
oh it's a
space so I hit continue
here and then it fails
right I had to figure out when it's
right I had to figure out when it's
hanging
though it's indefinitely in the Creator
I was actually very impressed by some of
I was actually very impressed by some of
the stuff they did in this code
base they did uh very very well
here what
happened okay we made the driver end
happened okay we made the driver end
right on the main process we made the
right on the main process we made the
driver
driver
in
okay yeah and then it's going to fail in
okay yeah and then it's going to fail in
the sub process cool um
let me just try something really
quick if I just
do if I just do this
now this
works the car crashes into the
wall
wall
interesting you can open multiple of
interesting you can open multiple of
these
I get the init messages on
everything very
everything very
weird and then let's do initialized
initializing and we didn't get any
initializing and we didn't get any
initialized message right
[Music]
initializing puffer CPU
initializing puffer CPU
Drive oh no wait we do get right here
Drive oh no wait we do get right here
the driver process
initialized I'm going see if I put
initialized I'm going see if I put
it I'm sure if I put it right here it's
it I'm sure if I put it right here it's
failing on a knit
right yeah there you go same exact
right yeah there you go same exact
thing
thing
um I weird
very
weird
weird
oh
[ __ ] I bet it's
[ __ ] I bet it's
this that's so stupid but I bet it's
this yep
[Music]
[Music]
initializing oh no wait damn it I
initializing oh no wait damn it I
thought I solved
it man I was so sure that was going to
it man I was so sure that was going to
be it
where's their n
file how many launching simulat
file how many launching simulat
ators okay we get launch on all the
ators okay we get launch on all the
simulators if I put it down
here oh look at that we get launch on
here oh look at that we get launch on
all
these oh interesting so this does not
these oh interesting so this does not
work
um what the heck where would it be
um what the heck where would it be
failing that's
not that's
bizarre yeah done launch
bizarre yeah done launch
Sim okay
yeah I saw the done launch Sim there as
yeah I saw the done launch Sim there as
well I mean this it's got to be right
well I mean this it's got to be right
here right set up action
here right set up action
space
space
yep set up action space is
yep set up action space is
hanging
right hold on is that did that not work
I didn't get it here either
what oh get OBS
what oh get OBS
hangs
hangs
really get OBS is going to hang
how is that possible
okay so it's
definitely do you need continuous action
definitely do you need continuous action
spaces this is in the simulator code my
spaces this is in the simulator code my
friend friend is in the simulator code I
friend friend is in the simulator code I
should not need a damn
should not need a damn
thing uh it's get it's in get
OBS okay
OBS okay
print get
ego PR get
ego PR get
[Music]
[Music]
partner get Road
OBS get OBS
OBS get OBS
done we are actually print debugging
done we are actually print debugging
stuff because
weird works fine on the main
thread okay ego partner and then it dies
zero
one
4 don't ever do the thing I'm just doing
4 don't ever do the thing I'm just doing
do not ever do
this you only do this if you're
stupid
stupid
killed
killed
what oh memory leak real cool
uh where's the
aggressive where's all the kill all
aggressive where's all the kill all
prices there's like one really obnoxious
prices there's like one really obnoxious
gript that always works and nothing else
gript that always works and nothing else
ever
does okay get partner 012
normalize and flatten
I'm doing this really stupid right now
I'm doing this really stupid right now
because like this actually does not make
sense like I see absolutely nothing that
sense like I see absolutely nothing that
should be able to hang in here and yet
should be able to hang in here and yet
it's still hanging
Nan to num
how's that possible
fix there should not be Nan and
fix there should not be Nan and
OBS so I can just comment
it 0 one and two
no there's no way Divi a division is
no there's no way Divi a division is
hanging I don't believe
that not out of
memory I don't understand how the hell
memory I don't understand how the hell
that's even
possible
possible
01 wait Norm 01 yeah this literally
100 maybe the
indexing maybe it's like indexing a
indexing maybe it's like indexing a
gigantic
gigantic
tensor shouldn't
tensor shouldn't
be this is fine
let me install torch
Nev I don't care I want give me the
Nev I don't care I want give me the
install
hip install Cuda
hip install Cuda
12.1
boom what
what's the flag called no cash dur I
what's the flag called no cash dur I
don't know why it accepts the flag if
don't know why it accepts the flag if
it's not
correct huh
okay there we go and we'll see whether
okay there we go and we'll see whether
this fixes
it freaking random torch hanging bug
[Music]
fast Sim is all you
fast Sim is all you
need is
need is
true GPU Drive
h
I don't know why we have five people
I don't know why we have five people
watching me
watching me
debug random torch issues but welcome to
debug random torch issues but welcome to
the
the
debug um
it's going to be very cool if this thing
it's going to be very cool if this thing
works because basically what this will
works because basically what this will
mean is I'll just have to update the
mean is I'll just have to update the
puffer tank containers to all be 2.4
puffer tank containers to all be 2.4
solid people have been asking me to do
solid people have been asking me to do
that anyways that'll take me a little
that anyways that'll take me a little
bit of time won't be that bad though um
bit of time won't be that bad though um
I'll recompile like all of the docker
I'll recompile like all of the docker
builds with
builds with
2.4 I'll put this GPU drive on the uh on
2.4 I'll put this GPU drive on the uh on
the image while I'm doing
the image while I'm doing
that so we'll just have this environment
that so we'll just have this environment
be part
be part
of will be
of will be
distributed with the
distributed with the
docker and then it'll just
docker and then it'll just
work which will be really nice
I'm hoping we can get this to be
I'm hoping we can get this to be
reasonably fast as
reasonably fast as
well I mean I know that I can
well I mean I know that I can
have if I know that the policy can be
have if I know that the policy can be
made fast which I do then it's just
made fast which I do then it's just
going to be a matter of the M
going to be a matter of the M
Sim and I mean they say it's really fast
Sim and I mean they say it's really fast
on
on
GPU so we'll essentially just see how
GPU so we'll essentially just see how
well it is just optimized to GPU versus
well it is just optimized to GPU versus
fast in
fast in
general I would think with a driving Sim
general I would think with a driving Sim
there should be
there should be
like there should sort of be enough
like there should sort of be enough
logic that
logic that
um you should be able to get comparably
um you should be able to get comparably
fast stuff on good
fast stuff on good
CPU driving Sim doesn't strike me as
CPU driving Sim doesn't strike me as
something that would be amazing for um
something that would be amazing for um
for GPU so I think we should probably be
for GPU so I think we should probably be
able to get comparable just off of that
able to get comparable just off of that
like if this were like hardcore physics
like if this were like hardcore physics
Sim sure but I don't think it is
hopefully this does not break my uh
hopefully this does not break my uh
drivers we'll see I see it's downloading
drivers we'll see I see it's downloading
new
qnn but yeah I don't know if this will
qnn but yeah I don't know if this will
fix it either I'm trying to think what
fix it either I'm trying to think what
else it could be this really does look
else it could be this really does look
like torch bug to me though because how
like torch bug to me though because how
else can you have how else can you just
else can you have how else can you just
have a tensor that is hanging on a
have a tensor that is hanging on a
Division operation right that's got to
Division operation right that's got to
be bad torch bug of course that doesn't
be bad torch bug of course that doesn't
mean that it could be um that it's not
mean that it could be um that it's not
in this version as well
in this version as well
but I think it would
be I could also just write a numpy
be I could also just write a numpy
container right I could just write GPU
container right I could just write GPU
numpy en that's what I'll do
numpy en that's what I'll do
next because let me
see unless there's not a two numpy on
see unless there's not a two numpy on
this and you have to go through
this and you have to go through
torch is there a way to load Madrona
torch is there a way to load Madrona
tensor to numpy let me see
there docks for
this so this is a cool engine right
uh shoot it doesn't
have doesn't have
docks hav been updated in a while either
cpu.
cpu.
numpy I might be able to reduce the LI
numpy I might be able to reduce the LI
Reliance on Torch at the very least
right we'll see whether this is
right we'll see whether this is
torch let's start with this let's start
torch let's start with this let's start
with
with
this um but yeah we could also just
like what do we think should I just
like what do we think should I just
start doing
this I think I may as well because I
this I think I may as well because I
want to do this anyway so
want to do this anyway so
copy uh M
copy uh M
porch m numpy
numpy get D get
rewards reset let me
see get OBS I think it's called first
see get OBS I think it's called first
yeah let's let's look at
this and actually I can put this break
this and actually I can put this break
point in the uh the torch version all
right so we can figure this
out and a GPU Drive
Sim
CPU
CPU
there there's got to be a way to get
there there's got to be a way to get
this in numpy
this in numpy
right Two Jacks two
torch well this finished for now but it
torch well this finished for now but it
looks like there isn't a built-in
method so let's start here
damn it's still it still gets stuck
damn it's still it still gets stuck
here that is
crazy well I guess we're making M
crazy well I guess we're making M
numpy um How do you do Madrona to
torch and you do like that
asay I can do that it easily for now
though p
CPU
okay cpu.
np. copy
what's copy underscore like that is it
what's copy underscore like that is it
copy
too copies the elements from to Source
too copies the elements from to Source
into
into
self so it copies into it
that's really
that's really
annoying let's fix is this the are these
annoying let's fix is this the are these
the only
ones wait this is the torch on what am I
ones wait this is the torch on what am I
doing
for e
controlled
one one minus controlled mask
one one minus controlled mask
buol expand as Road
type okay good
and then this is the last one that we
and then this is the last one that we
don't know how to fix
don't know how to fix
right cuz we have SIM action
right cuz we have SIM action
tensor I guess this one's not
tensor I guess this one's not
terrible this is less Tor torch
terrible this is less Tor torch
logic so maybe we get
logic so maybe we get
lucky and
lucky and
um this is like not terrible to debug
um this is like not terrible to debug
we'll see
uh it is just it is just
uh it is just it is just
directly
directly
so comment
this we'll fix some bugs
this is numai
this is numai
en which makes sense like we don't want
en which makes sense like we don't want
to go through torch as
to go through torch as
much and where is
much and where is
this 325
this is numpy do
whereare lot of numpy logic
is there a numpy one
hot
nope
nope
IAL zeros
I think this is
it what does one hot return I think it
it what does one hot return I think it
turns you Longs or
something one hot ins
this
it I don't know why it's giving me all
it I don't know why it's giving me all
this garbage
too many
too many
indices three were indexed
the hell is numai where why does it
the hell is numai where why does it
return two things
this did I is there trailing comma on
this
what how is it this length
three we turns out n the
array wait or object
type yes
how is this L
three
oh well that's mildly annoying
I mean I don't do I have any alternative
here it's already 6 p.m
that's a pretty decent chunk of code to
that's a pretty decent chunk of code to
be screwing around with but I don't know
be screwing around with but I don't know
why the hell torch is just failing in a
why the hell torch is just failing in a
sub process
ridiculous let me try one thing real
ridiculous let me try one thing real
quick for
can I get like the JX is way close to
can I get like the JX is way close to
numpy can I just get the numpy tensors
numpy can I just get the numpy tensors
out of
that okay that actually makes the
that okay that actually makes the
en it's not multiprocess but
okay so what's the
array
imple how do you do Jacks to numpy
numpy
numpy
array did
that okay
cannot
interpret torch int 64
oh I don't need
this where's the conversion for this
this where's the conversion for this
stupid thing
jack. numpy
how about
this is Jack half this speed of torch
this is Jack half this speed of torch
you kidding
me Jack s is slow [ __ ]
well this is the single let's
see the stupid Jacks is
see the stupid Jacks is
slow does this even
slow does this even
work or is it still
hang no way this still
hang no way this still
hangs with Jack as well
well if I've tried both bindings this
well if I've tried both bindings this
thing's broken right
I'm assuming it's hanging let me
check unless it's just really slow
talk already 600 p.m. I really want to
talk already 600 p.m. I really want to
have Day One support for this
thing I just don't understand how it's
thing I just don't understand how it's
possible that this thing just can't run
possible that this thing just can't run
in a sub process that's
ridiculous for
it's failing at a really weird spot as
it's failing at a really weird spot as
well e
I'm trying to think if there's anything
I'm trying to think if there's anything
I can do to figure this out
now this is nothing right this is just
um this isn't this is just
abstract I mean this is the same thing
abstract I mean this is the same thing
but it's got
think is there anything that would break
think is there anything that would break
this in a
this in a
subprocess there really shouldn't
be the fact that it's breaking on a
be the fact that it's breaking on a
random ass torch operation that's like a
random ass torch operation that's like a
divide
right well the Jack's hate continues as
right well the Jack's hate continues as
that was freaking half the speed anyways
that was freaking half the speed anyways
nice job jacks
oops for
if I just comment
it Norm three Norm
four is it in place Ops that are
four is it in place Ops that are
breaking
it for
okay this is
okay this is
screwed is it just the norm code
though does this do it
broken pipe
great which is probably the end code
right wait the end code is six
okay like what is in this
okay like what is in this
data is it maybe that this thing needs
data is it maybe that this thing needs
to be
can I just do
this wait
what does this run
be one with the tensor
dudee if it's like the old thing it's
dudee if it's like the old thing it's
supposed to be tensor flow this is more
supposed to be tensor flow this is more
like tensor smash my fist through a
like tensor smash my fist through a
brick
wall freaking cursed I tell
wall freaking cursed I tell
you absolutely
cursed where the hell is it hanging
cursed where the hell is it hanging
now do I need to leave these prints in
come
come
on
[ __ ] one
012 it's there's no GPU here this is CPU
012 it's there's no GPU here this is CPU
torch in the environment and it's
torch in the environment and it's
hanging on like random ass operations
hanging on like random ass operations
like
divides normalize and flatten partner
divides normalize and flatten partner
OBS okay so it is still freaking hanging
OBS okay so it is still freaking hanging
here
here
do you work if
I or
I or
12 so it's still freaking breaking
here and I don't know why it's not
here and I don't know why it's not
giving me sane error messages
either still doesn't work
it's the lines don't make sense I have
it's the lines don't make sense I have
it from these prints that like it's just
it from these prints that like it's just
hanging on random operations like
divides nanum was hanging before as
divides nanum was hanging before as
well maybe I should try this again now
well maybe I should try this again now
that I'm on Torch
2.4
no but like it should even if there is
no but like it should even if there is
something wrong I should have a bloody
something wrong I should have a bloody
error message it's just hanging randomly
error message it's just hanging randomly
torches just hanging
try
this how is there no do
this how is there no do
copy the
Clone I'm not compiling the model what
Clone I'm not compiling the model what
there is no model
there is no model
here compile torch and debug
mode how the [ __ ] is this
broken how about
broken how about
this I'm not going to go download torch
this I'm not going to go download torch
from source and have to compile it and
from source and have to compile it and
de bug mode that's just not
de bug mode that's just not
happening aren't the prince buff aren't
Prince
Prince
um can you do do
flush I don't
flush I don't
know I don't think so this is not a
know I don't think so this is not a
compiled
model for
I like there's also just nothing that
I like there's also just nothing that
should be breaking this
whatsoever like okay fine we're going to
whatsoever like okay fine we're going to
do
we're going to do this and then
we're going to do this and then
OBS
OBS
six equals z make it easy for one hot
six equals z make it easy for one hot
what's this
do still doesn't get there what
how does this still not get here nothing
how does this still not get here nothing
is
is
happening literally nothing is freaking
happening literally nothing is freaking
happening
here it's breaking on assigning to a
here it's breaking on assigning to a
tensor
literally breaking on
literally breaking on
assigning config vanilla
assigning config vanilla
object this tensor is breaking when I
object this tensor is breaking when I
assign something to it somehow that
assign something to it somehow that
shouldn't be possible this is a normal
shouldn't be possible this is a normal
ass
tensor what what is
it a norm normal freaking
tensor e
now that was a little much to
now that was a little much to
expect it to get right
huh just comment
it what is it going to help me to know
it what is it going to help me to know
where the lock and torches like it's
where the lock and torches like it's
this is like a it shouldn't be even able
this is like a it shouldn't be even able
to lock like this is [ __ ]
cursed that actually got through
cursed that actually got through
everything once at least probably it's
everything once at least probably it's
crashed somewhere else now in
TCH cuz it's still
hanging how do I do it without torch the
hanging how do I do it without torch the
[ __ ] I did it actually without torch
[ __ ] I did it actually without torch
I did it with Jack and I still got a
I did it with Jack and I still got a
hang in Jack it's some [ __ ] with the
hang in Jack it's some [ __ ] with the
engine like like it's some [ __ ] with
engine like like it's some [ __ ] with
the engine and how it's handling the
the engine and how it's handling the
memory I think
okay let's try one other
okay let's try one other
thing I'm going to keep their original
function all right well keep all these
prints last thing and I'm just going to
prints last thing and I'm just going to
make an issue and be like hey I can't I
make an issue and be like hey I can't I
couldn't give you Day One support this
couldn't give you Day One support this
thing is [ __ ] cursed and uh I don't
thing is [ __ ] cursed and uh I don't
know what the heck it is there's like
know what the heck it is there's like
some weird thing in madona
obviously they would have never tested
obviously they would have never tested
this because they're not using it in a
this because they're not using it in a
sub process
right damn
it bet get out of here you troll
that's not how programming
works it's like that's not how computer
works it's like that's not how computer
work
what if I do what if I clone it here
how the hell does that still
how the hell does that still
crash do
clone e
get partner
zero oh well this is interesting wait
zero oh well this is interesting wait
now it just fails
immediately for
how is the tensor
how is the tensor
creating Maybe
creating Maybe
I don't know how madron
works at the moment it
doesn't this is such horeshit like I
doesn't this is such horeshit like I
this was supposed to be very easy and
this was supposed to be very easy and
there's like some incredibly [ __ ]
there's like some incredibly [ __ ]
cursed thing in
here lib torch is
here lib torch is
used yeah this tensor it comes from see
used yeah this tensor it comes from see
it's really obnoxious because they don't
it's really obnoxious because they don't
have a way to go straight to numpy it
have a way to go straight to numpy it
only either goes to Jax or to torch
there's no like just tensor to numpy
and really this should work I don't know
and really this should work I don't know
what it is why like in a subprocess it
doesn't I still don't know if that fixes
doesn't I still don't know if that fixes
it though
it though
like there's something incredibly
like there's something incredibly
incredibly weird going on because torch
incredibly weird going on because torch
should not just be randomly hanging and
should not just be randomly hanging and
I got the same thing with
ja yeah it works outside of a sub
ja yeah it works outside of a sub
process just fine
here whoop
here whoop
works oh killed well it's killed because
works oh killed well it's killed because
this thing also has a memory leak in
this thing also has a memory leak in
it now if I run
it see runs lots of stuff
crazy right
issues probably on how madon
issues probably on how madon
yeah but like what do I do about that
yeah but like what do I do about that
right
yeah that I think shackle yeah it's the
yeah that I think shackle yeah it's the
it's the GPU game engine
thing driving me freaking
crazy
crazy
um hold
on Long Shot
try to create a Madrona tensor
and then copying it to
torch well yes it gets past that point
torch well yes it gets past that point
and then it crashes quite
quickly for
do this thing have a
close okay does have a
close
Okay
Okay
nope I was hoping that if I close the
nope I was hoping that if I close the
driver end
driver end
that
somehow I don't know how something is
somehow I don't know how something is
not like subprocess safe I get if it's
not like subprocess safe I get if it's
not thread safe how is it not subprocess
not thread safe how is it not subprocess
safe 12.1 the puffer box 12.1 torch
2.4 how the hell is something not
2.4 how the hell is something not
subprocess safe
it is forked I could try spawning it I
it is forked I could try spawning it I
actually don't know if that breaks
actually don't know if that breaks
puffer though I think it breaks puffer
puffer though I think it breaks puffer
the way that we do um our shared memory
if it
if it
broke have you tried it on Mac OS I
broke have you tried it on Mac OS I
don't
know I don't know how
know I don't know how
um the let me think how do we do our
um the let me think how do we do our
shared
meem maybe
meem maybe
not I thought that you used this the
not I thought that you used this the
spawn context um
how do I change the spawn context hold
on start mode
modu will not found
CJ for
the other problem like the spawn method
the other problem like the spawn method
is just so incredibly slow for starting
is just so incredibly slow for starting
um sub processes I mean I guess I could
um sub processes I mean I guess I could
put it as a workaround just for
put it as a workaround just for
Madrona if this actually helps
Madrona if this actually helps
but I don't know what cmake I
have okay well it gets do a
different this is
WSL reimport M Dron in the sub
process Cuda on
process Cuda on
Windows yeah this is WSL
though I could try it on Native Linux
though I could try it on Native Linux
I'd be very
I'd be very
surprised let me try one last thing
here
um how the hell is this broken again
can I do this
if this ends up actually being WSL I
if this ends up actually being WSL I
might actually ditch WSL for wasting
might actually ditch WSL for wasting
[ __ ] a whole day of my life
say
error what the
error what the
hell how can you possibly how can
hell how can you possibly how can
something possibly break on a [ __ ] on
something possibly break on a [ __ ] on
Fork context that's
Fork context that's
insane what on
Earth holy
Earth holy
curs that's a new
curs that's a new
one I've never seen that I've straight
one I've never seen that I've straight
up never seen that let's let's see if it
up never seen that let's let's see if it
gets any
throughput got get all these print out
throughput got get all these print out
of the
way okay but it's literally slower than
way okay but it's literally slower than
than a single proc it's literally slower
than a single proc it's literally slower
than uh single
process no way it's slower than single
process no way it's slower than single
thread
okay so one
okay so one
subprocess hold on
subprocess hold on
that
that
matches zero copy false
maybe still
slow how's that possible
okay so we do get speed up
from maybe I just don't have cores for
from maybe I just don't have cores for
this
reimport router TR Fork
server well I don't even know if puffer
server well I don't even know if puffer
works with uh
works with uh
fork and it's slow
here I mean we'll have to try on the
here I mean we'll have to try on the
main puffer box I guess
what about
this now something is
this now something is
happening oh wait is is madona I think I
happening oh wait is is madona I think I
know I
know [ __ ] thing
where's your stupid thing
where do I set the number of threads
where do I set the number of threads
here I need to set it to run single
thread I remember this
import
Leb do
Leb do
reload does that help I think y thaty I
reload does that help I think y thaty I
think what's happening is it's running
think what's happening is it's running
every single sub process with a bunch of
every single sub process with a bunch of
threads
God damn it where is
this for
there's just there is a freaking thing
there's just there is a freaking thing
here and I don't
you found
you found
it oh no
h
right
GPU Drive torch
M exec mode
profile how do I set the stupid
parameter okay GitHub very nice thank
parameter okay GitHub very nice thank
you for adding this whole window to not
you for adding this whole window to not
find me
why can't I find this stupid thing to
why can't I find this stupid thing to
find
anywhere is it a binding right here
n isn't that Cuda
okay this
net
world where is
world where is
Madrona Madrona
there's nowhere to set the number of
there's nowhere to set the number of
freaking threads let me actually
freaking threads let me actually
ask let me ask
Aaron you would know
what where why can't I find
what where why can't I find
Aaron
is e
okay I sent I sent him a
okay I sent I sent him a
message did you find it
actually could be this
how do I get it to
call every time I think I C++ can't be
call every time I think I C++ can't be
isn't that bad I should do more C++ it's
isn't that bad I should do more C++ it's
like
like
nope what is this
zero probably means like I don't know
zero probably means like I don't know
numb processes or something weird
but how do I get to it
Aaron said you didn't do anything for
Aaron said you didn't do anything for
CPU specific for single
threading are we sure
threading are we sure
uh yeah autod detect num CP so that's
uh yeah autod detect num CP so that's
going to screw it up
if I just run this
if I just run this
right like
this yeah you see it's spinning all my
this yeah you see it's spinning all my
bloody course see all this
bloody course see all this
multiprocess it's spinning all my cores
yeah it's automatically using them very
yeah it's automatically using them very
inefficiently look at
inefficiently look at
this puffer Li would have them all at
100 e
there's got to be some way to do
that it just shouldn't be that slow
I mean I could hold
on I can see like
if I do 111 like
this
ridiculous it's how many worlds do we
ridiculous it's how many worlds do we
want 32 *
want 32 *
128 do an autotune run on it it's not
128 do an autotune run on it it's not
going to help
what if I just do this this is so
what if I just do this this is so
incredibly
stupid no not multi
stupid no not multi
processing I just let it use its own
processing I just let it use its own
internal threadpool which is worse than
internal threadpool which is worse than
Puffer
it's like literally not getting any
it's like literally not getting any
benefit
whatsoever it's not getting like any
whatsoever it's not getting like any
benefit whatsoever
literally
slower well this is too big batch I
slower well this is too big batch I
guess so 32 worlds
no it is meant to run multiple processes
no it is meant to run multiple processes
on a single
Machine drive me freaking nuts I tell
Machine drive me freaking nuts I tell
you
um I mean the thing is like this is
um I mean the thing is like this is
still orders of
still orders of
magnitudes off of where it needs to be
magnitudes off of where it needs to be
even if I get it to
do well I mean to be fair the steps per
do well I mean to be fair the steps per
second is too
second is too
low just from the policy isn't it
doesn't make sense that it would be that
doesn't make sense that it would be that
low do I
have yeah I don't even have masking
on how the hell would it be that
slow is it this just not being compiled
looks like it
looks like it
is um hold on ego embed
sequential input
sequential input
do hidden
looks like Cuda bandwidth and
um yeah this is combination of Cuda
um yeah this is combination of Cuda
bandwidth and the environment being slow
but like if I make the network faster
but like if I make the network faster
the environment's still going to
the environment's still going to
bottleneck so that right there that 30%
bottleneck so that right there that 30%
is Cuda
is Cuda
bandwidth is ridiculous
they're just passing way too much
they're just passing way too much
freaking data
freaking data
man how do they have this much
man how do they have this much
data there's like no way that there's
data there's like no way that there's
this much data I don't believe
it let me see what the heck they they're
it let me see what the heck they they're
passing
okay how they have this much
stuff there's nothing in here
well the state is all
zero so that probably is not great
I don't see how they can possibly have
I don't see how they can possibly have
this much data
like this can be made substantially
like this can be made substantially
faster it's just like they have way too
faster it's just like they have way too
much data at the moment
but graph
yeah
e e
me look one last
thing
so this is the size per observation
okay well I got some progress with this
okay well I got some progress with this
not all that happy with how far we got
not all that happy with how far we got
today on this um it is what it is it's
today on this um it is what it is it's
just
just
like cursed lowlevel
like cursed lowlevel
[ __ ] and the ma like this thing is
[ __ ] and the ma like this thing is
very well written um this GPU Drive
very well written um this GPU Drive
thing is very well written it's just
thing is very well written it's just
madona being
stupid I mean also I guess the
stupid I mean also I guess the
observation
observation
size would be
good if I could just like trim it
down I don't know if we can do that
there's a constant that I can edit
to like
16 let me try something real quick
here
here
Max no you don't need this much stuff I
Max no you don't need this much stuff I
have
have
20 have 16 even too much freaking
data this is ridiculously fast as
data this is ridiculously fast as
well uh where's the make
is their make
Command will this be better all of a
Command will this be better all of a
sudden
cannot reshape
num
worlds where's um M observation space
worlds where's um M observation space
do
do
shape
shape
h m
h m
config scene config right render config
config scene config right render config
uh does this not get
passed it should be getting
pasted hey
linky yes indeed star of the
linky yes indeed star of the
perer is there anybody even watching
perer is there anybody even watching
this this is okay there are people
this this is okay there are people
watching this that's insane I don't know
watching this that's insane I don't know
why you people like watching me debug
why you people like watching me debug
absolutely curse stuff
absolutely curse stuff
but if this is at all useful to you
but if this is at all useful to you
please D the puffer repo and use my
please D the puffer repo and use my
suffering
suffering
um
yeah just right end up not having a good
time six including me on YouTube yeah
time six including me on YouTube yeah
well welcome all
it's weird this should actually be
it's weird this should actually be
um be
reasonable was told that this should
be yeah this is way too
be yeah this is way too
big I have to
big I have to
pip the install it with
pep crazy stuff
I don't understand why it's still this
I don't understand why it's still this
gigantic freaking
gigantic freaking
space um
space um
I'm passing it a
config for
config for
Rams is this getting like a garbage
config doesn't look like this has stuff
config doesn't look like this has stuff
in it
I can't get this thing to like compile
I can't get this thing to like compile
correctly with reasonable size
OBS you know what I'm going to do last
OBS you know what I'm going to do last
thing I'm going to do I because I like
thing I'm going to do I because I like
this is going to drive me nuts otherwise
this is going to drive me nuts otherwise
uh what we're going to do
how fast can we potentially get this
how fast can we potentially get this
thing running if I just
like this is going to just be the ego
like this is going to just be the ego
OBS what
keyboard razor uh what is this Black
keyboard razor uh what is this Black
Widow tournament Edition chroma
Widow tournament Edition chroma
V2 had this a long time
it's got like I think the medium clicky
it's got like I think the medium clicky
switches on it not the Super clicky not
switches on it not the Super clicky not
the linear
ones yeah you want to see I've got a
ones yeah you want to see I've got a
three-foot mouse pad I've got the Death
three-foot mouse pad I've got the Death
Adder here and I have absolutely no time
Adder here and I have absolutely no time
to play any games that's great
[Music]
[Music]
um it's not true I have a little time
um it's not true I have a little time
but
still hello new to the stream can I know
still hello new to the stream can I know
what you're working on I visit well this
what you're working on I visit well this
is probably going to be a bad
is probably going to be a bad
introduction cuz currently I'm working
introduction cuz currently I'm working
on being very mad trying to add a
on being very mad trying to add a
binding for a GPU accelerated
binding for a GPU accelerated
environment that has really cursed
environment that has really cursed
backend stuff um
backend stuff um
so I'm working on like very cursed
so I'm working on like very cursed
things I I wish I could tell you what
things I I wish I could tell you what
I'm working on because I wish I knew uh
I'm working on because I wish I knew uh
as for the repository with puffer lib
as for the repository with puffer lib
we're trying to make reinforcement
we're trying to make reinforcement
learning fast and easy
learning fast and easy
so make it easy for neural networks to
so make it easy for neural networks to
learn how to play games by playing games
learn how to play games by playing games
would be a reductive version of it and
would be a reductive version of it and
this
this
involves usually a lot of fun stuff but
involves usually a lot of fun stuff but
every so often a lot of very painful
every so often a lot of very painful
infrastructure
you know once in a while a lot of
you know once in a while a lot of
painful
infrastructure it usually is fun today
infrastructure it usually is fun today
it is not fun today no fun was had
it is not fun today no fun was had
whatsoever
none usually very
none usually very
fun today fun was not allowed
we do stuff like uh I've got like a
we do stuff like uh I've got like a
miniature version of DOTA that runs at a
miniature version of DOTA that runs at a
million frames per
million frames per
second I've got a version of like
second I've got a version of like
slither.io that runs at like 12 million
slither.io that runs at like 12 million
frames per
frames per
second we've got a bunch of other fun
second we've got a bunch of other fun
stuff as well
got bite and
float for
okay so that is now
okay so that is now
42,000 fully bottlenecked by the
42,000 fully bottlenecked by the
EnV no longer bottle you see the misk
EnV no longer bottle you see the misk
time that went down that's to to device
transfer the that guy if you're still
transfer the that guy if you're still
around we got to totally fix that thing
around we got to totally fix that thing
like that's got to be
buffered okay now it's at 50K for
that's weird
this is
4096 even the network could be faster
here but the m is just
here but the m is just
like unacceptably
slow runs at like 100k I think
it's taking a
path I mean the forward pass is still
path I mean the forward pass is still
like forward pass should be faster than
like forward pass should be faster than
that as well
technically I could do a puffer GPU Sim
technically I could do a puffer GPU Sim
version of
this but then there wouldn't be as much
this but then there wouldn't be as much
um
um
puffer really wouldn't be able to do as
puffer really wouldn't be able to do as
much for
it
damn it's already 7:21 I got to get
damn it's already 7:21 I got to get
dinner and like let me last try is there
dinner and like let me last try is there
any way I can get this thing to run with
any way I can get this thing to run with
the single thread if I can at least get
the single thread if I can at least get
it to run single thread I can do
it to run single thread I can do
something with
that drive me
nuts didn't that guy link
something yeah he did
they vendored it okay
can I just try one thing I'm I'm going
can I just try one thing I'm I'm going
to try one thing it's going to be
Jank
MW why can't I see this here
what
the oh this is in Source
Madrona but wait didn't they vendor it
Madrona but wait didn't they vendor it
hold on
or am I just
dumb no they didn't I'm just dumb I just
dumb no they didn't I'm just dumb I just
was reading it wrong
source
e where's the madona doesn't get it like
e where's the madona doesn't get it like
clone Madrona or
something external
if I just edit the darn
source for
oh man it's still doing
it how is it still doing this
not rec what's the issue oh my gosh what
not rec what's the issue oh my gosh what
issues don't I have um the stupid like
issues don't I have um the stupid like
we've got low-level dependencies that
we've got low-level dependencies that
are just being really dumb
are just being really dumb
um jobs num
um jobs num
workers the
Reds what is it that this guy linked
Reds what is it that this guy linked
meona
I thought I had it
I thought I had it
here I don't know it's like how can you
here I don't know it's like how can you
possibly have something where I can't
possibly have something where I can't
set it to run on one threat
like go ahead spin all my cores even
like go ahead spin all my cores even
when I freaking edited the source to try
when I freaking edited the source to try
to fix it
it's
insane spins all my
cores man you're
trolling where would it be it would it
trolling where would it be it would it
be in
Sim for
no idea
I don't think this
is did this just break my freaking shell
no that's not going to obviously that's
no that's not going to obviously that's
not going to work I'm just like playing
not going to work I'm just like playing
around at this point
around at this point
um okay well apparently this stupid
um okay well apparently this stupid
Library doesn't have an easy way to set
Library doesn't have an easy way to set
the number of threads and I can't figure
the number of threads and I can't figure
out how to do it even editing their
out how to do it even editing their
source code so
source code so
yeah that doesn't matter this is single
yeah that doesn't matter this is single
like this is I'm this is supposed to be
like this is I'm this is supposed to be
running single thread and it's using all
running single thread and it's using all
my cores so this is dumb um it's using
my cores so this is dumb um it's using
all my cores very inefficiently I would
all my cores very inefficiently I would
add because it's like it's deciding to
add because it's like it's deciding to
use its own garbage C++ implementation
use its own garbage C++ implementation
instead of my python implementation
instead of my python implementation
which is going to ironically be much
faster OMP is not going to do anything
faster OMP is not going to do anything
anyways I don't know why I was trying
anyways I don't know why I was trying
that
um where where what
um where where what
file what file are you in
the number of times a language model has
the number of times a language model has
been right or helpful when I've been
been right or helpful when I've been
stuck so far has been
zero why why don't I have that file
zero why why don't I have that file
right there so I have is
right there so I have is
that is that not on the master Branch
that is that not on the master Branch
like what
madona include
Madrona set this to
one I don't know why there's
one I don't know why there's
a but here let's try it
dve if this works at least like I'll
dve if this works at least like I'll
have something to go off before
tomorrow I got to at least order my food
tomorrow I got to at least order my food
on the side here because otherwise I'm
on the side here because otherwise I'm
going to not have any I'm not going to
going to not have any I'm not going to
be able to eat
three
three
miles just give me a sandwich
okay e
one
sec now that's a joke I'm not doing
sec now that's a joke I'm not doing
that California [ __ ] 30 bucks to get
that California [ __ ] 30 bucks to get
a sandwich
hold on let me just find something to
hold on let me just find something to
order real
order real
quick cutting a few pounds this week but
quick cutting a few pounds this week but
I'm figuring out what I want to
I'm figuring out what I want to
get um
um
I think working on this increases your
I think working on this increases your
chance of
chance of
spontaneous combustion honestly
I don't know why it's so difficult to
I don't know why it's so difficult to
find like reasonable stuff around
here like there's a lot of good food but
here like there's a lot of good food but
like sometimes it's just you can't find
like sometimes it's just you can't find
like reasonable
stuff e
just get a pami sandwich real quick
produce
sh
this literally ends up being just as bad
this literally ends up being just as bad
and I'm sure that this is way
and I'm sure that this is way
worse H we just eat the cost for now
worse H we just eat the cost for now
then freaking
[ __ ] I swear if there were just like
[ __ ] I swear if there were just like
a diner a half mile from here I would be
a diner a half mile from here I would be
I'd just be set I would never have to
I'd just be set I would never have to
care about
care about
anything um
I'm like absolutely somebody that is
I'm like absolutely somebody that is
more than happy going to a diner like
more than happy going to a diner like
five times a
week um no no food truck I'm I generally
week um no no food truck I'm I generally
don't get stuff from food trucks because
don't get stuff from food trucks because
I like of just hygiene stuff
I like of just hygiene stuff
I've had too much like too many long too
I've had too much like too many long too
much long-term Health damage from um
much long-term Health damage from um
food poisoning over the years
already in fact I'm not even getting
already in fact I'm not even getting
lettuce on the sandwich because I don't
lettuce on the sandwich because I don't
trust I don't trust people to wash
trust I don't trust people to wash
lettuce is that
funny I basically just will not get
funny I basically just will not get
lettuce from places
you get freaking salmonella once you
you get freaking salmonella once you
never want to have any lettuce ever
again oh it's not hard to have zero it's
again oh it's not hard to have zero it's
just like lazies that don't do their job
just like lazies that don't do their job
and then they freaking kill you um
okay
so does this do
anything how is it still using all the
anything how is it still using all the
cores like literally
how that doesn't even make sense right I
how that doesn't even make sense right I
just recompiled it
this is just running single thread man
this is just running single thread man
it should be May in what are your
settings it's running without
vectorization it's running serial V I
vectorization it's running serial V I
should
say I also don't understand why this
say I also don't understand why this
thing doesn't exit cleanly and it just
thing doesn't exit cleanly and it just
leaves your cord spinning that's kind of
leaves your cord spinning that's kind of
gross
no it's not designed to run in serial VC
no it's not designed to run in serial VC
they have bad vectorization that I'm
they have bad vectorization that I'm
currently being forced to
currently being forced to
use puffer's back is basically always
use puffer's back is basically always
going to be better
is it not recompiling this or something
I mean this is just the default value is
I mean this is just the default value is
this getting called from somewhere
this getting called from somewhere
threadpool
executor could be
executor could be
right there a window
source
uhuh const config
CFG inl what the
heck doesn't have num workers
anywhere
CFG where's the actual implementation
CFG where's the actual implementation
for this thing
yeah that's what I'm looking
yeah that's what I'm looking
for but it's using get num cores which I
for but it's using get num cores which I
also I set all these to
also I set all these to
one right
for e
okay I mean this is like all the places
okay I mean this is like all the places
I can think
of the last like I don't know other than
this I don't know otherwise like why
this I don't know otherwise like why
it's just using all my bloody cores
and this is why I just really hate
and this is why I just really hate
working with like big
working with like big
clunky I mean the the GPU Drive code
clunky I mean the the GPU Drive code
base is fine it's the freaking Madrona
base is fine it's the freaking Madrona
code base that drives me
nuts it's like such a cool concept as
nuts it's like such a cool concept as
well but like
okay what is I don't know what you're
okay what is I don't know what you're
pasting roll out threads
SPS all my
SPS all my
course well I can't do anything about
that I really can't do anything about
that I really can't do anything about
that
um man can make a GPU pass through I
um man can make a GPU pass through I
guess and just have it run on GPU but
guess and just have it run on GPU but
that's not going to
that's not going to
be is not going to be anywhere near as
nice I guess it would
work yeah but the thing is usually like
work yeah but the thing is usually like
even if you have 24 cores is the thing
I don't know how much logic is in the
I don't know how much logic is in the
driving Sy to be fair it could be it's
driving Sy to be fair it could be it's
way heavier than it
way heavier than it
looks but
looks but
it like just looking at the M I don't
it like just looking at the M I don't
know how much physics and stuff they're
know how much physics and stuff they're
doing I guess they said they have lar
doing I guess they said they have lar
and stuff so maybe there's a bunch of
and stuff so maybe there's a bunch of
logic maybe there's like actually a
logic maybe there's like actually a
bunch of like really heavy Sim stuff
so I this has been like enough of my
so I this has been like enough of my
life at this point I think that tomorrow
life at this point I think that tomorrow
um I will do I'll just make a GPU
um I will do I'll just make a GPU
binding that'll be nice that'll mean
binding that'll be nice that'll mean
that we'll have a GPU back end for
that we'll have a GPU back end for
puffer which is cool um and then you
puffer which is cool um and then you
know puffer will just provide the the
know puffer will just provide the the
extra utils and stuff the convenience
extra utils and stuff the convenience
and the hyper Prem stuff and all of that
and the hyper Prem stuff and all of that
which is fine it's mainly like puffer is
which is fine it's mainly like puffer is
mainly supposed to be for CPU M's
mainly supposed to be for CPU M's
anyways that's where like most of Tex
anyways that's where like most of Tex
deck is at the moment but whatever I can
deck is at the moment but whatever I can
add just a binding for this and not be
add just a binding for this and not be
have this be so incredibly
have this be so incredibly
painful um what did open AI do oh they
painful um what did open AI do oh they
didn't do anything like their Ms were
didn't do anything like their Ms were
just slow period and then they spent
just slow period and then they spent
money to make you know to get more
cores that's what they did
I check a couple
things hopefully more productive day
things hopefully more productive day
tomorrow you're going to have a bad day
tomorrow you're going to have a bad day
once in a while
4200 that's
4200 that's
cool and
cool and
puffer still
puffer still
758 pretty nice little uptick in the
758 pretty nice little uptick in the
growth though in the last couple of days
growth though in the last couple of days
right
here so tomorrow what I'll do is I'll
here so tomorrow what I'll do is I'll
add the GPU
add the GPU
bind
bind
um I guess we can look real quick at
um I guess we can look real quick at
our w b
our w b
results I mean I need to get more
results I mean I need to get more
experiments loaded and stuff as well
experiments loaded and stuff as well
but jeez
let's see um at least a couple
let's see um at least a couple
reasonable results from today
reasonable results from today
so this is Space
Invaders Space Invaders does not do
Invaders Space Invaders does not do
amazingly what do they have in the
um do we have the result in
po uh paper
I think they have the results in the
appendix okay so it also it takes them a
appendix okay so it also it takes them a
while to get above 500 as well this is
while to get above 500 as well this is
like a 200 mil frames or whatever so I
like a 200 mil frames or whatever so I
don't feel too bad about that that it
don't feel too bad about that that it
takes you know a while to get above the
takes you know a while to get above the
Mark um
and then this is the new
and then this is the new
one sequ
one sequ
Quest oh we actually just beat them
Quest oh we actually just beat them
straight up on cqu Quest like
straight up on cqu Quest like
immediately look at
immediately look at
that that's really
that that's really
solid yeah these are good these are good
solid yeah these are good these are good
implementations these are very good
implementations solvar with just hyper
implementations solvar with just hyper
pram tuning
most of these did pretty well a couple
most of these did pretty well a couple
of M's um didn't but like the curves
of M's um didn't but like the curves
were always good it's just the uh some
were always good it's just the uh some
of them are just going to take more
of them are just going to take more
samples as
all okay so um I'll call it early today
all okay so um I'll call it early today
um this is definitely
cool e
okay
of course why do people tune in right
of course why do people tune in right
when I'm about to leave
when I'm about to leave
so here's the here's the brief summary
so here's the here's the brief summary
for folks um from today so I tried
for folks um from today so I tried
everything I could to get this new GPU
everything I could to get this new GPU
driving Sim uh working with puffer I got
driving Sim uh working with puffer I got
it to run after some absolutely here let
it to run after some absolutely here let
me find the m i got it to run after some
me find the m i got it to run after some
absolutely insane
absolutely insane
Shenanigans um but it's just like it's
Shenanigans um but it's just like it's
not fast on CPU because Madrona is
not fast on CPU because Madrona is
trying to multi-thread and it's doing it
trying to multi-thread and it's doing it
very very poorly and I can't find any
very very poorly and I can't find any
way to disable it so I think probably
way to disable it so I think probably
I'm going to just add a GPU binding
I'm going to just add a GPU binding
tomorrow cuz that will be relatively
tomorrow cuz that will be relatively
easy and take minimal modifications to
easy and take minimal modifications to
puffer um that will at least allow me to
puffer um that will at least allow me to
get training running at a reasonable
get training running at a reasonable
speed and be able to do carb sweeps and
speed and be able to do carb sweeps and
stuff so that we can have like some cool
stuff so that we can have like some cool
policies in this um that should work and
policies in this um that should work and
then yeah we'll see after that for sure
then yeah we'll see after that for sure
um there are a lot of things I can see
um there are a lot of things I can see
here where there could be speed
here where there could be speed
enhancements but it's it's tough as it
enhancements but it's it's tough as it
is at the moment so yep that's the whole
is at the moment so yep that's the whole
deal with everything uh other projects
deal with everything uh other projects
still happening uh the Atari stuff we'll
still happening uh the Atari stuff we'll
pick that back up probably on Thursday
pick that back up probably on Thursday
or Friday uh the MOBA stuff as well
or Friday uh the MOBA stuff as well
needs hyper pram sweeps uh the Atari
needs hyper pram sweeps uh the Atari
sweeps were kind of meant to test out
sweeps were kind of meant to test out
carbs and make sure everything
carbs and make sure everything
everything is good now that that's good
everything is good now that that's good
we've got the mobo oh yeah I forgot we
we've got the mobo oh yeah I forgot we
did do one cool thing let's see if it
did do one cool thing let's see if it
did anything
did anything
interesting I forgot that we did this
run I I let this run overnight for a
run I I let this run overnight for a
very long time though it's
very long time though it's
not interestingly um it doesn't seem
not interestingly um it doesn't seem
like it's gotten as far as I had
like it's gotten as far as I had
expected
SPS of
SPS of
5500 wait no 50 no this is reasonable
5500 wait no 50 no this is reasonable
SPS I don't know how it's possible that
SPS I don't know how it's possible that
this has
this has
taken this long
here this must have
crashed yeah this crashed well it ran
crashed yeah this crashed well it ran
for uh two billion steps at
for uh two billion steps at
least and we actually were getting
least and we actually were getting
we it looks like it was starting to
we it looks like it was starting to
learn stuff as
well yeah box Four reboot let me see if
well yeah box Four reboot let me see if
I can find the bug in this real quick
differing extents oh there's like a rare
differing extents oh there's like a rare
slice bug great I'll have to find that
slice bug great I'll have to find that
later that's
later that's
obnoxious it looks like there's a rare
obnoxious it looks like there's a rare
observation slice bug
it does look like this was starting to
it does look like this was starting to
learn some stuff though like these are
learn some stuff though like these are
good reward
good reward
curves interesting at
curves interesting at
least total Towers
least total Towers
taken you can see all the skill usages
taken you can see all the skill usages
we've got good
logs level means going up means they're
logs level means going up means they're
actually learning to do
actually learning to do
something so this project is looking
something so this project is looking
good there just a bunch of work to keep
good there just a bunch of work to keep
doing
doing
um yeah I'll be
um yeah I'll be
back through
back through
Friday I'll work on some stuff maybe
Friday I'll work on some stuff maybe
I'll even stream Saturday we'll see this
I'll even stream Saturday we'll see this
week and then
week and then
Sunday Sunday through like probably
Sunday Sunday through like probably
Tuesday or Wednesday I've got some other
Tuesday or Wednesday I've got some other
stuff to do and then I'll be back after
stuff to do and then I'll be back after
that that's the plan
all right though I'm going to call it
all right though I'm going to call it
here
here
um folks watching if you haven't already
um folks watching if you haven't already
if you want to support all this
work give the puffer a star helps me out
work give the puffer a star helps me out
a whole bunch puffer AI puffer lib and
a whole bunch puffer AI puffer lib and
other than that I we'll see you later
other than that I we'll see you later
bye

Kind: captions
Language: en
we're
back got some good questions
answered time to
answered time to
fix this
integration
integration
yeah I know I'm going off the rails here
yeah I know I'm going off the rails here
all right
all right
uh cool yeah the stream works so I have
uh cool yeah the stream works so I have
a text file with
a text file with
some some stuff on it yeah their m is
some some stuff on it yeah their m is
really fast I'm going to have to do some
really fast I'm going to have to do some
work to get it to be this fast um and
work to get it to be this fast um and
then also Deany is currently fixing a
then also Deany is currently fixing a
small bug um but in the meantime we have
small bug um but in the meantime we have
stuff to
stuff to
do so what I've been
do so what I've been
told what I have been
told what I have been
told uh there is a mask thing that I
told uh there is a mask thing that I
have to
set let me see where mask gets set
from be and receive
from be and receive
masks buff. masks okay so here here I
masks buff. masks okay so here here I
have to assign uh I have to assign masks
have to assign uh I have to assign masks
to the
to the
buffer that's
fine that should be no
fine that should be no
problemo um
problemo um
so OBS to numpy
we also need to do this mask
we also need to do this mask
thing
uh just do OBS and
mask let me make sure hold on let me
mask let me make sure hold on let me
grab this
grab this
window cuz I need to check I need to
window cuz I need to check I need to
leave the DMS open because in case uh
leave the DMS open because in case uh
bug is
fixed all
right
there so the first thing we need to do
there so the first thing we need to do
is figure out this mask um I've been
is figure out this mask um I've been
told it is self so mask
s.m. cont
s.m. cont
agent cont agent
agent cont agent
mask. numpy
mask. numpy
times self. nope not
duns m. dead agent mask.
duns m. dead agent mask.
numpy okay now we have the mask right
I think I can just do self. buff. mask
I think I can just do self. buff. mask
right self. buff.
right self. buff.
mask
equals
equals
yeah like this so I haven't I haven't
yeah like this so I haven't I haven't
made a buffer up here but when puffer
made a buffer up here but when puffer
vectorization runs it will be made for
vectorization runs it will be made for
me
and then that should be picked up
and then that should be picked up
automatically for
us I've also been told that
us I've also been told that
um I should look
um I should look
for I should look specifically
for I should look specifically
for scenes that have uh a reasonable
for scenes that have uh a reasonable
number of
number of
Agents scene config is scene
Agents scene config is scene
config K unique scenes
config K unique scenes
K unique
n selection
discipline I do need to filter for
these scene config
these scene config
let me see if I can
let me see if I can
find let me see if I can find
that
that
758 um where was the
758 um where was the
driver I thought I had a tab with it
start the repo folks helps out the
start the repo folks helps out the
project
um so many
um so many
branches a lot of
work so I was looking at this for this
work so I was looking at this for this
scene
config which is pi
Drive
config scene config what's in
config scene config what's in
here okay literally just a data class
here okay literally just a data class
cool um are there options to
filter you get path
filter you get path
data num
data num
worlds selection discipline
worlds selection discipline
is K unique
scenes
interesting exact
n okay so there's definitely something
n okay so there's definitely something
here
of course we can count with and without
of course we can count with and without
for
now because this is how they load
now because this is how they load
it so we should be able to match that
it so we should be able to match that
for now though unfortunately there's a
for now though unfortunately there's a
little there's a thing with how puffer
little there's a thing with how puffer
handles processing that's going to make
handles processing that's going to make
it a little harder
I would really like to set this to 32
I would really like to set this to 32
but we'll we'll come back to
but we'll we'll come back to
that
um see if this
Runs run it a few
Runs run it a few
times this bug is the the one that's
times this bug is the the one that's
being fixed right
being fixed right
now come
on there it
on there it
goes dead agent mask no attribute it's
goes dead agent mask no attribute it's
like dead agent mask or something silly
like dead agent mask or something silly
right
cont agent mask
exists does dead agent mask not
exists does dead agent mask not
exist
uhoh am I missing something in here
uhoh am I missing something in here
controlled agent mask it dos
Max agent
Max agent
count
count
[Music]
[Music]
normalize one
normalize one
code
render unwrapped and
render unwrapped and
visualizer so there is no dead uh I
visualizer so there is no dead uh I
don't see dead agent mask in here
don't see dead agent mask in here
anywhere so that's fine I can do this
anywhere so that's fine I can do this
for now and then I'm assuming this is
for now and then I'm assuming this is
like this gets created later or
something I was told that
something I was told that
these self.
these self.
buff no attribute
mask uh
really should be a mask
this bug will be gone in a few
minutes we'll just deal with it for now
really am I just getting
unlucky what do I do do I just reduce
unlucky what do I do do I just reduce
the number of M's to make it less likely
the number of M's to make it less likely
to
happen if I just do one world is it
happen if I just do one world is it
going to be like really unlikely for
going to be like really unlikely for
this to happen
yeah it's masks I'm just
dumb buff.
masks kind that works
then we have a breakpoint and
step
nice um now is there a dead agent
masks no
cont agent mask
I think we'll leave it like this for now
I think we'll leave it like this for now
this should still give us quite a bit um
this should still give us quite a bit um
let's just do let's do something for fun
so holy hell
do you see this it controls two
do you see this it controls two
agents
agents
jeez that's going to be
rough okay it's what I thought so at the
rough okay it's what I thought so at the
beginning of the episode none of the
beginning of the episode none of the
agents are
dead you can initialize it from the anai
so we'll just
do self. live
agent uh nump pi.
agent uh nump pi.
ons
ons
Bull and then
dead agent
mask like I cannot reproduce
it yeah let me get her the error
oh got it
yeah e
we've got a Repro of the
error
error
nice uh let's see if we can find the
nice uh let's see if we can find the
dead agent mask in the meantime
is it going to be really slow
is it going to be really slow
though it only has one
m and this particular m is like two
m and this particular m is like two
agents so I'll set this up to 10 and
agents so I'll set this up to 10 and
I'll just deal with the
I'll deal with
I'll deal with
this I want to see if I can find where
this I want to see if I can find where
the dead agent mask
is maybe I can just find it in their
Source it's B3
wrapper uhoh
oh they're using it for
duns yeah it's not from the
duns yeah it's not from the
okay I see what you mean by this this is
okay I see what you mean by this this is
fine it's because they're using duns in
fine it's because they're using duns in
kind of a weird
way yeah but that's fine
right this will mean you missed the last
right this will mean you missed the last
time
time
step though that's not a huge
deal yeah so what we'll do do
is
so live agent mask
equals
terminal
terminal
terminal and then this is
terminal and then this is
times self. live agent
times self. live agent
mask and this is already
mask and this is already
numpy perfect
does this now work
not seeing it failing
yet if I run it with multiprocessing
yet if I run it with multiprocessing
well that'll just make it fail right
well that'll just make it fail right
surely one of the M's won't work
so I think I need to get the uh I need
so I think I need to get the uh I need
to wait until I have the this bug fix I
think maybe I can find this egg
think maybe I can find this egg
fault that'd be funny
GPU Drive environment.
py well this is different this is me
py well this is different this is me
being stupid
here we
here we
go
go
uh M
torch dpu
torch dpu
Drive P
Drive P
GPU GPU Drive m m
forch encode Road points of
OBS oh if this is all the if this is the
OBS oh if this is all the if this is the
whole bug
whole bug
right then all I have to do
right then all I have to do
[Music]
is OBS of
I just do
this no because this happens in the
this no because this happens in the
inette right
do we have the m in here
somewhere scene world where is it self.
Sim point
Sim
dur Sim dot do we have
dur Sim dot do we have
cont controlled State
cont controlled State
tensor tensor
okay and where's this break
point
so I think it's something like
so I think it's something like
uh
uh
Road types of
do this
work can't reprod hold on
oops let me get
oops let me get
the files
H where do I put this paast
pin been so long since I have had to
pin been so long since I have had to
past pin
past pin
something for
hold on where do I get
this paast
bin there we go
does this fix it
uh this is not
uh this is not
rvel batch
equals re
shape what's up with the uh The Masks
shape what's up with the uh The Masks
hold on
s.m. cont agent
s.m. cont agent
mask
mask
tape why the heck can't I just out rvel
tape why the heck can't I just out rvel
this I should be able to
this I should be able to
right oh I I bet it's cuz uh this thing
right oh I I bet it's cuz uh this thing
has to
has to
be
be
rvel
rvel
Ravel I'll try
this seriously cannot be broadcast oh do
this seriously cannot be broadcast oh do
rvel Dumbo
ah this broke my terminal
shoot speed fixing
this if I just don't set this buff mask
this if I just don't set this buff mask
it'll be way faster
right yeah let me just run it a couple
right yeah let me just run it a couple
times
oops not this one
right e
cool so this is the the environment
cool so this is the the environment
working now it's very nice
um this should be enough for
um this should be enough for
us to be able to start doing a few
us to be able to start doing a few
things with this en I'd
say multiprocessing
say multiprocessing
work or is this still going to be
slow e
definitely something screwy with trying
definitely something screwy with trying
to vectorize this though I think that's
to vectorize this though I think that's
very odd
very odd
no I should totally be able to just
no I should totally be able to just
factorize
factorize
this the whole point of
this the whole point of
puffer
um clean puff
um clean puff
RL let's just open up receive Maybe
in order to
vectorize you need to use box
vectorize you need to use box
four I brought box four back
four I brought box four back
up no wait I didn't right I uh I did
up no wait I didn't right I uh I did
tell them to bring it back up but the
tell them to bring it back up but the
guy wasn't there
guy wasn't there
today so I did do my I did do my
today so I did do my I did do my
homework bet but um the guy wasn't there
homework bet but um the guy wasn't there
so rip he's going to be there tomorrow
can we replace guy with a robot that's
can we replace guy with a robot that's
not his job I don't have a guy on
not his job I don't have a guy on
payroll whose job it is just to press
payroll whose job it is just to press
buttons on boxes like there's a guy that
buttons on boxes like there's a guy that
works there on the property that like
works there on the property that like
you know is there sometimes with on
you know is there sometimes with on
different hours that like will just re
different hours that like will just re
like you know hey can you reboot this
like you know hey can you reboot this
stuff when it goes
[Music]
[Music]
down we've been doing some real cool
down we've been doing some real cool
stuff though
stuff though
today definitely something broken in V
today definitely something broken in V
very very odd um for something to be
very very odd um for something to be
broken in
V I assume I'm just not getting Trace
V I assume I'm just not getting Trace
backs or something
because I should be
because I should be
uh I should be fine here
let me think what this would possibly
be oh
be oh
also where did my DMs
also where did my DMs
go we go
is this on dev
is this on dev
Branch uh I don't know if I've committed
Branch uh I don't know if I've committed
it yet but yeah it will
be will be on dev
be will be on dev
Branch the goal here is um some buddies
Branch the goal here is um some buddies
at NYU released a really awesome
at NYU released a really awesome
multi-agent driving Sim and uh we're
multi-agent driving Sim and uh we're
doing Day One
support for
when is day one this is day one it was
when is day one this is day one it was
released today therefore today is day
one I can just figure out why whoops
one I can just figure out why whoops
let's not DM that
let's not DM that
um if I can just figure out why this
um if I can just figure out why this
won't vck that'd be great
m
trying to think why this would not work
trying to think why this would not work
in
Beck I can't think of anything
Beck I can't think of anything
fundamental unless it's eating an
fundamental unless it's eating an
error e
yeah yeah yeah let's look at VEC well
yeah yeah yeah let's look at VEC well
there's not going to be much to look
at because the multiprocessing is going
at because the multiprocessing is going
to be
it's going to give you like this worker
it's going to give you like this worker
function
right and you're not going to be able to
right and you're not going to be able to
do much from
do much from
here because this is in a
subprocess right
it's so weird that this
doesn't yeah it's very
doesn't yeah it's very
weird can you not make multiple of these
weird can you not make multiple of these
or something on the
or something on the
[Music]
same okay let's not just sit here
same okay let's not just sit here
there's got to be something we can do
there's got to be something we can do
right
one one one
one one one
go there's one environment on one
go there's one environment on one
process does it do
it apparently
it apparently
not still stuck so something about the
not still stuck so something about the
multiprocessing is just
multiprocessing is just
blocking it from working it could be a
blocking it from working it could be a
path issue
path issue
maybe be a path
maybe be a path
issue run Cal yeah it works in Cal
issue run Cal yeah it works in Cal
look even with all these M it'll work in
cereal there you go 35k train not too
cereal there you go 35k train not too
bad on the startup time
either should be way faster than this
either should be way faster than this
though with VC
though with VC
um got to be something I'm
um got to be something I'm
missing it is working
missing it is working
yes working
yes working
I'm a little suspicious with this CH
I'm a little suspicious with this CH
dur
dur
this thing
here try
multiprocessing is there anything up
multiprocessing is there anything up
nope there's nothing up there either
would it be something with the render
would it be something with the render
config or something trying to like open
config or something trying to like open
p game on
subprocesses let's
see it's also possible they've never
see it's also possible they've never
tested this on a sub process
what do we think what are our thoughts
what do we think what are our thoughts
on this ablate stuff oh yeah thanks why
on this ablate stuff oh yeah thanks why
didn't I think of that I got to do the
didn't I think of that I got to do the
ablat of
stuff a blate stuff he says ablate
stuff where's the post the
repo no repo yeah here
so Pi by top I don't don't how does that
so Pi by top I don't don't how does that
tell
me I think it's py game it's trying to
me I think it's py game it's trying to
initialize P game is going to be my
initialize P game is going to be my
guess
here can I just pass render config equal
here can I just pass render config equal
none is that a thing I can do
enable batch
enable batch
renderer incompatible okay so it doesn't
renderer incompatible okay so it doesn't
like doesn't like this
renderer m torch
it's got to be Pi game somewhere
right m.v is
LF this looks like it only calls on get
LF this looks like it only calls on get
render
render
though initialize
though initialize
simulator so this should be fine I
simulator so this should be fine I
thought what was happening is that they
thought what was happening is that they
were initializing the um
were initializing the um
I thought that they would be like
I thought that they would be like
initializing the renderer and Pi game on
initializing the renderer and Pi game on
a subprocess or
a subprocess or
something do you need the agent masking
something do you need the agent masking
it's not added at the moment and no you
it's not added at the moment and no you
wouldn't need the agent masking for
wouldn't need the agent masking for
this it's just going to make it
slower what happens if I just I leave r
slower what happens if I just I leave r
mode like this but instead of doing uh
mode like this but instead of doing uh
render mode where is
render mode where is
it render
it render
mode H for
mode H for
fish does that do
it this is single
it this is single
core yeah it works single
core the option
oh I see
all SCS
multiprocessing back end
and
and
nothing I was hoping that the render
nothing I was hoping that the render
mode would just make it work um if it's
mode would just make it work um if it's
not like loading P game but
not like loading P game but
no looks like
no looks like
not kind of weird
I wouldn't think that this would mess it
I wouldn't think that this would mess it
up I really
wouldn't exec
wouldn't exec
mode CPU
enable batch
renderer for
set up
rendering set
rendering set
up does this get
called that's probably the function I
want aha
want aha
gotcha exactly what I expected
gotcha if I comment you
out this is going to be a legendary call
out this is going to be a legendary call
if I get
it go away
visualizer really I thought this would
visualizer really I thought this would
work
dang I really thought that would
dang I really thought that would
work it's almost always like you're
work it's almost always like you're
doing some dumb render thing and it
doing some dumb render thing and it
messes it
messes it
up GPU Drive torch M right yeah this is
up GPU Drive torch M right yeah this is
what I'm using
I think I got to open up the remote
I think I got to open up the remote
debugger for this
unfortunately been so long since I've
unfortunately been so long since I've
used this
it's hanging as well it's not crashing
it's hanging as well it's not crashing
which is even weirder
remote
pdb
what oh it's a minimal containers is
what oh it's a minimal containers is
why are you using C aren't you using
CPU what do you mean on aren't you using
CPU what do you mean on aren't you using
CPU do you need render mode args but
CPU do you need render mode args but
drone is a different render back
end
44 all right accepted
connection okay the SIM initializes
okay so that actually works
not getting
not getting
reset it's getting made but not getting
reset it's getting made but not getting
reset is that a
thing can't be
thing can't be
right can't
be I can't do use
be I can't do use
GPU I I don't have madona compiled with
GPU I I don't have madona compiled with
Cuda man
could be I still
could be I still
think I am doing that right now do you
think I am doing that right now do you
see what I'm doing I'm doing I have a
see what I'm doing I'm doing I have a
remote debugger set up I don't bring
remote debugger set up I don't bring
this out very often but um
this out very often but um
this is the heavy debug
this is the heavy debug
tool this is when you have utterly
tool this is when you have utterly
cursed
cursed
Shenanigans they're driving you
Shenanigans they're driving you
mad when you bring these
out am I
dumb wait am I actually stupid
no it's not this is
fine right
wait self DOD
if I do this here does this do anything
different okay the fact that I don't get
different okay the fact that I don't get
the remote pdb prompt means it's not
the remote pdb prompt means it's not
getting
here so why would it not be getting
here so why would it not be getting
here it's possible I missed API stuff
here it's possible I missed API stuff
right this could very well be not even a
right this could very well be not even a
madona issue or anything this could just
madona issue or anything this could just
be a me being dumb
issue this is going to be so cool once
issue this is going to be so cool once
we get it working
was this the thing that was driving you
was this the thing that was driving you
and whoever crazy here I'll change it to
and whoever crazy here I'll change it to
1.0
1.0
whatever doesn't make a
difference though probably I shouldn't
difference though probably I shouldn't
touch code that's this deep but
whatever uh
m. reset
right and I'm just going to call a
seral I'm just going to call reset here
okay yeah this is all fine
still
still
no how early do I have to go in
here here
here here
is this too
late
really actually wait a
really actually wait a
second so if I go here
is there a lock
file how about this
waiting for connection right
oh it's a
space so I hit continue
here and then it fails
right I had to figure out when it's
right I had to figure out when it's
hanging
though it's indefinitely in the Creator
I was actually very impressed by some of
I was actually very impressed by some of
the stuff they did in this code
base they did uh very very well
here what
happened okay we made the driver end
happened okay we made the driver end
right on the main process we made the
right on the main process we made the
driver
driver
in
okay yeah and then it's going to fail in
okay yeah and then it's going to fail in
the sub process cool um
let me just try something really
quick if I just
do if I just do this
now this
works the car crashes into the
wall
wall
interesting you can open multiple of
interesting you can open multiple of
these
I get the init messages on
everything very
everything very
weird and then let's do initialized
initializing and we didn't get any
initializing and we didn't get any
initialized message right
[Music]
initializing puffer CPU
initializing puffer CPU
Drive oh no wait we do get right here
Drive oh no wait we do get right here
the driver process
initialized I'm going see if I put
initialized I'm going see if I put
it I'm sure if I put it right here it's
it I'm sure if I put it right here it's
failing on a knit
right yeah there you go same exact
right yeah there you go same exact
thing
thing
um I weird
very
weird
weird
oh
[ __ ] I bet it's
[ __ ] I bet it's
this that's so stupid but I bet it's
this yep
[Music]
[Music]
initializing oh no wait damn it I
initializing oh no wait damn it I
thought I solved
it man I was so sure that was going to
it man I was so sure that was going to
be it
where's their n
file how many launching simulat
file how many launching simulat
ators okay we get launch on all the
ators okay we get launch on all the
simulators if I put it down
here oh look at that we get launch on
here oh look at that we get launch on
all
these oh interesting so this does not
these oh interesting so this does not
work
um what the heck where would it be
um what the heck where would it be
failing that's
not that's
bizarre yeah done launch
bizarre yeah done launch
Sim okay
yeah I saw the done launch Sim there as
yeah I saw the done launch Sim there as
well I mean this it's got to be right
well I mean this it's got to be right
here right set up action
here right set up action
space
space
yep set up action space is
yep set up action space is
hanging
right hold on is that did that not work
I didn't get it here either
what oh get OBS
what oh get OBS
hangs
hangs
really get OBS is going to hang
how is that possible
okay so it's
definitely do you need continuous action
definitely do you need continuous action
spaces this is in the simulator code my
spaces this is in the simulator code my
friend friend is in the simulator code I
friend friend is in the simulator code I
should not need a damn
should not need a damn
thing uh it's get it's in get
OBS okay
OBS okay
print get
ego PR get
ego PR get
[Music]
[Music]
partner get Road
OBS get OBS
OBS get OBS
done we are actually print debugging
done we are actually print debugging
stuff because
weird works fine on the main
thread okay ego partner and then it dies
zero
one
4 don't ever do the thing I'm just doing
4 don't ever do the thing I'm just doing
do not ever do
this you only do this if you're
stupid
stupid
killed
killed
what oh memory leak real cool
uh where's the
aggressive where's all the kill all
aggressive where's all the kill all
prices there's like one really obnoxious
prices there's like one really obnoxious
gript that always works and nothing else
gript that always works and nothing else
ever
does okay get partner 012
normalize and flatten
I'm doing this really stupid right now
I'm doing this really stupid right now
because like this actually does not make
sense like I see absolutely nothing that
sense like I see absolutely nothing that
should be able to hang in here and yet
should be able to hang in here and yet
it's still hanging
Nan to num
how's that possible
fix there should not be Nan and
fix there should not be Nan and
OBS so I can just comment
it 0 one and two
no there's no way Divi a division is
no there's no way Divi a division is
hanging I don't believe
that not out of
memory I don't understand how the hell
memory I don't understand how the hell
that's even
possible
possible
01 wait Norm 01 yeah this literally
100 maybe the
indexing maybe it's like indexing a
indexing maybe it's like indexing a
gigantic
gigantic
tensor shouldn't
tensor shouldn't
be this is fine
let me install torch
Nev I don't care I want give me the
Nev I don't care I want give me the
install
hip install Cuda
hip install Cuda
12.1
boom what
what's the flag called no cash dur I
what's the flag called no cash dur I
don't know why it accepts the flag if
don't know why it accepts the flag if
it's not
correct huh
okay there we go and we'll see whether
okay there we go and we'll see whether
this fixes
it freaking random torch hanging bug
[Music]
fast Sim is all you
fast Sim is all you
need is
need is
true GPU Drive
h
I don't know why we have five people
I don't know why we have five people
watching me
watching me
debug random torch issues but welcome to
debug random torch issues but welcome to
the
the
debug um
it's going to be very cool if this thing
it's going to be very cool if this thing
works because basically what this will
works because basically what this will
mean is I'll just have to update the
mean is I'll just have to update the
puffer tank containers to all be 2.4
puffer tank containers to all be 2.4
solid people have been asking me to do
solid people have been asking me to do
that anyways that'll take me a little
that anyways that'll take me a little
bit of time won't be that bad though um
bit of time won't be that bad though um
I'll recompile like all of the docker
I'll recompile like all of the docker
builds with
builds with
2.4 I'll put this GPU drive on the uh on
2.4 I'll put this GPU drive on the uh on
the image while I'm doing
the image while I'm doing
that so we'll just have this environment
that so we'll just have this environment
be part
be part
of will be
of will be
distributed with the
distributed with the
docker and then it'll just
docker and then it'll just
work which will be really nice
I'm hoping we can get this to be
I'm hoping we can get this to be
reasonably fast as
reasonably fast as
well I mean I know that I can
well I mean I know that I can
have if I know that the policy can be
have if I know that the policy can be
made fast which I do then it's just
made fast which I do then it's just
going to be a matter of the M
going to be a matter of the M
Sim and I mean they say it's really fast
Sim and I mean they say it's really fast
on
on
GPU so we'll essentially just see how
GPU so we'll essentially just see how
well it is just optimized to GPU versus
well it is just optimized to GPU versus
fast in
fast in
general I would think with a driving Sim
general I would think with a driving Sim
there should be
there should be
like there should sort of be enough
like there should sort of be enough
logic that
logic that
um you should be able to get comparably
um you should be able to get comparably
fast stuff on good
fast stuff on good
CPU driving Sim doesn't strike me as
CPU driving Sim doesn't strike me as
something that would be amazing for um
something that would be amazing for um
for GPU so I think we should probably be
for GPU so I think we should probably be
able to get comparable just off of that
able to get comparable just off of that
like if this were like hardcore physics
like if this were like hardcore physics
Sim sure but I don't think it is
hopefully this does not break my uh
hopefully this does not break my uh
drivers we'll see I see it's downloading
drivers we'll see I see it's downloading
new
qnn but yeah I don't know if this will
qnn but yeah I don't know if this will
fix it either I'm trying to think what
fix it either I'm trying to think what
else it could be this really does look
else it could be this really does look
like torch bug to me though because how
like torch bug to me though because how
else can you have how else can you just
else can you have how else can you just
have a tensor that is hanging on a
have a tensor that is hanging on a
Division operation right that's got to
Division operation right that's got to
be bad torch bug of course that doesn't
be bad torch bug of course that doesn't
mean that it could be um that it's not
mean that it could be um that it's not
in this version as well
in this version as well
but I think it would
be I could also just write a numpy
be I could also just write a numpy
container right I could just write GPU
container right I could just write GPU
numpy en that's what I'll do
numpy en that's what I'll do
next because let me
see unless there's not a two numpy on
see unless there's not a two numpy on
this and you have to go through
this and you have to go through
torch is there a way to load Madrona
torch is there a way to load Madrona
tensor to numpy let me see
there docks for
this so this is a cool engine right
uh shoot it doesn't
have doesn't have
docks hav been updated in a while either
cpu.
cpu.
numpy I might be able to reduce the LI
numpy I might be able to reduce the LI
Reliance on Torch at the very least
right we'll see whether this is
right we'll see whether this is
torch let's start with this let's start
torch let's start with this let's start
with
with
this um but yeah we could also just
like what do we think should I just
like what do we think should I just
start doing
this I think I may as well because I
this I think I may as well because I
want to do this anyway so
want to do this anyway so
copy uh M
copy uh M
porch m numpy
numpy get D get
rewards reset let me
see get OBS I think it's called first
see get OBS I think it's called first
yeah let's let's look at
this and actually I can put this break
this and actually I can put this break
point in the uh the torch version all
right so we can figure this
out and a GPU Drive
Sim
CPU
CPU
there there's got to be a way to get
there there's got to be a way to get
this in numpy
this in numpy
right Two Jacks two
torch well this finished for now but it
torch well this finished for now but it
looks like there isn't a built-in
method so let's start here
damn it's still it still gets stuck
damn it's still it still gets stuck
here that is
crazy well I guess we're making M
crazy well I guess we're making M
numpy um How do you do Madrona to
torch and you do like that
asay I can do that it easily for now
though p
CPU
okay cpu.
np. copy
what's copy underscore like that is it
what's copy underscore like that is it
copy
too copies the elements from to Source
too copies the elements from to Source
into
into
self so it copies into it
that's really
that's really
annoying let's fix is this the are these
annoying let's fix is this the are these
the only
ones wait this is the torch on what am I
ones wait this is the torch on what am I
doing
for e
controlled
one one minus controlled mask
one one minus controlled mask
buol expand as Road
type okay good
and then this is the last one that we
and then this is the last one that we
don't know how to fix
don't know how to fix
right cuz we have SIM action
right cuz we have SIM action
tensor I guess this one's not
tensor I guess this one's not
terrible this is less Tor torch
terrible this is less Tor torch
logic so maybe we get
logic so maybe we get
lucky and
lucky and
um this is like not terrible to debug
um this is like not terrible to debug
we'll see
uh it is just it is just
uh it is just it is just
directly
directly
so comment
this we'll fix some bugs
this is numai
this is numai
en which makes sense like we don't want
en which makes sense like we don't want
to go through torch as
to go through torch as
much and where is
much and where is
this 325
this is numpy do
whereare lot of numpy logic
is there a numpy one
hot
nope
nope
IAL zeros
I think this is
it what does one hot return I think it
it what does one hot return I think it
turns you Longs or
something one hot ins
this
it I don't know why it's giving me all
it I don't know why it's giving me all
this garbage
too many
too many
indices three were indexed
the hell is numai where why does it
the hell is numai where why does it
return two things
this did I is there trailing comma on
this
what how is it this length
three we turns out n the
array wait or object
type yes
how is this L
three
oh well that's mildly annoying
I mean I don't do I have any alternative
here it's already 6 p.m
that's a pretty decent chunk of code to
that's a pretty decent chunk of code to
be screwing around with but I don't know
be screwing around with but I don't know
why the hell torch is just failing in a
why the hell torch is just failing in a
sub process
ridiculous let me try one thing real
ridiculous let me try one thing real
quick for
can I get like the JX is way close to
can I get like the JX is way close to
numpy can I just get the numpy tensors
numpy can I just get the numpy tensors
out of
that okay that actually makes the
that okay that actually makes the
en it's not multiprocess but
okay so what's the
array
imple how do you do Jacks to numpy
numpy
numpy
array did
that okay
cannot
interpret torch int 64
oh I don't need
this where's the conversion for this
this where's the conversion for this
stupid thing
jack. numpy
how about
this is Jack half this speed of torch
this is Jack half this speed of torch
you kidding
me Jack s is slow [ __ ]
well this is the single let's
see the stupid Jacks is
see the stupid Jacks is
slow does this even
slow does this even
work or is it still
hang no way this still
hang no way this still
hangs with Jack as well
well if I've tried both bindings this
well if I've tried both bindings this
thing's broken right
I'm assuming it's hanging let me
check unless it's just really slow
talk already 600 p.m. I really want to
talk already 600 p.m. I really want to
have Day One support for this
thing I just don't understand how it's
thing I just don't understand how it's
possible that this thing just can't run
possible that this thing just can't run
in a sub process that's
ridiculous for
it's failing at a really weird spot as
it's failing at a really weird spot as
well e
I'm trying to think if there's anything
I'm trying to think if there's anything
I can do to figure this out
now this is nothing right this is just
um this isn't this is just
abstract I mean this is the same thing
abstract I mean this is the same thing
but it's got
think is there anything that would break
think is there anything that would break
this in a
this in a
subprocess there really shouldn't
be the fact that it's breaking on a
be the fact that it's breaking on a
random ass torch operation that's like a
random ass torch operation that's like a
divide
right well the Jack's hate continues as
right well the Jack's hate continues as
that was freaking half the speed anyways
that was freaking half the speed anyways
nice job jacks
oops for
if I just comment
it Norm three Norm
four is it in place Ops that are
four is it in place Ops that are
breaking
it for
okay this is
okay this is
screwed is it just the norm code
though does this do it
broken pipe
great which is probably the end code
right wait the end code is six
okay like what is in this
okay like what is in this
data is it maybe that this thing needs
data is it maybe that this thing needs
to be
can I just do
this wait
what does this run
be one with the tensor
dudee if it's like the old thing it's
dudee if it's like the old thing it's
supposed to be tensor flow this is more
supposed to be tensor flow this is more
like tensor smash my fist through a
like tensor smash my fist through a
brick
wall freaking cursed I tell
wall freaking cursed I tell
you absolutely
cursed where the hell is it hanging
cursed where the hell is it hanging
now do I need to leave these prints in
come
come
on
[ __ ] one
012 it's there's no GPU here this is CPU
012 it's there's no GPU here this is CPU
torch in the environment and it's
torch in the environment and it's
hanging on like random ass operations
hanging on like random ass operations
like
divides normalize and flatten partner
divides normalize and flatten partner
OBS okay so it is still freaking hanging
OBS okay so it is still freaking hanging
here
here
do you work if
I or
I or
12 so it's still freaking breaking
here and I don't know why it's not
here and I don't know why it's not
giving me sane error messages
either still doesn't work
it's the lines don't make sense I have
it's the lines don't make sense I have
it from these prints that like it's just
it from these prints that like it's just
hanging on random operations like
divides nanum was hanging before as
divides nanum was hanging before as
well maybe I should try this again now
well maybe I should try this again now
that I'm on Torch
2.4
no but like it should even if there is
no but like it should even if there is
something wrong I should have a bloody
something wrong I should have a bloody
error message it's just hanging randomly
error message it's just hanging randomly
torches just hanging
try
this how is there no do
this how is there no do
copy the
Clone I'm not compiling the model what
Clone I'm not compiling the model what
there is no model
there is no model
here compile torch and debug
mode how the [ __ ] is this
broken how about
broken how about
this I'm not going to go download torch
this I'm not going to go download torch
from source and have to compile it and
from source and have to compile it and
de bug mode that's just not
de bug mode that's just not
happening aren't the prince buff aren't
Prince
Prince
um can you do do
flush I don't
flush I don't
know I don't think so this is not a
know I don't think so this is not a
compiled
model for
I like there's also just nothing that
I like there's also just nothing that
should be breaking this
whatsoever like okay fine we're going to
whatsoever like okay fine we're going to
do
we're going to do this and then
we're going to do this and then
OBS
OBS
six equals z make it easy for one hot
six equals z make it easy for one hot
what's this
do still doesn't get there what
how does this still not get here nothing
how does this still not get here nothing
is
is
happening literally nothing is freaking
happening literally nothing is freaking
happening
here it's breaking on assigning to a
here it's breaking on assigning to a
tensor
literally breaking on
literally breaking on
assigning config vanilla
assigning config vanilla
object this tensor is breaking when I
object this tensor is breaking when I
assign something to it somehow that
assign something to it somehow that
shouldn't be possible this is a normal
shouldn't be possible this is a normal
ass
tensor what what is
it a norm normal freaking
tensor e
now that was a little much to
now that was a little much to
expect it to get right
huh just comment
it what is it going to help me to know
it what is it going to help me to know
where the lock and torches like it's
where the lock and torches like it's
this is like a it shouldn't be even able
this is like a it shouldn't be even able
to lock like this is [ __ ]
cursed that actually got through
cursed that actually got through
everything once at least probably it's
everything once at least probably it's
crashed somewhere else now in
TCH cuz it's still
hanging how do I do it without torch the
hanging how do I do it without torch the
[ __ ] I did it actually without torch
[ __ ] I did it actually without torch
I did it with Jack and I still got a
I did it with Jack and I still got a
hang in Jack it's some [ __ ] with the
hang in Jack it's some [ __ ] with the
engine like like it's some [ __ ] with
engine like like it's some [ __ ] with
the engine and how it's handling the
the engine and how it's handling the
memory I think
okay let's try one other
okay let's try one other
thing I'm going to keep their original
function all right well keep all these
prints last thing and I'm just going to
prints last thing and I'm just going to
make an issue and be like hey I can't I
make an issue and be like hey I can't I
couldn't give you Day One support this
couldn't give you Day One support this
thing is [ __ ] cursed and uh I don't
thing is [ __ ] cursed and uh I don't
know what the heck it is there's like
know what the heck it is there's like
some weird thing in madona
obviously they would have never tested
obviously they would have never tested
this because they're not using it in a
this because they're not using it in a
sub process
right damn
it bet get out of here you troll
that's not how programming
works it's like that's not how computer
works it's like that's not how computer
work
what if I do what if I clone it here
how the hell does that still
how the hell does that still
crash do
clone e
get partner
zero oh well this is interesting wait
zero oh well this is interesting wait
now it just fails
immediately for
how is the tensor
how is the tensor
creating Maybe
creating Maybe
I don't know how madron
works at the moment it
doesn't this is such horeshit like I
doesn't this is such horeshit like I
this was supposed to be very easy and
this was supposed to be very easy and
there's like some incredibly [ __ ]
there's like some incredibly [ __ ]
cursed thing in
here lib torch is
here lib torch is
used yeah this tensor it comes from see
used yeah this tensor it comes from see
it's really obnoxious because they don't
it's really obnoxious because they don't
have a way to go straight to numpy it
have a way to go straight to numpy it
only either goes to Jax or to torch
there's no like just tensor to numpy
and really this should work I don't know
and really this should work I don't know
what it is why like in a subprocess it
doesn't I still don't know if that fixes
doesn't I still don't know if that fixes
it though
it though
like there's something incredibly
like there's something incredibly
incredibly weird going on because torch
incredibly weird going on because torch
should not just be randomly hanging and
should not just be randomly hanging and
I got the same thing with
ja yeah it works outside of a sub
ja yeah it works outside of a sub
process just fine
here whoop
here whoop
works oh killed well it's killed because
works oh killed well it's killed because
this thing also has a memory leak in
this thing also has a memory leak in
it now if I run
it see runs lots of stuff
crazy right
issues probably on how madon
issues probably on how madon
yeah but like what do I do about that
yeah but like what do I do about that
right
yeah that I think shackle yeah it's the
yeah that I think shackle yeah it's the
it's the GPU game engine
thing driving me freaking
crazy
crazy
um hold
on Long Shot
try to create a Madrona tensor
and then copying it to
torch well yes it gets past that point
torch well yes it gets past that point
and then it crashes quite
quickly for
do this thing have a
close okay does have a
close
Okay
Okay
nope I was hoping that if I close the
nope I was hoping that if I close the
driver end
driver end
that
somehow I don't know how something is
somehow I don't know how something is
not like subprocess safe I get if it's
not like subprocess safe I get if it's
not thread safe how is it not subprocess
not thread safe how is it not subprocess
safe 12.1 the puffer box 12.1 torch
2.4 how the hell is something not
2.4 how the hell is something not
subprocess safe
it is forked I could try spawning it I
it is forked I could try spawning it I
actually don't know if that breaks
actually don't know if that breaks
puffer though I think it breaks puffer
puffer though I think it breaks puffer
the way that we do um our shared memory
if it
if it
broke have you tried it on Mac OS I
broke have you tried it on Mac OS I
don't
know I don't know how
know I don't know how
um the let me think how do we do our
um the let me think how do we do our
shared
meem maybe
meem maybe
not I thought that you used this the
not I thought that you used this the
spawn context um
how do I change the spawn context hold
on start mode
modu will not found
CJ for
the other problem like the spawn method
the other problem like the spawn method
is just so incredibly slow for starting
is just so incredibly slow for starting
um sub processes I mean I guess I could
um sub processes I mean I guess I could
put it as a workaround just for
put it as a workaround just for
Madrona if this actually helps
Madrona if this actually helps
but I don't know what cmake I
have okay well it gets do a
different this is
WSL reimport M Dron in the sub
process Cuda on
process Cuda on
Windows yeah this is WSL
though I could try it on Native Linux
though I could try it on Native Linux
I'd be very
I'd be very
surprised let me try one last thing
here
um how the hell is this broken again
can I do this
if this ends up actually being WSL I
if this ends up actually being WSL I
might actually ditch WSL for wasting
might actually ditch WSL for wasting
[ __ ] a whole day of my life
say
error what the
error what the
hell how can you possibly how can
hell how can you possibly how can
something possibly break on a [ __ ] on
something possibly break on a [ __ ] on
Fork context that's
Fork context that's
insane what on
Earth holy
Earth holy
curs that's a new
curs that's a new
one I've never seen that I've straight
one I've never seen that I've straight
up never seen that let's let's see if it
up never seen that let's let's see if it
gets any
throughput got get all these print out
throughput got get all these print out
of the
way okay but it's literally slower than
way okay but it's literally slower than
than a single proc it's literally slower
than a single proc it's literally slower
than uh single
process no way it's slower than single
process no way it's slower than single
thread
okay so one
okay so one
subprocess hold on
subprocess hold on
that
that
matches zero copy false
maybe still
slow how's that possible
okay so we do get speed up
from maybe I just don't have cores for
from maybe I just don't have cores for
this
reimport router TR Fork
server well I don't even know if puffer
server well I don't even know if puffer
works with uh
works with uh
fork and it's slow
here I mean we'll have to try on the
here I mean we'll have to try on the
main puffer box I guess
what about
this now something is
this now something is
happening oh wait is is madona I think I
happening oh wait is is madona I think I
know I
know [ __ ] thing
where's your stupid thing
where do I set the number of threads
where do I set the number of threads
here I need to set it to run single
thread I remember this
import
Leb do
Leb do
reload does that help I think y thaty I
reload does that help I think y thaty I
think what's happening is it's running
think what's happening is it's running
every single sub process with a bunch of
every single sub process with a bunch of
threads
God damn it where is
this for
there's just there is a freaking thing
there's just there is a freaking thing
here and I don't
you found
you found
it oh no
h
right
GPU Drive torch
M exec mode
profile how do I set the stupid
parameter okay GitHub very nice thank
parameter okay GitHub very nice thank
you for adding this whole window to not
you for adding this whole window to not
find me
why can't I find this stupid thing to
why can't I find this stupid thing to
find
anywhere is it a binding right here
n isn't that Cuda
okay this
net
world where is
world where is
Madrona Madrona
there's nowhere to set the number of
there's nowhere to set the number of
freaking threads let me actually
freaking threads let me actually
ask let me ask
Aaron you would know
what where why can't I find
what where why can't I find
Aaron
is e
okay I sent I sent him a
okay I sent I sent him a
message did you find it
actually could be this
how do I get it to
call every time I think I C++ can't be
call every time I think I C++ can't be
isn't that bad I should do more C++ it's
isn't that bad I should do more C++ it's
like
like
nope what is this
zero probably means like I don't know
zero probably means like I don't know
numb processes or something weird
but how do I get to it
Aaron said you didn't do anything for
Aaron said you didn't do anything for
CPU specific for single
threading are we sure
threading are we sure
uh yeah autod detect num CP so that's
uh yeah autod detect num CP so that's
going to screw it up
if I just run this
if I just run this
right like
this yeah you see it's spinning all my
this yeah you see it's spinning all my
bloody course see all this
bloody course see all this
multiprocess it's spinning all my cores
yeah it's automatically using them very
yeah it's automatically using them very
inefficiently look at
inefficiently look at
this puffer Li would have them all at
100 e
there's got to be some way to do
that it just shouldn't be that slow
I mean I could hold
on I can see like
if I do 111 like
this
ridiculous it's how many worlds do we
ridiculous it's how many worlds do we
want 32 *
want 32 *
128 do an autotune run on it it's not
128 do an autotune run on it it's not
going to help
what if I just do this this is so
what if I just do this this is so
incredibly
stupid no not multi
stupid no not multi
processing I just let it use its own
processing I just let it use its own
internal threadpool which is worse than
internal threadpool which is worse than
Puffer
it's like literally not getting any
it's like literally not getting any
benefit
whatsoever it's not getting like any
whatsoever it's not getting like any
benefit whatsoever
literally
slower well this is too big batch I
slower well this is too big batch I
guess so 32 worlds
no it is meant to run multiple processes
no it is meant to run multiple processes
on a single
Machine drive me freaking nuts I tell
Machine drive me freaking nuts I tell
you
um I mean the thing is like this is
um I mean the thing is like this is
still orders of
still orders of
magnitudes off of where it needs to be
magnitudes off of where it needs to be
even if I get it to
do well I mean to be fair the steps per
do well I mean to be fair the steps per
second is too
second is too
low just from the policy isn't it
doesn't make sense that it would be that
doesn't make sense that it would be that
low do I
have yeah I don't even have masking
on how the hell would it be that
slow is it this just not being compiled
looks like it
looks like it
is um hold on ego embed
sequential input
sequential input
do hidden
looks like Cuda bandwidth and
um yeah this is combination of Cuda
um yeah this is combination of Cuda
bandwidth and the environment being slow
but like if I make the network faster
but like if I make the network faster
the environment's still going to
the environment's still going to
bottleneck so that right there that 30%
bottleneck so that right there that 30%
is Cuda
is Cuda
bandwidth is ridiculous
they're just passing way too much
they're just passing way too much
freaking data
freaking data
man how do they have this much
man how do they have this much
data there's like no way that there's
data there's like no way that there's
this much data I don't believe
it let me see what the heck they they're
it let me see what the heck they they're
passing
okay how they have this much
stuff there's nothing in here
well the state is all
zero so that probably is not great
I don't see how they can possibly have
I don't see how they can possibly have
this much data
like this can be made substantially
like this can be made substantially
faster it's just like they have way too
faster it's just like they have way too
much data at the moment
but graph
yeah
e e
me look one last
thing
so this is the size per observation
okay well I got some progress with this
okay well I got some progress with this
not all that happy with how far we got
not all that happy with how far we got
today on this um it is what it is it's
today on this um it is what it is it's
just
just
like cursed lowlevel
like cursed lowlevel
[ __ ] and the ma like this thing is
[ __ ] and the ma like this thing is
very well written um this GPU Drive
very well written um this GPU Drive
thing is very well written it's just
thing is very well written it's just
madona being
stupid I mean also I guess the
stupid I mean also I guess the
observation
observation
size would be
good if I could just like trim it
down I don't know if we can do that
there's a constant that I can edit
to like
16 let me try something real quick
here
here
Max no you don't need this much stuff I
Max no you don't need this much stuff I
have
have
20 have 16 even too much freaking
data this is ridiculously fast as
data this is ridiculously fast as
well uh where's the make
is their make
Command will this be better all of a
Command will this be better all of a
sudden
cannot reshape
num
worlds where's um M observation space
worlds where's um M observation space
do
do
shape
shape
h m
h m
config scene config right render config
config scene config right render config
uh does this not get
passed it should be getting
pasted hey
linky yes indeed star of the
linky yes indeed star of the
perer is there anybody even watching
perer is there anybody even watching
this this is okay there are people
this this is okay there are people
watching this that's insane I don't know
watching this that's insane I don't know
why you people like watching me debug
why you people like watching me debug
absolutely curse stuff
absolutely curse stuff
but if this is at all useful to you
but if this is at all useful to you
please D the puffer repo and use my
please D the puffer repo and use my
suffering
suffering
um
yeah just right end up not having a good
time six including me on YouTube yeah
time six including me on YouTube yeah
well welcome all
it's weird this should actually be
it's weird this should actually be
um be
reasonable was told that this should
be yeah this is way too
be yeah this is way too
big I have to
big I have to
pip the install it with
pep crazy stuff
I don't understand why it's still this
I don't understand why it's still this
gigantic freaking
gigantic freaking
space um
space um
I'm passing it a
config for
config for
Rams is this getting like a garbage
config doesn't look like this has stuff
config doesn't look like this has stuff
in it
I can't get this thing to like compile
I can't get this thing to like compile
correctly with reasonable size
OBS you know what I'm going to do last
OBS you know what I'm going to do last
thing I'm going to do I because I like
thing I'm going to do I because I like
this is going to drive me nuts otherwise
this is going to drive me nuts otherwise
uh what we're going to do
how fast can we potentially get this
how fast can we potentially get this
thing running if I just
like this is going to just be the ego
like this is going to just be the ego
OBS what
keyboard razor uh what is this Black
keyboard razor uh what is this Black
Widow tournament Edition chroma
Widow tournament Edition chroma
V2 had this a long time
it's got like I think the medium clicky
it's got like I think the medium clicky
switches on it not the Super clicky not
switches on it not the Super clicky not
the linear
ones yeah you want to see I've got a
ones yeah you want to see I've got a
three-foot mouse pad I've got the Death
three-foot mouse pad I've got the Death
Adder here and I have absolutely no time
Adder here and I have absolutely no time
to play any games that's great
[Music]
[Music]
um it's not true I have a little time
um it's not true I have a little time
but
still hello new to the stream can I know
still hello new to the stream can I know
what you're working on I visit well this
what you're working on I visit well this
is probably going to be a bad
is probably going to be a bad
introduction cuz currently I'm working
introduction cuz currently I'm working
on being very mad trying to add a
on being very mad trying to add a
binding for a GPU accelerated
binding for a GPU accelerated
environment that has really cursed
environment that has really cursed
backend stuff um
backend stuff um
so I'm working on like very cursed
so I'm working on like very cursed
things I I wish I could tell you what
things I I wish I could tell you what
I'm working on because I wish I knew uh
I'm working on because I wish I knew uh
as for the repository with puffer lib
as for the repository with puffer lib
we're trying to make reinforcement
we're trying to make reinforcement
learning fast and easy
learning fast and easy
so make it easy for neural networks to
so make it easy for neural networks to
learn how to play games by playing games
learn how to play games by playing games
would be a reductive version of it and
would be a reductive version of it and
this
this
involves usually a lot of fun stuff but
involves usually a lot of fun stuff but
every so often a lot of very painful
every so often a lot of very painful
infrastructure
you know once in a while a lot of
you know once in a while a lot of
painful
infrastructure it usually is fun today
infrastructure it usually is fun today
it is not fun today no fun was had
it is not fun today no fun was had
whatsoever
none usually very
none usually very
fun today fun was not allowed
we do stuff like uh I've got like a
we do stuff like uh I've got like a
miniature version of DOTA that runs at a
miniature version of DOTA that runs at a
million frames per
million frames per
second I've got a version of like
second I've got a version of like
slither.io that runs at like 12 million
slither.io that runs at like 12 million
frames per
frames per
second we've got a bunch of other fun
second we've got a bunch of other fun
stuff as well
got bite and
float for
okay so that is now
okay so that is now
42,000 fully bottlenecked by the
42,000 fully bottlenecked by the
EnV no longer bottle you see the misk
EnV no longer bottle you see the misk
time that went down that's to to device
transfer the that guy if you're still
transfer the that guy if you're still
around we got to totally fix that thing
around we got to totally fix that thing
like that's got to be
buffered okay now it's at 50K for
that's weird
this is
4096 even the network could be faster
here but the m is just
here but the m is just
like unacceptably
slow runs at like 100k I think
it's taking a
path I mean the forward pass is still
path I mean the forward pass is still
like forward pass should be faster than
like forward pass should be faster than
that as well
technically I could do a puffer GPU Sim
technically I could do a puffer GPU Sim
version of
this but then there wouldn't be as much
this but then there wouldn't be as much
um
um
puffer really wouldn't be able to do as
puffer really wouldn't be able to do as
much for
it
damn it's already 7:21 I got to get
damn it's already 7:21 I got to get
dinner and like let me last try is there
dinner and like let me last try is there
any way I can get this thing to run with
any way I can get this thing to run with
the single thread if I can at least get
the single thread if I can at least get
it to run single thread I can do
it to run single thread I can do
something with
that drive me
nuts didn't that guy link
something yeah he did
they vendored it okay
can I just try one thing I'm I'm going
can I just try one thing I'm I'm going
to try one thing it's going to be
Jank
MW why can't I see this here
what
the oh this is in Source
Madrona but wait didn't they vendor it
Madrona but wait didn't they vendor it
hold on
or am I just
dumb no they didn't I'm just dumb I just
dumb no they didn't I'm just dumb I just
was reading it wrong
source
e where's the madona doesn't get it like
e where's the madona doesn't get it like
clone Madrona or
something external
if I just edit the darn
source for
oh man it's still doing
it how is it still doing this
not rec what's the issue oh my gosh what
not rec what's the issue oh my gosh what
issues don't I have um the stupid like
issues don't I have um the stupid like
we've got low-level dependencies that
we've got low-level dependencies that
are just being really dumb
are just being really dumb
um jobs num
um jobs num
workers the
Reds what is it that this guy linked
Reds what is it that this guy linked
meona
I thought I had it
I thought I had it
here I don't know it's like how can you
here I don't know it's like how can you
possibly have something where I can't
possibly have something where I can't
set it to run on one threat
like go ahead spin all my cores even
like go ahead spin all my cores even
when I freaking edited the source to try
when I freaking edited the source to try
to fix it
it's
insane spins all my
cores man you're
trolling where would it be it would it
trolling where would it be it would it
be in
Sim for
no idea
I don't think this
is did this just break my freaking shell
no that's not going to obviously that's
no that's not going to obviously that's
not going to work I'm just like playing
not going to work I'm just like playing
around at this point
around at this point
um okay well apparently this stupid
um okay well apparently this stupid
Library doesn't have an easy way to set
Library doesn't have an easy way to set
the number of threads and I can't figure
the number of threads and I can't figure
out how to do it even editing their
out how to do it even editing their
source code so
source code so
yeah that doesn't matter this is single
yeah that doesn't matter this is single
like this is I'm this is supposed to be
like this is I'm this is supposed to be
running single thread and it's using all
running single thread and it's using all
my cores so this is dumb um it's using
my cores so this is dumb um it's using
all my cores very inefficiently I would
all my cores very inefficiently I would
add because it's like it's deciding to
add because it's like it's deciding to
use its own garbage C++ implementation
use its own garbage C++ implementation
instead of my python implementation
instead of my python implementation
which is going to ironically be much
faster OMP is not going to do anything
faster OMP is not going to do anything
anyways I don't know why I was trying
anyways I don't know why I was trying
that
um where where what
um where where what
file what file are you in
the number of times a language model has
the number of times a language model has
been right or helpful when I've been
been right or helpful when I've been
stuck so far has been
zero why why don't I have that file
zero why why don't I have that file
right there so I have is
right there so I have is
that is that not on the master Branch
that is that not on the master Branch
like what
madona include
Madrona set this to
one I don't know why there's
one I don't know why there's
a but here let's try it
dve if this works at least like I'll
dve if this works at least like I'll
have something to go off before
tomorrow I got to at least order my food
tomorrow I got to at least order my food
on the side here because otherwise I'm
on the side here because otherwise I'm
going to not have any I'm not going to
going to not have any I'm not going to
be able to eat
three
three
miles just give me a sandwich
okay e
one
sec now that's a joke I'm not doing
sec now that's a joke I'm not doing
that California [ __ ] 30 bucks to get
that California [ __ ] 30 bucks to get
a sandwich
hold on let me just find something to
hold on let me just find something to
order real
order real
quick cutting a few pounds this week but
quick cutting a few pounds this week but
I'm figuring out what I want to
I'm figuring out what I want to
get um
um
I think working on this increases your
I think working on this increases your
chance of
chance of
spontaneous combustion honestly
I don't know why it's so difficult to
I don't know why it's so difficult to
find like reasonable stuff around
here like there's a lot of good food but
here like there's a lot of good food but
like sometimes it's just you can't find
like sometimes it's just you can't find
like reasonable
stuff e
just get a pami sandwich real quick
produce
sh
this literally ends up being just as bad
this literally ends up being just as bad
and I'm sure that this is way
and I'm sure that this is way
worse H we just eat the cost for now
worse H we just eat the cost for now
then freaking
[ __ ] I swear if there were just like
[ __ ] I swear if there were just like
a diner a half mile from here I would be
a diner a half mile from here I would be
I'd just be set I would never have to
I'd just be set I would never have to
care about
care about
anything um
I'm like absolutely somebody that is
I'm like absolutely somebody that is
more than happy going to a diner like
more than happy going to a diner like
five times a
week um no no food truck I'm I generally
week um no no food truck I'm I generally
don't get stuff from food trucks because
don't get stuff from food trucks because
I like of just hygiene stuff
I like of just hygiene stuff
I've had too much like too many long too
I've had too much like too many long too
much long-term Health damage from um
much long-term Health damage from um
food poisoning over the years
already in fact I'm not even getting
already in fact I'm not even getting
lettuce on the sandwich because I don't
lettuce on the sandwich because I don't
trust I don't trust people to wash
trust I don't trust people to wash
lettuce is that
funny I basically just will not get
funny I basically just will not get
lettuce from places
you get freaking salmonella once you
you get freaking salmonella once you
never want to have any lettuce ever
again oh it's not hard to have zero it's
again oh it's not hard to have zero it's
just like lazies that don't do their job
just like lazies that don't do their job
and then they freaking kill you um
okay
so does this do
anything how is it still using all the
anything how is it still using all the
cores like literally
how that doesn't even make sense right I
how that doesn't even make sense right I
just recompiled it
this is just running single thread man
this is just running single thread man
it should be May in what are your
settings it's running without
vectorization it's running serial V I
vectorization it's running serial V I
should
say I also don't understand why this
say I also don't understand why this
thing doesn't exit cleanly and it just
thing doesn't exit cleanly and it just
leaves your cord spinning that's kind of
leaves your cord spinning that's kind of
gross
no it's not designed to run in serial VC
no it's not designed to run in serial VC
they have bad vectorization that I'm
they have bad vectorization that I'm
currently being forced to
currently being forced to
use puffer's back is basically always
use puffer's back is basically always
going to be better
is it not recompiling this or something
I mean this is just the default value is
I mean this is just the default value is
this getting called from somewhere
this getting called from somewhere
threadpool
executor could be
executor could be
right there a window
source
uhuh const config
CFG inl what the
heck doesn't have num workers
anywhere
CFG where's the actual implementation
CFG where's the actual implementation
for this thing
yeah that's what I'm looking
yeah that's what I'm looking
for but it's using get num cores which I
for but it's using get num cores which I
also I set all these to
also I set all these to
one right
for e
okay I mean this is like all the places
okay I mean this is like all the places
I can think
of the last like I don't know other than
this I don't know otherwise like why
this I don't know otherwise like why
it's just using all my bloody cores
and this is why I just really hate
and this is why I just really hate
working with like big
working with like big
clunky I mean the the GPU Drive code
clunky I mean the the GPU Drive code
base is fine it's the freaking Madrona
base is fine it's the freaking Madrona
code base that drives me
nuts it's like such a cool concept as
nuts it's like such a cool concept as
well but like
okay what is I don't know what you're
okay what is I don't know what you're
pasting roll out threads
SPS all my
SPS all my
course well I can't do anything about
that I really can't do anything about
that I really can't do anything about
that
um man can make a GPU pass through I
um man can make a GPU pass through I
guess and just have it run on GPU but
guess and just have it run on GPU but
that's not going to
that's not going to
be is not going to be anywhere near as
nice I guess it would
work yeah but the thing is usually like
work yeah but the thing is usually like
even if you have 24 cores is the thing
I don't know how much logic is in the
I don't know how much logic is in the
driving Sy to be fair it could be it's
driving Sy to be fair it could be it's
way heavier than it
way heavier than it
looks but
looks but
it like just looking at the M I don't
it like just looking at the M I don't
know how much physics and stuff they're
know how much physics and stuff they're
doing I guess they said they have lar
doing I guess they said they have lar
and stuff so maybe there's a bunch of
and stuff so maybe there's a bunch of
logic maybe there's like actually a
logic maybe there's like actually a
bunch of like really heavy Sim stuff
so I this has been like enough of my
so I this has been like enough of my
life at this point I think that tomorrow
life at this point I think that tomorrow
um I will do I'll just make a GPU
um I will do I'll just make a GPU
binding that'll be nice that'll mean
binding that'll be nice that'll mean
that we'll have a GPU back end for
that we'll have a GPU back end for
puffer which is cool um and then you
puffer which is cool um and then you
know puffer will just provide the the
know puffer will just provide the the
extra utils and stuff the convenience
extra utils and stuff the convenience
and the hyper Prem stuff and all of that
and the hyper Prem stuff and all of that
which is fine it's mainly like puffer is
which is fine it's mainly like puffer is
mainly supposed to be for CPU M's
mainly supposed to be for CPU M's
anyways that's where like most of Tex
anyways that's where like most of Tex
deck is at the moment but whatever I can
deck is at the moment but whatever I can
add just a binding for this and not be
add just a binding for this and not be
have this be so incredibly
have this be so incredibly
painful um what did open AI do oh they
painful um what did open AI do oh they
didn't do anything like their Ms were
didn't do anything like their Ms were
just slow period and then they spent
just slow period and then they spent
money to make you know to get more
cores that's what they did
I check a couple
things hopefully more productive day
things hopefully more productive day
tomorrow you're going to have a bad day
tomorrow you're going to have a bad day
once in a while
4200 that's
4200 that's
cool and
cool and
puffer still
puffer still
758 pretty nice little uptick in the
758 pretty nice little uptick in the
growth though in the last couple of days
growth though in the last couple of days
right
here so tomorrow what I'll do is I'll
here so tomorrow what I'll do is I'll
add the GPU
add the GPU
bind
bind
um I guess we can look real quick at
um I guess we can look real quick at
our w b
our w b
results I mean I need to get more
results I mean I need to get more
experiments loaded and stuff as well
experiments loaded and stuff as well
but jeez
let's see um at least a couple
let's see um at least a couple
reasonable results from today
reasonable results from today
so this is Space
Invaders Space Invaders does not do
Invaders Space Invaders does not do
amazingly what do they have in the
um do we have the result in
po uh paper
I think they have the results in the
appendix okay so it also it takes them a
appendix okay so it also it takes them a
while to get above 500 as well this is
while to get above 500 as well this is
like a 200 mil frames or whatever so I
like a 200 mil frames or whatever so I
don't feel too bad about that that it
don't feel too bad about that that it
takes you know a while to get above the
takes you know a while to get above the
Mark um
and then this is the new
and then this is the new
one sequ
one sequ
Quest oh we actually just beat them
Quest oh we actually just beat them
straight up on cqu Quest like
straight up on cqu Quest like
immediately look at
immediately look at
that that's really
that that's really
solid yeah these are good these are good
solid yeah these are good these are good
implementations these are very good
implementations solvar with just hyper
implementations solvar with just hyper
pram tuning
most of these did pretty well a couple
most of these did pretty well a couple
of M's um didn't but like the curves
of M's um didn't but like the curves
were always good it's just the uh some
were always good it's just the uh some
of them are just going to take more
of them are just going to take more
samples as
all okay so um I'll call it early today
all okay so um I'll call it early today
um this is definitely
cool e
okay
of course why do people tune in right
of course why do people tune in right
when I'm about to leave
when I'm about to leave
so here's the here's the brief summary
so here's the here's the brief summary
for folks um from today so I tried
for folks um from today so I tried
everything I could to get this new GPU
everything I could to get this new GPU
driving Sim uh working with puffer I got
driving Sim uh working with puffer I got
it to run after some absolutely here let
it to run after some absolutely here let
me find the m i got it to run after some
me find the m i got it to run after some
absolutely insane
absolutely insane
Shenanigans um but it's just like it's
Shenanigans um but it's just like it's
not fast on CPU because Madrona is
not fast on CPU because Madrona is
trying to multi-thread and it's doing it
trying to multi-thread and it's doing it
very very poorly and I can't find any
very very poorly and I can't find any
way to disable it so I think probably
way to disable it so I think probably
I'm going to just add a GPU binding
I'm going to just add a GPU binding
tomorrow cuz that will be relatively
tomorrow cuz that will be relatively
easy and take minimal modifications to
easy and take minimal modifications to
puffer um that will at least allow me to
puffer um that will at least allow me to
get training running at a reasonable
get training running at a reasonable
speed and be able to do carb sweeps and
speed and be able to do carb sweeps and
stuff so that we can have like some cool
stuff so that we can have like some cool
policies in this um that should work and
policies in this um that should work and
then yeah we'll see after that for sure
then yeah we'll see after that for sure
um there are a lot of things I can see
um there are a lot of things I can see
here where there could be speed
here where there could be speed
enhancements but it's it's tough as it
enhancements but it's it's tough as it
is at the moment so yep that's the whole
is at the moment so yep that's the whole
deal with everything uh other projects
deal with everything uh other projects
still happening uh the Atari stuff we'll
still happening uh the Atari stuff we'll
pick that back up probably on Thursday
pick that back up probably on Thursday
or Friday uh the MOBA stuff as well
or Friday uh the MOBA stuff as well
needs hyper pram sweeps uh the Atari
needs hyper pram sweeps uh the Atari
sweeps were kind of meant to test out
sweeps were kind of meant to test out
carbs and make sure everything
carbs and make sure everything
everything is good now that that's good
everything is good now that that's good
we've got the mobo oh yeah I forgot we
we've got the mobo oh yeah I forgot we
did do one cool thing let's see if it
did do one cool thing let's see if it
did anything
did anything
interesting I forgot that we did this
run I I let this run overnight for a
run I I let this run overnight for a
very long time though it's
very long time though it's
not interestingly um it doesn't seem
not interestingly um it doesn't seem
like it's gotten as far as I had
like it's gotten as far as I had
expected
SPS of
SPS of
5500 wait no 50 no this is reasonable
5500 wait no 50 no this is reasonable
SPS I don't know how it's possible that
SPS I don't know how it's possible that
this has
this has
taken this long
here this must have
crashed yeah this crashed well it ran
crashed yeah this crashed well it ran
for uh two billion steps at
for uh two billion steps at
least and we actually were getting
least and we actually were getting
we it looks like it was starting to
we it looks like it was starting to
learn stuff as
well yeah box Four reboot let me see if
well yeah box Four reboot let me see if
I can find the bug in this real quick
differing extents oh there's like a rare
differing extents oh there's like a rare
slice bug great I'll have to find that
slice bug great I'll have to find that
later that's
later that's
obnoxious it looks like there's a rare
obnoxious it looks like there's a rare
observation slice bug
it does look like this was starting to
it does look like this was starting to
learn some stuff though like these are
learn some stuff though like these are
good reward
good reward
curves interesting at
curves interesting at
least total Towers
least total Towers
taken you can see all the skill usages
taken you can see all the skill usages
we've got good
logs level means going up means they're
logs level means going up means they're
actually learning to do
actually learning to do
something so this project is looking
something so this project is looking
good there just a bunch of work to keep
good there just a bunch of work to keep
doing
doing
um yeah I'll be
um yeah I'll be
back through
back through
Friday I'll work on some stuff maybe
Friday I'll work on some stuff maybe
I'll even stream Saturday we'll see this
I'll even stream Saturday we'll see this
week and then
week and then
Sunday Sunday through like probably
Sunday Sunday through like probably
Tuesday or Wednesday I've got some other
Tuesday or Wednesday I've got some other
stuff to do and then I'll be back after
stuff to do and then I'll be back after
that that's the plan
all right though I'm going to call it
all right though I'm going to call it
here
here
um folks watching if you haven't already
um folks watching if you haven't already
if you want to support all this
work give the puffer a star helps me out
work give the puffer a star helps me out
a whole bunch puffer AI puffer lib and
a whole bunch puffer AI puffer lib and
other than that I we'll see you later
other than that I we'll see you later
bye
