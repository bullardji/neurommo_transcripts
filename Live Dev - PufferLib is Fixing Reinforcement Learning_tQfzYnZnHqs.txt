Kind: captions
Language: en
Hello, we are
Hello, we are
live. It is
live. It is
late. I am
late. I am
tired, but we're going to do a short
tired, but we're going to do a short
stream
stream
anyways because why not? I said I would
anyways because why not? I said I would
deal with some messages. Had to deal
deal with some messages. Had to deal
with a few other silly things, but uh
with a few other silly things, but uh
whatever. We'll we'll get something
whatever. We'll we'll get something
done, right?
I just wanted to run
um a few more experiments on
um a few more experiments on
Diane, sort of think about it a little
Diane, sort of think about it a little
bit
bit
more and figure out what we can do with
it. Get my container back.
Welcome Twitch
folks. Hey, I
folks. Hey, I
bet long dinner. They gave me like 3x
bet long dinner. They gave me like 3x
the normal quantity of ice cream, so I
the normal quantity of ice cream, so I
am
stopped. Oh, I have this here. Perfect.
It was the first time I've been there.
The other location though like third of
The other location though like third of
the
amount. Dangerous having ice cream
amount. Dangerous having ice cream
around.
around.
I don't know. It doesn't really tempt
I don't know. It doesn't really tempt
me. I get it when I'm like out
me. I get it when I'm like out
sometimes. Calories are not bad when
sometimes. Calories are not bad when
you're
you're
underweight. Um,
okay. That'll actually just end up
okay. That'll actually just end up
helping me recover because otherwise I'm
helping me recover because otherwise I'm
going to feel beat up as hell tomorrow
going to feel beat up as hell tomorrow
from all the squats.
Okay, here we are with
Okay, here we are with
Diane. It's literally just this little
Diane. It's literally just this little
bit of code,
right? Where's the loss?
There it is. Literally just this little
There it is. Literally just this little
block of
code. Does it even make sense that it is
code. Does it even make sense that it is
so easy for
Uh, for this to be told apart
Like we have this
graph and it's this tiny little
graph and it's this tiny little
loss, right?
Does cross entropy even make sense the
Does cross entropy even make sense the
way it's defined
here? Input logic and
target. You ran snake
earlier. This is not dying
earlier. This is not dying
related. Well, the default hypers are
related. Well, the default hypers are
now for move on
now for move on
bet.
bet.
So, yeah, there could be a difference.
We should get you a box again so you can
We should get you a box again so you can
run experiments. We technically have
run experiments. We technically have
um if you want to set stuff up on box
um if you want to set stuff up on box
six, go ahead. It's uh it's a little
six, go ahead. It's uh it's a little
dodgy. I think one of like I think the
dodgy. I think one of like I think the
chip is like intermittently
chip is like intermittently
screwy. So, it's probably going to get I
screwy. So, it's probably going to get I
mean all the boxes are going to get sent
mean all the boxes are going to get sent
through main gear anyways on their way
through main gear anyways on their way
to the new facility. But yeah, you can
to the new facility. But yeah, you can
feel free to set stuff up on box
six. I mean, you've been doing a ton of
six. I mean, you've been doing a ton of
stuff. You should I don't know why you
stuff. You should I don't know why you
don't have a
box. Like the point of giving
box. Like the point of giving
contributed hardware is to make it
contributed hardware is to make it
easier for you to like work on cool
easier for you to like work on cool
stuff and get stuff done,
right? Uh, okay. So, this is
right? Uh, okay. So, this is
interesting.
So target is supposed to
So target is supposed to
be soft maxed I guess.
Oh no, because it's Z
indices. No more optimizer. Yeah, you
indices. No more optimizer. Yeah, you
shouldn't be using that [ __ ] Adam, like
shouldn't be using that [ __ ] Adam, like
it's a step change. It's really a step
it's a step change. It's really a step
change in
change in
capabilities. You might have to set up
capabilities. You might have to set up
the dev container build. I don't know
the dev container build. I don't know
what's on the current
one. And I'm trying to get more boxes.
one. And I'm trying to get more boxes.
It's just like one, it's a really big
It's just like one, it's a really big
purchase.
purchase.
Um, it's like a lowend house size
Um, it's like a lowend house size
purchase and uh two is the terrace. So,
purchase and uh two is the terrace. So,
I had to sort both of those things
out. Yeah, we're not buying we're not
out. Yeah, we're not buying we're not
buying the boxes for plus 40%. No, thank
buying the boxes for plus 40%. No, thank
you.
science
science
policy. I I'm not it's not I'm not
policy. I I'm not it's not I'm not
commenting on the tariffs as a whole.
commenting on the tariffs as a whole.
This was like obviously some dumb
This was like obviously some dumb
loophole anyways because they put an
loophole anyways because they put an
exception on
exception on
electronics, right? And then they just
electronics, right? And then they just
didn't put one on components. So like
didn't put one on components. So like
obviously the intent is not to make it
obviously the intent is not to make it
so that you need to manufacture your
so that you need to manufacture your
whole box in China instead of just
whole box in China instead of just
importing the comp. Like it's some
importing the comp. Like it's some
oversight. It'll get fixed unless people
oversight. It'll get fixed unless people
are really dumb.
So this loss correctly computed. I'm
So this loss correctly computed. I'm
trying to think how the hell it's this
trying to think how the hell it's this
smart like how is it
smart like how is it
that the logits are like immediately
Let me make sure of one thing.
And I actually ate too much ice cream.
And I actually ate too much ice cream.
Holy hell.
It's like not even a bad thing either
It's like not even a bad thing either
because it's like great for
because it's like great for
recovery and I kicked my ass doing
recovery and I kicked my ass doing
squats
squats
today. But like
holy. Okay. So this guy launch should
holy. Okay. So this guy launch should
not optimize
not optimize
like much at
all. Okay. So, we can see here the Dion
all. Okay. So, we can see here the Dion
loss is
1.3 because I put a stop grad here. So,
1.3 because I put a stop grad here. So,
it can't optimize the rest of the
it can't optimize the rest of the
network. So, it literally has no way to
network. So, it literally has no way to
tell the policy to act differently.
By
By
comparison, if we delete the stop
grad loss is almost zero immediately.
So, what box is Aaron on? I moved Aaron
So, what box is Aaron on? I moved Aaron
to box
five. Let me d Doesn't
five. Let me d Doesn't
actually I'll double check. You don't
actually I'll double check. You don't
have to delete his box. You can just
have to delete his box. You can just
make a new
make a new
one. Let me double check.
Yep. Aaron's on box five.
Yeah, that's how it's supposed to work.
Yeah, that's how it's supposed to work.
Anyways, you need the dev container bet,
Anyways, you need the dev container bet,
like the dev branch of Puffer Tank or
like the dev branch of Puffer Tank or
whatever that has the new base in it.
whatever that has the new base in it.
That's like the CUDA 128 or whatever
That's like the CUDA 128 or whatever
base. Well, not 128, it's 124, I think.
base. Well, not 128, it's 124, I think.
Yeah, it it's the it should say CUDA
Yeah, it it's the it should say CUDA
like CUDA dev or whatever in the from
like CUDA dev or whatever in the from
you need the developer uh you need the
you need the developer uh you need the
developer tools for CUDA so you can
developer tools for CUDA so you can
compile 312. Yes.
It's kind of crazy that literally you
It's kind of crazy that literally you
just give this thing down sampled
just give this thing down sampled
logs and it perfectly knows
which has gone Like which agent is what?
Well, let's get rid of
Well, let's get rid of
the distribution.
[Music]
I'm just getting tired here. Oops.
See if this still
works. Keeps popping up.
Okay, this will be
interesting. We'll let this run a bit.
I honestly want to stay up and keep
I honestly want to stay up and keep
working on this because I'm afraid that
working on this because I'm afraid that
if I I'm afraid if I like lie down to go
if I I'm afraid if I like lie down to go
to sleep, I'm going to throw up with all
to sleep, I'm going to throw up with all
this ice cream. It's actually
this ice cream. It's actually
ridiculous.
Well, that actually did something.
It's telling the policies apart, but
It's telling the policies apart, but
it's trying so hard to do it.
Yeah. Okay.
Really? That doesn't even help much at
Really? That doesn't even help much at
all, does
it? It is like really really
it? It is like really really
hard for this thing
hard for this thing
uh to figure it out.
That soft max really made it
tough. What if we give it the full
We give it the full thing.
Is it log softmax or soft max?
You
You
normally log soft max or soft
max log soft max
right.
So log soft max of
So log soft max of
logic it's totally good.
Yeah, the Diane loss here is getting
Yeah, the Diane loss here is getting
totally
screwed. Without this mask, it's easy,
right? I comment this one line.
So,
uh, dang.
Why does it hurt it that badly? Okay.
So I guess what it happened is it can't
So I guess what it happened is it can't
tell which policy is which just based on
tell which policy is which just based on
the actions,
right? It's using the other
right? It's using the other
logics like differences in the other.
logics like differences in the other.
Okay, that would make sense.
Okay, that would make sense.
So then if we get this to work, it could
So then if we get this to work, it could
be very powerful,
right? So what if we just like put this
right? So what if we just like put this
mask
mask
on and then we just
do we do
this. We know like 1.3 is random or
this. We know like 1.3 is random or
whatever, I think.
Okay, this looks good. Do we have it on
Okay, this looks good. Do we have it on
Neptune? We do.
Neptune? We do.
Cool. Let's see what this does.
And then we will try the down sampled
And then we will try the down sampled
one as
one as
well. With the down sampled
well. With the down sampled
one, I don't even know if we have to
one, I don't even know if we have to
down
sample. Oh, this isn't even bad.
It still mostly knows which one is
It still mostly knows which one is
um is
um is
which. It just really wanted to push the
which. It just really wanted to push the
loss all the way to zero is all
So now it pretty much just gets to see
So now it pretty much just gets to see
the sequence of
the sequence of
actions. That's cool.
actions. That's cool.
So given that you can see the sequence
So given that you can see the sequence
of actions that an agent takes and given
of actions that an agent takes and given
that you can tell it whether to push
that you can tell it whether to push
that probability of that specific action
that probability of that specific action
up or
up or
down make the agents do distinguishable
things. Seems cool.
Do we still think there's any reason to
Do we still think there's any reason to
give it um a down sample trajectory?
I'm not sure.
I could also probably mess with entropy
I could also probably mess with entropy
at this point,
at this point,
right? We probably don't need entropy
right? We probably don't need entropy
anymore with
this. Maybe not. Hard to say.
preventing the policy from determinizing
preventing the policy from determinizing
is
is
still maybe a
thing. Maybe it isn't. I don't
know. I want to see what this policy
know. I want to see what this policy
does though. I know that
What's the best that we have on this?
What's the best that we have on this?
Like 91
Like 91
92. It's going to take a little bit of a
92. It's going to take a little bit of a
per hit with
per hit with
this, but I want to see if it does
this, but I want to see if it does
anything interesting.
anything interesting.
It's kind of hard to say in this
It's kind of hard to say in this
environment, right? Like you'd really
environment, right? Like you'd really
want something where the policies are
want something where the policies are
more
expressive. I wonder how to doing
I mean, this has continued to improve.
I mean, this has continued to improve.
It's like not that far behind now,
It's like not that far behind now,
right? That's like really close.
That's pretty
cool. These are tiny policies as well.
cool. These are tiny policies as well.
Mind you
It's also just possible that this loss
It's also just possible that this loss
is too high,
right? I mean the uh the Diane loss
right? I mean the uh the Diane loss
coefficient like maybe it is kind of
coefficient like maybe it is kind of
more like entropy bonus where you want
more like entropy bonus where you want
like 0.01 or something of it.
It's crazy solid
though. So, this is one where it was
though. So, this is one where it was
like trivial for it to learn Diane
like trivial for it to learn Diane
because it had the full logic
distribution. Oh, score is 90 with the
distribution. Oh, score is 90 with the
eval.
eval.
All right, that's like pretty much on
That's the point of
puffer. I don't know. Can we see any
puffer. I don't know. Can we see any
play style
differences? It's hard to say. Like, can
differences? It's hard to say. Like, can
we see play style differences?
Right. They do seem more sideways,
Right. They do seem more sideways,
right? Do all of them seem more sideways
right? Do all of them seem more sideways
or some colors more sideways and some of
or some colors more sideways and some of
them more up and down?
They kind of all seem a little more
sideways. Salmon one maybe.
sideways. Salmon one maybe.
Yeah, maybe.
Well, it says I can tell these apart
Well, it says I can tell these apart
very accurately, right?
Try
something. We do like this.
I want to see what this loss ends up
I want to see what this loss ends up
being.
being.
if it like does anything substantially
different. There's more stuff we can
different. There's more stuff we can
try, right?
I'm kind of also wondering if we give it
states. Is there any way that that makes
states. Is there any way that that makes
sense?
Like if we also give it
states that might do
something like I'm trying to think if
something like I'm trying to think if
it's if there's a thing right where even
it's if there's a thing right where even
if the state path is not
if the state path is not
differentiable if like because it can
differentiable if like because it can
use the states that it ends up
use the states that it ends up
in if like that somehow
makes it able to better optimize the
makes it able to better optimize the
actions.
Well, but like can it right because the
Well, but like can it right because the
thing is the state's not
thing is the state's not
differentiable. All right. Have I drawn
differentiable. All right. Have I drawn
this diagram
yet? So I like this is an important
yet? So I like this is an important
concept as well.
Okay. So like this is how it works,
Okay. So like this is how it works,
right? So you have like you have like
right? So you have like you have like
obs and then you you take action one and
obs and then you you take action one and
then you get
then you get
obso,
right? And then the thing is that in the
right? And then the thing is that in the
way that this looks like in the neural
way that this looks like in the neural
net, right? It's like
net, right? It's like
[Music]
02 and the way it looks in the neural
02 and the way it looks in the neural
net right is like this is
LSTM. And then this is like a one
a2. Okay. And then what you do is you
a2. Okay. And then what you do is you
put this into a
discriminator which is
like okay. Okay. And then this tells you
like okay. Okay. And then this tells you
this tries to predict like
Z1 which is the index and then the trick
Z1 which is the index and then the trick
of Diane right is that this is
Z1. So you're trying to based on the
Z1. So you're trying to based on the
actions predict the
actions predict the
Z, right?
Z, right?
So like one thing you could do is you
So like one thing you could do is you
could put the observations into the
could put the observations into the
network. But then if you go backwards
network. But then if you go backwards
through the network, right? The way that
through the network, right? The way that
this learns is it goes backwards through
this learns is it goes backwards through
the actions and you actually back
the actions and you actually back
propagate through the logits. So you can
propagate through the logits. So you can
actually update the network, right? To
actually update the network, right? To
change the action props. But with the
change the action props. But with the
observation, the gradient through the
observation, the gradient through the
observation doesn't go backwards through
observation doesn't go backwards through
the network.
the network.
So I don't know if there's like some way
So I don't know if there's like some way
indirectly that this could potentially
indirectly that this could potentially
learn something but you see it can't
learn something but you see it can't
directly learn here
directly learn here
right like there's no direct dependence
right like there's no direct dependence
of the weights on the
observations. So the discriminator is
observations. So the discriminator is
trying to predict Z. Z is a one hot
trying to predict Z. Z is a one hot
vector. So Z think of a one hot vector
vector. So Z think of a one hot vector
is just an index right?
is just an index right?
So you just tell it that hey this is
So you just tell it that hey this is
going to be uh one and one is just like
going to be uh one and one is just like
you're team one you need to behave
you're team one you need to behave
differently from team
differently from team
two. Okay. And how do you know if you
two. Okay. And how do you know if you
behave differently? Well if the
behave differently? Well if the
discriminator can tell a can tell you
discriminator can tell a can tell you
apart from the other teams just based on
apart from the other teams just based on
your actions then you're behaving
your actions then you're behaving
differently.
differently.
Right? So that's how this thing works.
Right? So that's how this thing works.
You tell it what team it's on and then
You tell it what team it's on and then
the discriminator tries to predict just
the discriminator tries to predict just
based on the actions what team it's on.
So, the only way that the network can
So, the only way that the network can
tell you what team it's on is by taking
tell you what team it's on is by taking
actions that are
distinguishable. Why do we want to
distinguishable. Why do we want to
predict Z? So that it learns. We want
predict Z? So that it learns. We want
the ideas that we want the
the ideas that we want the
policy to be able to play in many
policy to be able to play in many
different ways.
That's exploration,
right? If we have a policy that can play
right? If we have a policy that can play
the game a lot of different
the game a lot of different
distinguishable
distinguishable
ways, that's like exploration in a
nutshell. It's kind of a cool idea,
nutshell. It's kind of a cool idea,
right?
Yeah, this is like a bad end to try to
Yeah, this is like a bad end to try to
sus out play style difference is the
sus out play style difference is the
problem.
separate. No, it can't identify them.
separate. No, it can't identify them.
So, the thing is just because they're in
So, the thing is just because they're in
the network like you're getting just the
the network like you're getting just the
probability of best action or the
probability of best action or the
probability of the action you're taking.
probability of the action you're taking.
So, you can't cheat and send any
So, you can't cheat and send any
information like that to the
information like that to the
discriminator
discriminator
network because the discriminator
network because the discriminator
network only gets to see these actions
network only gets to see these actions
A1, A2, A3. So, there's no way that you
A1, A2, A3. So, there's no way that you
can like smuggle information because if
can like smuggle information because if
we just let you like send the hidden
we just let you like send the hidden
state or something, it's trivial.
We wouldn't need separate
obs. Oh, it's just a one hot. See, it's
obs. Oh, it's just a one hot. See, it's
just like an extra one
hot. It's a very trivial network
hot. It's a very trivial network
modification. You share the same weights
modification. You share the same weights
for all the nets. That's the point.
If they're all pursuing the same
If they're all pursuing the same
strategy, the discriminator wouldn't be
strategy, the discriminator wouldn't be
able to tell them apart and the loss
able to tell them apart and the loss
would be near
random. The discriminator can tell he's
random. The discriminator can tell he's
apart.
We should probably log the
We should probably log the
accuracy losses near zero whenever. So
accuracy losses near zero whenever. So
the run that we lo watched before this
the run that we lo watched before this
had near zero loss.
Yes, it's 0.1 here.
I mean technically we can do like this
right? We can do
I think less snakes just makes the end
I think less snakes just makes the end
really
really
easy. I don't
easy. I don't
know. We could try
it. Let me see what this
it. Let me see what this
does. I just cranked up the D and lost a
does. I just cranked up the D and lost a
ton. So like now it really really wants
ton. So like now it really really wants
to tell them apart.
to tell them apart.
Smaller canvas gives you less space to
Smaller canvas gives you less space to
tell what they're
tell what they're
doing. If anything, I want a big canvas
doing. If anything, I want a big canvas
and see if they go in different
and see if they go in different
directions,
right? Okay. So, this has very low loss.
Let's see if we can
tell. I mean, this is a lower like a
tell. I mean, this is a lower like a
lower reward
policy. Maybe we can tell it apart.
It's got ridiculously low Dion
loss. Yeah. So here it does it
right. White snakes go
up. Pink snake
up. Pink snake
goes up and to the
left. Red snake goes pretty well
left. Red snake goes pretty well
straight left.
I mean, we don't I can't necessarily
I mean, we don't I can't necessarily
tell them all apart, but we can
tell them all apart, but we can
definitely see there's separation,
definitely see there's separation,
right? Like, there's very clearly
right? Like, there's very clearly
separation here, right?
Red is
cubing. They probably don't know
cubing. They probably don't know
anything particularly sophisticated.
anything particularly sophisticated.
It's a really small
model. They do have perfect micro
model. They do have perfect micro
though.
I mean like this is definitely
I mean like this is definitely
something,
right? If perfect, why
die? There's already a like there's
die? There's already a like there's
already a reward penalty.
And it micro they they don't see very
And it micro they they don't see very
far, right? So like you can get yourself
far, right? So like you can get yourself
into a circumstance where there's no way
out. So you can't see very far. So if
out. So you can't see very far. So if
you get into like the inner part of a
you get into like the inner part of a
spiral, there's just no way out.
Yeah, we
could. No, you will tank PF a
bit. Train speed. I
bit. Train speed. I
mean, I kind of like this being the
mean, I kind of like this being the
really fast
end. Okay, let me think about other
end. Okay, let me think about other
things we can do to
things we can do to
like fiddle with this.
We don't really need to do two policies.
We don't really need to do two policies.
Hang on. Let's do
Hang on. Let's do
something. What do I think is the most
something. What do I think is the most
likely to
likely to
improve turf?
uh BPD horizon is that way because of
uh BPD horizon is that way because of
the new experience buffer code. requires
the new experience buffer code. requires
longer
horizons. Also, I though I do believe it
horizons. Also, I though I do believe it
was
anyways. I liked 0.1 on the co
anyways. I liked 0.1 on the co
here. If we do
here. If we do
0.1 and we do
16 and no
mask. What's this look like?
So bet
So bet
um it no longer bootstraps J over
um it no longer bootstraps J over
multiple
multiple
segments. So you need to fit your whole
segments. So you need to fit your whole
J horizon in BPTT.
I mean, most likely we're going to end
I mean, most likely we're going to end
up just going up to like we're going to
up just going up to like we're going to
end up renaming BBT because it's really
end up renaming BBT because it's really
trajectory segment length now and it's
trajectory segment length now and it's
probably going to go up to like 128
us. Isn't that kind of
us. Isn't that kind of
good? I just
did. It's not. Not really. It depends
did. It's not. Not really. It depends
where it levels, I guess.
says it's very
diverse. It's like not bad.
Is it just me or is it actually kind of
Is it just me or is it actually kind of
distinguishable?
Red doesn't seem to go to the left
Red doesn't seem to go to the left
though. Look. See all these reds over
though. Look. See all these reds over
here?
here?
Look. That's different, right?
What happens if I
do at some
do at some
point? There's just not
point? There's just not
enough. It's not going to be able to
enough. It's not going to be able to
tell these apart, right?
Yeah. Okay. So, this just tanks
Yeah. Okay. So, this just tanks
it. That just hard tanks
it. Is it Kai? I don't know.
it. Is it Kai? I don't know.
Man, if you have different names, I'm
Man, if you have different names, I'm
not going to remember. If you have like
not going to remember. If you have like
different names everywhere, it's just
different names everywhere, it's just
it's not
realistic. 0.01
I
mean, that's pretty damn
mean, that's pretty damn
good. And low dying losses. What? Oh. Oh
good. And low dying losses. What? Oh. Oh
ho. Wait, wait, wait, wait, wait, wait,
ho. Wait, wait, wait, wait, wait, wait,
wait.
wait.
Uh, that was kind of doing a thing,
Uh, that was kind of doing a thing,
wasn't
wasn't
it? Yeah, that was kind of doing a
thing. Maybe maybe this is the formula.
Maybe we just give it a little more time
Maybe we just give it a little more time
and we
see that's like that was pretty
good. So this is like a whole bunch of
good. So this is like a whole bunch of
different strategies. Just like try to
different strategies. Just like try to
make it distinguish a whole bunch of
make it distinguish a whole bunch of
stuff, but don't give it some crazy high
stuff, but don't give it some crazy high
penalty that's going to corrupt the
penalty that's going to corrupt the
policy.
So like Diane loss can start out kind of
So like Diane loss can start out kind of
high
There. We need an end where we can
There. We need an end where we can
actually like distinguish different
actually like distinguish different
behaviors
though. Dion loss could
though. Dion loss could
decrease. It
decrease. It
will. It's hard to decrease the Dian
will. It's hard to decrease the Dian
loss while the policy is like rapidly
loss while the policy is like rapidly
increasing in competence
though. So notice here that this one is
though. So notice here that this one is
like
like
Well, there's a learning rate schedule
Well, there's a learning rate schedule
difference here. Okay.
Yo, that's actually really
good. Screw it. Full
good. Screw it. Full
run. Full run and then
bed. That got 95 score, which is higher
bed. That got 95 score, which is higher
than I've seen from a legit
run. We solve exploration tonight. Screw
run. We solve exploration tonight. Screw
it. More breakthroughs,
it. More breakthroughs,
guys. Not enough breakthroughs for a
guys. Not enough breakthroughs for a
day. We solve RL with Diane. Let's go.
Maybe we set up a hyper pram sweep on
Maybe we set up a hyper pram sweep on
this as
this as
well. I'd have to kind of fix a couple
well. I'd have to kind of fix a couple
of the boxes. I've been meaning to do
of the boxes. I've been meaning to do
that so they're not
that so they're not
idle. Um, I mean I have them so I can
idle. Um, I mean I have them so I can
use them and people don't
use them and people don't
like so I can run my own
stuff. Quick
stuff. Quick
check. Puffer advantage. Normal
check. Puffer advantage. Normal
advantage. Puffer advantage. Normal
advantage. Puffer advantage. Normal
advantage. Small
advantage. Small
difference, but it is
there. Uhoh, we got a dip down
there. Uhoh, we got a dip down
here. There might be a learning rate
here. There might be a learning rate
screw up
thing. We will see.
I could probably like fix a box while
I could probably like fix a box while
I'm sitting here.
box zero. My
box zero is mine, right?
and this has cuda cuda on it I
[Music]
Okay, this
runs. So, we will be able to set up a
runs. So, we will be able to set up a
sweep, I
sweep, I
think, because
think, because
um like to just do
Box 6 has CUDA
Box 6 has CUDA
123. How the [ __ ] does that
happen? No, because I don't have the
happen? No, because I don't have the
container set up for 123.
Um, should I just run like an app get
Um, should I just run like an app get
like update Nvidia or some [ __ ]
Yeah, but like just update it
Yeah, but like just update it
anyways. Well, but don't do it on the
anyways. Well, but don't do it on the
container. Like I'm going to have to
container. Like I'm going to have to
pseudo it on the
box. No, you're going to [ __ ] that
box. No, you're going to [ __ ] that
up. Cuz there's stuff in fall four.
I mean, you can go for it and try it. I
guess 128 is a pain cuz you need like
guess 128 is a pain cuz you need like
more recent drivers.
This got
97. So about the same.
It's a cool
model. Pretty dense.
Yeah, this is
Yeah, this is
good. It's like really
good. It's like really
dense. Look at all the snakes.
I'm going to run this sweep
uh that was the most recent one it
uh that was the most recent one it
seems. So the one before that was
Many snake
I don't think you're going to really be
I don't think you're going to really be
able to tell looking at them
visually, but what we can do
Okay, we want all this crap out of the
sweep. So it only is going to
sweep Diane loss
sweep Diane loss
coefficient and the archive
coefficient and the archive
size. So all just going to
size. So all just going to
sweep. So fix everything
sweep. So fix everything
else and then just do this.
Oh, we got a sweep
Oh, we got a sweep
running. That's going to be nice.
We might also tune like a down sample
We might also tune like a down sample
co, but I I think that this could do
co, but I I think that this could do
some stuff.
We're only sweeping the Diane loss
We're only sweeping the Diane loss
coefficient and the archive size. Two
coefficient and the archive size. Two
total sweep params.
Get out of here,
Get out of here,
bot. We build the bots around
here. Okay, so this runs, right?
here. Okay, so this runs, right?
Uh, I should probably let it finish one
Uh, I should probably let it finish one
just in case. Sometimes there's like
just in case. Sometimes there's like
weird behavior between
weird behavior between
runs. So, we'll double check
runs. So, we'll double check
that. But like this algorithm seems
that. But like this algorithm seems
good. Since we do have some folks on
good. Since we do have some folks on
YouTube, I'll uh I'll briefly say what
YouTube, I'll uh I'll briefly say what
this algorithm is. So, what this does is
this algorithm is. So, what this does is
it takes the action
it takes the action
logics of uh an
logics of uh an
entire trajectory
entire trajectory
segment. It assigns each trajectory
segment. It assigns each trajectory
segment an index in the
segment an index in the
observations. So like your trajectory
observations. So like your trajectory
segment one, your index one, trajectory
segment one, your index one, trajectory
segment two, your index four, whatever.
segment two, your index four, whatever.
You pick a fixed number of indices and
You pick a fixed number of indices and
then you train a discriminator just on
then you train a discriminator just on
the action logits to try to predict that
the action logits to try to predict that
index. So the effect is that different
index. So the effect is that different
trajectories should try to be
trajectories should try to be
distinguishable based on their index.
distinguishable based on their index.
It's almost like saying you you're going
It's almost like saying you you're going
to have play style one, you're going to
to have play style one, you're going to
have play style two, you're going to
have play style two, you're going to
have play style three.
have play style three.
Um, and potentially this can give you
Um, and potentially this can give you
better exploration. And that's the hope
better exploration. And that's the hope
that this is like something
that this is like something
substantially better than like naive
substantially better than like naive
entropy or whatever because it actually
entropy or whatever because it actually
has to be
has to be
distinguishable differences in
behavior. And we're going to see how
behavior. And we're going to see how
that does. Preliminary results are
that does. Preliminary results are
pretty
pretty
good. I say is we immediately on the
good. I say is we immediately on the
very first run
very first run
get
get
0.9 three 0.94
0.9 three 0.94
whatever I think the first run takes
whatever I think the first run takes
mean per so that's not entirely
unexpected pretty good
seed context has already been set oh I
seed context has already been set oh I
thought we fixed that bug
I thought we fixed
that. See, good thing I checked.
when I say about stuff breaking on
when I say about stuff breaking on
second run
second run
sometimes. All right, we'll let this one
go. Should be faster this time anyways.
go. Should be faster this time anyways.
No compile time.
How was this run? Out of
How was this run? Out of
curiosity.
curiosity.
Well, buffer lib
Well, buffer lib
206.
206.
Good. Yeah, those version numbers don't
Good. Yeah, those version numbers don't
get updated per commit or anything. They
get updated per commit or anything. They
only get updated per pit package uh per
only get updated per pit package uh per
uh pi pi package update. So,
container worked.
container worked.
Good. Very
Good. Very
good. See if this guy ever
good. See if this guy ever
replied.
replied.
Nope. Went off to lunch and never came
Nope. Went off to lunch and never came
back.
I
I
mean, I don't know how much there is to
mean, I don't know how much there is to
gain
gain
in sweeping these params, but if there
in sweeping these params, but if there
is
is
uh even a little bit in
uh even a little bit in
there, it could have a very interesting
there, it could have a very interesting
policy by
tomorrow. 1.5 mil steps per second.
tomorrow. 1.5 mil steps per second.
All the runs should run at exactly that
speed once this this can only compile
speed once this this can only compile
like a few
like a few
times. Yeah. So,
We will see what Diane does for
We will see what Diane does for
us. We will see what Diane does for us.
us. We will see what Diane does for us.
It is late and I must sleep.
It is late and I must sleep.
Um, I got to run in the morning and then
Um, I got to run in the morning and then
I will be on streaming the rest of the
I will be on streaming the rest of the
day. We got Diane done.
So, I'm going to get some sleep. I'll be
So, I'm going to get some sleep. I'll be
back in the morning after that. I think
back in the morning after that. I think
we did Diane. We did
we did Diane. We did
uh the new trace
algorithm. I mean, we're doing pretty
algorithm. I mean, we're doing pretty
well on all these things so far.
maybe binding stuff, maybe experimental
maybe binding stuff, maybe experimental
side
side
stuff. Depends. We'll come up with some
stuff. We've got a lot of the to-do list
stuff. We've got a lot of the to-do list
done in the last couple days, really.
done in the last couple days, really.
But, uh, for folks watching, all the
But, uh, for folks watching, all the
stuff is free and open source. You can
stuff is free and open source. You can
get everything at
get everything at
puffer.ai. If you want to help me out
puffer.ai. If you want to help me out
for free, actually quite tangibly, star
for free, actually quite tangibly, star
the star the uh the GitHub. We
are 10 stars away from 1950, at which
are 10 stars away from 1950, at which
point it will round up to
point it will round up to
2K. There are not many RL repos with
2K. There are not many RL repos with
that. So, please do
that. So, please do
that. And uh if you want to get involved
that. And uh if you want to get involved
with dev, join the Discord,
with dev, join the Discord,
discord.gg/puffer. Most of these
discord.gg/puffer. Most of these
environments are written by
environments are written by
contributors, many of whom came in with
contributors, many of whom came in with
zero RL experience. Great way to get
zero RL experience. Great way to get
involved with RL. It's a great way to
involved with RL. It's a great way to
learn. It's a lot of fun,
too. There's uh we have some articles on
too. There's uh we have some articles on
this blog, including a quick start guide
this blog, including a quick start guide
for beginners, but also some more
for beginners, but also some more
advanced stuff.
advanced stuff.
There's also more stuff on X that you
There's also more stuff on X that you
can't find anywhere else.

Kind: captions
Language: en
Hello, we are
Hello, we are
live. It is
live. It is
late. I am
late. I am
tired, but we're going to do a short
tired, but we're going to do a short
stream
stream
anyways because why not? I said I would
anyways because why not? I said I would
deal with some messages. Had to deal
deal with some messages. Had to deal
with a few other silly things, but uh
with a few other silly things, but uh
whatever. We'll we'll get something
whatever. We'll we'll get something
done, right?
I just wanted to run
um a few more experiments on
um a few more experiments on
Diane, sort of think about it a little
Diane, sort of think about it a little
bit
bit
more and figure out what we can do with
it. Get my container back.
Welcome Twitch
folks. Hey, I
folks. Hey, I
bet long dinner. They gave me like 3x
bet long dinner. They gave me like 3x
the normal quantity of ice cream, so I
the normal quantity of ice cream, so I
am
stopped. Oh, I have this here. Perfect.
It was the first time I've been there.
The other location though like third of
The other location though like third of
the
amount. Dangerous having ice cream
amount. Dangerous having ice cream
around.
around.
I don't know. It doesn't really tempt
I don't know. It doesn't really tempt
me. I get it when I'm like out
me. I get it when I'm like out
sometimes. Calories are not bad when
sometimes. Calories are not bad when
you're
you're
underweight. Um,
okay. That'll actually just end up
okay. That'll actually just end up
helping me recover because otherwise I'm
helping me recover because otherwise I'm
going to feel beat up as hell tomorrow
going to feel beat up as hell tomorrow
from all the squats.
Okay, here we are with
Okay, here we are with
Diane. It's literally just this little
Diane. It's literally just this little
bit of code,
right? Where's the loss?
There it is. Literally just this little
There it is. Literally just this little
block of
code. Does it even make sense that it is
code. Does it even make sense that it is
so easy for
Uh, for this to be told apart
Like we have this
graph and it's this tiny little
graph and it's this tiny little
loss, right?
Does cross entropy even make sense the
Does cross entropy even make sense the
way it's defined
here? Input logic and
target. You ran snake
earlier. This is not dying
earlier. This is not dying
related. Well, the default hypers are
related. Well, the default hypers are
now for move on
now for move on
bet.
bet.
So, yeah, there could be a difference.
We should get you a box again so you can
We should get you a box again so you can
run experiments. We technically have
run experiments. We technically have
um if you want to set stuff up on box
um if you want to set stuff up on box
six, go ahead. It's uh it's a little
six, go ahead. It's uh it's a little
dodgy. I think one of like I think the
dodgy. I think one of like I think the
chip is like intermittently
chip is like intermittently
screwy. So, it's probably going to get I
screwy. So, it's probably going to get I
mean all the boxes are going to get sent
mean all the boxes are going to get sent
through main gear anyways on their way
through main gear anyways on their way
to the new facility. But yeah, you can
to the new facility. But yeah, you can
feel free to set stuff up on box
six. I mean, you've been doing a ton of
six. I mean, you've been doing a ton of
stuff. You should I don't know why you
stuff. You should I don't know why you
don't have a
box. Like the point of giving
box. Like the point of giving
contributed hardware is to make it
contributed hardware is to make it
easier for you to like work on cool
easier for you to like work on cool
stuff and get stuff done,
right? Uh, okay. So, this is
right? Uh, okay. So, this is
interesting.
So target is supposed to
So target is supposed to
be soft maxed I guess.
Oh no, because it's Z
indices. No more optimizer. Yeah, you
indices. No more optimizer. Yeah, you
shouldn't be using that [ __ ] Adam, like
shouldn't be using that [ __ ] Adam, like
it's a step change. It's really a step
it's a step change. It's really a step
change in
change in
capabilities. You might have to set up
capabilities. You might have to set up
the dev container build. I don't know
the dev container build. I don't know
what's on the current
one. And I'm trying to get more boxes.
one. And I'm trying to get more boxes.
It's just like one, it's a really big
It's just like one, it's a really big
purchase.
purchase.
Um, it's like a lowend house size
Um, it's like a lowend house size
purchase and uh two is the terrace. So,
purchase and uh two is the terrace. So,
I had to sort both of those things
out. Yeah, we're not buying we're not
out. Yeah, we're not buying we're not
buying the boxes for plus 40%. No, thank
buying the boxes for plus 40%. No, thank
you.
science
science
policy. I I'm not it's not I'm not
policy. I I'm not it's not I'm not
commenting on the tariffs as a whole.
commenting on the tariffs as a whole.
This was like obviously some dumb
This was like obviously some dumb
loophole anyways because they put an
loophole anyways because they put an
exception on
exception on
electronics, right? And then they just
electronics, right? And then they just
didn't put one on components. So like
didn't put one on components. So like
obviously the intent is not to make it
obviously the intent is not to make it
so that you need to manufacture your
so that you need to manufacture your
whole box in China instead of just
whole box in China instead of just
importing the comp. Like it's some
importing the comp. Like it's some
oversight. It'll get fixed unless people
oversight. It'll get fixed unless people
are really dumb.
So this loss correctly computed. I'm
So this loss correctly computed. I'm
trying to think how the hell it's this
trying to think how the hell it's this
smart like how is it
smart like how is it
that the logits are like immediately
Let me make sure of one thing.
And I actually ate too much ice cream.
And I actually ate too much ice cream.
Holy hell.
It's like not even a bad thing either
It's like not even a bad thing either
because it's like great for
because it's like great for
recovery and I kicked my ass doing
recovery and I kicked my ass doing
squats
squats
today. But like
holy. Okay. So this guy launch should
holy. Okay. So this guy launch should
not optimize
not optimize
like much at
all. Okay. So, we can see here the Dion
all. Okay. So, we can see here the Dion
loss is
1.3 because I put a stop grad here. So,
1.3 because I put a stop grad here. So,
it can't optimize the rest of the
it can't optimize the rest of the
network. So, it literally has no way to
network. So, it literally has no way to
tell the policy to act differently.
By
By
comparison, if we delete the stop
grad loss is almost zero immediately.
So, what box is Aaron on? I moved Aaron
So, what box is Aaron on? I moved Aaron
to box
five. Let me d Doesn't
five. Let me d Doesn't
actually I'll double check. You don't
actually I'll double check. You don't
have to delete his box. You can just
have to delete his box. You can just
make a new
make a new
one. Let me double check.
Yep. Aaron's on box five.
Yeah, that's how it's supposed to work.
Yeah, that's how it's supposed to work.
Anyways, you need the dev container bet,
Anyways, you need the dev container bet,
like the dev branch of Puffer Tank or
like the dev branch of Puffer Tank or
whatever that has the new base in it.
whatever that has the new base in it.
That's like the CUDA 128 or whatever
That's like the CUDA 128 or whatever
base. Well, not 128, it's 124, I think.
base. Well, not 128, it's 124, I think.
Yeah, it it's the it should say CUDA
Yeah, it it's the it should say CUDA
like CUDA dev or whatever in the from
like CUDA dev or whatever in the from
you need the developer uh you need the
you need the developer uh you need the
developer tools for CUDA so you can
developer tools for CUDA so you can
compile 312. Yes.
It's kind of crazy that literally you
It's kind of crazy that literally you
just give this thing down sampled
just give this thing down sampled
logs and it perfectly knows
which has gone Like which agent is what?
Well, let's get rid of
Well, let's get rid of
the distribution.
[Music]
I'm just getting tired here. Oops.
See if this still
works. Keeps popping up.
Okay, this will be
interesting. We'll let this run a bit.
I honestly want to stay up and keep
I honestly want to stay up and keep
working on this because I'm afraid that
working on this because I'm afraid that
if I I'm afraid if I like lie down to go
if I I'm afraid if I like lie down to go
to sleep, I'm going to throw up with all
to sleep, I'm going to throw up with all
this ice cream. It's actually
this ice cream. It's actually
ridiculous.
Well, that actually did something.
It's telling the policies apart, but
It's telling the policies apart, but
it's trying so hard to do it.
Yeah. Okay.
Really? That doesn't even help much at
Really? That doesn't even help much at
all, does
it? It is like really really
it? It is like really really
hard for this thing
hard for this thing
uh to figure it out.
That soft max really made it
tough. What if we give it the full
We give it the full thing.
Is it log softmax or soft max?
You
You
normally log soft max or soft
max log soft max
right.
So log soft max of
So log soft max of
logic it's totally good.
Yeah, the Diane loss here is getting
Yeah, the Diane loss here is getting
totally
screwed. Without this mask, it's easy,
right? I comment this one line.
So,
uh, dang.
Why does it hurt it that badly? Okay.
So I guess what it happened is it can't
So I guess what it happened is it can't
tell which policy is which just based on
tell which policy is which just based on
the actions,
right? It's using the other
right? It's using the other
logics like differences in the other.
logics like differences in the other.
Okay, that would make sense.
Okay, that would make sense.
So then if we get this to work, it could
So then if we get this to work, it could
be very powerful,
right? So what if we just like put this
right? So what if we just like put this
mask
mask
on and then we just
do we do
this. We know like 1.3 is random or
this. We know like 1.3 is random or
whatever, I think.
Okay, this looks good. Do we have it on
Okay, this looks good. Do we have it on
Neptune? We do.
Neptune? We do.
Cool. Let's see what this does.
And then we will try the down sampled
And then we will try the down sampled
one as
one as
well. With the down sampled
well. With the down sampled
one, I don't even know if we have to
one, I don't even know if we have to
down
sample. Oh, this isn't even bad.
It still mostly knows which one is
It still mostly knows which one is
um is
um is
which. It just really wanted to push the
which. It just really wanted to push the
loss all the way to zero is all
So now it pretty much just gets to see
So now it pretty much just gets to see
the sequence of
the sequence of
actions. That's cool.
actions. That's cool.
So given that you can see the sequence
So given that you can see the sequence
of actions that an agent takes and given
of actions that an agent takes and given
that you can tell it whether to push
that you can tell it whether to push
that probability of that specific action
that probability of that specific action
up or
up or
down make the agents do distinguishable
things. Seems cool.
Do we still think there's any reason to
Do we still think there's any reason to
give it um a down sample trajectory?
I'm not sure.
I could also probably mess with entropy
I could also probably mess with entropy
at this point,
at this point,
right? We probably don't need entropy
right? We probably don't need entropy
anymore with
this. Maybe not. Hard to say.
preventing the policy from determinizing
preventing the policy from determinizing
is
is
still maybe a
thing. Maybe it isn't. I don't
know. I want to see what this policy
know. I want to see what this policy
does though. I know that
What's the best that we have on this?
What's the best that we have on this?
Like 91
Like 91
92. It's going to take a little bit of a
92. It's going to take a little bit of a
per hit with
per hit with
this, but I want to see if it does
this, but I want to see if it does
anything interesting.
anything interesting.
It's kind of hard to say in this
It's kind of hard to say in this
environment, right? Like you'd really
environment, right? Like you'd really
want something where the policies are
want something where the policies are
more
expressive. I wonder how to doing
I mean, this has continued to improve.
I mean, this has continued to improve.
It's like not that far behind now,
It's like not that far behind now,
right? That's like really close.
That's pretty
cool. These are tiny policies as well.
cool. These are tiny policies as well.
Mind you
It's also just possible that this loss
It's also just possible that this loss
is too high,
right? I mean the uh the Diane loss
right? I mean the uh the Diane loss
coefficient like maybe it is kind of
coefficient like maybe it is kind of
more like entropy bonus where you want
more like entropy bonus where you want
like 0.01 or something of it.
It's crazy solid
though. So, this is one where it was
though. So, this is one where it was
like trivial for it to learn Diane
like trivial for it to learn Diane
because it had the full logic
distribution. Oh, score is 90 with the
distribution. Oh, score is 90 with the
eval.
eval.
All right, that's like pretty much on
That's the point of
puffer. I don't know. Can we see any
puffer. I don't know. Can we see any
play style
differences? It's hard to say. Like, can
differences? It's hard to say. Like, can
we see play style differences?
Right. They do seem more sideways,
Right. They do seem more sideways,
right? Do all of them seem more sideways
right? Do all of them seem more sideways
or some colors more sideways and some of
or some colors more sideways and some of
them more up and down?
They kind of all seem a little more
sideways. Salmon one maybe.
sideways. Salmon one maybe.
Yeah, maybe.
Well, it says I can tell these apart
Well, it says I can tell these apart
very accurately, right?
Try
something. We do like this.
I want to see what this loss ends up
I want to see what this loss ends up
being.
being.
if it like does anything substantially
different. There's more stuff we can
different. There's more stuff we can
try, right?
I'm kind of also wondering if we give it
states. Is there any way that that makes
states. Is there any way that that makes
sense?
Like if we also give it
states that might do
something like I'm trying to think if
something like I'm trying to think if
it's if there's a thing right where even
it's if there's a thing right where even
if the state path is not
if the state path is not
differentiable if like because it can
differentiable if like because it can
use the states that it ends up
use the states that it ends up
in if like that somehow
makes it able to better optimize the
makes it able to better optimize the
actions.
Well, but like can it right because the
Well, but like can it right because the
thing is the state's not
thing is the state's not
differentiable. All right. Have I drawn
differentiable. All right. Have I drawn
this diagram
yet? So I like this is an important
yet? So I like this is an important
concept as well.
Okay. So like this is how it works,
Okay. So like this is how it works,
right? So you have like you have like
right? So you have like you have like
obs and then you you take action one and
obs and then you you take action one and
then you get
then you get
obso,
right? And then the thing is that in the
right? And then the thing is that in the
way that this looks like in the neural
way that this looks like in the neural
net, right? It's like
net, right? It's like
[Music]
02 and the way it looks in the neural
02 and the way it looks in the neural
net right is like this is
LSTM. And then this is like a one
a2. Okay. And then what you do is you
a2. Okay. And then what you do is you
put this into a
discriminator which is
like okay. Okay. And then this tells you
like okay. Okay. And then this tells you
this tries to predict like
Z1 which is the index and then the trick
Z1 which is the index and then the trick
of Diane right is that this is
Z1. So you're trying to based on the
Z1. So you're trying to based on the
actions predict the
actions predict the
Z, right?
Z, right?
So like one thing you could do is you
So like one thing you could do is you
could put the observations into the
could put the observations into the
network. But then if you go backwards
network. But then if you go backwards
through the network, right? The way that
through the network, right? The way that
this learns is it goes backwards through
this learns is it goes backwards through
the actions and you actually back
the actions and you actually back
propagate through the logits. So you can
propagate through the logits. So you can
actually update the network, right? To
actually update the network, right? To
change the action props. But with the
change the action props. But with the
observation, the gradient through the
observation, the gradient through the
observation doesn't go backwards through
observation doesn't go backwards through
the network.
the network.
So I don't know if there's like some way
So I don't know if there's like some way
indirectly that this could potentially
indirectly that this could potentially
learn something but you see it can't
learn something but you see it can't
directly learn here
directly learn here
right like there's no direct dependence
right like there's no direct dependence
of the weights on the
observations. So the discriminator is
observations. So the discriminator is
trying to predict Z. Z is a one hot
trying to predict Z. Z is a one hot
vector. So Z think of a one hot vector
vector. So Z think of a one hot vector
is just an index right?
is just an index right?
So you just tell it that hey this is
So you just tell it that hey this is
going to be uh one and one is just like
going to be uh one and one is just like
you're team one you need to behave
you're team one you need to behave
differently from team
differently from team
two. Okay. And how do you know if you
two. Okay. And how do you know if you
behave differently? Well if the
behave differently? Well if the
discriminator can tell a can tell you
discriminator can tell a can tell you
apart from the other teams just based on
apart from the other teams just based on
your actions then you're behaving
your actions then you're behaving
differently.
differently.
Right? So that's how this thing works.
Right? So that's how this thing works.
You tell it what team it's on and then
You tell it what team it's on and then
the discriminator tries to predict just
the discriminator tries to predict just
based on the actions what team it's on.
So, the only way that the network can
So, the only way that the network can
tell you what team it's on is by taking
tell you what team it's on is by taking
actions that are
distinguishable. Why do we want to
distinguishable. Why do we want to
predict Z? So that it learns. We want
predict Z? So that it learns. We want
the ideas that we want the
the ideas that we want the
policy to be able to play in many
policy to be able to play in many
different ways.
That's exploration,
right? If we have a policy that can play
right? If we have a policy that can play
the game a lot of different
the game a lot of different
distinguishable
distinguishable
ways, that's like exploration in a
nutshell. It's kind of a cool idea,
nutshell. It's kind of a cool idea,
right?
Yeah, this is like a bad end to try to
Yeah, this is like a bad end to try to
sus out play style difference is the
sus out play style difference is the
problem.
separate. No, it can't identify them.
separate. No, it can't identify them.
So, the thing is just because they're in
So, the thing is just because they're in
the network like you're getting just the
the network like you're getting just the
probability of best action or the
probability of best action or the
probability of the action you're taking.
probability of the action you're taking.
So, you can't cheat and send any
So, you can't cheat and send any
information like that to the
information like that to the
discriminator
discriminator
network because the discriminator
network because the discriminator
network only gets to see these actions
network only gets to see these actions
A1, A2, A3. So, there's no way that you
A1, A2, A3. So, there's no way that you
can like smuggle information because if
can like smuggle information because if
we just let you like send the hidden
we just let you like send the hidden
state or something, it's trivial.
We wouldn't need separate
obs. Oh, it's just a one hot. See, it's
obs. Oh, it's just a one hot. See, it's
just like an extra one
hot. It's a very trivial network
hot. It's a very trivial network
modification. You share the same weights
modification. You share the same weights
for all the nets. That's the point.
If they're all pursuing the same
If they're all pursuing the same
strategy, the discriminator wouldn't be
strategy, the discriminator wouldn't be
able to tell them apart and the loss
able to tell them apart and the loss
would be near
random. The discriminator can tell he's
random. The discriminator can tell he's
apart.
We should probably log the
We should probably log the
accuracy losses near zero whenever. So
accuracy losses near zero whenever. So
the run that we lo watched before this
the run that we lo watched before this
had near zero loss.
Yes, it's 0.1 here.
I mean technically we can do like this
right? We can do
I think less snakes just makes the end
I think less snakes just makes the end
really
really
easy. I don't
easy. I don't
know. We could try
it. Let me see what this
it. Let me see what this
does. I just cranked up the D and lost a
does. I just cranked up the D and lost a
ton. So like now it really really wants
ton. So like now it really really wants
to tell them apart.
to tell them apart.
Smaller canvas gives you less space to
Smaller canvas gives you less space to
tell what they're
tell what they're
doing. If anything, I want a big canvas
doing. If anything, I want a big canvas
and see if they go in different
and see if they go in different
directions,
right? Okay. So, this has very low loss.
Let's see if we can
tell. I mean, this is a lower like a
tell. I mean, this is a lower like a
lower reward
policy. Maybe we can tell it apart.
It's got ridiculously low Dion
loss. Yeah. So here it does it
right. White snakes go
up. Pink snake
up. Pink snake
goes up and to the
left. Red snake goes pretty well
left. Red snake goes pretty well
straight left.
I mean, we don't I can't necessarily
I mean, we don't I can't necessarily
tell them all apart, but we can
tell them all apart, but we can
definitely see there's separation,
definitely see there's separation,
right? Like, there's very clearly
right? Like, there's very clearly
separation here, right?
Red is
cubing. They probably don't know
cubing. They probably don't know
anything particularly sophisticated.
anything particularly sophisticated.
It's a really small
model. They do have perfect micro
model. They do have perfect micro
though.
I mean like this is definitely
I mean like this is definitely
something,
right? If perfect, why
die? There's already a like there's
die? There's already a like there's
already a reward penalty.
And it micro they they don't see very
And it micro they they don't see very
far, right? So like you can get yourself
far, right? So like you can get yourself
into a circumstance where there's no way
out. So you can't see very far. So if
out. So you can't see very far. So if
you get into like the inner part of a
you get into like the inner part of a
spiral, there's just no way out.
Yeah, we
could. No, you will tank PF a
bit. Train speed. I
bit. Train speed. I
mean, I kind of like this being the
mean, I kind of like this being the
really fast
end. Okay, let me think about other
end. Okay, let me think about other
things we can do to
things we can do to
like fiddle with this.
We don't really need to do two policies.
We don't really need to do two policies.
Hang on. Let's do
Hang on. Let's do
something. What do I think is the most
something. What do I think is the most
likely to
likely to
improve turf?
uh BPD horizon is that way because of
uh BPD horizon is that way because of
the new experience buffer code. requires
the new experience buffer code. requires
longer
horizons. Also, I though I do believe it
horizons. Also, I though I do believe it
was
anyways. I liked 0.1 on the co
anyways. I liked 0.1 on the co
here. If we do
here. If we do
0.1 and we do
16 and no
mask. What's this look like?
So bet
So bet
um it no longer bootstraps J over
um it no longer bootstraps J over
multiple
multiple
segments. So you need to fit your whole
segments. So you need to fit your whole
J horizon in BPTT.
I mean, most likely we're going to end
I mean, most likely we're going to end
up just going up to like we're going to
up just going up to like we're going to
end up renaming BBT because it's really
end up renaming BBT because it's really
trajectory segment length now and it's
trajectory segment length now and it's
probably going to go up to like 128
us. Isn't that kind of
us. Isn't that kind of
good? I just
did. It's not. Not really. It depends
did. It's not. Not really. It depends
where it levels, I guess.
says it's very
diverse. It's like not bad.
Is it just me or is it actually kind of
Is it just me or is it actually kind of
distinguishable?
Red doesn't seem to go to the left
Red doesn't seem to go to the left
though. Look. See all these reds over
though. Look. See all these reds over
here?
here?
Look. That's different, right?
What happens if I
do at some
do at some
point? There's just not
point? There's just not
enough. It's not going to be able to
enough. It's not going to be able to
tell these apart, right?
Yeah. Okay. So, this just tanks
Yeah. Okay. So, this just tanks
it. That just hard tanks
it. Is it Kai? I don't know.
it. Is it Kai? I don't know.
Man, if you have different names, I'm
Man, if you have different names, I'm
not going to remember. If you have like
not going to remember. If you have like
different names everywhere, it's just
different names everywhere, it's just
it's not
realistic. 0.01
I
mean, that's pretty damn
mean, that's pretty damn
good. And low dying losses. What? Oh. Oh
good. And low dying losses. What? Oh. Oh
ho. Wait, wait, wait, wait, wait, wait,
ho. Wait, wait, wait, wait, wait, wait,
wait.
wait.
Uh, that was kind of doing a thing,
Uh, that was kind of doing a thing,
wasn't
wasn't
it? Yeah, that was kind of doing a
thing. Maybe maybe this is the formula.
Maybe we just give it a little more time
Maybe we just give it a little more time
and we
see that's like that was pretty
good. So this is like a whole bunch of
good. So this is like a whole bunch of
different strategies. Just like try to
different strategies. Just like try to
make it distinguish a whole bunch of
make it distinguish a whole bunch of
stuff, but don't give it some crazy high
stuff, but don't give it some crazy high
penalty that's going to corrupt the
penalty that's going to corrupt the
policy.
So like Diane loss can start out kind of
So like Diane loss can start out kind of
high
There. We need an end where we can
There. We need an end where we can
actually like distinguish different
actually like distinguish different
behaviors
though. Dion loss could
though. Dion loss could
decrease. It
decrease. It
will. It's hard to decrease the Dian
will. It's hard to decrease the Dian
loss while the policy is like rapidly
loss while the policy is like rapidly
increasing in competence
though. So notice here that this one is
though. So notice here that this one is
like
like
Well, there's a learning rate schedule
Well, there's a learning rate schedule
difference here. Okay.
Yo, that's actually really
good. Screw it. Full
good. Screw it. Full
run. Full run and then
bed. That got 95 score, which is higher
bed. That got 95 score, which is higher
than I've seen from a legit
run. We solve exploration tonight. Screw
run. We solve exploration tonight. Screw
it. More breakthroughs,
it. More breakthroughs,
guys. Not enough breakthroughs for a
guys. Not enough breakthroughs for a
day. We solve RL with Diane. Let's go.
Maybe we set up a hyper pram sweep on
Maybe we set up a hyper pram sweep on
this as
this as
well. I'd have to kind of fix a couple
well. I'd have to kind of fix a couple
of the boxes. I've been meaning to do
of the boxes. I've been meaning to do
that so they're not
that so they're not
idle. Um, I mean I have them so I can
idle. Um, I mean I have them so I can
use them and people don't
use them and people don't
like so I can run my own
stuff. Quick
stuff. Quick
check. Puffer advantage. Normal
check. Puffer advantage. Normal
advantage. Puffer advantage. Normal
advantage. Puffer advantage. Normal
advantage. Small
advantage. Small
difference, but it is
there. Uhoh, we got a dip down
there. Uhoh, we got a dip down
here. There might be a learning rate
here. There might be a learning rate
screw up
thing. We will see.
I could probably like fix a box while
I could probably like fix a box while
I'm sitting here.
box zero. My
box zero is mine, right?
and this has cuda cuda on it I
[Music]
Okay, this
runs. So, we will be able to set up a
runs. So, we will be able to set up a
sweep, I
sweep, I
think, because
think, because
um like to just do
Box 6 has CUDA
Box 6 has CUDA
123. How the [ __ ] does that
happen? No, because I don't have the
happen? No, because I don't have the
container set up for 123.
Um, should I just run like an app get
Um, should I just run like an app get
like update Nvidia or some [ __ ]
Yeah, but like just update it
Yeah, but like just update it
anyways. Well, but don't do it on the
anyways. Well, but don't do it on the
container. Like I'm going to have to
container. Like I'm going to have to
pseudo it on the
box. No, you're going to [ __ ] that
box. No, you're going to [ __ ] that
up. Cuz there's stuff in fall four.
I mean, you can go for it and try it. I
guess 128 is a pain cuz you need like
guess 128 is a pain cuz you need like
more recent drivers.
This got
97. So about the same.
It's a cool
model. Pretty dense.
Yeah, this is
Yeah, this is
good. It's like really
good. It's like really
dense. Look at all the snakes.
I'm going to run this sweep
uh that was the most recent one it
uh that was the most recent one it
seems. So the one before that was
Many snake
I don't think you're going to really be
I don't think you're going to really be
able to tell looking at them
visually, but what we can do
Okay, we want all this crap out of the
sweep. So it only is going to
sweep Diane loss
sweep Diane loss
coefficient and the archive
coefficient and the archive
size. So all just going to
size. So all just going to
sweep. So fix everything
sweep. So fix everything
else and then just do this.
Oh, we got a sweep
Oh, we got a sweep
running. That's going to be nice.
We might also tune like a down sample
We might also tune like a down sample
co, but I I think that this could do
co, but I I think that this could do
some stuff.
We're only sweeping the Diane loss
We're only sweeping the Diane loss
coefficient and the archive size. Two
coefficient and the archive size. Two
total sweep params.
Get out of here,
Get out of here,
bot. We build the bots around
here. Okay, so this runs, right?
here. Okay, so this runs, right?
Uh, I should probably let it finish one
Uh, I should probably let it finish one
just in case. Sometimes there's like
just in case. Sometimes there's like
weird behavior between
weird behavior between
runs. So, we'll double check
runs. So, we'll double check
that. But like this algorithm seems
that. But like this algorithm seems
good. Since we do have some folks on
good. Since we do have some folks on
YouTube, I'll uh I'll briefly say what
YouTube, I'll uh I'll briefly say what
this algorithm is. So, what this does is
this algorithm is. So, what this does is
it takes the action
it takes the action
logics of uh an
logics of uh an
entire trajectory
entire trajectory
segment. It assigns each trajectory
segment. It assigns each trajectory
segment an index in the
segment an index in the
observations. So like your trajectory
observations. So like your trajectory
segment one, your index one, trajectory
segment one, your index one, trajectory
segment two, your index four, whatever.
segment two, your index four, whatever.
You pick a fixed number of indices and
You pick a fixed number of indices and
then you train a discriminator just on
then you train a discriminator just on
the action logits to try to predict that
the action logits to try to predict that
index. So the effect is that different
index. So the effect is that different
trajectories should try to be
trajectories should try to be
distinguishable based on their index.
distinguishable based on their index.
It's almost like saying you you're going
It's almost like saying you you're going
to have play style one, you're going to
to have play style one, you're going to
have play style two, you're going to
have play style two, you're going to
have play style three.
have play style three.
Um, and potentially this can give you
Um, and potentially this can give you
better exploration. And that's the hope
better exploration. And that's the hope
that this is like something
that this is like something
substantially better than like naive
substantially better than like naive
entropy or whatever because it actually
entropy or whatever because it actually
has to be
has to be
distinguishable differences in
behavior. And we're going to see how
behavior. And we're going to see how
that does. Preliminary results are
that does. Preliminary results are
pretty
pretty
good. I say is we immediately on the
good. I say is we immediately on the
very first run
very first run
get
get
0.9 three 0.94
0.9 three 0.94
whatever I think the first run takes
whatever I think the first run takes
mean per so that's not entirely
unexpected pretty good
seed context has already been set oh I
seed context has already been set oh I
thought we fixed that bug
I thought we fixed
that. See, good thing I checked.
when I say about stuff breaking on
when I say about stuff breaking on
second run
second run
sometimes. All right, we'll let this one
go. Should be faster this time anyways.
go. Should be faster this time anyways.
No compile time.
How was this run? Out of
How was this run? Out of
curiosity.
curiosity.
Well, buffer lib
Well, buffer lib
206.
206.
Good. Yeah, those version numbers don't
Good. Yeah, those version numbers don't
get updated per commit or anything. They
get updated per commit or anything. They
only get updated per pit package uh per
only get updated per pit package uh per
uh pi pi package update. So,
container worked.
container worked.
Good. Very
Good. Very
good. See if this guy ever
good. See if this guy ever
replied.
replied.
Nope. Went off to lunch and never came
Nope. Went off to lunch and never came
back.
I
I
mean, I don't know how much there is to
mean, I don't know how much there is to
gain
gain
in sweeping these params, but if there
in sweeping these params, but if there
is
is
uh even a little bit in
uh even a little bit in
there, it could have a very interesting
there, it could have a very interesting
policy by
tomorrow. 1.5 mil steps per second.
tomorrow. 1.5 mil steps per second.
All the runs should run at exactly that
speed once this this can only compile
speed once this this can only compile
like a few
like a few
times. Yeah. So,
We will see what Diane does for
We will see what Diane does for
us. We will see what Diane does for us.
us. We will see what Diane does for us.
It is late and I must sleep.
It is late and I must sleep.
Um, I got to run in the morning and then
Um, I got to run in the morning and then
I will be on streaming the rest of the
I will be on streaming the rest of the
day. We got Diane done.
So, I'm going to get some sleep. I'll be
So, I'm going to get some sleep. I'll be
back in the morning after that. I think
back in the morning after that. I think
we did Diane. We did
we did Diane. We did
uh the new trace
algorithm. I mean, we're doing pretty
algorithm. I mean, we're doing pretty
well on all these things so far.
maybe binding stuff, maybe experimental
maybe binding stuff, maybe experimental
side
side
stuff. Depends. We'll come up with some
stuff. We've got a lot of the to-do list
stuff. We've got a lot of the to-do list
done in the last couple days, really.
done in the last couple days, really.
But, uh, for folks watching, all the
But, uh, for folks watching, all the
stuff is free and open source. You can
stuff is free and open source. You can
get everything at
get everything at
puffer.ai. If you want to help me out
puffer.ai. If you want to help me out
for free, actually quite tangibly, star
for free, actually quite tangibly, star
the star the uh the GitHub. We
are 10 stars away from 1950, at which
are 10 stars away from 1950, at which
point it will round up to
point it will round up to
2K. There are not many RL repos with
2K. There are not many RL repos with
that. So, please do
that. So, please do
that. And uh if you want to get involved
that. And uh if you want to get involved
with dev, join the Discord,
with dev, join the Discord,
discord.gg/puffer. Most of these
discord.gg/puffer. Most of these
environments are written by
environments are written by
contributors, many of whom came in with
contributors, many of whom came in with
zero RL experience. Great way to get
zero RL experience. Great way to get
involved with RL. It's a great way to
involved with RL. It's a great way to
learn. It's a lot of fun,
too. There's uh we have some articles on
too. There's uh we have some articles on
this blog, including a quick start guide
this blog, including a quick start guide
for beginners, but also some more
for beginners, but also some more
advanced stuff.
advanced stuff.
There's also more stuff on X that you
There's also more stuff on X that you
can't find anywhere else.
