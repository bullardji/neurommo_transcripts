Kind: captions
Language: en
hopefully I've un broken my machine
bet it's the stupid experiments folder
bet it's the stupid experiments folder
again
not really a lot
actually okay I don't know where all my
actually okay I don't know where all my
space went doesn't
matter the docker
matter the docker
pull go grab it from here
good
chart stole that off of offer and I
chart stole that off of offer and I
stole that I don't know where I stole
stole that I don't know where I stole
that off of I stole it off of somewhere
else only
fair okay we only have to pull one layer
fair okay we only have to pull one layer
not
not
bad we only have to pull one
layer there anything I can clean out of
layer there anything I can clean out of
here in the meantime
C stuff going on
how do these graphs look
all right this looks
good and see what you're
learning okay
learning okay
well something's still not working oh no
well something's still not working oh no
look you've got this uh this progress
look you've got this uh this progress
metric here train rewards going up over
metric here train rewards going up over
time progress is going up over time
right B clip Frack is lower value
right B clip Frack is lower value
loss looks way better
oh my camera froze
oh my camera froze
lovely let me go plug the camera unplug
lovely let me go plug the camera unplug
and replug it
go let me see in the meantime what uh
go let me see in the meantime what uh
what I think I'm going to have to do on
what I think I'm going to have to do on
GPU
Drive oh so this doesn't even have a
Drive oh so this doesn't even have a
base or anything
I think I just have to fix like the
I think I just have to fix like the
way probably just have to fix the way
way probably just have to fix the way
it's set up with
serialization I probably am just going
serialization I probably am just going
to make this be a puffer native en is
to make this be a puffer native en is
what I'll
what I'll
do that'll be better
yeah that'll be
fine ve
fine ve
native well I don't know actually cuz we
native well I don't know actually cuz we
have to see if these
are yeah cuz it's actually the we do
are yeah cuz it's actually the we do
tensors here okay
so it has to be like VEC nun or
so it has to be like VEC nun or
something which is
fine for
now don't know what Sam's up
to you've been doing and stuff
well I think dapne is back
well I think dapne is back
on GPU Drive
m
e e
h
I should have space for this I hope
all right we got the
image and everything is set up except
image and everything is set up except
needs the poetry
install this weird Docker run is usually
install this weird Docker run is usually
instantaneous if I uh oh I got some
instantaneous if I uh oh I got some
space
space
I will just give it a second there you
go all right installing
now for
prior to 1.1 I got to work on like
prior to 1.1 I got to work on like
bringing down the install time of
bringing down the install time of
puffer really makes a
difference it's like if something just
difference it's like if something just
installs instantly you just know it's
good for
what
uh
uh
2.5 let's
see python package ecosystem is rough
all
right and then we have to go to the
branch just fast puffer PPO
I don't know I'd suggest at least
I don't know I'd suggest at least
running the Poetry
running the Poetry
build um in the docker setup yeah poetry
build um in the docker setup yeah poetry
will have to update some stuff but it
will have to update some stuff but it
would save like 90% of the time for
install I guess maybe it has to rebuild
install I guess maybe it has to rebuild
anyways
all right get
all right get
checkout what is it get
checkout what is it get
checkout
uh wait
uh wait
I can just check out this this is a
I can just check out this this is a
branch
right out
right out
B uh integration
get there we
go algorithms
um there's a commit on this
right initial
right initial
puffer puffer
M run puffer ippo this is
promising Das
promising Das
M where'd it
M where'd it
go baselines ipo. run
go baselines ipo. run
buffer I is this
it wait is it I thought it was there was
it wait is it I thought it was there was
like a fast run or
like a fast run or
whatever or is this
it gu this is it
just run puffer P I guess no module name
just run puffer P I guess no module name
torch
lovely
reactivate is it like poetry activate or
reactivate is it like poetry activate or
something dumb hate
poetry it's so slow and
janky are you watching
janky are you watching
this
this
uh poetry
uh poetry
shell all right thank
you use
you use
UV I I used what was in the default of
UV I I used what was in the default of
the docker container this is your
the docker container this is your
container
here
here
okay see if I can get this working still
okay see if I can get this working still
no module
no module
torch
seriously what do I screw up here
I did
this how's there no torch I saw poetry
this how's there no torch I saw poetry
install it
um
this container is up to date
right yeah it's got torch in
here for
no I didn't forget to activate or
no I didn't forget to activate or
anything
try and think what I'm doing
here oh wait there's no
M's no wait I have
GPU Drive bin
GPU Drive bin
python yeah I'm in the
N so why don't I have
torch no module GPU Drive no module
torch no module GPU Drive no module
torch
do a poetry ad
torch already
present is there just something I forgot
present is there just something I forgot
that's not listed here like I don't use
that's not listed here like I don't use
poetry I don't know if there's like an
poetry I don't know if there's like an
EnV activate or like a refresh or
EnV activate or like a refresh or
something like
that I did poetry
install surprising it's not cached
install surprising it's not cached
everything so maybe it does need to be
everything so maybe it does need to be
done but I did do
done but I did do
this
already yeah still no
torch is this supposed to
torch is this supposed to
be 0.1 on this
be 0.1 on this
Branch I'm on
Branch I'm on
whoops wait why does this put me
whoops wait why does this put me
into oh
yeah I'm in this
Branch
Branch
torch what's the other thing that you
torch what's the other thing that you
have for
have for
this I can just do it can I just do this
this I can just do it can I just do this
manually
does this work inside the docker or does
does this work inside the docker or does
something get messed up if I just like
something get messed up if I just like
control C out of this
control C out of this
environment I'm going to try
it get back into the
Container H where's the
container oops
need to run it through
pip Docker has
pip Docker has
external
um I don't know how to get out of this
um I don't know how to get out of this
thing but whatever we'll just do we'll
thing but whatever we'll just do we'll
just try
this there's already this is already
this there's already this is already
built so I think I just need to
do
this okay magically works now no
this okay magically works now no
idea Bizarro all I did was reboot the
container bizarre
anyways uh what was this
anyways uh what was this
so we
got
got
spr
spr
gration algorithms no was
gration algorithms no was
baselines
baselines
ippo run puffer
P yeah what I've been doing for puffer
P yeah what I've been doing for puffer
tank that's been very effective um is I
tank that's been very effective um is I
just use the docker and then I don't put
just use the docker and then I don't put
any other like VM stuff on top of it
any other like VM stuff on top of it
right I use the docker as the VM uh in a
right I use the docker as the VM uh in a
sense so like it's just a pip install or
sense so like it's just a pip install or
UV or whatever you want to use no cond
UV or whatever you want to use no cond
no poetry none of
no poetry none of
that that's been pretty
that that's been pretty
effective okay so there's no puffer lip
effective okay so there's no puffer lip
here so presuming that
here so presuming that
you you just clone puffer lib or
you you just clone puffer lib or
something you just cloned puffer lib Dev
I need to get my own install time down
I need to get my own install time down
on puffer lib
on puffer lib
geez should be
instantaneous
pole all right so we're on dev oops
now we got puffer
lib let's see if there's anything
lib let's see if there's anything
incompatible in
incompatible in
here hopefully it doesn't mess up like
here hopefully it doesn't mess up like
torch version or
something okay it's going to go grab
something okay it's going to go grab
Jim numpy open
CV bunch of random stuff scyon doer
CV bunch of random stuff scyon doer
should be
fine pip install torch and M after
fine pip install torch and M after
poetry yeah pip install e dot got it I
poetry yeah pip install e dot got it I
think
I think that was the most likely thing
I think that was the most likely thing
that happened
that happened
um that broke it is just me using native
um that broke it is just me using native
like VEC native for something
like VEC native for something
new but I figured that while I was add
new but I figured that while I was add
it I would set up I do the whole proper
it I would set up I do the whole proper
setup for you guys to make sure that
setup for you guys to make sure that
everything was actually
working okay so now
working okay so now
hopefully this
hopefully this
runs and we get to your same
error the startup
time okay I think this is the seg fault
time okay I think this is the seg fault
that uh you got to so
that uh you got to so
let's figure this
out GPU
out GPU
[Music]
Drive where's your n here there's like a
Drive where's your n here there's like a
puffer end somewhere
puffer end somewhere
right
Ms initial puffer
Ms initial puffer
code algorithms puffer Li puffer
n and this is just what we had from
n and this is just what we had from
here I don't have my editor on here
here I don't have my editor on here
that's okay we'll do vanilla
Vim do make a huge
difference interesting so where would
difference interesting so where would
this egg fult is the question
does this let you make your
M or does it already seg
B
B
um okay that's weird so this seg fol in
um okay that's weird so this seg fol in
the creation of GPU drive itself
we is this getting past like something
ridiculous and
config in
config in
config 64 scenes
what do we have our config for this
thing there's like a puffer config
thing there's like a puffer config
somewhere
right I not see the
right I not see the
config for live utils
where do you have um I had like a config
where do you have um I had like a config
with my
with my
original with my version
original with my version
originally is that just in
originally is that just in
here
utils utils has the
utils utils has the
policy where does it say how many
policy where does it say how many
Ms are getting passed in
is that
is that
somehow in the algorithm file or
something
puffer num worlds
is there no new config added to this
thing off for IP maybe the
Run what was it baselines
IPO and so here I this yeah this is
IPO and so here I this yeah this is
familiar and I think yeah you just
familiar and I think yeah you just
pulled all the args out of the any files
pulled all the args out of the any files
into
into
this
this
um just
um just
fine and then where is num
fine and then where is num
NS Beck num
NS Beck num
ends default is
ends default is
eight beck. num workers is eight oh well
eight beck. num workers is eight oh well
this is probably it right
this is probably it right
here uh if I I recall this is different
here uh if I I recall this is different
from what I
from what I
had yeah I see why that would
work if we check what I did for you guys
originally not
ocean yeah okay so you see um
ocean yeah okay so you see um
it looks like there's this new VC thing
it looks like there's this new VC thing
which is vcn num
which is vcn num
M I had this set to
M I had this set to
one
because yeah you're doing this okay so
because yeah you're doing this okay so
you have this with
you have this with
multiprocessing uh your EnV is not
multiprocessing uh your EnV is not
designed for multiprocessing cuz it's a
designed for multiprocessing cuz it's a
GPU accelerated
GPU accelerated
environment so what's going to have to
environment so what's going to have to
happen here is I'm going to have to
happen here is I'm going to have to
change this to like none I'm going to
change this to like none I'm going to
probably have to make a couple updates
probably have to make a couple updates
to puffer
to puffer
lib
lib
um probably going to have to go from
um probably going to have to go from
there let's see if I do cereal for now
there let's see if I do cereal for now
what
happens yeah this needs to be one this
happens yeah this needs to be one this
needs to be one this needs to be one do
needs to be one this needs to be one do
I have zero copy on I didn't even think
I have zero copy on I didn't even think
I had zero copy on for you guys did
I yeah this is
I yeah this is
false oh store true is fine
we still going to seg
P guess that's what we're doing today
P guess that's what we're doing today
um okay
um okay
me use the restroom I'll be right back
me use the restroom I'll be right back
we're going to get this to
work
e
e e
[Music]
so where are we when this thing seg
bolts make
bolts make
en wait we're in the
Run uh how's that make any
sense one puffer 236
what for
ah okay so this is an
error this is
um yeah you don't even really need this
um yeah you don't even really need this
but whatever like it this n Creator just
but whatever like it this n Creator just
has to be a function so you can
has to be a function so you can
literally just pass it the class if you
literally just pass it the class if you
want um I'll leave it for now but you
want um I'll leave it for now but you
can literally just pass the class
okay so
okay so
now we're in the back end at the very
now we're in the back end at the very
least where it should
least where it should
be either way though that thing
be either way though that thing
shouldn't have seg foled uh which is the
shouldn't have seg foled uh which is the
odd
part so n config here has what's this
part so n config here has what's this
Max agents and scene is
128 what did I how did I do this
128 what did I how did I do this
originally n number worlds was
128 okay so now you have 64
128 okay so now you have 64
worlds
um I don't know we'll do like eight I
um I don't know we'll do like eight I
think these configs are just like like
think these configs are just like like
screwed up I think this is a GPU Drive
screwed up I think this is a GPU Drive
thing cuz we haven't even gotten to the
thing cuz we haven't even gotten to the
spot where I would have broken it with
spot where I would have broken it with
puffer
yet so like if I just do
this yeah okay so literally it was just
this yeah okay so literally it was just
you had too many worlds or whatever um
you had too many worlds or whatever um
because like I think it was it went up
because like I think it was it went up
to 128 agents or whatever from before so
to 128 agents or whatever from before so
it's seg falting just out of memory it's
it's seg falting just out of memory it's
either higher end card needed or
either higher end card needed or
whatever there um but now now I'll
whatever there um but now now I'll
actually get to fix
this okay so we need to do VEC none
this okay so we need to do VEC none
maybe or native none or
maybe or native none or
native let me think about that
native let me think about that
so I'll do this right now and Puffer
I use this right or do I not use
this okay we have perer
inv I can't really make this a
native uh
I can't really make this in Native
I can't really make this in Native
en because you guys have like Cuda
en because you guys have like Cuda
tensor
um no poetry
um no poetry
what hey that guy how's it going fixing
what hey that guy how's it going fixing
GPU Drive stuff
I think this has just got to be like
I think this has just got to be like
make uh none
make uh none
right first agent about to finish its
right first agent about to finish its
sweep assignment very
sweep assignment very
nice
nice
yeah just
yeah just
do
do
if oh wait if back end is
if oh wait if back end is
native return M Creator or end creators
native return M Creator or end creators
oh do we not even use that thing anymore
oh do we not even use that thing anymore
hold
hold
on and ARs and
on and ARs and
bars I think we can just use we can just
bars I think we can just use we can just
abuse um Native
abuse um Native
right cuz I don't even know if I use
right cuz I don't even know if I use
this thing do
I yeah I don't okay so can I just like
native
vector.
make back end is
make back end is
native oh that's Bizarro
uh yeah whatever so we'll just do it for
uh yeah whatever so we'll just do it for
now I I had there's a gross thing here
now I I had there's a gross thing here
it doesn't matter for now
though I'm not
sure cool
uh okay so now we
uh okay so now we
are vector make yeah and now it's making
are vector make yeah and now it's making
a native
van no attribute driver end there should
van no attribute driver end there should
be a driver
be a driver
end shouldn't there
end shouldn't there
open up
puffer oh yeah okay all we got to
puffer oh yeah okay all we got to
do we can probably just make this thing
do we can probably just make this thing
a puffer and yeah so we do have to do a
a puffer and yeah so we do have to do a
little bit of work here no big deal
from puffer lib
from puffer lib
do
do
environment puffer
and puffer
and and
and and
then just take this gets buffer
yeah so you do actually have to use the
yeah so you do actually have to use the
buffers
buffers
here that's fine we'll just refactor a
here that's fine we'll just refactor a
little bit for you
you from having to deal with that for
get rid of some gross things for
you and because you want stuff to be
you and because you want stuff to be
torch tensors
masks
actions
terminals
terminals
locations so returns
locations so returns
lengths is all fine
observations self out
rewards let's reset return
here uh this has to return something
here uh this has to return something
doesn't
it how do I handle this
[ __ ] looks like I do just return
[ __ ] looks like I do just return
um
huh oh because it's when you call like
huh oh because it's when you call like
async reset or
async reset or
whatever
right yeah yeah it's cuz when you call a
right yeah yeah it's cuz when you call a
async
async
reset or
whatever ASN Ki is good you may not like
whatever ASN Ki is good you may not like
it but this is what Peak Performance
it but this is what Peak Performance
looks like my
friend I think they're going to be happy
friend I think they're going to be happy
with
this and they Define step like this
this and they Define step like this
right
this has been run through like black or
this has been run through like black or
some other format this is weird I don't
some other format this is weird I don't
know what this is but
know what this is but
whatever okay um
equals OBS s
equals OBS s
rewards Bo self.
rewards Bo self.
terminal terminal self.
modifications inations I guess is
fine
fine
do oh no you don't need self infos
turn
turn
observations rewards self.
terminals info most
terminals info most
likely and the rest is handled for
likely and the rest is handled for
you and uh I'm sure we'll have to make
you and uh I'm sure we'll have to make
some fixes to this but
super
no really oh underscore
no really oh underscore
net there we go
um okay so in this case it's even though
um okay so in this case it's even though
it's a little odd uh we can put this at
it's a little odd uh we can put this at
the bottom is I think we have to put it
the bottom is I think we have to put it
like
like
here actually I'm going to put a little
here actually I'm going to put a little
comment this
comment this
assigns bunch of buffers to
assigns bunch of buffers to
your you can't use them cuz you want for
your you can't use them cuz you want for
numpy so I am
careful num agents
there numb
agents num worlds Maybe
oh uh that's kind of awkward
because wait
what oh yeah yeah yeah this is
what oh yeah yeah yeah this is
fine so what we do is
kind of sketchy to be
kind of sketchy to be
honest but hey this is API abuse so
honest but hey this is API abuse so
anything goes
is no longer
needed GPU no attribute observations
cuz this ghost here
dummy wa where's this
dummy wa where's this
buffer end
131 ah break
point
24 uh that's Bizarro isn't
it six SP
oh interesting observations
is wait it can't be
is wait it can't be
3,876
right are any of the the GPU Drive folks
right are any of the the GPU Drive folks
still watching
this this is the one part where it gets
this this is the one part where it gets
a little bit domain specific
a little bit domain specific
I I need to figure out
I I need to figure out
how how GPU Drive is allocating data
how how GPU Drive is allocating data
buffers now and how I make sure that we
buffers now and how I make sure that we
match shapes
here welcome YouTube folks as
well yeah it's kind of late in uh in New
well yeah it's kind of late in uh in New
York theyve probably uh they probably
York theyve probably uh they probably
called it a night and so no big deal
called it a night and so no big deal
I'll figure it out um Ober a shape is 24
I'll figure it out um Ober a shape is 24
so why why would observations be of
so why why would observations be of
shape
24 uh that's interesting it should not
24 uh that's interesting it should not
be
right oh self-controlled agents
right oh self-controlled agents
Mask wait hold on
something is very weird here let me see
something is very weird here let me see
how I did this for you
how I did this for you
before I
did this kind of specific
okay so we
okay so we
have OBS was given to be the agents that
have OBS was given to be the agents that
you
you
control
right then actions was given to be
right then actions was given to be
all doesn't make any sense no does
all doesn't make any sense no does
it so when you reset
only given
only given
observations agents that you
control then
control then
actions oh no cuz it's the buffer is
actions oh no cuz it's the buffer is
controlled agents okay so I see how I
controlled agents okay so I see how I
did this so I pruned out the ones that
did this so I pruned out the ones that
you don't control at the start which is
you don't control at the start which is
totally fine it's totally fine so all
totally fine it's totally fine so all
that's wrong is the uh the tensor
that's wrong is the uh the tensor
shape right
here actions needs to be not this shap
here actions needs to be not this shap
shape this shape is very silly this just
shape this shape is very silly this just
needs to be self. Nom
needs to be self. Nom
agents be an
agents be an
N64
N64
this and then we've got our
this and then we've got our
mask
Heroes and then self num agents num
Heroes and then self num agents num
agents numb agents
agents numb agents
okay uh oh actually wait that this does
okay uh oh actually wait that this does
need to be a remember now so
actions
actions
H it's kind of both isn't
H it's kind of both isn't
it so what you need is
actually we'll just do padded
actions so you got your padded actions
actions so you got your padded actions
now
do we even need self actions here I
do we even need self actions here I
don't think we use self. actions do we
don't think we use self. actions do we
it's kind of just
it's kind of just
optional I think we can actually just
optional I think we can actually just
leave this as
actions yeah and then what we'll do is
let's see about this
8 by
128 something's very weird
here for
it seems
weird 8 by 128
there like some garbage indexing going
there like some garbage indexing going
on
here okay so 8 by
128 oh eight M's
okay there are only 24 agents in
okay there are only 24 agents in
here so this is actually
here so this is actually
correct Believe It or
Not uh this is what's going to hurt perf
Not uh this is what's going to hurt perf
the most but that's hurting perf from
the most but that's hurting perf from
adona that's for you guys to figure out
oops where is
oh this parameter is not getting used um
oh this parameter is not getting used um
correctly this Max controlled agents
correctly this Max controlled agents
thing is not getting used correctly at
thing is not getting used correctly at
all
right
why is D World deten sir
that's cpu. numpy
already
what reset
this
change device side Asser
um policy
[Music]
Max
yeah yeah these buffers need to be
wait why is
wait why is
um
um
observations it shouldn't be that way
observations it shouldn't be that way
right
that's very
bizarre uh yeah there's garbage data in
bizarre uh yeah there's garbage data in
here
Hey
Hey
Eugene how's it going so I've got this
Eugene how's it going so I've got this
thing you're looking at a padding tensor
thing you're looking at a padding tensor
I don't think I am looking at a padding
I don't think I am looking at a padding
tensor though uh I'll show you so you
tensor though uh I'll show you so you
get your OBS right you get your
get your OBS right you get your
controlled agent
controlled agent
mask oh is it just
mask oh is it just
um is it because that even with the
um is it because that even with the
controlled agent mask like there still
controlled agent mask like there still
might be some dead agents or whatever
might be some dead agents or whatever
is that
it live agents
maybe yeah this is the same problem as
maybe yeah this is the same problem as
before so I mean even once I get this
before so I mean even once I get this
working you're going to be heavily
working you're going to be heavily
limited by the GPU Drive padding stuff
limited by the GPU Drive padding stuff
um but at least you'll have like a
um but at least you'll have like a
standalone and I can help you iterate
standalone and I can help you iterate
from
there it's in uh the the branch Daphne
there it's in uh the the branch Daphne
has been working on I can push this if
has been working on I can push this if
you want but it doesn't run it didn't
you want but it doesn't run it didn't
run before either so I don't know if
run before either so I don't know if
there's much harm to do but I'm added to
there's much harm to do but I'm added to
this so I can push it if you
want it's like close it's just there's a
want it's like close it's just there's a
little
yeah so there's the
yeah so there's the
issue I have made some
changes wait we have some
changes wait we have some
disagreement about whether the padding
disagreement about whether the padding
did it cut off your question
did it cut off your question
there is needed I
there is needed I
assume is hurting
assume is hurting
performance it's
performance it's
definitely I mean you have let me put
definitely I mean you have let me put
this in perspective right you have 24
this in perspective right you have 24
agents in 8 time 128 so you have 24
agents in 8 time 128 so you have 24
agents out of total of possible
agents out of total of possible
1,024 I have to do a copy slice in order
1,024 I have to do a copy slice in order
to get those things into
to get those things into
um oh is hurting perform okay yeah we're
um oh is hurting perform okay yeah we're
writing time gotcha gotcha okay I
writing time gotcha gotcha okay I
misread it X cut your message off you
misread it X cut your message off you
can see your message right here this is
can see your message right here this is
how I see it
okay so
okay so
breakpoint this is in your container as
well okay self
live do
live do
sum okay this is weird so we have 24
sum okay this is weird so we have 24
agents alive so none of these should be
agents alive so none of these should be
padding I
padding I
assume OBS is 24
uh
uh
one let's do
Max also these observations are kind of
huge so this guy this guy like some of
huge so this guy this guy like some of
these are broken like or something it
these are broken like or something it
says that they're
alive it seems like even at the start
alive it seems like even at the start
some of these are just immediately
screwy yeah it's bad
screwy yeah it's bad
right so I mean I can just for now just
right so I mean I can just for now just
so that you have something that runs
so that you have something that runs
right I can just do like look into this
right I can just do like look into this
broken data I can just do
broken data I can just do
OBS OBS greater than you know 10 equal
OBS OBS greater than you know 10 equal
Z OBS OBS less than
negative I can just do this for
now still synchronized
bugs we still have iniz bugs for some
reason ASAP very
reason ASAP very
good
good
mix
mix
in
interesting so except for the padding
interesting so except for the padding
everything's
everything's
fine rewards. Max what's or reward.
fine rewards. Max what's or reward.
maxmin
no
no
rewards
terminal not sure what
terminal not sure what
is breaking the policy
here Cuda synchronize
I think I saw on this PR there was my
I think I saw on this PR there was my
policy I actually don't remember which
policy I actually don't remember which
policy was in the pr uh if this was my
policy was in the pr uh if this was my
one or your one I think I used like a
one or your one I think I used like a
simpler
simpler
policy just to make it
policy just to make it
faster can you set launch blocking
okay so this is likely action probs
okay so this is likely action probs
being messed
up uh mine was permutation invariant as
up uh mine was permutation invariant as
well it has serious sample efficiency
well it has serious sample efficiency
did you try it versus the one that I
did you try it versus the one that I
gave you cuz I basically just took yours
gave you cuz I basically just took yours
and I took like some layer Norms out and
and I took like some layer Norms out and
stuff to speed it
stuff to speed it
up it was also it was still permutation
up it was also it was still permutation
invariant in everything
to be fair it might still be sample
to be fair it might still be sample
efficiency might be more sample
efficiency might be more sample
efficient but I suspect that mine is
efficient but I suspect that mine is
likely a better wall
likely a better wall
clock seriously trying puffer perfect
clock seriously trying puffer perfect
blank check for
support layer Norms are sometimes pretty
support layer Norms are sometimes pretty
good training at a million steps per
good training at a million steps per
second is sometimes pretty good
second is sometimes pretty good
too and that's like uh we have like
too and that's like uh we have like
several M's in Puffer that trained a
several M's in Puffer that trained a
million and even the more complex ones
million and even the more complex ones
we still get like in the hundreds of
thousands yeah I mean sample efficiency
thousands yeah I mean sample efficiency
like when you have the fast Sim anyways
like when you have the fast Sim anyways
right
right
may as well just push perf per wall
may as well just push perf per wall
clock unclear where tradeoff well what
clock unclear where tradeoff well what
I've done is you just like set your
I've done is you just like set your
hyper parameter sweep you just set the
hyper parameter sweep you just set the
cost to be equal to wall clock seconds
cost to be equal to wall clock seconds
and then you let it figure it out right
and then you let it figure it out right
you just sweep over you try different
you just sweep over you try different
architectures it's wall clock training
perf uh I'm trying to see where where
perf uh I'm trying to see where where
your thing was
your thing was
here where's your policy
oh yeah it was in this utils
file was it
util okay
util okay
[Music]
so oh yeah this is my
so oh yeah this is my
policy so this is my policy which is
policy so this is my policy which is
just your policy without layer norms and
just your policy without layer norms and
slightly
slightly
simplified this is the whole
simplified this is the whole
thing so this should totally be fine
thing so this should totally be fine
then
um what was what's the action space
here single action
space should work
discreet of nine should be reasonable
discreet of nine should be reasonable
action space
right sell and
right sell and
steer two discrete vectors I'm seeing
steer two discrete vectors I'm seeing
discrete of
nine nine is fine so I'm assuming that's
nine nine is fine so I'm assuming that's
just like
just like
merged okay um well then there shouldn't
merged okay um well then there shouldn't
be any
be any
issues if that's what it's going to
issues if that's what it's going to
be I can go check the
be I can go check the
policy
policy
um three yeah three we do that as well
um three yeah three we do that as well
we technically we support multi-
we technically we support multi-
discreet too if you want to do multi
discreet too if you want to do multi
discreet you can do it with puffer uh
discreet you can do it with puffer uh
there are a couple things in the latest
there are a couple things in the latest
version that I wanted to check to make
version that I wanted to check to make
sure that that's good so maybe hold off
sure that that's good so maybe hold off
but um I mean we do support multi-
but um I mean we do support multi-
discreete and we have a bunch of multi
discreete and we have a bunch of multi
discreete ends
we also support we support continuous as
we also support we support continuous as
well uh we just don't support mixed
well uh we just don't support mixed
continuous and discreet at the moment
continuous and discreet at the moment
you got to pick
you got to pick
one that could be added to be fair but
one that could be added to be fair but
hopefully not on my plate before 1.1
hopefully not on my plate before 1.1
release we've been really busy with uh
release we've been really busy with uh
1.1 like all these M's these are all
1.1 like all these M's these are all
going to be a million plus depths per
going to be a million plus depths per
second environments in 1
second environments in 1
one it's like 10 15,000 lines of
C okay so we can see right here we've
C okay so we can see right here we've
got garbage in the neural net
um to beat a hobby
horse it's all right I get to do this
horse it's all right I get to do this
stuff all day without having to uh worry
stuff all day without having to uh worry
about publications and stuff
about publications and stuff
now I seriously think that once we
now I seriously think that once we
release these the next phase for puffer
release these the next phase for puffer
is going to be like redoing the last 10
is going to be like redoing the last 10
years of RL research there's your error
years of RL research there's your error
by the way uh redoing the last 10 years
by the way uh redoing the last 10 years
of RL research but like with proper
of RL research but like with proper
evals and stuff so you get consistent
evals and stuff so you get consistent
results and you're probably going to see
results and you're probably going to see
a lot from that okay so Road objects and
a lot from that okay so Road objects and
Road graphs are garbage I don't know why
RL for Co what's
this
this
interesting they have
interesting they have
m's or is this
alos a lot of people on
this wrecking
soda
soda
interesting they have
m's is this meta doing torch oral or
m's is this meta doing torch oral or
what is this
set of
set of
M's
interesting don't have their M's listed
interesting okay they have a lot of
interesting okay they have a lot of
stuff in
here are they in
here are they in
torch oh no they're
interesting they're all in Python though
or I guess they're in
torch interesting I'll look at it I
torch interesting I'll look at it I
don't know how sophisticated these are
don't know how sophisticated these are
um if they're going to just be in in
um if they're going to just be in in
like torture Rays like
like torture Rays like
this one of the cool things with puffers
this one of the cool things with puffers
we're really not constrained on
we're really not constrained on
environment complexity at all
environment complexity at all
like like we can make stuff like this
like like we can make stuff like this
Moa
Moa
I mean we have people contributing all
I mean we have people contributing all
sorts of Ms like we've got this like
sorts of Ms like we've got this like
whole tactics game M that somebody just
whole tactics game M that somebody just
made that's like a full like MMO combat
made that's like a full like MMO combat
type Sim we've got somebody just
type Sim we've got somebody just
contributed
contributed
go um we've got this
MOA so like one of the cool things we
MOA so like one of the cool things we
can do with puffers just make really
can do with puffers just make really
complicated yeah this
Nathan's uh wait which
Nathan's yeah yeah yeah this one you've
Nathan's yeah yeah yeah this one you've
been collaborating for 5 years oh that's
been collaborating for 5 years oh that's
awesome yeah yeah Nathan's been in here
awesome yeah yeah Nathan's been in here
a lot working on this he also did uh he
a lot working on this he also did uh he
did our pong implementation too puffer
pong and then we've got a couple new big
pong and then we've got a couple new big
projects I have one other big project
projects I have one other big project
coming in the works and then also we've
coming in the works and then also we've
got uh there's a new collab that's going
got uh there's a new collab that's going
to be on this TCG this like magic the
to be on this TCG this like magic the
Gathering style en uh which I'm I have
Gathering style en uh which I'm I have
hopes for I made this prototype of it
hopes for I made this prototype of it
just to see you know how far I could get
just to see you know how far I could get
really quickly with it um but yeah we're
really quickly with it um but yeah we're
going to have like build this out and
going to have like build this out and
stuff loves wri in
stuff loves wri in
Sims it's gotten really way easier to do
Sims it's gotten really way easier to do
high perf stuff in uh in puffer like I
high perf stuff in uh in puffer like I
don't know if you've taken a look at all
don't know if you've taken a look at all
at these ends but like this is actually
at these ends but like this is actually
a very very legit option now um because
a very very legit option now um because
essentially like because vectorization
essentially like because vectorization
is now fast and because we have good
is now fast and because we have good
Integrations end to end with
Integrations end to end with
vectorization
vectorization
right we can kind of just start writing
right we can kind of just start writing
generic code and have it be fast so like
generic code and have it be fast so like
uh I don't know what's a good example
uh I don't know what's a good example
the Moa here which would be like a
the Moa here which would be like a
pretty substantial software project
pretty substantial software project
right well it's one file it's 2,000
right well it's one file it's 2,000
lines of c and you can just read it top
lines of c and you can just read it top
to bottom and it's pretty brain dead
to bottom and it's pretty brain dead
like there's absolutely nothing
like there's absolutely nothing
surprising in here it's just really
surprising in here it's just really
simple procedural code all the way
simple procedural code all the way
through um simpler example would be
through um simpler example would be
like what's like
like what's like
decent I guess like
decent I guess like
pong pong. H 300 lines including a bunch
pong pong. H 300 lines including a bunch
of extra logging stuff so really like
of extra logging stuff so really like
250 lines and just very simple little
250 lines and just very simple little
procedural
procedural
logic observations and everything obs
logic observations and everything obs
ation get computed directly into shared
ation get computed directly into shared
memory runs millions of steps per second
memory runs millions of steps per second
don't have to like write Vector code you
don't have to like write Vector code you
just get to write normal like normal
just get to write normal like normal
loops and stuff so very nice for
that wrote nocturn in C++ for similar
that wrote nocturn in C++ for similar
reasons never ran faster than
reasons never ran faster than
6K um
6K um
I don't actually know how
I don't actually know how
intensive of computations you have going
intensive of computations you have going
on in
on in
there it could be that I
there it could be that I
mean I like C because it's it's like so
mean I like C because it's it's like so
simple it's actually kind of hard to
simple it's actually kind of hard to
shoot yourself in the foot like there
shoot yourself in the foot like there
are no malaks there is no memory
are no malaks there is no memory
allocation dynamically during uh the Run
allocation dynamically during uh the Run
um it's all static memory so that helps
um it's all static memory so that helps
a lot
a lot
um I mean we don't have stuff like
um I mean we don't have stuff like
vector that can like dynamically resize
vector that can like dynamically resize
we don't have a lot of things it it's
we don't have a lot of things it it's
pretty much just Loops over static
pretty much just Loops over static
arrays and
arrays and
[Music]
[Music]
memory I'd have to actually get like if
memory I'd have to actually get like if
you're interested in like trying to
you're interested in like trying to
figure out how to do this type of thing
figure out how to do this type of thing
really high perf I could look at it and
really high perf I could look at it and
basically I would just need to know like
basically I would just need to know like
what the slow Parts in theory of the
what the slow Parts in theory of the
nvar like what are the parts that
nvar like what are the parts that
actually like require flops in theory
actually like require flops in theory
and then I'd have to figure out how fast
and then I'd have to figure out how fast
those pieces can run single thread
those pieces can run single thread
that's all I would have to
do do you have any idea why the uh the
do do you have any idea why the uh the
ego state is good but these things are
ego state is good but these things are
like way out of
like way out of
bounds so I can just fix this up for you
bounds so I can just fix this up for you
real quick and I can send you over a uh
real quick and I can send you over a uh
a nice thing to to play with tomorrow so
a nice thing to to play with tomorrow so
you can play with this
tomorrow GPU Drive doesn't feel yeah no
tomorrow GPU Drive doesn't feel yeah no
well I don't know where your lab is
well I don't know where your lab is
going with the Future Sims and stuff but
going with the Future Sims and stuff but
you know the simulated M for research
you know the simulated M for research
game has gotten a lot
game has gotten a lot
easier not obvious what's wrong with it
easier not obvious what's wrong with it
it's particularly weird
it's particularly weird
because I
because I
mean how is the data even getting in the
mean how is the data even getting in the
policy like
policy like
that
that
oh shouldn't be able to do
that is it just wrong at the first step
that is it just wrong at the first step
I think
I think
so I mean you have this unpack function
so I mean you have this unpack function
don't
you it algorithm puffer
you it algorithm puffer
utils where is
utils where is
unpack reshape this is just a reshape
unpack reshape this is just a reshape
though this doesn't scale
though this doesn't scale
right so if this is just a reshape then
right so if this is just a reshape then
uh my scaling should have fixed this for
you unless it's getting like one
you unless it's getting like one
hunted
hunted
uh every agent that has nonsense OBS
uh every agent that has nonsense OBS
let's
let's
see I don't know let's see
no
worries and just get to the gym a little
later yeah so it's just a few of them it
later yeah so it's just a few of them it
looks like but the thing is I thought I
looks like but the thing is I thought I
accounted for
accounted for
that oh I didn't account for it in reset
that oh I didn't account for it in reset
I'm stupid one second I forgot to do it
I'm stupid one second I forgot to do it
in reset my
bad get you right
here so OBS do we even right into OBS
here so OBS do we even right into OBS
here
here
wait
what
what zero
empty
grand total of 470 steps per
grand total of 470 steps per
second um but I have the settings very
second um but I have the settings very
low
low
um I'll leave some comments in the file
um I'll leave some comments in the file
basically you had the settings too high
basically you had the settings too high
like it was too many worlds with too
like it was too many worlds with too
many Max agents you got to do some stuff
many Max agents you got to do some stuff
with that um I have it running at the
with that um I have it running at the
very least
very least
now I mean this is purely
settings I can try to get something a
settings I can try to get something a
bit more reasonable for you here
okay um so I changed a few things I got
okay um so I changed a few things I got
to push a new update to puffer for you
to push a new update to puffer for you
to make this work there was like 90% I
to make this work there was like 90% I
had to fix stuff in in here but I did
had to fix stuff in in here but I did
have to fix a couple things in puffer um
have to fix a couple things in puffer um
just because we have like this new n
just because we have like this new n
format and I'm using the thing that used
format and I'm using the thing that used
to be called native for that now um I
to be called native for that now um I
made your en under the native format now
made your en under the native format now
it's a puffer en um it matches like Jim
it's a puffer en um it matches like Jim
VEC format roughly it this should be
VEC format roughly it this should be
fine uh yeah this should be fine don't
fine uh yeah this should be fine don't
try to multiprocess it don't try to make
try to multiprocess it don't try to make
it serial or whatever it's a GPU M run
it serial or whatever it's a GPU M run
it on GPU that'll get you several
it on GPU that'll get you several
100,000 SPS if you want to multiprocess
100,000 SPS if you want to multiprocess
it we can figure out how to multiprocess
it we can figure out how to multiprocess
it after it shouldn't be that hard um I
it after it shouldn't be that hard um I
will have to change a couple things and
will have to change a couple things and
the Cuda tensors will have to go through
the Cuda tensors will have to go through
numpy if you want to do that though so
numpy if you want to do that though so
we'll do that after um the only other
we'll do that after um the only other
thing for you was where was the the
thing for you was where was the the
config baselines run
yeah so I set this
yeah so I set this
thing it okay so I set these all to one
thing it okay so I set these all to one
which is what they should be and I think
which is what they should be and I think
it's actually in the end file and num
it's actually in the end file and num
worlds is only eight
so yeah that's so
so yeah that's so
slow I mean look you've got 70 some odd
slow I mean look you've got 70 some odd
time in the
en
en
um so what's happening here is like it's
um so what's happening here is like it's
padded to 128 agents the scene is very
padded to 128 agents the scene is very
sparse right so like the actual batch
sparse right so like the actual batch
size coming out of madona is Tiny uh you
size coming out of madona is Tiny uh you
need like dense agents so get those
need like dense agents so get those
timings St up but now you got the puffer
timings St up but now you got the puffer
harness can I just push this to this
harness can I just push this to this
Branch or do you want me to I can put
Branch or do you want me to I can put
this in a new Branch actually
dasb
into
rations
slash smoke
slash smoke
tested puer
tested puer
PP B
focus on training Den scenes I you know
focus on training Den scenes I you know
you really should be able to at the
you really should be able to at the
engine level just have those tensors be
engine level just have those tensors be
configur like you should be able to do
configur like you should be able to do
something with that but whatever for the
something with that but whatever for the
time being puffer NS puffer
time being puffer NS puffer
po uh didn't
po uh didn't
there I
there I
change guess that's all I
change guess that's all I
changed yeah
kind of should be able to return a flat
kind of should be able to return a flat
tensor yeah exactly and even then
tensor yeah exactly and even then
like got to work on having those scenes
like got to work on having those scenes
like be denser like the agents got to
like be denser like the agents got to
not die so much insist on it yeah I mean
not die so much insist on it yeah I mean
I can probably come up with some ways to
I can probably come up with some ways to
make that easier to do depends how deep
make that easier to do depends how deep
into madon it is oh I talked to uh to
into madon it is oh I talked to uh to
Brennan on uh I talked to like the
Brennan on uh I talked to like the
madona folks at Stanford uh last week
madona folks at Stanford uh last week
couple weeks ago whatever um so I think
couple weeks ago whatever um so I think
we can probably end up supporting a lot
we can probably end up supporting a lot
more of these GPU madona
more of these GPU madona
M get to 80% pretty fast and then they
M get to 80% pretty fast and then they
don't die often 80% would be fine like
don't die often 80% would be fine like
the problem is a lot of the runs I've
the problem is a lot of the runs I've
seen for here have been like 5% and then
seen for here have been like 5% and then
the like it's 95% just idle
uh this
okay so there's your PR or your your
okay so there's your PR or your your
branch because I think they just gave me
branch because I think they just gave me
access to do
access to do
that
um is
um is
this and I'll post it in the
slack I'll get you your uh your other
slack I'll get you your uh your other
commit real quick as well
us oh do I not even change
us oh do I not even change
anything I thought I
did oh I don't
actually yeah I guess I didn't change
actually yeah I guess I didn't change
anything I think you're
good never mind I was smarter than I
good never mind I was smarter than I
thought
thought
here uh whoops uh my bad leaking slack
here uh whoops uh my bad leaking slack
on stream
there I don't think you need latest
there I don't think you need latest
puffer or anything uh I forgot that I
puffer or anything uh I forgot that I
just had to change your rapper not
just had to change your rapper not
puffer
puffer
rapper all right well I think uh if
rapper all right well I think uh if
that's all for tonight I'm going to
that's all for tonight I'm going to
maybe do a couple quick things on the
maybe do a couple quick things on the
mooba and then uh call a night after uh
mooba and then uh call a night after uh
get some exercise get some food called a
get some exercise get some food called a
night
night
um yeah I mean just let me know how this
um yeah I mean just let me know how this
integration goes and and I'll be able to
integration goes and and I'll be able to
help on that you can just like you can
help on that you can just like you can
message me on the slack but more likely
message me on the slack but more likely
if you want instant if you just want
if you want instant if you just want
instant feedback just send students over
instant feedback just send students over
to stream and you get instant answers to
to stream and you get instant answers to
stuff and uh I'm more than happy to like
stuff and uh I'm more than happy to like
pull stuff on pull stuff up live and fix
pull stuff on pull stuff up live and fix
things like this I have the container
things like this I have the container
now this is just your GPU
now this is just your GPU
container uh
container uh
yeah we should be good with
yeah we should be good with
that I really still hope that there's
that I really still hope that there's
you know I really hope that there's
you know I really hope that there's
eventually a way that we could do like I
eventually a way that we could do like I
don't know compile all of Madrona to a
don't know compile all of Madrona to a
web assembly or something so you can
web assembly or something so you can
like stick GPU Drive online that' just
like stick GPU Drive online that' just
be awesome I've done it for a lot of my
be awesome I've done it for a lot of my
M's and like if it's just steering an
M's and like if it's just steering an
acceleration you could literally map the
acceleration you could literally map the
cars to the keyboard so like you know
cars to the keyboard so like you know
you can take over for the agents and see
you can take over for the agents and see
if you can drive better than the agents
if you can drive better than the agents
that's how we have it
that's how we have it
here uh obviously we don't have it like
here uh obviously we don't have it like
the website needs a redesign and stuff
the website needs a redesign and stuff
but like here like this is a Connect 4
but like here like this is a Connect 4
agent that's pretty darn good I can hold
agent that's pretty darn good I can hold
shift and it'll stop playing and then I
shift and it'll stop playing and then I
can like you know take over for the
can like you know take over for the
agent and like try to beat it on stuff
agent and like try to beat it on stuff
uh right like I can try to beat
uh right like I can try to beat
it Unity
it Unity
setup Drive in
setup Drive in
VR that's
VR that's
cool I think the biggest thing honestly
cool I think the biggest thing honestly
is just compiling for web assembly just
is just compiling for web assembly just
having it in the browser has been so
having it in the browser has been so
nice I mean like literally like look
nice I mean like literally like look
here's the agent playing pong it's
here's the agent playing pong it's
pretty good at pong right and then like
pretty good at pong right and then like
you can just hold shift and now I'm
you can just hold shift and now I'm
playing it and now I can see like oh
playing it and now I can see like oh
actually this is kind of hard to do
actually this is kind of hard to do
better than the agent is right so it's
better than the agent is right so it's
just like very instant gratification for
just like very instant gratification for
Stuff
very very hard to drive with a keyboard
very very hard to drive with a keyboard
Grand Theft
Auto through a
wheel it's only three dire it's if
wheel it's only three dire it's if
it'sit a discreet of nine isn't that
it'sit a discreet of nine isn't that
just like W
just like W
WD with like the key not being pressed
WD with like the key not being pressed
is
zero I think you can do it
all
all
right see you around thank you
right see you around thank you
by all right we go back to GPU drive for
by all right we go back to GPU drive for
a bit I mean uh PR MOA for a
bit see if I can fix this ah 20 minutes
bit see if I can fix this ah 20 minutes
or so see you
Eugene what is a
parantha
oh yeah
okay e
trying to think where we were with the
Moa oh I I need to be on the
Moa oh I I need to be on the
box yeah I remember I
left yeah it's it's on the server
okay puffer ocean
okay so this is where we were uh yeah I
okay so this is where we were uh yeah I
remember
remember
um we were trying to figure out when you
um we were trying to figure out when you
take a tower or when you scan a tower
this player
okay what's up here so scan
okay what's up here so scan
Tower at
106 that was like instantaneous
106 that was like instantaneous
really player zero scan Tower
106 I don't know how he got over there
106 I don't know how he got over there
that fast but
okay oh is there something wrong with
okay oh is there something wrong with
player
zero that's kind of weird that it's
zero that's kind of weird that it's
always player zero
oh no no no no because this is yeah it's
oh no no no no because this is yeah it's
it's their own base
right wait but hold on 106 is X no
right wait but hold on 106 is X no
that's the enemy base how' they get over
that's the enemy base how' they get over
there
oh
that makes no sense at
all okay so they scan it
and then they move towards it
so
bizarre e
I'm not seeing
it if it's scanning the tower it should
it if it's scanning the tower it should
be moving towards
it for
I mean is this somehow screwing it up
it's funny how with the replies on uh on
it's funny how with the replies on uh on
x people always assume when I say C I'm
x people always assume when I say C I'm
I mean C++ no I mean writing C it's
simpler why is dire tower towers alive
zero one is dire tow Towers
zero one is dire tow Towers
alive Tower
team same thing as before
they both have no Towers alive that
they both have no Towers alive that
makes no
sense well cuz you're dumb is why this
sense well cuz you're dumb is why this
is zero
okay this will be a little bit more
okay this will be a little bit more
informative
logs 12 dire Towers
logs 12 dire Towers
alive so dire got all their
towers almost all their towers
radiant has like no Towers because at
radiant has like no Towers because at
the end of the
the end of the
game lots are programmed to basically
game lots are programmed to basically
take all of
take all of
them
right they've won all the games yeah
right they've won all the games yeah
this is exactly as it looks and then
this is exactly as it looks and then
randomly out of the blue we're going to
randomly out of the blue we're going to
get a victory for uh radiant right
yeah there you go
yeah there you go
so I mean according to this thing you
so I mean according to this thing you
got a radiant
Victory you've
got both of these relatively close to
got both of these relatively close to
the enemy ancient but this player zero
the enemy ancient but this player zero
right next to it but I don't think it's
right next to it but I don't think it's
just a player zero bug because we've
just a player zero bug because we've
seen other ones close to it and like
seen other ones close to it and like
this is pretty close too
um man did they just get like teleported
um man did they just get like teleported
here or something let me see cuz like
here or something let me see cuz like
Tower
Tower
Tower
X okay so Tower
X okay so Tower
Team 1 2 3 four five 6 7 8 nine so the
Team 1 2 3 four five 6 7 8 nine so the
first nine
first nine
Towers is 0 through
8 well one the mid Tower I assume this
8 well one the mid Tower I assume this
is the mid tower Tower nine
is the mid tower Tower nine
here so
and five
and five
six oh no this is top Tower isn't
six oh no this is top Tower isn't
it or this
it or this
is wait 1 two 3 4 5 6 7 8
is wait 1 two 3 4 5 6 7 8
n huh
oh 10 right
no yeah 10 so it's
no yeah 10 so it's
103 and then one two three four five
103 and then one two three four five
six
10 h
PID greater than equal
5 it's greater than equal right
yeah how are these all so high
level you reset the XP as well when you
reset e
wait Tower 22 wait wait there's a clue
wait Tower 22 wait wait there's a clue
there isn't
there isn't
there wait Tower
Tower Health Tower y Tower X
[Music]
actually is
anybody wait Tower y Tower X player y
anybody wait Tower y Tower X player y
player
X so what player 20 wait player three is
X so what player 20 wait player three is
the one that's close by right
the one that's close by right
at
24107 where's the enemy
ancient it's at 26 is the
Y 107 so yeah it's literally right on
Y 107 so yeah it's literally right on
top of it player three
top of it player three
is player three is a level 20
is player three is a level 20
n which character is player three is it
n which character is player three is it
the
tank yeah it's the
tank yeah it's the
tank so
tank so
somehow right the tank gets all the way
somehow right the tank gets all the way
over there
because these other agents
we're actually not even all that close
we're actually not even all that close
to the enemy
to the enemy
Tower enemy
Tower enemy
ancient but they've taken like
ancient but they've taken like
everything
everything
else who the heck is defending
why aren't they all the way at the
why aren't they all the way at the
ancient
it's very
obnoxious try something real quick
let me Commit This current thing right
let me Commit This current thing right
here actually
or
speed for
here they
here they
come here's Ultra fast MOBA
come here's Ultra fast MOBA
mode ah I'm getting
mode ah I'm getting
wrecked
wrecked
okay here comes their
okay here comes their
tank oh what the heck killed the
tank oh what the heck killed the
tank the tower
okay here comes their
okay here comes their
tank okay so our Towers defend the tank
tank okay so our Towers defend the tank
against the tank they do a decent
job
job
yeah he's level 13 now he's level
yeah he's level 13 now he's level
16 and then that resets the end
16 and then that resets the end
right does the tank get stuck somewhere
right does the tank get stuck somewhere
or something
or not
respawn there's the
tank so top laner strong very strong
tank so top laner strong very strong
right
here's the
tank Towers don't really
regen do they regen I know why they
regen do they regen I know why they
don't regen much either way I don't
don't regen much either way I don't
think they regen at
all CU it got to be like some weird Edge
all CU it got to be like some weird Edge
case where like despawning an agent or
case where like despawning an agent or
some
some
[ __ ]
because otherwise
because otherwise
like how
right Ultra fast mob is kind of
fun oh there is the tank
you can also see like that this Tower is
you can also see like that this Tower is
starting to take some damage as
well look see he took our
Tower uh do we check status on
Tower uh do we check status on
Towers cuz this is kind of weird
could that mess something
could that mess something
up I don't think
so there's the there he
so there's the there he
is he has taking our
Tower update cool cool Downs yeah
Tower update cool cool Downs yeah
there's no update status or
anything yeah there's no stun check on a
anything yeah there's no stun check on a
tower
tower
oh uh that didn't reset the
game well there's your problem
game well there's your problem
game doesn't
reset
huh I thought I'd fix that a while
huh I thought I'd fix that a while
ago but yeah so what's going to happen
ago but yeah so what's going to happen
is eventually like you run this thing
is eventually like you run this thing
for long enough then yeah eventually
for long enough then yeah eventually
like uh our team is going to power Farm
up that's crazy he's still getting hit I
up that's crazy he's still getting hit I
think isn't
think isn't
he I mean this is the damage
animation interesting
now this shows you the importance of
now this shows you the importance of
rendering the freaking game and playing
it I'm going to see if I spot it real
it I'm going to see if I spot it real
quick and if not I'm going to call it a
quick and if not I'm going to call it a
day and we'll know for tomorrow where to
start for
shouldn't be needed
but let's see about
this e
[Music]
we'll see if it
breaks if this doesn't break I'm not
breaks if this doesn't break I'm not
going to put any more thought in for the
going to put any more thought in for the
night I'm just going to launch a
night I'm just going to launch a
training run see what happens
damn
damn
it that's
weird it still happens it looks like cuz
weird it still happens it looks like cuz
they're at the
they're at the
base um
base um
yeah that's
disappointing I mean are they able to
disappointing I mean are they able to
heal it or some [ __ ]
try this last
try this last
one last one for the
day
for e
powers and this is about what we
powers and this is about what we
want let's see if it
breaks if so yeah okay so
breaks if so yeah okay so
there's there's some weird Edge
there's there's some weird Edge
case um where every some number of games
case um where every some number of games
not even that rare to be
not even that rare to be
honest uh it's possible that like the
honest uh it's possible that like the
game win or game over condition doesn't
trigger uh I don't know why that
is but that appears to be what is
happening yeah um I'm going to call it
happening yeah um I'm going to call it
here I'm going to figure this out
here I'm going to figure this out
tomorrow we at least got a visual Repro
tomorrow we at least got a visual Repro
of what's
of what's
Happening we know what the issue is this
Happening we know what the issue is this
is probably the main thing preventing
is probably the main thing preventing
all the training frankly because this is
all the training frankly because this is
going to happen very early on in
going to happen very early on in
training and then there's nothing to
training and then there's nothing to
learn because you know all your games
learn because you know all your games
eventually just get stuck in limbo um
eventually just get stuck in limbo um
all right thanks folks I will uh
all right thanks folks I will uh
probably continue on this on stream in
probably continue on this on stream in
the morning all the usual things if you
the morning all the usual things if you
haven't already all free and open source
haven't already all free and open source
on puffer lib uh GitHub
on puffer lib uh GitHub
here please go ahead and give that a
here please go ahead and give that a
star really helps us out a ton uh if
star really helps us out a ton uh if
you're interested Ed in contributing to
you're interested Ed in contributing to
this discord.gg puffer lots of new
this discord.gg puffer lots of new
contributors on there onboarding new
contributors on there onboarding new
folks all the time and if you're looking
folks all the time and if you're looking
for reinforcement learning and adjacent
for reinforcement learning and adjacent
Tech

Kind: captions
Language: en
hopefully I've un broken my machine
bet it's the stupid experiments folder
bet it's the stupid experiments folder
again
not really a lot
actually okay I don't know where all my
actually okay I don't know where all my
space went doesn't
matter the docker
matter the docker
pull go grab it from here
good
chart stole that off of offer and I
chart stole that off of offer and I
stole that I don't know where I stole
stole that I don't know where I stole
that off of I stole it off of somewhere
else only
fair okay we only have to pull one layer
fair okay we only have to pull one layer
not
not
bad we only have to pull one
layer there anything I can clean out of
layer there anything I can clean out of
here in the meantime
C stuff going on
how do these graphs look
all right this looks
good and see what you're
learning okay
learning okay
well something's still not working oh no
well something's still not working oh no
look you've got this uh this progress
look you've got this uh this progress
metric here train rewards going up over
metric here train rewards going up over
time progress is going up over time
right B clip Frack is lower value
right B clip Frack is lower value
loss looks way better
oh my camera froze
oh my camera froze
lovely let me go plug the camera unplug
lovely let me go plug the camera unplug
and replug it
go let me see in the meantime what uh
go let me see in the meantime what uh
what I think I'm going to have to do on
what I think I'm going to have to do on
GPU
Drive oh so this doesn't even have a
Drive oh so this doesn't even have a
base or anything
I think I just have to fix like the
I think I just have to fix like the
way probably just have to fix the way
way probably just have to fix the way
it's set up with
serialization I probably am just going
serialization I probably am just going
to make this be a puffer native en is
to make this be a puffer native en is
what I'll
what I'll
do that'll be better
yeah that'll be
fine ve
fine ve
native well I don't know actually cuz we
native well I don't know actually cuz we
have to see if these
are yeah cuz it's actually the we do
are yeah cuz it's actually the we do
tensors here okay
so it has to be like VEC nun or
so it has to be like VEC nun or
something which is
fine for
now don't know what Sam's up
to you've been doing and stuff
well I think dapne is back
well I think dapne is back
on GPU Drive
m
e e
h
I should have space for this I hope
all right we got the
image and everything is set up except
image and everything is set up except
needs the poetry
install this weird Docker run is usually
install this weird Docker run is usually
instantaneous if I uh oh I got some
instantaneous if I uh oh I got some
space
space
I will just give it a second there you
go all right installing
now for
prior to 1.1 I got to work on like
prior to 1.1 I got to work on like
bringing down the install time of
bringing down the install time of
puffer really makes a
difference it's like if something just
difference it's like if something just
installs instantly you just know it's
good for
what
uh
uh
2.5 let's
see python package ecosystem is rough
all
right and then we have to go to the
branch just fast puffer PPO
I don't know I'd suggest at least
I don't know I'd suggest at least
running the Poetry
running the Poetry
build um in the docker setup yeah poetry
build um in the docker setup yeah poetry
will have to update some stuff but it
will have to update some stuff but it
would save like 90% of the time for
install I guess maybe it has to rebuild
install I guess maybe it has to rebuild
anyways
all right get
all right get
checkout what is it get
checkout what is it get
checkout
uh wait
uh wait
I can just check out this this is a
I can just check out this this is a
branch
right out
right out
B uh integration
get there we
go algorithms
um there's a commit on this
right initial
right initial
puffer puffer
M run puffer ippo this is
promising Das
promising Das
M where'd it
M where'd it
go baselines ipo. run
go baselines ipo. run
buffer I is this
it wait is it I thought it was there was
it wait is it I thought it was there was
like a fast run or
like a fast run or
whatever or is this
it gu this is it
just run puffer P I guess no module name
just run puffer P I guess no module name
torch
lovely
reactivate is it like poetry activate or
reactivate is it like poetry activate or
something dumb hate
poetry it's so slow and
janky are you watching
janky are you watching
this
this
uh poetry
uh poetry
shell all right thank
you use
you use
UV I I used what was in the default of
UV I I used what was in the default of
the docker container this is your
the docker container this is your
container
here
here
okay see if I can get this working still
okay see if I can get this working still
no module
no module
torch
seriously what do I screw up here
I did
this how's there no torch I saw poetry
this how's there no torch I saw poetry
install it
um
this container is up to date
right yeah it's got torch in
here for
no I didn't forget to activate or
no I didn't forget to activate or
anything
try and think what I'm doing
here oh wait there's no
M's no wait I have
GPU Drive bin
GPU Drive bin
python yeah I'm in the
N so why don't I have
torch no module GPU Drive no module
torch no module GPU Drive no module
torch
do a poetry ad
torch already
present is there just something I forgot
present is there just something I forgot
that's not listed here like I don't use
that's not listed here like I don't use
poetry I don't know if there's like an
poetry I don't know if there's like an
EnV activate or like a refresh or
EnV activate or like a refresh or
something like
that I did poetry
install surprising it's not cached
install surprising it's not cached
everything so maybe it does need to be
everything so maybe it does need to be
done but I did do
done but I did do
this
already yeah still no
torch is this supposed to
torch is this supposed to
be 0.1 on this
be 0.1 on this
Branch I'm on
Branch I'm on
whoops wait why does this put me
whoops wait why does this put me
into oh
yeah I'm in this
Branch
Branch
torch what's the other thing that you
torch what's the other thing that you
have for
have for
this I can just do it can I just do this
this I can just do it can I just do this
manually
does this work inside the docker or does
does this work inside the docker or does
something get messed up if I just like
something get messed up if I just like
control C out of this
control C out of this
environment I'm going to try
it get back into the
Container H where's the
container oops
need to run it through
pip Docker has
pip Docker has
external
um I don't know how to get out of this
um I don't know how to get out of this
thing but whatever we'll just do we'll
thing but whatever we'll just do we'll
just try
this there's already this is already
this there's already this is already
built so I think I just need to
do
this okay magically works now no
this okay magically works now no
idea Bizarro all I did was reboot the
container bizarre
anyways uh what was this
anyways uh what was this
so we
got
got
spr
spr
gration algorithms no was
gration algorithms no was
baselines
baselines
ippo run puffer
P yeah what I've been doing for puffer
P yeah what I've been doing for puffer
tank that's been very effective um is I
tank that's been very effective um is I
just use the docker and then I don't put
just use the docker and then I don't put
any other like VM stuff on top of it
any other like VM stuff on top of it
right I use the docker as the VM uh in a
right I use the docker as the VM uh in a
sense so like it's just a pip install or
sense so like it's just a pip install or
UV or whatever you want to use no cond
UV or whatever you want to use no cond
no poetry none of
no poetry none of
that that's been pretty
that that's been pretty
effective okay so there's no puffer lip
effective okay so there's no puffer lip
here so presuming that
here so presuming that
you you just clone puffer lib or
you you just clone puffer lib or
something you just cloned puffer lib Dev
I need to get my own install time down
I need to get my own install time down
on puffer lib
on puffer lib
geez should be
instantaneous
pole all right so we're on dev oops
now we got puffer
lib let's see if there's anything
lib let's see if there's anything
incompatible in
incompatible in
here hopefully it doesn't mess up like
here hopefully it doesn't mess up like
torch version or
something okay it's going to go grab
something okay it's going to go grab
Jim numpy open
CV bunch of random stuff scyon doer
CV bunch of random stuff scyon doer
should be
fine pip install torch and M after
fine pip install torch and M after
poetry yeah pip install e dot got it I
poetry yeah pip install e dot got it I
think
I think that was the most likely thing
I think that was the most likely thing
that happened
that happened
um that broke it is just me using native
um that broke it is just me using native
like VEC native for something
like VEC native for something
new but I figured that while I was add
new but I figured that while I was add
it I would set up I do the whole proper
it I would set up I do the whole proper
setup for you guys to make sure that
setup for you guys to make sure that
everything was actually
working okay so now
working okay so now
hopefully this
hopefully this
runs and we get to your same
error the startup
time okay I think this is the seg fault
time okay I think this is the seg fault
that uh you got to so
that uh you got to so
let's figure this
out GPU
out GPU
[Music]
Drive where's your n here there's like a
Drive where's your n here there's like a
puffer end somewhere
puffer end somewhere
right
Ms initial puffer
Ms initial puffer
code algorithms puffer Li puffer
n and this is just what we had from
n and this is just what we had from
here I don't have my editor on here
here I don't have my editor on here
that's okay we'll do vanilla
Vim do make a huge
difference interesting so where would
difference interesting so where would
this egg fult is the question
does this let you make your
M or does it already seg
B
B
um okay that's weird so this seg fol in
um okay that's weird so this seg fol in
the creation of GPU drive itself
we is this getting past like something
ridiculous and
config in
config in
config 64 scenes
what do we have our config for this
thing there's like a puffer config
thing there's like a puffer config
somewhere
right I not see the
right I not see the
config for live utils
where do you have um I had like a config
where do you have um I had like a config
with my
with my
original with my version
original with my version
originally is that just in
originally is that just in
here
utils utils has the
utils utils has the
policy where does it say how many
policy where does it say how many
Ms are getting passed in
is that
is that
somehow in the algorithm file or
something
puffer num worlds
is there no new config added to this
thing off for IP maybe the
Run what was it baselines
IPO and so here I this yeah this is
IPO and so here I this yeah this is
familiar and I think yeah you just
familiar and I think yeah you just
pulled all the args out of the any files
pulled all the args out of the any files
into
into
this
this
um just
um just
fine and then where is num
fine and then where is num
NS Beck num
NS Beck num
ends default is
ends default is
eight beck. num workers is eight oh well
eight beck. num workers is eight oh well
this is probably it right
this is probably it right
here uh if I I recall this is different
here uh if I I recall this is different
from what I
from what I
had yeah I see why that would
work if we check what I did for you guys
originally not
ocean yeah okay so you see um
ocean yeah okay so you see um
it looks like there's this new VC thing
it looks like there's this new VC thing
which is vcn num
which is vcn num
M I had this set to
M I had this set to
one
because yeah you're doing this okay so
because yeah you're doing this okay so
you have this with
you have this with
multiprocessing uh your EnV is not
multiprocessing uh your EnV is not
designed for multiprocessing cuz it's a
designed for multiprocessing cuz it's a
GPU accelerated
GPU accelerated
environment so what's going to have to
environment so what's going to have to
happen here is I'm going to have to
happen here is I'm going to have to
change this to like none I'm going to
change this to like none I'm going to
probably have to make a couple updates
probably have to make a couple updates
to puffer
to puffer
lib
lib
um probably going to have to go from
um probably going to have to go from
there let's see if I do cereal for now
there let's see if I do cereal for now
what
happens yeah this needs to be one this
happens yeah this needs to be one this
needs to be one this needs to be one do
needs to be one this needs to be one do
I have zero copy on I didn't even think
I have zero copy on I didn't even think
I had zero copy on for you guys did
I yeah this is
I yeah this is
false oh store true is fine
we still going to seg
P guess that's what we're doing today
P guess that's what we're doing today
um okay
um okay
me use the restroom I'll be right back
me use the restroom I'll be right back
we're going to get this to
work
e
e e
[Music]
so where are we when this thing seg
bolts make
bolts make
en wait we're in the
Run uh how's that make any
sense one puffer 236
what for
ah okay so this is an
error this is
um yeah you don't even really need this
um yeah you don't even really need this
but whatever like it this n Creator just
but whatever like it this n Creator just
has to be a function so you can
has to be a function so you can
literally just pass it the class if you
literally just pass it the class if you
want um I'll leave it for now but you
want um I'll leave it for now but you
can literally just pass the class
okay so
okay so
now we're in the back end at the very
now we're in the back end at the very
least where it should
least where it should
be either way though that thing
be either way though that thing
shouldn't have seg foled uh which is the
shouldn't have seg foled uh which is the
odd
part so n config here has what's this
part so n config here has what's this
Max agents and scene is
128 what did I how did I do this
128 what did I how did I do this
originally n number worlds was
128 okay so now you have 64
128 okay so now you have 64
worlds
um I don't know we'll do like eight I
um I don't know we'll do like eight I
think these configs are just like like
think these configs are just like like
screwed up I think this is a GPU Drive
screwed up I think this is a GPU Drive
thing cuz we haven't even gotten to the
thing cuz we haven't even gotten to the
spot where I would have broken it with
spot where I would have broken it with
puffer
yet so like if I just do
this yeah okay so literally it was just
this yeah okay so literally it was just
you had too many worlds or whatever um
you had too many worlds or whatever um
because like I think it was it went up
because like I think it was it went up
to 128 agents or whatever from before so
to 128 agents or whatever from before so
it's seg falting just out of memory it's
it's seg falting just out of memory it's
either higher end card needed or
either higher end card needed or
whatever there um but now now I'll
whatever there um but now now I'll
actually get to fix
this okay so we need to do VEC none
this okay so we need to do VEC none
maybe or native none or
maybe or native none or
native let me think about that
native let me think about that
so I'll do this right now and Puffer
I use this right or do I not use
this okay we have perer
inv I can't really make this a
native uh
I can't really make this in Native
I can't really make this in Native
en because you guys have like Cuda
en because you guys have like Cuda
tensor
um no poetry
um no poetry
what hey that guy how's it going fixing
what hey that guy how's it going fixing
GPU Drive stuff
I think this has just got to be like
I think this has just got to be like
make uh none
make uh none
right first agent about to finish its
right first agent about to finish its
sweep assignment very
sweep assignment very
nice
nice
yeah just
yeah just
do
do
if oh wait if back end is
if oh wait if back end is
native return M Creator or end creators
native return M Creator or end creators
oh do we not even use that thing anymore
oh do we not even use that thing anymore
hold
hold
on and ARs and
on and ARs and
bars I think we can just use we can just
bars I think we can just use we can just
abuse um Native
abuse um Native
right cuz I don't even know if I use
right cuz I don't even know if I use
this thing do
I yeah I don't okay so can I just like
native
vector.
make back end is
make back end is
native oh that's Bizarro
uh yeah whatever so we'll just do it for
uh yeah whatever so we'll just do it for
now I I had there's a gross thing here
now I I had there's a gross thing here
it doesn't matter for now
though I'm not
sure cool
uh okay so now we
uh okay so now we
are vector make yeah and now it's making
are vector make yeah and now it's making
a native
van no attribute driver end there should
van no attribute driver end there should
be a driver
be a driver
end shouldn't there
end shouldn't there
open up
puffer oh yeah okay all we got to
puffer oh yeah okay all we got to
do we can probably just make this thing
do we can probably just make this thing
a puffer and yeah so we do have to do a
a puffer and yeah so we do have to do a
little bit of work here no big deal
from puffer lib
from puffer lib
do
do
environment puffer
and puffer
and and
and and
then just take this gets buffer
yeah so you do actually have to use the
yeah so you do actually have to use the
buffers
buffers
here that's fine we'll just refactor a
here that's fine we'll just refactor a
little bit for you
you from having to deal with that for
get rid of some gross things for
you and because you want stuff to be
you and because you want stuff to be
torch tensors
masks
actions
terminals
terminals
locations so returns
locations so returns
lengths is all fine
observations self out
rewards let's reset return
here uh this has to return something
here uh this has to return something
doesn't
it how do I handle this
[ __ ] looks like I do just return
[ __ ] looks like I do just return
um
huh oh because it's when you call like
huh oh because it's when you call like
async reset or
async reset or
whatever
right yeah yeah it's cuz when you call a
right yeah yeah it's cuz when you call a
async
async
reset or
whatever ASN Ki is good you may not like
whatever ASN Ki is good you may not like
it but this is what Peak Performance
it but this is what Peak Performance
looks like my
friend I think they're going to be happy
friend I think they're going to be happy
with
this and they Define step like this
this and they Define step like this
right
this has been run through like black or
this has been run through like black or
some other format this is weird I don't
some other format this is weird I don't
know what this is but
know what this is but
whatever okay um
equals OBS s
equals OBS s
rewards Bo self.
rewards Bo self.
terminal terminal self.
modifications inations I guess is
fine
fine
do oh no you don't need self infos
turn
turn
observations rewards self.
terminals info most
terminals info most
likely and the rest is handled for
likely and the rest is handled for
you and uh I'm sure we'll have to make
you and uh I'm sure we'll have to make
some fixes to this but
super
no really oh underscore
no really oh underscore
net there we go
um okay so in this case it's even though
um okay so in this case it's even though
it's a little odd uh we can put this at
it's a little odd uh we can put this at
the bottom is I think we have to put it
the bottom is I think we have to put it
like
like
here actually I'm going to put a little
here actually I'm going to put a little
comment this
comment this
assigns bunch of buffers to
assigns bunch of buffers to
your you can't use them cuz you want for
your you can't use them cuz you want for
numpy so I am
careful num agents
there numb
agents num worlds Maybe
oh uh that's kind of awkward
because wait
what oh yeah yeah yeah this is
what oh yeah yeah yeah this is
fine so what we do is
kind of sketchy to be
kind of sketchy to be
honest but hey this is API abuse so
honest but hey this is API abuse so
anything goes
is no longer
needed GPU no attribute observations
cuz this ghost here
dummy wa where's this
dummy wa where's this
buffer end
131 ah break
point
24 uh that's Bizarro isn't
it six SP
oh interesting observations
is wait it can't be
is wait it can't be
3,876
right are any of the the GPU Drive folks
right are any of the the GPU Drive folks
still watching
this this is the one part where it gets
this this is the one part where it gets
a little bit domain specific
a little bit domain specific
I I need to figure out
I I need to figure out
how how GPU Drive is allocating data
how how GPU Drive is allocating data
buffers now and how I make sure that we
buffers now and how I make sure that we
match shapes
here welcome YouTube folks as
well yeah it's kind of late in uh in New
well yeah it's kind of late in uh in New
York theyve probably uh they probably
York theyve probably uh they probably
called it a night and so no big deal
called it a night and so no big deal
I'll figure it out um Ober a shape is 24
I'll figure it out um Ober a shape is 24
so why why would observations be of
so why why would observations be of
shape
24 uh that's interesting it should not
24 uh that's interesting it should not
be
right oh self-controlled agents
right oh self-controlled agents
Mask wait hold on
something is very weird here let me see
something is very weird here let me see
how I did this for you
how I did this for you
before I
did this kind of specific
okay so we
okay so we
have OBS was given to be the agents that
have OBS was given to be the agents that
you
you
control
right then actions was given to be
right then actions was given to be
all doesn't make any sense no does
all doesn't make any sense no does
it so when you reset
only given
only given
observations agents that you
control then
control then
actions oh no cuz it's the buffer is
actions oh no cuz it's the buffer is
controlled agents okay so I see how I
controlled agents okay so I see how I
did this so I pruned out the ones that
did this so I pruned out the ones that
you don't control at the start which is
you don't control at the start which is
totally fine it's totally fine so all
totally fine it's totally fine so all
that's wrong is the uh the tensor
that's wrong is the uh the tensor
shape right
here actions needs to be not this shap
here actions needs to be not this shap
shape this shape is very silly this just
shape this shape is very silly this just
needs to be self. Nom
needs to be self. Nom
agents be an
agents be an
N64
N64
this and then we've got our
this and then we've got our
mask
Heroes and then self num agents num
Heroes and then self num agents num
agents numb agents
agents numb agents
okay uh oh actually wait that this does
okay uh oh actually wait that this does
need to be a remember now so
actions
actions
H it's kind of both isn't
H it's kind of both isn't
it so what you need is
actually we'll just do padded
actions so you got your padded actions
actions so you got your padded actions
now
do we even need self actions here I
do we even need self actions here I
don't think we use self. actions do we
don't think we use self. actions do we
it's kind of just
it's kind of just
optional I think we can actually just
optional I think we can actually just
leave this as
actions yeah and then what we'll do is
let's see about this
8 by
128 something's very weird
here for
it seems
weird 8 by 128
there like some garbage indexing going
there like some garbage indexing going
on
here okay so 8 by
128 oh eight M's
okay there are only 24 agents in
okay there are only 24 agents in
here so this is actually
here so this is actually
correct Believe It or
Not uh this is what's going to hurt perf
Not uh this is what's going to hurt perf
the most but that's hurting perf from
the most but that's hurting perf from
adona that's for you guys to figure out
oops where is
oh this parameter is not getting used um
oh this parameter is not getting used um
correctly this Max controlled agents
correctly this Max controlled agents
thing is not getting used correctly at
thing is not getting used correctly at
all
right
why is D World deten sir
that's cpu. numpy
already
what reset
this
change device side Asser
um policy
[Music]
Max
yeah yeah these buffers need to be
wait why is
wait why is
um
um
observations it shouldn't be that way
observations it shouldn't be that way
right
that's very
bizarre uh yeah there's garbage data in
bizarre uh yeah there's garbage data in
here
Hey
Hey
Eugene how's it going so I've got this
Eugene how's it going so I've got this
thing you're looking at a padding tensor
thing you're looking at a padding tensor
I don't think I am looking at a padding
I don't think I am looking at a padding
tensor though uh I'll show you so you
tensor though uh I'll show you so you
get your OBS right you get your
get your OBS right you get your
controlled agent
controlled agent
mask oh is it just
mask oh is it just
um is it because that even with the
um is it because that even with the
controlled agent mask like there still
controlled agent mask like there still
might be some dead agents or whatever
might be some dead agents or whatever
is that
it live agents
maybe yeah this is the same problem as
maybe yeah this is the same problem as
before so I mean even once I get this
before so I mean even once I get this
working you're going to be heavily
working you're going to be heavily
limited by the GPU Drive padding stuff
limited by the GPU Drive padding stuff
um but at least you'll have like a
um but at least you'll have like a
standalone and I can help you iterate
standalone and I can help you iterate
from
there it's in uh the the branch Daphne
there it's in uh the the branch Daphne
has been working on I can push this if
has been working on I can push this if
you want but it doesn't run it didn't
you want but it doesn't run it didn't
run before either so I don't know if
run before either so I don't know if
there's much harm to do but I'm added to
there's much harm to do but I'm added to
this so I can push it if you
want it's like close it's just there's a
want it's like close it's just there's a
little
yeah so there's the
yeah so there's the
issue I have made some
changes wait we have some
changes wait we have some
disagreement about whether the padding
disagreement about whether the padding
did it cut off your question
did it cut off your question
there is needed I
there is needed I
assume is hurting
assume is hurting
performance it's
performance it's
definitely I mean you have let me put
definitely I mean you have let me put
this in perspective right you have 24
this in perspective right you have 24
agents in 8 time 128 so you have 24
agents in 8 time 128 so you have 24
agents out of total of possible
agents out of total of possible
1,024 I have to do a copy slice in order
1,024 I have to do a copy slice in order
to get those things into
to get those things into
um oh is hurting perform okay yeah we're
um oh is hurting perform okay yeah we're
writing time gotcha gotcha okay I
writing time gotcha gotcha okay I
misread it X cut your message off you
misread it X cut your message off you
can see your message right here this is
can see your message right here this is
how I see it
okay so
okay so
breakpoint this is in your container as
well okay self
live do
live do
sum okay this is weird so we have 24
sum okay this is weird so we have 24
agents alive so none of these should be
agents alive so none of these should be
padding I
padding I
assume OBS is 24
uh
uh
one let's do
Max also these observations are kind of
huge so this guy this guy like some of
huge so this guy this guy like some of
these are broken like or something it
these are broken like or something it
says that they're
alive it seems like even at the start
alive it seems like even at the start
some of these are just immediately
screwy yeah it's bad
screwy yeah it's bad
right so I mean I can just for now just
right so I mean I can just for now just
so that you have something that runs
so that you have something that runs
right I can just do like look into this
right I can just do like look into this
broken data I can just do
broken data I can just do
OBS OBS greater than you know 10 equal
OBS OBS greater than you know 10 equal
Z OBS OBS less than
negative I can just do this for
now still synchronized
bugs we still have iniz bugs for some
reason ASAP very
reason ASAP very
good
good
mix
mix
in
interesting so except for the padding
interesting so except for the padding
everything's
everything's
fine rewards. Max what's or reward.
fine rewards. Max what's or reward.
maxmin
no
no
rewards
terminal not sure what
terminal not sure what
is breaking the policy
here Cuda synchronize
I think I saw on this PR there was my
I think I saw on this PR there was my
policy I actually don't remember which
policy I actually don't remember which
policy was in the pr uh if this was my
policy was in the pr uh if this was my
one or your one I think I used like a
one or your one I think I used like a
simpler
simpler
policy just to make it
policy just to make it
faster can you set launch blocking
okay so this is likely action probs
okay so this is likely action probs
being messed
up uh mine was permutation invariant as
up uh mine was permutation invariant as
well it has serious sample efficiency
well it has serious sample efficiency
did you try it versus the one that I
did you try it versus the one that I
gave you cuz I basically just took yours
gave you cuz I basically just took yours
and I took like some layer Norms out and
and I took like some layer Norms out and
stuff to speed it
stuff to speed it
up it was also it was still permutation
up it was also it was still permutation
invariant in everything
to be fair it might still be sample
to be fair it might still be sample
efficiency might be more sample
efficiency might be more sample
efficient but I suspect that mine is
efficient but I suspect that mine is
likely a better wall
likely a better wall
clock seriously trying puffer perfect
clock seriously trying puffer perfect
blank check for
support layer Norms are sometimes pretty
support layer Norms are sometimes pretty
good training at a million steps per
good training at a million steps per
second is sometimes pretty good
second is sometimes pretty good
too and that's like uh we have like
too and that's like uh we have like
several M's in Puffer that trained a
several M's in Puffer that trained a
million and even the more complex ones
million and even the more complex ones
we still get like in the hundreds of
thousands yeah I mean sample efficiency
thousands yeah I mean sample efficiency
like when you have the fast Sim anyways
like when you have the fast Sim anyways
right
right
may as well just push perf per wall
may as well just push perf per wall
clock unclear where tradeoff well what
clock unclear where tradeoff well what
I've done is you just like set your
I've done is you just like set your
hyper parameter sweep you just set the
hyper parameter sweep you just set the
cost to be equal to wall clock seconds
cost to be equal to wall clock seconds
and then you let it figure it out right
and then you let it figure it out right
you just sweep over you try different
you just sweep over you try different
architectures it's wall clock training
perf uh I'm trying to see where where
perf uh I'm trying to see where where
your thing was
your thing was
here where's your policy
oh yeah it was in this utils
file was it
util okay
util okay
[Music]
so oh yeah this is my
so oh yeah this is my
policy so this is my policy which is
policy so this is my policy which is
just your policy without layer norms and
just your policy without layer norms and
slightly
slightly
simplified this is the whole
simplified this is the whole
thing so this should totally be fine
thing so this should totally be fine
then
um what was what's the action space
here single action
space should work
discreet of nine should be reasonable
discreet of nine should be reasonable
action space
right sell and
right sell and
steer two discrete vectors I'm seeing
steer two discrete vectors I'm seeing
discrete of
nine nine is fine so I'm assuming that's
nine nine is fine so I'm assuming that's
just like
just like
merged okay um well then there shouldn't
merged okay um well then there shouldn't
be any
be any
issues if that's what it's going to
issues if that's what it's going to
be I can go check the
be I can go check the
policy
policy
um three yeah three we do that as well
um three yeah three we do that as well
we technically we support multi-
we technically we support multi-
discreet too if you want to do multi
discreet too if you want to do multi
discreet you can do it with puffer uh
discreet you can do it with puffer uh
there are a couple things in the latest
there are a couple things in the latest
version that I wanted to check to make
version that I wanted to check to make
sure that that's good so maybe hold off
sure that that's good so maybe hold off
but um I mean we do support multi-
but um I mean we do support multi-
discreete and we have a bunch of multi
discreete and we have a bunch of multi
discreete ends
we also support we support continuous as
we also support we support continuous as
well uh we just don't support mixed
well uh we just don't support mixed
continuous and discreet at the moment
continuous and discreet at the moment
you got to pick
you got to pick
one that could be added to be fair but
one that could be added to be fair but
hopefully not on my plate before 1.1
hopefully not on my plate before 1.1
release we've been really busy with uh
release we've been really busy with uh
1.1 like all these M's these are all
1.1 like all these M's these are all
going to be a million plus depths per
going to be a million plus depths per
second environments in 1
second environments in 1
one it's like 10 15,000 lines of
C okay so we can see right here we've
C okay so we can see right here we've
got garbage in the neural net
um to beat a hobby
horse it's all right I get to do this
horse it's all right I get to do this
stuff all day without having to uh worry
stuff all day without having to uh worry
about publications and stuff
about publications and stuff
now I seriously think that once we
now I seriously think that once we
release these the next phase for puffer
release these the next phase for puffer
is going to be like redoing the last 10
is going to be like redoing the last 10
years of RL research there's your error
years of RL research there's your error
by the way uh redoing the last 10 years
by the way uh redoing the last 10 years
of RL research but like with proper
of RL research but like with proper
evals and stuff so you get consistent
evals and stuff so you get consistent
results and you're probably going to see
results and you're probably going to see
a lot from that okay so Road objects and
a lot from that okay so Road objects and
Road graphs are garbage I don't know why
RL for Co what's
this
this
interesting they have
interesting they have
m's or is this
alos a lot of people on
this wrecking
soda
soda
interesting they have
m's is this meta doing torch oral or
m's is this meta doing torch oral or
what is this
set of
set of
M's
interesting don't have their M's listed
interesting okay they have a lot of
interesting okay they have a lot of
stuff in
here are they in
here are they in
torch oh no they're
interesting they're all in Python though
or I guess they're in
torch interesting I'll look at it I
torch interesting I'll look at it I
don't know how sophisticated these are
don't know how sophisticated these are
um if they're going to just be in in
um if they're going to just be in in
like torture Rays like
like torture Rays like
this one of the cool things with puffers
this one of the cool things with puffers
we're really not constrained on
we're really not constrained on
environment complexity at all
environment complexity at all
like like we can make stuff like this
like like we can make stuff like this
Moa
Moa
I mean we have people contributing all
I mean we have people contributing all
sorts of Ms like we've got this like
sorts of Ms like we've got this like
whole tactics game M that somebody just
whole tactics game M that somebody just
made that's like a full like MMO combat
made that's like a full like MMO combat
type Sim we've got somebody just
type Sim we've got somebody just
contributed
contributed
go um we've got this
MOA so like one of the cool things we
MOA so like one of the cool things we
can do with puffers just make really
can do with puffers just make really
complicated yeah this
Nathan's uh wait which
Nathan's yeah yeah yeah this one you've
Nathan's yeah yeah yeah this one you've
been collaborating for 5 years oh that's
been collaborating for 5 years oh that's
awesome yeah yeah Nathan's been in here
awesome yeah yeah Nathan's been in here
a lot working on this he also did uh he
a lot working on this he also did uh he
did our pong implementation too puffer
pong and then we've got a couple new big
pong and then we've got a couple new big
projects I have one other big project
projects I have one other big project
coming in the works and then also we've
coming in the works and then also we've
got uh there's a new collab that's going
got uh there's a new collab that's going
to be on this TCG this like magic the
to be on this TCG this like magic the
Gathering style en uh which I'm I have
Gathering style en uh which I'm I have
hopes for I made this prototype of it
hopes for I made this prototype of it
just to see you know how far I could get
just to see you know how far I could get
really quickly with it um but yeah we're
really quickly with it um but yeah we're
going to have like build this out and
going to have like build this out and
stuff loves wri in
stuff loves wri in
Sims it's gotten really way easier to do
Sims it's gotten really way easier to do
high perf stuff in uh in puffer like I
high perf stuff in uh in puffer like I
don't know if you've taken a look at all
don't know if you've taken a look at all
at these ends but like this is actually
at these ends but like this is actually
a very very legit option now um because
a very very legit option now um because
essentially like because vectorization
essentially like because vectorization
is now fast and because we have good
is now fast and because we have good
Integrations end to end with
Integrations end to end with
vectorization
vectorization
right we can kind of just start writing
right we can kind of just start writing
generic code and have it be fast so like
generic code and have it be fast so like
uh I don't know what's a good example
uh I don't know what's a good example
the Moa here which would be like a
the Moa here which would be like a
pretty substantial software project
pretty substantial software project
right well it's one file it's 2,000
right well it's one file it's 2,000
lines of c and you can just read it top
lines of c and you can just read it top
to bottom and it's pretty brain dead
to bottom and it's pretty brain dead
like there's absolutely nothing
like there's absolutely nothing
surprising in here it's just really
surprising in here it's just really
simple procedural code all the way
simple procedural code all the way
through um simpler example would be
through um simpler example would be
like what's like
like what's like
decent I guess like
decent I guess like
pong pong. H 300 lines including a bunch
pong pong. H 300 lines including a bunch
of extra logging stuff so really like
of extra logging stuff so really like
250 lines and just very simple little
250 lines and just very simple little
procedural
procedural
logic observations and everything obs
logic observations and everything obs
ation get computed directly into shared
ation get computed directly into shared
memory runs millions of steps per second
memory runs millions of steps per second
don't have to like write Vector code you
don't have to like write Vector code you
just get to write normal like normal
just get to write normal like normal
loops and stuff so very nice for
that wrote nocturn in C++ for similar
that wrote nocturn in C++ for similar
reasons never ran faster than
reasons never ran faster than
6K um
6K um
I don't actually know how
I don't actually know how
intensive of computations you have going
intensive of computations you have going
on in
on in
there it could be that I
there it could be that I
mean I like C because it's it's like so
mean I like C because it's it's like so
simple it's actually kind of hard to
simple it's actually kind of hard to
shoot yourself in the foot like there
shoot yourself in the foot like there
are no malaks there is no memory
are no malaks there is no memory
allocation dynamically during uh the Run
allocation dynamically during uh the Run
um it's all static memory so that helps
um it's all static memory so that helps
a lot
a lot
um I mean we don't have stuff like
um I mean we don't have stuff like
vector that can like dynamically resize
vector that can like dynamically resize
we don't have a lot of things it it's
we don't have a lot of things it it's
pretty much just Loops over static
pretty much just Loops over static
arrays and
arrays and
[Music]
[Music]
memory I'd have to actually get like if
memory I'd have to actually get like if
you're interested in like trying to
you're interested in like trying to
figure out how to do this type of thing
figure out how to do this type of thing
really high perf I could look at it and
really high perf I could look at it and
basically I would just need to know like
basically I would just need to know like
what the slow Parts in theory of the
what the slow Parts in theory of the
nvar like what are the parts that
nvar like what are the parts that
actually like require flops in theory
actually like require flops in theory
and then I'd have to figure out how fast
and then I'd have to figure out how fast
those pieces can run single thread
those pieces can run single thread
that's all I would have to
do do you have any idea why the uh the
do do you have any idea why the uh the
ego state is good but these things are
ego state is good but these things are
like way out of
like way out of
bounds so I can just fix this up for you
bounds so I can just fix this up for you
real quick and I can send you over a uh
real quick and I can send you over a uh
a nice thing to to play with tomorrow so
a nice thing to to play with tomorrow so
you can play with this
tomorrow GPU Drive doesn't feel yeah no
tomorrow GPU Drive doesn't feel yeah no
well I don't know where your lab is
well I don't know where your lab is
going with the Future Sims and stuff but
going with the Future Sims and stuff but
you know the simulated M for research
you know the simulated M for research
game has gotten a lot
game has gotten a lot
easier not obvious what's wrong with it
easier not obvious what's wrong with it
it's particularly weird
it's particularly weird
because I
because I
mean how is the data even getting in the
mean how is the data even getting in the
policy like
policy like
that
that
oh shouldn't be able to do
that is it just wrong at the first step
that is it just wrong at the first step
I think
I think
so I mean you have this unpack function
so I mean you have this unpack function
don't
you it algorithm puffer
you it algorithm puffer
utils where is
utils where is
unpack reshape this is just a reshape
unpack reshape this is just a reshape
though this doesn't scale
though this doesn't scale
right so if this is just a reshape then
right so if this is just a reshape then
uh my scaling should have fixed this for
you unless it's getting like one
you unless it's getting like one
hunted
hunted
uh every agent that has nonsense OBS
uh every agent that has nonsense OBS
let's
let's
see I don't know let's see
no
worries and just get to the gym a little
later yeah so it's just a few of them it
later yeah so it's just a few of them it
looks like but the thing is I thought I
looks like but the thing is I thought I
accounted for
accounted for
that oh I didn't account for it in reset
that oh I didn't account for it in reset
I'm stupid one second I forgot to do it
I'm stupid one second I forgot to do it
in reset my
bad get you right
here so OBS do we even right into OBS
here so OBS do we even right into OBS
here
here
wait
what
what zero
empty
grand total of 470 steps per
grand total of 470 steps per
second um but I have the settings very
second um but I have the settings very
low
low
um I'll leave some comments in the file
um I'll leave some comments in the file
basically you had the settings too high
basically you had the settings too high
like it was too many worlds with too
like it was too many worlds with too
many Max agents you got to do some stuff
many Max agents you got to do some stuff
with that um I have it running at the
with that um I have it running at the
very least
very least
now I mean this is purely
settings I can try to get something a
settings I can try to get something a
bit more reasonable for you here
okay um so I changed a few things I got
okay um so I changed a few things I got
to push a new update to puffer for you
to push a new update to puffer for you
to make this work there was like 90% I
to make this work there was like 90% I
had to fix stuff in in here but I did
had to fix stuff in in here but I did
have to fix a couple things in puffer um
have to fix a couple things in puffer um
just because we have like this new n
just because we have like this new n
format and I'm using the thing that used
format and I'm using the thing that used
to be called native for that now um I
to be called native for that now um I
made your en under the native format now
made your en under the native format now
it's a puffer en um it matches like Jim
it's a puffer en um it matches like Jim
VEC format roughly it this should be
VEC format roughly it this should be
fine uh yeah this should be fine don't
fine uh yeah this should be fine don't
try to multiprocess it don't try to make
try to multiprocess it don't try to make
it serial or whatever it's a GPU M run
it serial or whatever it's a GPU M run
it on GPU that'll get you several
it on GPU that'll get you several
100,000 SPS if you want to multiprocess
100,000 SPS if you want to multiprocess
it we can figure out how to multiprocess
it we can figure out how to multiprocess
it after it shouldn't be that hard um I
it after it shouldn't be that hard um I
will have to change a couple things and
will have to change a couple things and
the Cuda tensors will have to go through
the Cuda tensors will have to go through
numpy if you want to do that though so
numpy if you want to do that though so
we'll do that after um the only other
we'll do that after um the only other
thing for you was where was the the
thing for you was where was the the
config baselines run
yeah so I set this
yeah so I set this
thing it okay so I set these all to one
thing it okay so I set these all to one
which is what they should be and I think
which is what they should be and I think
it's actually in the end file and num
it's actually in the end file and num
worlds is only eight
so yeah that's so
so yeah that's so
slow I mean look you've got 70 some odd
slow I mean look you've got 70 some odd
time in the
en
en
um so what's happening here is like it's
um so what's happening here is like it's
padded to 128 agents the scene is very
padded to 128 agents the scene is very
sparse right so like the actual batch
sparse right so like the actual batch
size coming out of madona is Tiny uh you
size coming out of madona is Tiny uh you
need like dense agents so get those
need like dense agents so get those
timings St up but now you got the puffer
timings St up but now you got the puffer
harness can I just push this to this
harness can I just push this to this
Branch or do you want me to I can put
Branch or do you want me to I can put
this in a new Branch actually
dasb
into
rations
slash smoke
slash smoke
tested puer
tested puer
PP B
focus on training Den scenes I you know
focus on training Den scenes I you know
you really should be able to at the
you really should be able to at the
engine level just have those tensors be
engine level just have those tensors be
configur like you should be able to do
configur like you should be able to do
something with that but whatever for the
something with that but whatever for the
time being puffer NS puffer
time being puffer NS puffer
po uh didn't
po uh didn't
there I
there I
change guess that's all I
change guess that's all I
changed yeah
kind of should be able to return a flat
kind of should be able to return a flat
tensor yeah exactly and even then
tensor yeah exactly and even then
like got to work on having those scenes
like got to work on having those scenes
like be denser like the agents got to
like be denser like the agents got to
not die so much insist on it yeah I mean
not die so much insist on it yeah I mean
I can probably come up with some ways to
I can probably come up with some ways to
make that easier to do depends how deep
make that easier to do depends how deep
into madon it is oh I talked to uh to
into madon it is oh I talked to uh to
Brennan on uh I talked to like the
Brennan on uh I talked to like the
madona folks at Stanford uh last week
madona folks at Stanford uh last week
couple weeks ago whatever um so I think
couple weeks ago whatever um so I think
we can probably end up supporting a lot
we can probably end up supporting a lot
more of these GPU madona
more of these GPU madona
M get to 80% pretty fast and then they
M get to 80% pretty fast and then they
don't die often 80% would be fine like
don't die often 80% would be fine like
the problem is a lot of the runs I've
the problem is a lot of the runs I've
seen for here have been like 5% and then
seen for here have been like 5% and then
the like it's 95% just idle
uh this
okay so there's your PR or your your
okay so there's your PR or your your
branch because I think they just gave me
branch because I think they just gave me
access to do
access to do
that
um is
um is
this and I'll post it in the
slack I'll get you your uh your other
slack I'll get you your uh your other
commit real quick as well
us oh do I not even change
us oh do I not even change
anything I thought I
did oh I don't
actually yeah I guess I didn't change
actually yeah I guess I didn't change
anything I think you're
good never mind I was smarter than I
good never mind I was smarter than I
thought
thought
here uh whoops uh my bad leaking slack
here uh whoops uh my bad leaking slack
on stream
there I don't think you need latest
there I don't think you need latest
puffer or anything uh I forgot that I
puffer or anything uh I forgot that I
just had to change your rapper not
just had to change your rapper not
puffer
puffer
rapper all right well I think uh if
rapper all right well I think uh if
that's all for tonight I'm going to
that's all for tonight I'm going to
maybe do a couple quick things on the
maybe do a couple quick things on the
mooba and then uh call a night after uh
mooba and then uh call a night after uh
get some exercise get some food called a
get some exercise get some food called a
night
night
um yeah I mean just let me know how this
um yeah I mean just let me know how this
integration goes and and I'll be able to
integration goes and and I'll be able to
help on that you can just like you can
help on that you can just like you can
message me on the slack but more likely
message me on the slack but more likely
if you want instant if you just want
if you want instant if you just want
instant feedback just send students over
instant feedback just send students over
to stream and you get instant answers to
to stream and you get instant answers to
stuff and uh I'm more than happy to like
stuff and uh I'm more than happy to like
pull stuff on pull stuff up live and fix
pull stuff on pull stuff up live and fix
things like this I have the container
things like this I have the container
now this is just your GPU
now this is just your GPU
container uh
container uh
yeah we should be good with
yeah we should be good with
that I really still hope that there's
that I really still hope that there's
you know I really hope that there's
you know I really hope that there's
eventually a way that we could do like I
eventually a way that we could do like I
don't know compile all of Madrona to a
don't know compile all of Madrona to a
web assembly or something so you can
web assembly or something so you can
like stick GPU Drive online that' just
like stick GPU Drive online that' just
be awesome I've done it for a lot of my
be awesome I've done it for a lot of my
M's and like if it's just steering an
M's and like if it's just steering an
acceleration you could literally map the
acceleration you could literally map the
cars to the keyboard so like you know
cars to the keyboard so like you know
you can take over for the agents and see
you can take over for the agents and see
if you can drive better than the agents
if you can drive better than the agents
that's how we have it
that's how we have it
here uh obviously we don't have it like
here uh obviously we don't have it like
the website needs a redesign and stuff
the website needs a redesign and stuff
but like here like this is a Connect 4
but like here like this is a Connect 4
agent that's pretty darn good I can hold
agent that's pretty darn good I can hold
shift and it'll stop playing and then I
shift and it'll stop playing and then I
can like you know take over for the
can like you know take over for the
agent and like try to beat it on stuff
agent and like try to beat it on stuff
uh right like I can try to beat
uh right like I can try to beat
it Unity
it Unity
setup Drive in
setup Drive in
VR that's
VR that's
cool I think the biggest thing honestly
cool I think the biggest thing honestly
is just compiling for web assembly just
is just compiling for web assembly just
having it in the browser has been so
having it in the browser has been so
nice I mean like literally like look
nice I mean like literally like look
here's the agent playing pong it's
here's the agent playing pong it's
pretty good at pong right and then like
pretty good at pong right and then like
you can just hold shift and now I'm
you can just hold shift and now I'm
playing it and now I can see like oh
playing it and now I can see like oh
actually this is kind of hard to do
actually this is kind of hard to do
better than the agent is right so it's
better than the agent is right so it's
just like very instant gratification for
just like very instant gratification for
Stuff
very very hard to drive with a keyboard
very very hard to drive with a keyboard
Grand Theft
Auto through a
wheel it's only three dire it's if
wheel it's only three dire it's if
it'sit a discreet of nine isn't that
it'sit a discreet of nine isn't that
just like W
just like W
WD with like the key not being pressed
WD with like the key not being pressed
is
zero I think you can do it
all
all
right see you around thank you
right see you around thank you
by all right we go back to GPU drive for
by all right we go back to GPU drive for
a bit I mean uh PR MOA for a
bit see if I can fix this ah 20 minutes
bit see if I can fix this ah 20 minutes
or so see you
Eugene what is a
parantha
oh yeah
okay e
trying to think where we were with the
Moa oh I I need to be on the
Moa oh I I need to be on the
box yeah I remember I
left yeah it's it's on the server
okay puffer ocean
okay so this is where we were uh yeah I
okay so this is where we were uh yeah I
remember
remember
um we were trying to figure out when you
um we were trying to figure out when you
take a tower or when you scan a tower
this player
okay what's up here so scan
okay what's up here so scan
Tower at
106 that was like instantaneous
106 that was like instantaneous
really player zero scan Tower
106 I don't know how he got over there
106 I don't know how he got over there
that fast but
okay oh is there something wrong with
okay oh is there something wrong with
player
zero that's kind of weird that it's
zero that's kind of weird that it's
always player zero
oh no no no no because this is yeah it's
oh no no no no because this is yeah it's
it's their own base
right wait but hold on 106 is X no
right wait but hold on 106 is X no
that's the enemy base how' they get over
that's the enemy base how' they get over
there
oh
that makes no sense at
all okay so they scan it
and then they move towards it
so
bizarre e
I'm not seeing
it if it's scanning the tower it should
it if it's scanning the tower it should
be moving towards
it for
I mean is this somehow screwing it up
it's funny how with the replies on uh on
it's funny how with the replies on uh on
x people always assume when I say C I'm
x people always assume when I say C I'm
I mean C++ no I mean writing C it's
simpler why is dire tower towers alive
zero one is dire tow Towers
zero one is dire tow Towers
alive Tower
team same thing as before
they both have no Towers alive that
they both have no Towers alive that
makes no
sense well cuz you're dumb is why this
sense well cuz you're dumb is why this
is zero
okay this will be a little bit more
okay this will be a little bit more
informative
logs 12 dire Towers
logs 12 dire Towers
alive so dire got all their
towers almost all their towers
radiant has like no Towers because at
radiant has like no Towers because at
the end of the
the end of the
game lots are programmed to basically
game lots are programmed to basically
take all of
take all of
them
right they've won all the games yeah
right they've won all the games yeah
this is exactly as it looks and then
this is exactly as it looks and then
randomly out of the blue we're going to
randomly out of the blue we're going to
get a victory for uh radiant right
yeah there you go
yeah there you go
so I mean according to this thing you
so I mean according to this thing you
got a radiant
Victory you've
got both of these relatively close to
got both of these relatively close to
the enemy ancient but this player zero
the enemy ancient but this player zero
right next to it but I don't think it's
right next to it but I don't think it's
just a player zero bug because we've
just a player zero bug because we've
seen other ones close to it and like
seen other ones close to it and like
this is pretty close too
um man did they just get like teleported
um man did they just get like teleported
here or something let me see cuz like
here or something let me see cuz like
Tower
Tower
Tower
X okay so Tower
X okay so Tower
Team 1 2 3 four five 6 7 8 nine so the
Team 1 2 3 four five 6 7 8 nine so the
first nine
first nine
Towers is 0 through
8 well one the mid Tower I assume this
8 well one the mid Tower I assume this
is the mid tower Tower nine
is the mid tower Tower nine
here so
and five
and five
six oh no this is top Tower isn't
six oh no this is top Tower isn't
it or this
it or this
is wait 1 two 3 4 5 6 7 8
is wait 1 two 3 4 5 6 7 8
n huh
oh 10 right
no yeah 10 so it's
no yeah 10 so it's
103 and then one two three four five
103 and then one two three four five
six
10 h
PID greater than equal
5 it's greater than equal right
yeah how are these all so high
level you reset the XP as well when you
reset e
wait Tower 22 wait wait there's a clue
wait Tower 22 wait wait there's a clue
there isn't
there isn't
there wait Tower
Tower Health Tower y Tower X
[Music]
actually is
anybody wait Tower y Tower X player y
anybody wait Tower y Tower X player y
player
X so what player 20 wait player three is
X so what player 20 wait player three is
the one that's close by right
the one that's close by right
at
24107 where's the enemy
ancient it's at 26 is the
Y 107 so yeah it's literally right on
Y 107 so yeah it's literally right on
top of it player three
top of it player three
is player three is a level 20
is player three is a level 20
n which character is player three is it
n which character is player three is it
the
tank yeah it's the
tank yeah it's the
tank so
tank so
somehow right the tank gets all the way
somehow right the tank gets all the way
over there
because these other agents
we're actually not even all that close
we're actually not even all that close
to the enemy
to the enemy
Tower enemy
Tower enemy
ancient but they've taken like
ancient but they've taken like
everything
everything
else who the heck is defending
why aren't they all the way at the
why aren't they all the way at the
ancient
it's very
obnoxious try something real quick
let me Commit This current thing right
let me Commit This current thing right
here actually
or
speed for
here they
here they
come here's Ultra fast MOBA
come here's Ultra fast MOBA
mode ah I'm getting
mode ah I'm getting
wrecked
wrecked
okay here comes their
okay here comes their
tank oh what the heck killed the
tank oh what the heck killed the
tank the tower
okay here comes their
okay here comes their
tank okay so our Towers defend the tank
tank okay so our Towers defend the tank
against the tank they do a decent
job
job
yeah he's level 13 now he's level
yeah he's level 13 now he's level
16 and then that resets the end
16 and then that resets the end
right does the tank get stuck somewhere
right does the tank get stuck somewhere
or something
or not
respawn there's the
tank so top laner strong very strong
tank so top laner strong very strong
right
here's the
tank Towers don't really
regen do they regen I know why they
regen do they regen I know why they
don't regen much either way I don't
don't regen much either way I don't
think they regen at
all CU it got to be like some weird Edge
all CU it got to be like some weird Edge
case where like despawning an agent or
case where like despawning an agent or
some
some
[ __ ]
because otherwise
because otherwise
like how
right Ultra fast mob is kind of
fun oh there is the tank
you can also see like that this Tower is
you can also see like that this Tower is
starting to take some damage as
well look see he took our
Tower uh do we check status on
Tower uh do we check status on
Towers cuz this is kind of weird
could that mess something
could that mess something
up I don't think
so there's the there he
so there's the there he
is he has taking our
Tower update cool cool Downs yeah
Tower update cool cool Downs yeah
there's no update status or
anything yeah there's no stun check on a
anything yeah there's no stun check on a
tower
tower
oh uh that didn't reset the
game well there's your problem
game well there's your problem
game doesn't
reset
huh I thought I'd fix that a while
huh I thought I'd fix that a while
ago but yeah so what's going to happen
ago but yeah so what's going to happen
is eventually like you run this thing
is eventually like you run this thing
for long enough then yeah eventually
for long enough then yeah eventually
like uh our team is going to power Farm
up that's crazy he's still getting hit I
up that's crazy he's still getting hit I
think isn't
think isn't
he I mean this is the damage
animation interesting
now this shows you the importance of
now this shows you the importance of
rendering the freaking game and playing
it I'm going to see if I spot it real
it I'm going to see if I spot it real
quick and if not I'm going to call it a
quick and if not I'm going to call it a
day and we'll know for tomorrow where to
start for
shouldn't be needed
but let's see about
this e
[Music]
we'll see if it
breaks if this doesn't break I'm not
breaks if this doesn't break I'm not
going to put any more thought in for the
going to put any more thought in for the
night I'm just going to launch a
night I'm just going to launch a
training run see what happens
damn
damn
it that's
weird it still happens it looks like cuz
weird it still happens it looks like cuz
they're at the
they're at the
base um
base um
yeah that's
disappointing I mean are they able to
disappointing I mean are they able to
heal it or some [ __ ]
try this last
try this last
one last one for the
day
for e
powers and this is about what we
powers and this is about what we
want let's see if it
breaks if so yeah okay so
breaks if so yeah okay so
there's there's some weird Edge
there's there's some weird Edge
case um where every some number of games
case um where every some number of games
not even that rare to be
not even that rare to be
honest uh it's possible that like the
honest uh it's possible that like the
game win or game over condition doesn't
trigger uh I don't know why that
is but that appears to be what is
happening yeah um I'm going to call it
happening yeah um I'm going to call it
here I'm going to figure this out
here I'm going to figure this out
tomorrow we at least got a visual Repro
tomorrow we at least got a visual Repro
of what's
of what's
Happening we know what the issue is this
Happening we know what the issue is this
is probably the main thing preventing
is probably the main thing preventing
all the training frankly because this is
all the training frankly because this is
going to happen very early on in
going to happen very early on in
training and then there's nothing to
training and then there's nothing to
learn because you know all your games
learn because you know all your games
eventually just get stuck in limbo um
eventually just get stuck in limbo um
all right thanks folks I will uh
all right thanks folks I will uh
probably continue on this on stream in
probably continue on this on stream in
the morning all the usual things if you
the morning all the usual things if you
haven't already all free and open source
haven't already all free and open source
on puffer lib uh GitHub
on puffer lib uh GitHub
here please go ahead and give that a
here please go ahead and give that a
star really helps us out a ton uh if
star really helps us out a ton uh if
you're interested Ed in contributing to
you're interested Ed in contributing to
this discord.gg puffer lots of new
this discord.gg puffer lots of new
contributors on there onboarding new
contributors on there onboarding new
folks all the time and if you're looking
folks all the time and if you're looking
for reinforcement learning and adjacent
for reinforcement learning and adjacent
Tech
