Kind: captions
Language: en
okay we're back
okay we're back
live that's one heck of a parito front
live that's one heck of a parito front
right there my gosh 26 seconds solve
right there my gosh 26 seconds solve
glorious truly
glorious we have this algorithm well set
glorious we have this algorithm well set
um I going to sit here for a second
um I going to sit here for a second
while the stream warms
while the stream warms
up get my supplements
up get my supplements
and then I'll chat about what we're
and then I'll chat about what we're
going to build tonight welcome
bet
AI I've been trying this blueprint stack
AI I've been trying this blueprint stack
for the last I don't know few weeks I
for the last I don't know few weeks I
haven't been perfectly consistent taking
haven't been perfectly consistent taking
it but it's been decent overall
dude you gota you got to up the quality
dude you gota you got to up the quality
of stuff you're posting on uh on X like
of stuff you're posting on uh on X like
you have some reasonable stuff but also
you have some reasonable stuff but also
you kind of just Spam bot stuff at
times no I don't all
times no I don't all
right I get your Tweet
notifications what are you trying to be
notifications what are you trying to be
the next yapan
yeah look my best posts are stupid
yeah look my best posts are stupid
comments as well but the thing is they
comments as well but the thing is they
don't actually
convert I have stuff that's gotten like
convert I have stuff that's gotten like
a thousand some
a thousand some
OD where I just like I made some like
OD where I just like I made some like
dumb code
dumb code
joke Puff is incredible my friend thank
joke Puff is incredible my friend thank
you very
much so um we have new stuff for you in
much so um we have new stuff for you in
puffer lib as well what you're looking
puffer lib as well what you're looking
at right here is I haven't run the
at right here is I haven't run the
baselines fully yet but most likely soda
baselines fully yet but most likely soda
hyper parameter sweeps for RL by a
hyper parameter sweeps for RL by a
massive
margin in about 400 lines of code
takes about two hours to
takes about two hours to
run what like two billion steps a
pong maybe it was about a week fulltime
pong maybe it was about a week fulltime
a week's worth of fulltime work for me
yeah I mean this here this is a parito
yeah I mean this here this is a parito
curve on pong so you'll notice that it
curve on pong so you'll notice that it
doesn't have any expensive runs that
doesn't have any expensive runs that
give you bad results you'll notice it
give you bad results you'll notice it
doesn't spend too much time on overly
doesn't spend too much time on overly
expensive runs that aren't really giving
expensive runs that aren't really giving
you much performance benefit because
you much performance benefit because
it's already solved over here and you'll
it's already solved over here and you'll
notice as well that we have uh this is
notice as well that we have uh this is
solved in 26.5
solved in 26.5
seconds so pretty
good we're very happy with this
good we're very happy with this
so um what I want to do
so um what I want to do
tonight and I'm not going to go too
tonight and I'm not going to go too
crazy on this if it ends up being harder
crazy on this if it ends up being harder
than expected but a few folks in
than expected but a few folks in
Industry have asked me for this um and
Industry have asked me for this um and
you know it would be nice to get uh a
you know it would be nice to get uh a
couple more contracts going with puffer
couple more contracts going with puffer
puffer is a business as well you know we
puffer is a business as well you know we
need to be able to pay for the
need to be able to pay for the
gpus so uh we do that through service
gpus so uh we do that through service
contracts and one of the things people
contracts and one of the things people
have been asking about is
distributed so I've always stayed away
distributed so I've always stayed away
from this
from this
because God it's a
because God it's a
mess and your
mess and your
time what
this thing's kind of
gross e
DDP I mean this basically looks like MPI
I wonder if I could put this as an
I wonder if I could put this as an
option just in the demo. P script and
option just in the demo. P script and
not have to pollute the clean puff
not have to pollute the clean puff
RL do you think
uh the thing is that they have a data
uh the thing is that they have a data
parallel but they don't like it
explain data parallel you take your
explain data parallel you take your
batch of 4096 OBS you have four gpus you
batch of 4096 OBS you have four gpus you
give each GPU 1024 OBS and you run them
give each GPU 1024 OBS and you run them
in
parallel uh it would if they'd
parallel uh it would if they'd
implemented it correctly but they didn't
implemented it correctly but they didn't
so they kind of punted on it and say
so they kind of punted on it and say
yeah never use this even though would
yeah never use this even though would
exist and use this distributed data
exist and use this distributed data
parallel
instead I mean nothing's going to happen
instead I mean nothing's going to happen
with me just staring at it so I may as
with me just staring at it so I may as
well just try to [ __ ] with it and see
well just try to [ __ ] with it and see
what
what
happens that guy says Ray something
happens that guy says Ray something
something no bad
not for
this I'm sure they're just wrapping
this e
this isn't we don't need multiple
machines this is just if we can get
machines this is just if we can get
multi GPU on one machine that'll be a
multi GPU on one machine that'll be a
good
start yep wouldn't it be nice if that
start yep wouldn't it be nice if that
were
simple unfortunately we cannot have nice
simple unfortunately we cannot have nice
things with these
people it isn't no and if I wanted to
people it isn't no and if I wanted to
actually build that to be simple and be
actually build that to be simple and be
good it would take me quite a while so
good it would take me quite a while so
we're going to wrap this thingy for now
we're going to wrap this thingy for now
and see if it's any
and see if it's any
good is it common to have 10 gpus no
good is it common to have 10 gpus no
it's common to have 4 to8
made e
consumer mother yeah no they're not for
consumer mother yeah no they're not for
that they're for
serers basically industry wants to know
serers basically industry wants to know
if you can spend um 50 times the money
if you can spend um 50 times the money
to make it five times faster
MH well to be fair we could probably
MH well to be fair we could probably
make it five times faster for like five
make it five times faster for like five
to six times the cost uh if we got a
to six times the cost uh if we got a
tiny box on this
thing
thing
hopefully it would only be ratio one for
hopefully it would only be ratio one for
larger models so it's not going to give
larger models so it's not going to give
us 6 million steps per second I would
us 6 million steps per second I would
doubt but uh you know it might keep us
doubt but uh you know it might keep us
at good uh SPS relative if we're going
at good uh SPS relative if we're going
to do 10 million parameter
to do 10 million parameter
models I don't know I figured I'd take
models I don't know I figured I'd take
an hour or two and do it since people
an hour or two and do it since people
have asked and it would be a cool thing
have asked and it would be a cool thing
to show off if we get it to work quickly
bandwidth no bandwidth is still an issue
bandwidth no bandwidth is still an issue
because the models are so small we
because the models are so small we
process over like a gigabyte of data per
second e
okay you go ahead and time it and see
okay you go ahead and time it and see
why uh where the bottlenecks are in our
why uh where the bottlenecks are in our
RL processes go ahead speed up our
RL processes go ahead speed up our
trainer get us to five or 10 million
trainer get us to five or 10 million
steps per second then
if you can like if you can double our
if you can like if you can double our
training speed uh I don't know I'll send
training speed uh I don't know I'll send
you a box or
something
e
e e
that's
lovely
for e
do we just run this whole bloody process
do we just run this whole bloody process
in
in
there but if we just put this
what if we just do
this
e
e e
hopefully you can import them like this
hopefully you can import them like this
I think you should be able to
looking around ironically most RL
looking around ironically most RL
because memory usage is essentially
because memory usage is essentially
zero less than 150 gigabytes per
zero less than 150 gigabytes per
second single
second single
pcie mm speeds are more than fast enough
pcie mm speeds are more than fast enough
to handle the data still
okay
okay
so where's the overhead from then just
so where's the overhead from then just
Cuda kernel
Cuda kernel
launch compiling does not magically make
launch compiling does not magically make
all of our stuff Run 100 times faster as
all of our stuff Run 100 times faster as
far as we've
far as we've
seen we've got pretty small networks
seen we've got pretty small networks
we've got like hundred some odd thousand
we've got like hundred some odd thousand
parameter
parameter
networks uh and then they run at up to a
networks uh and then they run at up to a
million steps per second in training
also less than 150 GB per second who the
also less than 150 GB per second who the
hell is doing 150 gbes a second of
hell is doing 150 gbes a second of
transfer I guess for the the weight
transfer I guess for the the weight
transfer but that's like one giant
transfer but that's like one giant
tensor it' be faster with more gpus I
tensor it' be faster with more gpus I
don't know what's the
overhead I mean 4096
we're running like 200 batches a second
we're running like 200 batches a second
I believe or
I believe or
more it's essentially zero well then
more it's essentially zero well then
what's the bottleneck because we see we
what's the bottleneck because we see we
see uh slowdown when we go over a
see uh slowdown when we go over a
gigabyte a
gigabyte a
second
um like you'd have to profile the train
um like you'd have to profile the train
script and figure it out from there
with what setup like
with what setup like
Hardware top end desktop with a 4090 and
Hardware top end desktop with a 4090 and
a high-end CPU
a high-end CPU
950x it's not CPU bound at
all I mean if you think about it though
all I mean if you think about it though
here's the thing we have a batch size of
here's the thing we have a batch size of
4096 in the forward pass right okay so a
4096 in the forward pass right okay so a
million per second you're doing like
million per second you're doing like
over 200 batches uh you're doing over
over 200 batches uh you're doing over
200 batches per
200 batches per
second okay so like you literally like
second okay so like you literally like
millisecond like millisecond overhead in
millisecond like millisecond overhead in
like launch times and stuff is going to
like launch times and stuff is going to
kill perf
oh
e e
I wouldn't say it's dying but we've
I wouldn't say it's dying but we've
noticed our Nets are substan
noticed our Nets are substan
slower with uh when we substantially
slower with uh when we substantially
exceed a gond
exceed a gond
yeah yeah ddr4 or ddr5 either
way I mean you could it could be the net
way I mean you could it could be the net
it could just be that we're genuinely
it could just be that we're genuinely
Network bound at this point I haven't
Network bound at this point I haven't
done the math I would need to know
done the math I would need to know
like it would be difficult I'd have to
like it would be difficult I'd have to
compute the like flop uh throughput or
compute the like flop uh throughput or
whatever
well we've noticed substantial bandwidth
well we've noticed substantial bandwidth
overhead I don't know the thing is you
overhead I don't know the thing is you
also end up copying
also end up copying
it that might be with memory
it that might be with memory
pinned you you end up still needing to
pinned you you end up still needing to
copy it I don't
know
e
e
e
e
e
e
e e
where's M name come
from
e
e
e
e
e
e
e e
this support stuff off the screen one
second
e
e
e
e
e
e e
just silly
just silly
support I don't even know what this is
support I don't even know what this is
that somebody just really wants to write
that somebody just really wants to write
ends in like Julia or something I don't
know okay let's see if the runs or just
know okay let's see if the runs or just
freezes
so uh I guess DDP is just uh lags or
so uh I guess DDP is just uh lags or
fails or
fails or
something if I do World size one does
something if I do World size one does
that do anything
doesn't seem to do
anything
for
e e
this freees
huh e
the
the
heck why should this thing
heck why should this thing
hang oh actually maybe we should check
hang oh actually maybe we should check
if it's actually doing
something maybe the uh the GPU actually
goes see
so memory went up but GPU utilization is
so memory went up but GPU utilization is
still very very
low 15% if I kill
low 15% if I kill
it yeah it's just a me so it all the
it yeah it's just a me so it all the
policy
the other one just in
case still no huh
oh you know what I wonder if it's torch
oh you know what I wonder if it's torch
Cuda synchronize
still
no that's crazy I would have thought
no that's crazy I would have thought
that would have been it
thing is so cursed
I mean this gets to somewhere how do we
I mean this gets to somewhere how do we
see where it gets to
see where it gets to
do we have to freaking print debug here
do we have to freaking print debug here
is this a
thing e
D where's this freaking dashboard I
D where's this freaking dashboard I
swear
literally printy buug this
Shenanigans okay
you do binary search on this thing
Pals on the policy
huh well that's not particularly useful
huh well that's not particularly useful
now is it
no it doesn't fail
here do I not have an lstm or
something I'm confused is the
context e
question
mark okay so for some reason it thinks
mark okay so for some reason it thinks
the policy is not recurrent
oh it's I I know
why e
hell how the hell is this stupid
hell how the hell is this stupid
thing oh it's cuz stupid
thing oh it's cuz stupid
me
me
okay man I honestly I thought we were
okay man I honestly I thought we were
done with
done with
MPI I thought we' gotten over this era
MPI I thought we' gotten over this era
of stupidity but apparently not
oops and I also realized this is
oops and I also realized this is
covering
chat my
bad needs to up a dosage ah
maybe I might need to up my freaking
maybe I might need to up my freaking
coffee dosage
[Music]
yeah guys turn currently
uh talking up the on some stuff I don't
uh talking up the on some stuff I don't
even freaking know man
don't
know e
yeah I I don't think he knows what he
yeah I I don't think he knows what he
means C well Captain's not
watching that's not how that
works oh this only gets trained
config
e
e
e
e
e
e e
iing know does this
work apparently it does
cool apparently that does
do this
so this trains
at so this the default thing it trains
at so this the default thing it trains
at
at
580k 5 80ish
H now this does not
H now this does not
work go back to
two still does not work did I have
two still does not work did I have
something wrong
yes it runs
two no so it only runs at one so
two no so it only runs at one so
assumably that's multiple
assumably that's multiple
devices
probably
for
e
e e
okay so uh I keep having to answer stuff
okay so uh I keep having to answer stuff
on the side
and why is
and why is
it why are the first two links tutorials
it why are the first two links tutorials
instead of just docks it really that
bad okay World size
is
on example I don't want example I want
on example I don't want example I want
the freaking docks where's the
the freaking docks where's the
docks docs distributed data parallel and
docks docs distributed data parallel and
there is no freaking function
there is no freaking function
signature what is wrong with you
signature what is wrong with you
here it is here are the real docs
here it is here are the real docs
okay device
ID device
ideas
spawn so I guess World size is just
spawn so I guess World size is just
multiple devices
nccl is the fastest back
nccl is the fastest back
end
okay so the tutorial gave me the slow
okay so the tutorial gave me the slow
back end
okay so there's very little overhead
okay so there's very little overhead
there if any at all compared to single
processed e
the support
stuff
e
e e
is there a way that I can test this
is there a way that I can test this
without multiple gpus
is there a way I can do this
probably is but it's hard and doesn't
probably is but it's hard and doesn't
work I I could just go get a multi GPU
work I I could just go get a multi GPU
machine for
testing should I just do that real
testing should I just do that real
quick going do
that what's like a really easy way to do
that what's like a really easy way to do
that what's like a really easy way to
that what's like a really easy way to
just like get
just like get
a a uh multi-gpu machine for a couple
a a uh multi-gpu machine for a couple
hours I don't have any mine are all
hours I don't have any mine are all
single GPU
I mean you don't think it would be
I mean you don't think it would be
really easy there's so many freaking
really easy there's so many freaking
companies devoted to this that they
companies devoted to this that they
literally have like Renta trucks
literally have like Renta trucks
advertising GPU rental services driving
advertising GPU rental services driving
around
nups e
yes but I mean it's going to be a few
yes but I mean it's going to be a few
hours it'll be like 10 20 bucks whatever
there that will do
there that will do
it I could try vast as well but I think
it I could try vast as well but I think
those are personal machines right
those are personal machines right
right they don't have
uh do they have like multi uh multi
machines I I don't think that they have
machines I I don't think that they have
I mean multi-gpu machines
renting machine should not be hard oh
renting machine should not be hard oh
yeah here this is 4 490s
Bulgaria don't put any private data on
there all
there all
right let me Commit This
you are 100%
you are 100%
confident
confident
no you can test it we have the automated
no you can test it we have the automated
tests so if you commit it and it passes
tests so if you commit it and it passes
the the build tests then it probably
the the build tests then it probably
works it should do those for anything
works it should do those for anything
you anything you PR I'm pretty sure it
you anything you PR I'm pretty sure it
should run the the tests
or you can just copy the file and put it
or you can just copy the file and put it
in your
fork I'm not confident of anything
fork I'm not confident of anything
here let's do this on the puffer oneops
that's crazy that they don't have a
that's crazy that they don't have a
login button on their main page there we
login button on their main page there we
go and with
go and with
Google do
question
question
mark where it just go where did it just
mark where it just go where did it just
go oh it just made me an account it gave
go oh it just made me an account it gave
me a sign up page and then it just made
me a sign up page and then it just made
me an account off Google
me an account off Google
whatever
whatever
okay check your email for
verification this should be pretty quick
right e
I torch
vast that's kind of cool
you need to add a card
okay not show my card on stream by
mistake for
hang
hang
on let me make sure I can actually get
on let me make sure I can actually get
these machines
put 10 bucks on it real
put 10 bucks on it real
quick that was nice and
easy
uh where's that machine I
uh where's that machine I
wanted did somebody grab it already
wanted did somebody grab it already
come
on this looks good
right
right
this H2 200s what are those
this is view the instances page in the
this is view the instances page in the
sidebar in the sidebar
huh what are you actually doing that guy
huh what are you actually doing that guy
wants to
wants to
know what am I doing right now I'm just
know what am I doing right now I'm just
trying to see if I can test distributed
trying to see if I can test distributed
data parallel with p with uh with Puffer
cool
okay open Terminal
access open Jupiter
access open Jupiter
terminal for
cool can you get SSH to this
cool can you get SSH to this
thing probably not you probably have to
thing probably not you probably have to
set up stuff it's no big deal for now uh
set up stuff it's no big deal for now uh
let's go grab Docker I
guess or actually do I even need Docker
guess or actually do I even need Docker
I probably don't if this thing has pie
I probably don't if this thing has pie
torch on it right
wow this white scheme is God awful
no
V there's GDP right
they don't put GCC on your instance man
y'all got to get some better
y'all got to get some better
containers no
GCC your container should not be so
GCC your container should not be so
minified that I have to manually install
minified that I have to manually install
a
compiler e
so whoever said that uh renting GPU
so whoever said that uh renting GPU
machines is difficult
I forgot the dependencies
I actually don't know why people rent
I actually don't know why people rent
these things out to be
these things out to be
honest for the prices that they rent
honest for the prices that they rent
them this is why I own the hardware
them this is why I own the hardware
because it's like there's no way you can
because it's like there's no way you can
get these things consistently enough
I mean a140 a day they're making what
I mean a140 a day they're making what
th000 bucks a year a little
more yeah I mean you're hardly making
more yeah I mean you're hardly making
anything on them though like the whole
anything on them though like the whole
point of owning your own Hardware is you
point of owning your own Hardware is you
have it for yourself on demand when you
have it for yourself on demand when you
want it
pyro as
well hyro PPL
I think that's all I need for uh for
I think that's all I need for uh for
this
huh their gpus are somehow did they over
huh their gpus are somehow did they over
underclock the hell out of
them oh dude that's not cool what the
heck what did you do to your 490s
guys these guys are scamming
guys these guys are scamming
you look at
you look at
that I don't know how you fix
that I don't know how you fix
the the
theme can you do no that's
theme can you do no that's
syntax there we
go I think they scam you look I think
go I think they scam you look I think
that they have them way under clocked so
that they have them way under clocked so
that they don't spend anything on power
the
heck for
all right I mean we can still test it
rank zero and rank one both on cuded
rank zero and rank one both on cuded
device
is this like dictionary shared or
something
e
e e
got two
got two
rank I
see e
oh wait it's doing it
you see the like the super fast
refreshes yeah it's actually doing it
that's kind of
that's kind of
cool I didn't expect that to
work cool
so that's like 4X faster training you're
so that's like 4X faster training you're
not going to see it here but the way
not going to see it here but the way
that you can tell is that this stays the
that you can tell is that this stays the
same so this doesn't drop very much
same so this doesn't drop very much
there's very low overhead but you can
there's very low overhead but you can
see it ticks a whole bunch of updates
see it ticks a whole bunch of updates
really quick it's cuz it's actually
really quick it's cuz it's actually
doing four updates every
doing four updates every
time so that's cool
so um DDP not that
bad don't let me forget to close this
bad don't let me forget to close this
tonight but we're going to do a little
tonight but we're going to do a little
Dev over
here can you set up a guide on how to do
distributed
distributed
um the guide's just following the torch
um the guide's just following the torch
instructions I was just going to merge
instructions I was just going to merge
it do you want what do you want a guide
it do you want what do you want a guide
for something I mean I I don't know
for something I mean I I don't know
maybe it's a good article for x or
maybe it's a good article for x or
something
just a demo. p it's a little more than
just a demo. p it's a little more than
that but not much
this little bit of code this little bit
this little bit of code this little bit
of code added a
flag I the only thing is that the thing
flag I the only thing is that the thing
is uh all the dashboard just updates in
is uh all the dashboard just updates in
place so it just it updates four times
place so it just it updates four times
in place and the stats going to W be
in place and the stats going to W be
won't be
correct
e e
all reduce for summation
it's obnoxious isn't it
kind of gross
I guess we try something like this we
I guess we try something like this we
get this working and then we uh we try
get this working and then we uh we try
to Port it
to Port it
back oh it's nine already though isn't
back oh it's nine already though isn't
it
the thing is I feel good at the moment
the thing is I feel good at the moment
and I could keep going on
this I'll do just a little more on this
this I'll do just a little more on this
I don't want to be up too too late but
I don't want to be up too too late but
I'll do just a little more on
this let's Commit This for now
dude I've done my time all right my
dude I've done my time all right my
average bedtime in high school was like
average bedtime in high school was like
2 3 in the
2 3 in the
morning and I lived an hour
away I did my freaking time
stupid work does not require any sleep
stupid work does not require any sleep
because you can be stupid and still get
because you can be stupid and still get
it done smart work requires you to be
it done smart work requires you to be
well
rested also it's just a lot less
rested also it's just a lot less
miserable in general like there's
miserable in general like there's
basically no enjoyment to be had in life
basically no enjoyment to be had in life
if you have chronic sleep deprivation
if you have chronic sleep deprivation
it's like actually a form of torture
it's not even remotely an
exaggeration okay so there's this mean
exaggeration okay so there's this mean
and log operation
here
e e
what in the [ __ ] is
this
e
e
e
e
e
e
e e
I hear somebody trying to do DDP
I hear somebody trying to do DDP
somebody's done DDP it just requires uh
somebody's done DDP it just requires uh
some logging changes so that actually
some logging changes so that actually
make
sense and honest honestly why am I being
sense and honest honestly why am I being
stupid about this as well I should just
stupid about this as well I should just
do um actually I leave it as is damn
do um actually I leave it as is damn
it add log by rank in
it add log by rank in
front what do you
front what do you
mean log by rank
that's not what I want I don't want a
that's not what I want I don't want a
log per rank I want to take the uh I
log per rank I want to take the uh I
want a summer me
all reduces are
expensive well too bad if it can't do it
expensive well too bad if it can't do it
once per Epoch then what the hell if it
once per Epoch then what the hell if it
can't like reduce a few
scalers invalid device
oral I mean I can combine them into one
oral I mean I can combine them into one
all reduce
all reduce
later I just want it to work for
[Music]
let's put this somewhere up here
in a
block now what we're going to do a
block now what we're going to do a
block okay screw
block okay screw
you de
here e
data has no attribute device that's fine
handle closed [ __ ]
you late night coding I get a little
irritated got set up to Pi to pass test
did your test check for the garbage
did your test check for the garbage
compile
compile
Flags no
Flags no
idea using torch Runner writing this out
idea using torch Runner writing this out
by
by
hand what do you mean writing it out by
hand what do you mean writing it out by
hand is it so difficult to add like 10
hand is it so difficult to add like 10
lines of code
you could do that that's very
nice and then what we'll do is
this overview is
annoying just
annoying just
do yes
equals
EO and
this what do we do to check the
this what do we do to check the
rank check the
rank check the
rank this.g rank is zero
get rank not equal zero
get rank not equal zero
turn
turn
better let's torch run
better let's torch run
anyways I don't want things that take
anyways I don't want things that take
over my bloody command line and require
over my bloody command line and require
me to have a launch command that's not
me to have a launch command that's not
running the language that I'm coding
one day you too shall find the complete
one day you too shall find the complete
Zen
the Zen that
is writing your code not depending on
is writing your code not depending on
silly
things e
command from pie I don't want anything
command from pie I don't want anything
taking over my command
taking over my command
line I don't want
it everybody makes one of these bloody
it everybody makes one of these bloody
things
things
it's like no stop it give me anit
it's like no stop it give me anit
function I can call from my language
function I can call from my language
that I'm coding
in and also stop taking away control
in and also stop taking away control
over execution from me stop it
default process group has not been
initialized please make sure to call a
initialized please make sure to call a
net process
net process
group the hell does that mean I didn't
group the hell does that mean I didn't
think I had to do that
[ __ ] you can call the Run function
[ __ ] you can call the Run function
directly does it do anything then
directly does it do anything then
because the tutorial is pretty succinct
inet process group
huh oh this is the same this is the
huh oh this is the same this is the
garbage
right dude it's just this is [ __ ]
right dude it's just this is [ __ ]
engineering is all that this is I'm
engineering is all that this is I'm
surprised that so many places are
surprised that so many places are
actually using this the places not just
actually using this the places not just
made their own
distributed I mean literally people were
distributed I mean literally people were
doing like I mean people have been doing
doing like I mean people have been doing
MPI style stuff for how
long unironically Ray got the for all
long unironically Ray got the for all
the things that Ray screwed up they got
the things that Ray screwed up they got
the distributed API dead current like
the distributed API dead current like
dead on that's what they did
well and behold you just run functions
well and behold you just run functions
and then you run a loop and check when
and then you run a loop and check when
they're ready
well the comp the computation Paradigm
well the comp the computation Paradigm
is totally different you're right is
is totally different you're right is
probably a rapper well no actually they
probably a rapper well no actually they
like their the way their servers are set
like their the way their servers are set
up is quite different um their parameter
up is quite different um their parameter
servers and
servers and
stuff it's probably not great for small
stuff it's probably not great for small
models though
actor
framework yeah just having remote
framework yeah just having remote
classes yeah it's very
nice I uh I gave them the input on how
nice I uh I gave them the input on how
to design their debugger that's a fun
to design their debugger that's a fun
fact they came to me with like this
fact they came to me with like this
absolutely like insane deranged remote
absolutely like insane deranged remote
debugger setup and I was like all right
debugger setup and I was like all right
here this is pdb make it work remotely
here this is pdb make it work remotely
on your
on your
system and they went they did that so
system and they went they did that so
that was kind of cool
I like how it checks off its solution
I like how it checks off its solution
without actually running its own
code yeah I did
this ah this function was
missing why can't I copy C until it's
missing why can't I copy C until it's
done typing that's
silly oopsy whoopsie we forgot to spawn
silly oopsy whoopsie we forgot to spawn
oh there it is okay spawn Main
oh there it is okay spawn Main
and then you have to set
rank so anyways you're supposed to call
rank so anyways you're supposed to call
a nit process
a nit process
group I do that right don't I have this
group I do that right don't I have this
or do you have to call a nit process
or do you have to call a nit process
group
group
separately nit process yeah I do that
separately nit process yeah I do that
here it is and I just forgot set device
apparently Cuda do set device rank
oh you know what I'm not running it with
oh you know what I'm not running it with
GTP so it's probably complaining that I
GTP so it's probably complaining that I
can't check
that yeah you're
right hang on
how do you check if a disc is
enabled is there a way to check if dist
enabled is there a way to check if dist
isn't is an
is
is
initialized
perfect that's that's available not
perfect that's that's available not
initialized
right B Bing
bada bing bada
boom today has been a very funny stream
boom today has been a very funny stream
day in that it's been fairly active the
day in that it's been fairly active the
whole day hello twitch folks this is uh
whole day hello twitch folks this is uh
current Curr attempting to add
current Curr attempting to add
distributed support to puffer
distributed support to puffer
lib so people can train on their many
lib so people can train on their many
gpus that they have and we can have our
gpus that they have and we can have our
single GPU machines because they cost
less dist all reduce aha this is what
less dist all reduce aha this is what
happens when you forget to copy and
happens when you forget to copy and
paste your copy of pastable code
I've been cing a while getting
loopy well we test this for anyone who
loopy well we test this for anyone who
might be new
might be new
here puffer lib is an ultra high
here puffer lib is an ultra high
performance and very simple to use
performance and very simple to use
reinforcement learning library we train
reinforcement learning library we train
it a million steps per second on one GPU
it a million steps per second on one GPU
you can check it out on
you can check it out on
puff. we've got tons of
demos AEM tons of demos which presumably
demos AEM tons of demos which presumably
are not loading because my GP was busy
are not loading because my GP was busy
or something ridiculous yep literally
or something ridiculous yep literally
that's what it was that was
weird yeah there you go tons of
weird yeah there you go tons of
different RL environments you can check
different RL environments you can check
them out here they're all open source
them out here they're all open source
they're all ridiculously fast like
they're all ridiculously fast like
10,000 times real time they range from
10,000 times real time they range from
very simple to very
very simple to very
complex star the code to help us out
complex star the code to help us out
really helps us when people start the
really helps us when people start the
GitHub it's one of the main things we
GitHub it's one of the main things we
track you can join the Discord right
track you can join the Discord right
here discord.gg puffer you can also
here discord.gg puffer you can also
follow me on X for more RL content we've
follow me on X for more RL content we've
got a Blog here as well back to
got a Blog here as well back to
code okay so this now
code okay so this now
runs uh apparently I killed the machine
runs uh apparently I killed the machine
so we'll do
ddb
ddb
DDP this could be a
call to
call to
dism it could
be that'd be too smart though wouldn't
be that'd be too smart though wouldn't
it
uh no it can't
uh no it can't
because the
because the
initialized you forgot
this bam
yourself let's see if this is
logging so calls is
logging so calls is
initialized yeah and then what'll happen
initialized yeah and then what'll happen
is you'll get this value right and then
is you'll get this value right and then
it'll try to get the world size and
it'll try to get the world size and
they'll say it's not
they'll say it's not
initialized but
don't I think you got yourself
process group has not been
process group has not been
destroyed how do you destroy the process
destroyed how do you destroy the process
group just destroy process group lovely
okay so uh I guess what we do is we push
okay so uh I guess what we do is we push
this
and we tried this on our rented poty
and we tried this on our rented poty
machine which is actually a very nice
machine which is actually a very nice
machine that I think has been
machine that I think has been
underclocked to become a poverty machine
underclocked to become a poverty machine
because it is about the same speed no
because it is about the same speed no
it's about a third of the speed per card
it's about a third of the speed per card
as my local desktop
is for
make sure that still
runs
okay get these w b
okay get these w b
credentials wrong window
box seven is down again what do you keep
box seven is down again what do you keep
doing to box seven my guy what do you
doing to box seven my guy what do you
keep doing do
it I have to put Ram limits on these
it I have to put Ram limits on these
things you guys just oh like out of
things you guys just oh like out of
memory them
constantly cuz Spencer said it turns out
constantly cuz Spencer said it turns out
he was just out of memory his box
constantly I did plug in a
constantly I did plug in a
monitor I actually plugged in a monitor
monitor I actually plugged in a monitor
for the next time that it went down so
for the next time that it went down so
if I go out there it's probably up oops
if I go out there it's probably up oops
if I go out there that's it's just a WB
if I go out there that's it's just a WB
key nothing
key nothing
crazy uh if I do go out there I should
crazy uh if I do go out there I should
get
something cuz I out of memory
something cuz I out of memory
sporadically so you are taking the box
sporadically so you are taking the box
down damn it
well we will get uh some logs hopefully
well we will get uh some logs hopefully
if the monitor
Works put Ram limits y the no I think
Works put Ram limits y the no I think
one box has auntu most of them have
one box has auntu most of them have
Debian we're going to move to auntu
Debian we're going to move to auntu
though because I'm sick of dealing with
though because I'm sick of dealing with
Debian I thought it would be more stable
Debian I thought it would be more stable
it's not it's kind of
[ __ ] I thought I was being clever like
[ __ ] I thought I was being clever like
I'm going to put Debian on him instead
I'm going to put Debian on him instead
of buntu cuz I'm a smart guy
of buntu cuz I'm a smart guy
and it's just like no you're stupid what
and it's just like no you're stupid what
are you
are you
doing stop doing
that not logging interesting enough
that not logging interesting enough
enough okay we do get system logs but
enough okay we do get system logs but
that's
it status B was
integrated I got that thing uh I gave
integrated I got that thing uh I gave
linky the PRM integrate that quick
enough no it's in half
Bots it's been
there my guy has been there what you
doing for
it's a public Channel what are you
it's a public Channel what are you
talking about
did you have this collapsed or
something there are very few public
something there are very few public
channels
how do you not have access to that
how do you not have access to that
channel it's [ __ ] public
oh
oh
oops my
oops my
bad I'm stupid my
bad see you
that's where you guys were no they
that's where you guys were no they
aren't private it's just
Bots nothing interesting
there
there
hey it works
some
desps agent
steps never
seen uh at the moment I think we don't
seen uh at the moment I think we don't
have anything private on here I like
have anything private on here I like
I've locked like the old support channel
I've locked like the old support channel
so people don't post in it by
so people don't post in it by
mistake we might do some private
mistake we might do some private
channels in the future for like
channels in the future for like
customers and stuff but I've avoided it
customers and stuff but I've avoided it
just because I'll like accidentally leak
just because I'll like accidentally leak
those all the time right because I'll
those all the time right because I'll
just have Discord open on stream
no most of them are
Debian they should be a bun to but
Debian they should be a bun to but
they're
they're
not I mean this
works so that's pretty solid
that being unsafe no it's just uh it's
that being unsafe no it's just uh it's
annoying because it doesn't have drivers
annoying because it doesn't have drivers
for new
for new
gpus and that's that's just a standard
gpus and that's that's just a standard
out of memory there's nothing special
out of memory there's nothing special
about the
about the
OS cool so this
works
e
e
e
e e
what's a cool thing I could do for
this just put
the the star
chart e
that's pretty
nice okay
nice okay
well I got some cool emails to send to
well I got some cool emails to send to
people it's going to take a little bit
people it's going to take a little bit
more work but I'm you know I'm happy
more work but I'm you know I'm happy
that doesn't that look pretty easy uh we
that doesn't that look pretty easy uh we
are going to kill this fast instance
are going to kill this fast instance
before I forget
get we'll just stop it
I mean this has got to
be yeah no we're just going to get rid
be yeah no we're just going to get rid
of
of
this CU I'll forget otherwise
cool
cool
[Music]
[Music]
um that's pretty nice for uh just a
um that's pretty nice for uh just a
couple hours of work in the evening
couple hours of work in the evening
right preliminary multi-gpu I mean the
right preliminary multi-gpu I mean the
thing is we're not going to use it a ton
thing is we're not going to use it a ton
for what we do cuz we do uh mostly
for what we do cuz we do uh mostly
single GPU stuff but hey it's nice to
single GPU stuff but hey it's nice to
know that maybe we can get a tiny box
know that maybe we can get a tiny box
and maybe we can like you know do some
and maybe we can like you know do some
larger stuff on it if we want um and hey
larger stuff on it if we want um and hey
it'll be really nice for industry folks
it'll be really nice for industry folks
cuz a couple of people people have asked
cuz a couple of people people have asked
me in industry and uh I guess it's a
me in industry and uh I guess it's a
good time to say this is a company as
good time to say this is a company as
well it's all free and open source stuff
well it's all free and open source stuff
we don't sell the software we just sell
we don't sell the software we just sell
service it's Service as a service not
service it's Service as a service not
software as a service so if you're in an
software as a service so if you're in an
RL company or company that needs some RL
RL company or company that needs some RL
check that out but uh for the most part
check that out but uh for the most part
all software here start on GitHub to
all software here start on GitHub to
support really helps us out I work on
support really helps us out I work on
this full time and uh you can check out
this full time and uh you can check out
our environments right on the website
our environments right on the website
we've got a nice blog join the Discord
we've got a nice blog join the Discord
and follow on X I will be back tomorrow
and follow on X I will be back tomorrow
streaming more Dev probably first thing
streaming more Dev probably first thing
in the morning as usual uh I'm going to
in the morning as usual uh I'm going to
be working on a combination of
be working on a combination of
hyperparameter sweeps and a few other
hyperparameter sweeps and a few other
things speaking of which I would like to
things speaking of which I would like to
at least run one experiment overnight so
at least run one experiment overnight so
let's just set that up
my score the protein sweep
my score the protein sweep
Auto 1
Auto 1
E9 really should not need 1
E9 really should not need 1
E9 6
E9 6
e
e
8 do like
this Min 28
188 we'll see what this
188 we'll see what this
does
does
breakout
sweep mode
sweep mode
breakout uh sweep Neptune and then tag
I forgot my API token let's get
I forgot my API token let's get
that and this will just be some
that and this will just be some
experiments to run uh overnight and
experiments to run uh overnight and
we'll see how those
we'll see how those
go this is just all testing for the new
go this is just all testing for the new
algorithm that I'm going to be shipping
algorithm that I'm going to be shipping
as soon as tests are done
cool so hopefully this doesn't break on
cool so hopefully this doesn't break on
us we will see uh I don't know I'll
us we will see uh I don't know I'll
check it after I go brush my teeth and
check it after I go brush my teeth and
stuff thank you for tuning in it's been
stuff thank you for tuning in it's been
a fun stream day had lots of cool
a fun stream day had lots of cool
conversations on stream and fair few

Kind: captions
Language: en
okay we're back
okay we're back
live that's one heck of a parito front
live that's one heck of a parito front
right there my gosh 26 seconds solve
right there my gosh 26 seconds solve
glorious truly
glorious we have this algorithm well set
glorious we have this algorithm well set
um I going to sit here for a second
um I going to sit here for a second
while the stream warms
while the stream warms
up get my supplements
up get my supplements
and then I'll chat about what we're
and then I'll chat about what we're
going to build tonight welcome
bet
AI I've been trying this blueprint stack
AI I've been trying this blueprint stack
for the last I don't know few weeks I
for the last I don't know few weeks I
haven't been perfectly consistent taking
haven't been perfectly consistent taking
it but it's been decent overall
dude you gota you got to up the quality
dude you gota you got to up the quality
of stuff you're posting on uh on X like
of stuff you're posting on uh on X like
you have some reasonable stuff but also
you have some reasonable stuff but also
you kind of just Spam bot stuff at
times no I don't all
times no I don't all
right I get your Tweet
notifications what are you trying to be
notifications what are you trying to be
the next yapan
yeah look my best posts are stupid
yeah look my best posts are stupid
comments as well but the thing is they
comments as well but the thing is they
don't actually
convert I have stuff that's gotten like
convert I have stuff that's gotten like
a thousand some
a thousand some
OD where I just like I made some like
OD where I just like I made some like
dumb code
dumb code
joke Puff is incredible my friend thank
joke Puff is incredible my friend thank
you very
much so um we have new stuff for you in
much so um we have new stuff for you in
puffer lib as well what you're looking
puffer lib as well what you're looking
at right here is I haven't run the
at right here is I haven't run the
baselines fully yet but most likely soda
baselines fully yet but most likely soda
hyper parameter sweeps for RL by a
hyper parameter sweeps for RL by a
massive
margin in about 400 lines of code
takes about two hours to
takes about two hours to
run what like two billion steps a
pong maybe it was about a week fulltime
pong maybe it was about a week fulltime
a week's worth of fulltime work for me
yeah I mean this here this is a parito
yeah I mean this here this is a parito
curve on pong so you'll notice that it
curve on pong so you'll notice that it
doesn't have any expensive runs that
doesn't have any expensive runs that
give you bad results you'll notice it
give you bad results you'll notice it
doesn't spend too much time on overly
doesn't spend too much time on overly
expensive runs that aren't really giving
expensive runs that aren't really giving
you much performance benefit because
you much performance benefit because
it's already solved over here and you'll
it's already solved over here and you'll
notice as well that we have uh this is
notice as well that we have uh this is
solved in 26.5
solved in 26.5
seconds so pretty
good we're very happy with this
good we're very happy with this
so um what I want to do
so um what I want to do
tonight and I'm not going to go too
tonight and I'm not going to go too
crazy on this if it ends up being harder
crazy on this if it ends up being harder
than expected but a few folks in
than expected but a few folks in
Industry have asked me for this um and
Industry have asked me for this um and
you know it would be nice to get uh a
you know it would be nice to get uh a
couple more contracts going with puffer
couple more contracts going with puffer
puffer is a business as well you know we
puffer is a business as well you know we
need to be able to pay for the
need to be able to pay for the
gpus so uh we do that through service
gpus so uh we do that through service
contracts and one of the things people
contracts and one of the things people
have been asking about is
distributed so I've always stayed away
distributed so I've always stayed away
from this
from this
because God it's a
because God it's a
mess and your
mess and your
time what
this thing's kind of
gross e
DDP I mean this basically looks like MPI
I wonder if I could put this as an
I wonder if I could put this as an
option just in the demo. P script and
option just in the demo. P script and
not have to pollute the clean puff
not have to pollute the clean puff
RL do you think
uh the thing is that they have a data
uh the thing is that they have a data
parallel but they don't like it
explain data parallel you take your
explain data parallel you take your
batch of 4096 OBS you have four gpus you
batch of 4096 OBS you have four gpus you
give each GPU 1024 OBS and you run them
give each GPU 1024 OBS and you run them
in
parallel uh it would if they'd
parallel uh it would if they'd
implemented it correctly but they didn't
implemented it correctly but they didn't
so they kind of punted on it and say
so they kind of punted on it and say
yeah never use this even though would
yeah never use this even though would
exist and use this distributed data
exist and use this distributed data
parallel
instead I mean nothing's going to happen
instead I mean nothing's going to happen
with me just staring at it so I may as
with me just staring at it so I may as
well just try to [ __ ] with it and see
well just try to [ __ ] with it and see
what
what
happens that guy says Ray something
happens that guy says Ray something
something no bad
not for
this I'm sure they're just wrapping
this e
this isn't we don't need multiple
machines this is just if we can get
machines this is just if we can get
multi GPU on one machine that'll be a
multi GPU on one machine that'll be a
good
start yep wouldn't it be nice if that
start yep wouldn't it be nice if that
were
simple unfortunately we cannot have nice
simple unfortunately we cannot have nice
things with these
people it isn't no and if I wanted to
people it isn't no and if I wanted to
actually build that to be simple and be
actually build that to be simple and be
good it would take me quite a while so
good it would take me quite a while so
we're going to wrap this thingy for now
we're going to wrap this thingy for now
and see if it's any
and see if it's any
good is it common to have 10 gpus no
good is it common to have 10 gpus no
it's common to have 4 to8
made e
consumer mother yeah no they're not for
consumer mother yeah no they're not for
that they're for
serers basically industry wants to know
serers basically industry wants to know
if you can spend um 50 times the money
if you can spend um 50 times the money
to make it five times faster
MH well to be fair we could probably
MH well to be fair we could probably
make it five times faster for like five
make it five times faster for like five
to six times the cost uh if we got a
to six times the cost uh if we got a
tiny box on this
thing
thing
hopefully it would only be ratio one for
hopefully it would only be ratio one for
larger models so it's not going to give
larger models so it's not going to give
us 6 million steps per second I would
us 6 million steps per second I would
doubt but uh you know it might keep us
doubt but uh you know it might keep us
at good uh SPS relative if we're going
at good uh SPS relative if we're going
to do 10 million parameter
to do 10 million parameter
models I don't know I figured I'd take
models I don't know I figured I'd take
an hour or two and do it since people
an hour or two and do it since people
have asked and it would be a cool thing
have asked and it would be a cool thing
to show off if we get it to work quickly
bandwidth no bandwidth is still an issue
bandwidth no bandwidth is still an issue
because the models are so small we
because the models are so small we
process over like a gigabyte of data per
second e
okay you go ahead and time it and see
okay you go ahead and time it and see
why uh where the bottlenecks are in our
why uh where the bottlenecks are in our
RL processes go ahead speed up our
RL processes go ahead speed up our
trainer get us to five or 10 million
trainer get us to five or 10 million
steps per second then
if you can like if you can double our
if you can like if you can double our
training speed uh I don't know I'll send
training speed uh I don't know I'll send
you a box or
something
e
e e
that's
lovely
for e
do we just run this whole bloody process
do we just run this whole bloody process
in
in
there but if we just put this
what if we just do
this
e
e e
hopefully you can import them like this
hopefully you can import them like this
I think you should be able to
looking around ironically most RL
looking around ironically most RL
because memory usage is essentially
because memory usage is essentially
zero less than 150 gigabytes per
zero less than 150 gigabytes per
second single
second single
pcie mm speeds are more than fast enough
pcie mm speeds are more than fast enough
to handle the data still
okay
okay
so where's the overhead from then just
so where's the overhead from then just
Cuda kernel
Cuda kernel
launch compiling does not magically make
launch compiling does not magically make
all of our stuff Run 100 times faster as
all of our stuff Run 100 times faster as
far as we've
far as we've
seen we've got pretty small networks
seen we've got pretty small networks
we've got like hundred some odd thousand
we've got like hundred some odd thousand
parameter
parameter
networks uh and then they run at up to a
networks uh and then they run at up to a
million steps per second in training
also less than 150 GB per second who the
also less than 150 GB per second who the
hell is doing 150 gbes a second of
hell is doing 150 gbes a second of
transfer I guess for the the weight
transfer I guess for the the weight
transfer but that's like one giant
transfer but that's like one giant
tensor it' be faster with more gpus I
tensor it' be faster with more gpus I
don't know what's the
overhead I mean 4096
we're running like 200 batches a second
we're running like 200 batches a second
I believe or
I believe or
more it's essentially zero well then
more it's essentially zero well then
what's the bottleneck because we see we
what's the bottleneck because we see we
see uh slowdown when we go over a
see uh slowdown when we go over a
gigabyte a
gigabyte a
second
um like you'd have to profile the train
um like you'd have to profile the train
script and figure it out from there
with what setup like
with what setup like
Hardware top end desktop with a 4090 and
Hardware top end desktop with a 4090 and
a high-end CPU
a high-end CPU
950x it's not CPU bound at
all I mean if you think about it though
all I mean if you think about it though
here's the thing we have a batch size of
here's the thing we have a batch size of
4096 in the forward pass right okay so a
4096 in the forward pass right okay so a
million per second you're doing like
million per second you're doing like
over 200 batches uh you're doing over
over 200 batches uh you're doing over
200 batches per
200 batches per
second okay so like you literally like
second okay so like you literally like
millisecond like millisecond overhead in
millisecond like millisecond overhead in
like launch times and stuff is going to
like launch times and stuff is going to
kill perf
oh
e e
I wouldn't say it's dying but we've
I wouldn't say it's dying but we've
noticed our Nets are substan
noticed our Nets are substan
slower with uh when we substantially
slower with uh when we substantially
exceed a gond
exceed a gond
yeah yeah ddr4 or ddr5 either
way I mean you could it could be the net
way I mean you could it could be the net
it could just be that we're genuinely
it could just be that we're genuinely
Network bound at this point I haven't
Network bound at this point I haven't
done the math I would need to know
done the math I would need to know
like it would be difficult I'd have to
like it would be difficult I'd have to
compute the like flop uh throughput or
compute the like flop uh throughput or
whatever
well we've noticed substantial bandwidth
well we've noticed substantial bandwidth
overhead I don't know the thing is you
overhead I don't know the thing is you
also end up copying
also end up copying
it that might be with memory
it that might be with memory
pinned you you end up still needing to
pinned you you end up still needing to
copy it I don't
know
e
e
e
e
e
e
e e
where's M name come
from
e
e
e
e
e
e
e e
this support stuff off the screen one
second
e
e
e
e
e
e e
just silly
just silly
support I don't even know what this is
support I don't even know what this is
that somebody just really wants to write
that somebody just really wants to write
ends in like Julia or something I don't
know okay let's see if the runs or just
know okay let's see if the runs or just
freezes
so uh I guess DDP is just uh lags or
so uh I guess DDP is just uh lags or
fails or
fails or
something if I do World size one does
something if I do World size one does
that do anything
doesn't seem to do
anything
for
e e
this freees
huh e
the
the
heck why should this thing
heck why should this thing
hang oh actually maybe we should check
hang oh actually maybe we should check
if it's actually doing
something maybe the uh the GPU actually
goes see
so memory went up but GPU utilization is
so memory went up but GPU utilization is
still very very
low 15% if I kill
low 15% if I kill
it yeah it's just a me so it all the
it yeah it's just a me so it all the
policy
the other one just in
case still no huh
oh you know what I wonder if it's torch
oh you know what I wonder if it's torch
Cuda synchronize
still
no that's crazy I would have thought
no that's crazy I would have thought
that would have been it
thing is so cursed
I mean this gets to somewhere how do we
I mean this gets to somewhere how do we
see where it gets to
see where it gets to
do we have to freaking print debug here
do we have to freaking print debug here
is this a
thing e
D where's this freaking dashboard I
D where's this freaking dashboard I
swear
literally printy buug this
Shenanigans okay
you do binary search on this thing
Pals on the policy
huh well that's not particularly useful
huh well that's not particularly useful
now is it
no it doesn't fail
here do I not have an lstm or
something I'm confused is the
context e
question
mark okay so for some reason it thinks
mark okay so for some reason it thinks
the policy is not recurrent
oh it's I I know
why e
hell how the hell is this stupid
hell how the hell is this stupid
thing oh it's cuz stupid
thing oh it's cuz stupid
me
me
okay man I honestly I thought we were
okay man I honestly I thought we were
done with
done with
MPI I thought we' gotten over this era
MPI I thought we' gotten over this era
of stupidity but apparently not
oops and I also realized this is
oops and I also realized this is
covering
chat my
bad needs to up a dosage ah
maybe I might need to up my freaking
maybe I might need to up my freaking
coffee dosage
[Music]
yeah guys turn currently
uh talking up the on some stuff I don't
uh talking up the on some stuff I don't
even freaking know man
don't
know e
yeah I I don't think he knows what he
yeah I I don't think he knows what he
means C well Captain's not
watching that's not how that
works oh this only gets trained
config
e
e
e
e
e
e e
iing know does this
work apparently it does
cool apparently that does
do this
so this trains
at so this the default thing it trains
at so this the default thing it trains
at
at
580k 5 80ish
H now this does not
H now this does not
work go back to
two still does not work did I have
two still does not work did I have
something wrong
yes it runs
two no so it only runs at one so
two no so it only runs at one so
assumably that's multiple
assumably that's multiple
devices
probably
for
e
e e
okay so uh I keep having to answer stuff
okay so uh I keep having to answer stuff
on the side
and why is
and why is
it why are the first two links tutorials
it why are the first two links tutorials
instead of just docks it really that
bad okay World size
is
on example I don't want example I want
on example I don't want example I want
the freaking docks where's the
the freaking docks where's the
docks docs distributed data parallel and
docks docs distributed data parallel and
there is no freaking function
there is no freaking function
signature what is wrong with you
signature what is wrong with you
here it is here are the real docs
here it is here are the real docs
okay device
ID device
ideas
spawn so I guess World size is just
spawn so I guess World size is just
multiple devices
nccl is the fastest back
nccl is the fastest back
end
okay so the tutorial gave me the slow
okay so the tutorial gave me the slow
back end
okay so there's very little overhead
okay so there's very little overhead
there if any at all compared to single
processed e
the support
stuff
e
e e
is there a way that I can test this
is there a way that I can test this
without multiple gpus
is there a way I can do this
probably is but it's hard and doesn't
probably is but it's hard and doesn't
work I I could just go get a multi GPU
work I I could just go get a multi GPU
machine for
testing should I just do that real
testing should I just do that real
quick going do
that what's like a really easy way to do
that what's like a really easy way to do
that what's like a really easy way to
that what's like a really easy way to
just like get
just like get
a a uh multi-gpu machine for a couple
a a uh multi-gpu machine for a couple
hours I don't have any mine are all
hours I don't have any mine are all
single GPU
I mean you don't think it would be
I mean you don't think it would be
really easy there's so many freaking
really easy there's so many freaking
companies devoted to this that they
companies devoted to this that they
literally have like Renta trucks
literally have like Renta trucks
advertising GPU rental services driving
advertising GPU rental services driving
around
nups e
yes but I mean it's going to be a few
yes but I mean it's going to be a few
hours it'll be like 10 20 bucks whatever
there that will do
there that will do
it I could try vast as well but I think
it I could try vast as well but I think
those are personal machines right
those are personal machines right
right they don't have
uh do they have like multi uh multi
machines I I don't think that they have
machines I I don't think that they have
I mean multi-gpu machines
renting machine should not be hard oh
renting machine should not be hard oh
yeah here this is 4 490s
Bulgaria don't put any private data on
there all
there all
right let me Commit This
you are 100%
you are 100%
confident
confident
no you can test it we have the automated
no you can test it we have the automated
tests so if you commit it and it passes
tests so if you commit it and it passes
the the build tests then it probably
the the build tests then it probably
works it should do those for anything
works it should do those for anything
you anything you PR I'm pretty sure it
you anything you PR I'm pretty sure it
should run the the tests
or you can just copy the file and put it
or you can just copy the file and put it
in your
fork I'm not confident of anything
fork I'm not confident of anything
here let's do this on the puffer oneops
that's crazy that they don't have a
that's crazy that they don't have a
login button on their main page there we
login button on their main page there we
go and with
go and with
Google do
question
question
mark where it just go where did it just
mark where it just go where did it just
go oh it just made me an account it gave
go oh it just made me an account it gave
me a sign up page and then it just made
me a sign up page and then it just made
me an account off Google
me an account off Google
whatever
whatever
okay check your email for
verification this should be pretty quick
right e
I torch
vast that's kind of cool
you need to add a card
okay not show my card on stream by
mistake for
hang
hang
on let me make sure I can actually get
on let me make sure I can actually get
these machines
put 10 bucks on it real
put 10 bucks on it real
quick that was nice and
easy
uh where's that machine I
uh where's that machine I
wanted did somebody grab it already
wanted did somebody grab it already
come
on this looks good
right
right
this H2 200s what are those
this is view the instances page in the
this is view the instances page in the
sidebar in the sidebar
huh what are you actually doing that guy
huh what are you actually doing that guy
wants to
wants to
know what am I doing right now I'm just
know what am I doing right now I'm just
trying to see if I can test distributed
trying to see if I can test distributed
data parallel with p with uh with Puffer
cool
okay open Terminal
access open Jupiter
access open Jupiter
terminal for
cool can you get SSH to this
cool can you get SSH to this
thing probably not you probably have to
thing probably not you probably have to
set up stuff it's no big deal for now uh
set up stuff it's no big deal for now uh
let's go grab Docker I
guess or actually do I even need Docker
guess or actually do I even need Docker
I probably don't if this thing has pie
I probably don't if this thing has pie
torch on it right
wow this white scheme is God awful
no
V there's GDP right
they don't put GCC on your instance man
y'all got to get some better
y'all got to get some better
containers no
GCC your container should not be so
GCC your container should not be so
minified that I have to manually install
minified that I have to manually install
a
compiler e
so whoever said that uh renting GPU
so whoever said that uh renting GPU
machines is difficult
I forgot the dependencies
I actually don't know why people rent
I actually don't know why people rent
these things out to be
these things out to be
honest for the prices that they rent
honest for the prices that they rent
them this is why I own the hardware
them this is why I own the hardware
because it's like there's no way you can
because it's like there's no way you can
get these things consistently enough
I mean a140 a day they're making what
I mean a140 a day they're making what
th000 bucks a year a little
more yeah I mean you're hardly making
more yeah I mean you're hardly making
anything on them though like the whole
anything on them though like the whole
point of owning your own Hardware is you
point of owning your own Hardware is you
have it for yourself on demand when you
have it for yourself on demand when you
want it
pyro as
well hyro PPL
I think that's all I need for uh for
I think that's all I need for uh for
this
huh their gpus are somehow did they over
huh their gpus are somehow did they over
underclock the hell out of
them oh dude that's not cool what the
heck what did you do to your 490s
guys these guys are scamming
guys these guys are scamming
you look at
you look at
that I don't know how you fix
that I don't know how you fix
the the
theme can you do no that's
theme can you do no that's
syntax there we
go I think they scam you look I think
go I think they scam you look I think
that they have them way under clocked so
that they have them way under clocked so
that they don't spend anything on power
the
heck for
all right I mean we can still test it
rank zero and rank one both on cuded
rank zero and rank one both on cuded
device
is this like dictionary shared or
something
e
e e
got two
got two
rank I
see e
oh wait it's doing it
you see the like the super fast
refreshes yeah it's actually doing it
that's kind of
that's kind of
cool I didn't expect that to
work cool
so that's like 4X faster training you're
so that's like 4X faster training you're
not going to see it here but the way
not going to see it here but the way
that you can tell is that this stays the
that you can tell is that this stays the
same so this doesn't drop very much
same so this doesn't drop very much
there's very low overhead but you can
there's very low overhead but you can
see it ticks a whole bunch of updates
see it ticks a whole bunch of updates
really quick it's cuz it's actually
really quick it's cuz it's actually
doing four updates every
doing four updates every
time so that's cool
so um DDP not that
bad don't let me forget to close this
bad don't let me forget to close this
tonight but we're going to do a little
tonight but we're going to do a little
Dev over
here can you set up a guide on how to do
distributed
distributed
um the guide's just following the torch
um the guide's just following the torch
instructions I was just going to merge
instructions I was just going to merge
it do you want what do you want a guide
it do you want what do you want a guide
for something I mean I I don't know
for something I mean I I don't know
maybe it's a good article for x or
maybe it's a good article for x or
something
just a demo. p it's a little more than
just a demo. p it's a little more than
that but not much
this little bit of code this little bit
this little bit of code this little bit
of code added a
flag I the only thing is that the thing
flag I the only thing is that the thing
is uh all the dashboard just updates in
is uh all the dashboard just updates in
place so it just it updates four times
place so it just it updates four times
in place and the stats going to W be
in place and the stats going to W be
won't be
correct
e e
all reduce for summation
it's obnoxious isn't it
kind of gross
I guess we try something like this we
I guess we try something like this we
get this working and then we uh we try
get this working and then we uh we try
to Port it
to Port it
back oh it's nine already though isn't
back oh it's nine already though isn't
it
the thing is I feel good at the moment
the thing is I feel good at the moment
and I could keep going on
this I'll do just a little more on this
this I'll do just a little more on this
I don't want to be up too too late but
I don't want to be up too too late but
I'll do just a little more on
this let's Commit This for now
dude I've done my time all right my
dude I've done my time all right my
average bedtime in high school was like
average bedtime in high school was like
2 3 in the
2 3 in the
morning and I lived an hour
away I did my freaking time
stupid work does not require any sleep
stupid work does not require any sleep
because you can be stupid and still get
because you can be stupid and still get
it done smart work requires you to be
it done smart work requires you to be
well
rested also it's just a lot less
rested also it's just a lot less
miserable in general like there's
miserable in general like there's
basically no enjoyment to be had in life
basically no enjoyment to be had in life
if you have chronic sleep deprivation
if you have chronic sleep deprivation
it's like actually a form of torture
it's not even remotely an
exaggeration okay so there's this mean
exaggeration okay so there's this mean
and log operation
here
e e
what in the [ __ ] is
this
e
e
e
e
e
e
e e
I hear somebody trying to do DDP
I hear somebody trying to do DDP
somebody's done DDP it just requires uh
somebody's done DDP it just requires uh
some logging changes so that actually
some logging changes so that actually
make
sense and honest honestly why am I being
sense and honest honestly why am I being
stupid about this as well I should just
stupid about this as well I should just
do um actually I leave it as is damn
do um actually I leave it as is damn
it add log by rank in
it add log by rank in
front what do you
front what do you
mean log by rank
that's not what I want I don't want a
that's not what I want I don't want a
log per rank I want to take the uh I
log per rank I want to take the uh I
want a summer me
all reduces are
expensive well too bad if it can't do it
expensive well too bad if it can't do it
once per Epoch then what the hell if it
once per Epoch then what the hell if it
can't like reduce a few
scalers invalid device
oral I mean I can combine them into one
oral I mean I can combine them into one
all reduce
all reduce
later I just want it to work for
[Music]
let's put this somewhere up here
in a
block now what we're going to do a
block now what we're going to do a
block okay screw
block okay screw
you de
here e
data has no attribute device that's fine
handle closed [ __ ]
you late night coding I get a little
irritated got set up to Pi to pass test
did your test check for the garbage
did your test check for the garbage
compile
compile
Flags no
Flags no
idea using torch Runner writing this out
idea using torch Runner writing this out
by
by
hand what do you mean writing it out by
hand what do you mean writing it out by
hand is it so difficult to add like 10
hand is it so difficult to add like 10
lines of code
you could do that that's very
nice and then what we'll do is
this overview is
annoying just
annoying just
do yes
equals
EO and
this what do we do to check the
this what do we do to check the
rank check the
rank check the
rank this.g rank is zero
get rank not equal zero
get rank not equal zero
turn
turn
better let's torch run
better let's torch run
anyways I don't want things that take
anyways I don't want things that take
over my bloody command line and require
over my bloody command line and require
me to have a launch command that's not
me to have a launch command that's not
running the language that I'm coding
one day you too shall find the complete
one day you too shall find the complete
Zen
the Zen that
is writing your code not depending on
is writing your code not depending on
silly
things e
command from pie I don't want anything
command from pie I don't want anything
taking over my command
taking over my command
line I don't want
it everybody makes one of these bloody
it everybody makes one of these bloody
things
things
it's like no stop it give me anit
it's like no stop it give me anit
function I can call from my language
function I can call from my language
that I'm coding
in and also stop taking away control
in and also stop taking away control
over execution from me stop it
default process group has not been
initialized please make sure to call a
initialized please make sure to call a
net process
net process
group the hell does that mean I didn't
group the hell does that mean I didn't
think I had to do that
[ __ ] you can call the Run function
[ __ ] you can call the Run function
directly does it do anything then
directly does it do anything then
because the tutorial is pretty succinct
inet process group
huh oh this is the same this is the
huh oh this is the same this is the
garbage
right dude it's just this is [ __ ]
right dude it's just this is [ __ ]
engineering is all that this is I'm
engineering is all that this is I'm
surprised that so many places are
surprised that so many places are
actually using this the places not just
actually using this the places not just
made their own
distributed I mean literally people were
distributed I mean literally people were
doing like I mean people have been doing
doing like I mean people have been doing
MPI style stuff for how
long unironically Ray got the for all
long unironically Ray got the for all
the things that Ray screwed up they got
the things that Ray screwed up they got
the distributed API dead current like
the distributed API dead current like
dead on that's what they did
well and behold you just run functions
well and behold you just run functions
and then you run a loop and check when
and then you run a loop and check when
they're ready
well the comp the computation Paradigm
well the comp the computation Paradigm
is totally different you're right is
is totally different you're right is
probably a rapper well no actually they
probably a rapper well no actually they
like their the way their servers are set
like their the way their servers are set
up is quite different um their parameter
up is quite different um their parameter
servers and
servers and
stuff it's probably not great for small
stuff it's probably not great for small
models though
actor
framework yeah just having remote
framework yeah just having remote
classes yeah it's very
nice I uh I gave them the input on how
nice I uh I gave them the input on how
to design their debugger that's a fun
to design their debugger that's a fun
fact they came to me with like this
fact they came to me with like this
absolutely like insane deranged remote
absolutely like insane deranged remote
debugger setup and I was like all right
debugger setup and I was like all right
here this is pdb make it work remotely
here this is pdb make it work remotely
on your
on your
system and they went they did that so
system and they went they did that so
that was kind of cool
I like how it checks off its solution
I like how it checks off its solution
without actually running its own
code yeah I did
this ah this function was
missing why can't I copy C until it's
missing why can't I copy C until it's
done typing that's
silly oopsy whoopsie we forgot to spawn
silly oopsy whoopsie we forgot to spawn
oh there it is okay spawn Main
oh there it is okay spawn Main
and then you have to set
rank so anyways you're supposed to call
rank so anyways you're supposed to call
a nit process
a nit process
group I do that right don't I have this
group I do that right don't I have this
or do you have to call a nit process
or do you have to call a nit process
group
group
separately nit process yeah I do that
separately nit process yeah I do that
here it is and I just forgot set device
apparently Cuda do set device rank
oh you know what I'm not running it with
oh you know what I'm not running it with
GTP so it's probably complaining that I
GTP so it's probably complaining that I
can't check
that yeah you're
right hang on
how do you check if a disc is
enabled is there a way to check if dist
enabled is there a way to check if dist
isn't is an
is
is
initialized
perfect that's that's available not
perfect that's that's available not
initialized
right B Bing
bada bing bada
boom today has been a very funny stream
boom today has been a very funny stream
day in that it's been fairly active the
day in that it's been fairly active the
whole day hello twitch folks this is uh
whole day hello twitch folks this is uh
current Curr attempting to add
current Curr attempting to add
distributed support to puffer
distributed support to puffer
lib so people can train on their many
lib so people can train on their many
gpus that they have and we can have our
gpus that they have and we can have our
single GPU machines because they cost
less dist all reduce aha this is what
less dist all reduce aha this is what
happens when you forget to copy and
happens when you forget to copy and
paste your copy of pastable code
I've been cing a while getting
loopy well we test this for anyone who
loopy well we test this for anyone who
might be new
might be new
here puffer lib is an ultra high
here puffer lib is an ultra high
performance and very simple to use
performance and very simple to use
reinforcement learning library we train
reinforcement learning library we train
it a million steps per second on one GPU
it a million steps per second on one GPU
you can check it out on
you can check it out on
puff. we've got tons of
demos AEM tons of demos which presumably
demos AEM tons of demos which presumably
are not loading because my GP was busy
are not loading because my GP was busy
or something ridiculous yep literally
or something ridiculous yep literally
that's what it was that was
weird yeah there you go tons of
weird yeah there you go tons of
different RL environments you can check
different RL environments you can check
them out here they're all open source
them out here they're all open source
they're all ridiculously fast like
they're all ridiculously fast like
10,000 times real time they range from
10,000 times real time they range from
very simple to very
very simple to very
complex star the code to help us out
complex star the code to help us out
really helps us when people start the
really helps us when people start the
GitHub it's one of the main things we
GitHub it's one of the main things we
track you can join the Discord right
track you can join the Discord right
here discord.gg puffer you can also
here discord.gg puffer you can also
follow me on X for more RL content we've
follow me on X for more RL content we've
got a Blog here as well back to
got a Blog here as well back to
code okay so this now
code okay so this now
runs uh apparently I killed the machine
runs uh apparently I killed the machine
so we'll do
ddb
ddb
DDP this could be a
call to
call to
dism it could
be that'd be too smart though wouldn't
be that'd be too smart though wouldn't
it
uh no it can't
uh no it can't
because the
because the
initialized you forgot
this bam
yourself let's see if this is
logging so calls is
logging so calls is
initialized yeah and then what'll happen
initialized yeah and then what'll happen
is you'll get this value right and then
is you'll get this value right and then
it'll try to get the world size and
it'll try to get the world size and
they'll say it's not
they'll say it's not
initialized but
don't I think you got yourself
process group has not been
process group has not been
destroyed how do you destroy the process
destroyed how do you destroy the process
group just destroy process group lovely
okay so uh I guess what we do is we push
okay so uh I guess what we do is we push
this
and we tried this on our rented poty
and we tried this on our rented poty
machine which is actually a very nice
machine which is actually a very nice
machine that I think has been
machine that I think has been
underclocked to become a poverty machine
underclocked to become a poverty machine
because it is about the same speed no
because it is about the same speed no
it's about a third of the speed per card
it's about a third of the speed per card
as my local desktop
is for
make sure that still
runs
okay get these w b
okay get these w b
credentials wrong window
box seven is down again what do you keep
box seven is down again what do you keep
doing to box seven my guy what do you
doing to box seven my guy what do you
keep doing do
it I have to put Ram limits on these
it I have to put Ram limits on these
things you guys just oh like out of
things you guys just oh like out of
memory them
constantly cuz Spencer said it turns out
constantly cuz Spencer said it turns out
he was just out of memory his box
constantly I did plug in a
constantly I did plug in a
monitor I actually plugged in a monitor
monitor I actually plugged in a monitor
for the next time that it went down so
for the next time that it went down so
if I go out there it's probably up oops
if I go out there it's probably up oops
if I go out there that's it's just a WB
if I go out there that's it's just a WB
key nothing
key nothing
crazy uh if I do go out there I should
crazy uh if I do go out there I should
get
something cuz I out of memory
something cuz I out of memory
sporadically so you are taking the box
sporadically so you are taking the box
down damn it
well we will get uh some logs hopefully
well we will get uh some logs hopefully
if the monitor
Works put Ram limits y the no I think
Works put Ram limits y the no I think
one box has auntu most of them have
one box has auntu most of them have
Debian we're going to move to auntu
Debian we're going to move to auntu
though because I'm sick of dealing with
though because I'm sick of dealing with
Debian I thought it would be more stable
Debian I thought it would be more stable
it's not it's kind of
[ __ ] I thought I was being clever like
[ __ ] I thought I was being clever like
I'm going to put Debian on him instead
I'm going to put Debian on him instead
of buntu cuz I'm a smart guy
of buntu cuz I'm a smart guy
and it's just like no you're stupid what
and it's just like no you're stupid what
are you
are you
doing stop doing
that not logging interesting enough
that not logging interesting enough
enough okay we do get system logs but
enough okay we do get system logs but
that's
it status B was
integrated I got that thing uh I gave
integrated I got that thing uh I gave
linky the PRM integrate that quick
enough no it's in half
Bots it's been
there my guy has been there what you
doing for
it's a public Channel what are you
it's a public Channel what are you
talking about
did you have this collapsed or
something there are very few public
something there are very few public
channels
how do you not have access to that
how do you not have access to that
channel it's [ __ ] public
oh
oh
oops my
oops my
bad I'm stupid my
bad see you
that's where you guys were no they
that's where you guys were no they
aren't private it's just
Bots nothing interesting
there
there
hey it works
some
desps agent
steps never
seen uh at the moment I think we don't
seen uh at the moment I think we don't
have anything private on here I like
have anything private on here I like
I've locked like the old support channel
I've locked like the old support channel
so people don't post in it by
so people don't post in it by
mistake we might do some private
mistake we might do some private
channels in the future for like
channels in the future for like
customers and stuff but I've avoided it
customers and stuff but I've avoided it
just because I'll like accidentally leak
just because I'll like accidentally leak
those all the time right because I'll
those all the time right because I'll
just have Discord open on stream
no most of them are
Debian they should be a bun to but
Debian they should be a bun to but
they're
they're
not I mean this
works so that's pretty solid
that being unsafe no it's just uh it's
that being unsafe no it's just uh it's
annoying because it doesn't have drivers
annoying because it doesn't have drivers
for new
for new
gpus and that's that's just a standard
gpus and that's that's just a standard
out of memory there's nothing special
out of memory there's nothing special
about the
about the
OS cool so this
works
e
e
e
e e
what's a cool thing I could do for
this just put
the the star
chart e
that's pretty
nice okay
nice okay
well I got some cool emails to send to
well I got some cool emails to send to
people it's going to take a little bit
people it's going to take a little bit
more work but I'm you know I'm happy
more work but I'm you know I'm happy
that doesn't that look pretty easy uh we
that doesn't that look pretty easy uh we
are going to kill this fast instance
are going to kill this fast instance
before I forget
get we'll just stop it
I mean this has got to
be yeah no we're just going to get rid
be yeah no we're just going to get rid
of
of
this CU I'll forget otherwise
cool
cool
[Music]
[Music]
um that's pretty nice for uh just a
um that's pretty nice for uh just a
couple hours of work in the evening
couple hours of work in the evening
right preliminary multi-gpu I mean the
right preliminary multi-gpu I mean the
thing is we're not going to use it a ton
thing is we're not going to use it a ton
for what we do cuz we do uh mostly
for what we do cuz we do uh mostly
single GPU stuff but hey it's nice to
single GPU stuff but hey it's nice to
know that maybe we can get a tiny box
know that maybe we can get a tiny box
and maybe we can like you know do some
and maybe we can like you know do some
larger stuff on it if we want um and hey
larger stuff on it if we want um and hey
it'll be really nice for industry folks
it'll be really nice for industry folks
cuz a couple of people people have asked
cuz a couple of people people have asked
me in industry and uh I guess it's a
me in industry and uh I guess it's a
good time to say this is a company as
good time to say this is a company as
well it's all free and open source stuff
well it's all free and open source stuff
we don't sell the software we just sell
we don't sell the software we just sell
service it's Service as a service not
service it's Service as a service not
software as a service so if you're in an
software as a service so if you're in an
RL company or company that needs some RL
RL company or company that needs some RL
check that out but uh for the most part
check that out but uh for the most part
all software here start on GitHub to
all software here start on GitHub to
support really helps us out I work on
support really helps us out I work on
this full time and uh you can check out
this full time and uh you can check out
our environments right on the website
our environments right on the website
we've got a nice blog join the Discord
we've got a nice blog join the Discord
and follow on X I will be back tomorrow
and follow on X I will be back tomorrow
streaming more Dev probably first thing
streaming more Dev probably first thing
in the morning as usual uh I'm going to
in the morning as usual uh I'm going to
be working on a combination of
be working on a combination of
hyperparameter sweeps and a few other
hyperparameter sweeps and a few other
things speaking of which I would like to
things speaking of which I would like to
at least run one experiment overnight so
at least run one experiment overnight so
let's just set that up
my score the protein sweep
my score the protein sweep
Auto 1
Auto 1
E9 really should not need 1
E9 really should not need 1
E9 6
E9 6
e
e
8 do like
this Min 28
188 we'll see what this
188 we'll see what this
does
does
breakout
sweep mode
sweep mode
breakout uh sweep Neptune and then tag
I forgot my API token let's get
I forgot my API token let's get
that and this will just be some
that and this will just be some
experiments to run uh overnight and
experiments to run uh overnight and
we'll see how those
we'll see how those
go this is just all testing for the new
go this is just all testing for the new
algorithm that I'm going to be shipping
algorithm that I'm going to be shipping
as soon as tests are done
cool so hopefully this doesn't break on
cool so hopefully this doesn't break on
us we will see uh I don't know I'll
us we will see uh I don't know I'll
check it after I go brush my teeth and
check it after I go brush my teeth and
stuff thank you for tuning in it's been
stuff thank you for tuning in it's been
a fun stream day had lots of cool
a fun stream day had lots of cool
conversations on stream and fair few
