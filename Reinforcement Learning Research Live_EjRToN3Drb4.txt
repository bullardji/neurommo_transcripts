Kind: captions
Language: en
Good morning.
Be live here.
Be live here.
That's working. Hi.
Few things to work on today.
Okay, so still the drone stuff to figure
Okay, so still the drone stuff to figure
out. I don't think the experiments went
out. I don't think the experiments went
super great on this overnight. Uh, I
super great on this overnight. Uh, I
didn't really have time to queue up
didn't really have time to queue up
stuff the way I wanted to. I don't think
stuff the way I wanted to. I don't think
it
I kind of don't want to spend a whole
I kind of don't want to spend a whole
bunch of time today just fiddling with
bunch of time today just fiddling with
the drone stuff when I think it's
the drone stuff when I think it's
mostly a uh a problem of automated
mostly a uh a problem of automated
automating the experiments at this
automating the experiments at this
point. It seems like it should be pretty
point. It seems like it should be pretty
stable.
Let's see what happened to guy here,
Let's see what happened to guy here,
right?
right?
drone 10 bill
got all these like weird jumps in it,
got all these like weird jumps in it,
right?
Yeah. And then this PF is
kind of weird.
kind of weird.
I think it crashed actually because this
I think it crashed actually because this
looks like Yeah, this is only a three
looks like Yeah, this is only a three
bill.
bill.
It must have crashed.
That's a bit annoying, right?
Yeah, you can see we have ns in here.
And we've seen this before in a lot of
And we've seen this before in a lot of
different I don't think this is bug. I
different I don't think this is bug. I
think we just have some stability stuff
think we just have some stability stuff
that we need to uh prove.
that we need to uh prove.
And as as you get longer and longer
And as as you get longer and longer
runs, write larger and larger
runs, write larger and larger
experiments, you run into these edge
experiments, you run into these edge
cases way more often.
trying to think what the best way is to
trying to think what the best way is to
approach this.
Like I kind of want to just run an
Like I kind of want to just run an
automated sweep on this and work on
automated sweep on this and work on
other stuff for a bit because I do think
other stuff for a bit because I do think
that there are hyper prim in here that
that there are hyper prim in here that
should dissolve it,
should dissolve it,
right?
But
But
we do end up getting nanned out. A lot
we do end up getting nanned out. A lot
of them
like fixing the nan thing is going to
like fixing the nan thing is going to
actually be
actually be
that's like something I'm going to do in
that's like something I'm going to do in
the next big engineering task cuz that's
the next big engineering task cuz that's
actually going to be a fair bit of work.
I might just give myself like a small
I might just give myself like a small
budget of time to mess with it manually
budget of time to mess with it manually
just for a little bit.
just for a little bit.
If I can get something stable.
I think that's going to uh
I think that's going to uh
best option here.
best option here.
Like
Like
if I do this,
our starting point,
our starting point,
right?
right?
We like fit this to the
start here and then we'll see.
We'll do two bill
We'll do two bill
10 minute experiment is not ideal but
10 minute experiment is not ideal but
terrible.
terrible.
Use this time to start sort of thinking
Use this time to start sort of thinking
about some other stuff in the process.
Another day, another M script activate.
Well, I guess when we do use MS, we have
Well, I guess when we do use MS, we have
UV, so it'll be a little different from
UV, so it'll be a little different from
that. But yeah,
there's a whole bunch of new stuff I
there's a whole bunch of new stuff I
want to start on to be fair. Um, we're
want to start on to be fair. Um, we're
not just going to do drone things all
not just going to do drone things all
day today. I'm
day today. I'm
going to give myself a little time to
going to give myself a little time to
just fiddle with this a bit since seems
just fiddle with this a bit since seems
like for whatever reason on this
like for whatever reason on this
specific end we have more instability
specific end we have more instability
when running automated experiments. You
when running automated experiments. You
tend to like crash some stuff.
But after this we've got stuff to do on
But after this we've got stuff to do on
meta which is this uh like grid based
meta which is this uh like grid based
kind of factoryes and
kind of factoryes and
need to get like some basic basic things
need to get like some basic basic things
running on this.
uh later in the week on that. Have a
uh later in the week on that. Have a
head start.
Welcome to the folks on YouTube.
I have a couple new projects. Well, I
I have a couple new projects. Well, I
actually have several new projects in
actually have several new projects in
mind that would all be like relatively
mind that would all be like relatively
simple to get started on like at least
simple to get started on like at least
wouldn't take a huge amount of time.
wouldn't take a huge amount of time.
Um the project in material science I
Um the project in material science I
just started uh discussing with the
just started uh discussing with the
material scientists Stanford yesterday.
material scientists Stanford yesterday.
I think would be very cool for research
I think would be very cool for research
stuff we can do in robotics. I have um I
stuff we can do in robotics. I have um I
I've started like looking into how we
I've started like looking into how we
would do our own 60F arm sim
would do our own 60F arm sim
do that. That'd be a little bit of math
do that. That'd be a little bit of math
but it would not terrible I think.
but it would not terrible I think.
Uh and then there's also this power
Uh and then there's also this power
optimization problem.
optimization problem.
There's a lab that would be very very
There's a lab that would be very very
happy if we gave them them for that.
Lots and lots of applications to
Lots and lots of applications to
really the main bottleneck at the moment
really the main bottleneck at the moment
is just how many meetings I've got. Kind
is just how many meetings I've got. Kind
of getting my mind out of the dev swing.
of getting my mind out of the dev swing.
Awesome to catch you live. Just started
Awesome to catch you live. Just started
recording my Hearthstone clone puffer.
recording my Hearthstone clone puffer.
Well, that's awesome. So, uh, let me
Well, that's awesome. So, uh, let me
show you something. I don't think we
show you something. I don't think we
ever uploaded the there's a probably an
ever uploaded the there's a probably an
open PR for this. I just haven't merged.
open PR for this. I just haven't merged.
Uh it's Noah in the discord that uh
Uh it's Noah in the discord that uh
helped us. I did the initial bit.
helped us. I did the initial bit.
Okay. So there's this Magic the
Okay. So there's this Magic the
Gathering style clone here and uh we
Gathering style clone here and uh we
have some good ways to design this so
have some good ways to design this so
that it's useful for RL. So like you can
that it's useful for RL. So like you can
play a land and play a zero cost one one
play a land and play a zero cost one one
pass or you attack you swing
pass or you attack you swing
block play my land I play my uh two mana
block play my land I play my uh two mana
3 three
3 three
that's all I can do attack phase
that's all I can do attack phase
you know so on and so forth
you know so on and so forth
we have um
we have um
we have like really good ways to set
we have like really good ways to set
this stuff up for RL
this stuff up for RL
if you want to chat about that at some
I think the very important thing to
I think the very important thing to
getting it to work is going to be to as
getting it to work is going to be to as
much as possible just make it like the
much as possible just make it like the
whole UI of this I'm literally just
whole UI of this I'm literally just
pressing the buttons one through nine
pressing the buttons one through nine
and enter. So I've gotten it down to a
and enter. So I've gotten it down to a
very small number of button combos to
very small number of button combos to
take all the actions. That makes a big
take all the actions. That makes a big
difference.
Okay. So, we are still stuck on or
Okay. So, we are still stuck on or
whatever.
whatever.
Go check the
the episode return here and
not super great.
Going to start getting better set up.
Going to start getting better set up.
Trying to remember.
Trying to remember.
I have to do this on the remote, right?
Got to do this on vote.
Is it worth doing a sort of OCR
Is it worth doing a sort of OCR
technique the cards
technique the cards
got the number
got the number
definitely don't want to be doing like
definitely don't want to be doing like
from pixels hardstone
from pixels hardstone
that's going to be terrible.
that's going to be terrible.
You don't like if you're building the
You don't like if you're building the
sim, you don't need to do that, right?
sim, you don't need to do that, right?
Because like just have the numbers in
Because like just have the numbers in
the sim and you can observe them
the sim and you can observe them
directly.
Once you're talking about doing OCR on
Once you're talking about doing OCR on
pixels, you're like you're basically
pixels, you're like you're basically
you've lost by about five orders of
you've lost by about five orders of
magnitude in speed already.
You see this number here?
You see this number here?
This says that it's doing 3.1 million
This says that it's doing 3.1 million
interactions with the environment per
interactions with the environment per
second.
second.
That's training on 3.1.
That's training on 3.1.
So
So
if the drone is I think what are we
if the drone is I think what are we
doing hertz or 50 hertz or something
doing hertz or 50 hertz or something
like that let's call it 50 htz even so
like that let's call it 50 htz even so
that is what
thousand seconds I believe of data
thousand seconds I believe of data
second of interaction thousand seconds
second of interaction thousand seconds
per second uh that is almost 20 hours of
per second uh that is almost 20 hours of
data or like 17ish hours data every
data or like 17ish hours data every
single second.
A lot of data
actually you just divide this number by
actually you just divide this number by
50, right? You divide by 50, you get
50, right? You divide by 50, you get
your Did I say 60? Yeah, 60,000. It's
your Did I say 60? Yeah, 60,000. It's
running at 60,000 times real.
Learn it physics engine.
Learn it physics engine.
Learn
Learn
physics engine.
If you want to learn the physics engine
If you want to learn the physics engine
itself,
I've seen some stuff in this area. I I
I've seen some stuff in this area. I I
don't know if it works generally.
don't know if it works generally.
So the thing with RL, right, is as long
So the thing with RL, right, is as long
as you actually have access to P
as you actually have access to P
simulator dynamics randomize,
simulator dynamics randomize,
uh, it tends to be self-correcting,
uh, it tends to be self-correcting,
right? So like rather than the drone,
right? So like rather than the drone,
and this is the thing we're going to try
and this is the thing we're going to try
to get as well, we're going to try to
to get as well, we're going to try to
set this up so that rather than having
set this up so that rather than having
errors between the sim and the real
errors between the sim and the real
world accumulate,
world accumulate,
agent's actually going to be
agent's actually going to be
selfcorrecting,
selfcorrecting,
right? such that if the if its actions
right? such that if the if its actions
don't produce exactly the effect that it
don't produce exactly the effect that it
desires,
desires,
it will see that instantly
it will see that instantly
automatically correct core. That's the
automatically correct core. That's the
really cool thing that you can do with
really cool thing that you can do with
RL.
RL.
And we actually have some decent
And we actually have some decent
evidence.
evidence.
Um the problem is when you replace the
Um the problem is when you replace the
sim with an approximation of the sim
sim with an approximation of the sim
that like fails in like qualitatively
that like fails in like qualitatively
quite different ways.
quite different ways.
I don't know whether you get that same
I don't know whether you get that same
thing or you get the opposite which is
thing or you get the opposite which is
errors compounding.
Definitely don't want that one.
Exponentially compounding errors is very
Exponentially compounding errors is very
bad.
You guys are doing practical. We're
You guys are doing practical. We're
trying to be practical here, right? I
trying to be practical here, right? I
mean, this is a it's a research lab, but
mean, this is a it's a research lab, but
uh it's we're not doing research just
uh it's we're not doing research just
like to make ourselves feel clever,
like to make ourselves feel clever,
right? We're trying to actually solve
right? We're trying to actually solve
problems with it.
High performance sim in general seems
High performance sim in general seems
like a good tool, like good investment,
like a good tool, like good investment,
right? Being able to learn from large
right? Being able to learn from large
quantities of interaction data like a
quantities of interaction data like a
very good investment.
very good investment.
And we're sort of just spiraling out
And we're sort of just spiraling out
into different application areas looking
into different application areas looking
for problems that okay, we have this
for problems that okay, we have this
core fundamental tech. What can we solve
core fundamental tech. What can we solve
mostly how I look at things
trying to think what I can do about this
trying to think what I can do about this
drone sim not working amazingly well.
It just be the data ratios.
Could literally just
ratios, right?
ratios, right?
Well, let's actually at least have
Let's see if I can get them to like not
Let's see if I can get them to like not
facing
There's probably just some stuff we can
That's That's not any good.
Did rings pass go up.
Oh, you know what? This actually did
Oh, you know what? This actually did
kind of go up.
kind of go up.
Let me at least eval this locally
Let me at least eval this locally
because this might
because this might
this might kind of be worth something.
Get rid of
all right. So, here is uh the racing
all right. So, here is uh the racing
policy. Good.
policy. Good.
Here's our like go to wherever
Here's our like go to wherever
kind of drift around and do your thing.
like kind of a thing, but it's not
like kind of a thing, but it's not
brilliant, right?
How about the flag? The flag is like a
How about the flag? The flag is like a
really visually obvious one. Works.
Yeah. Really not
Yeah. Really not
not doing it this side. Okay.
not doing it this side. Okay.
Well, we'll play with this.
Definitely play with this.
bring any of the flag task
doing land robots not flying yet.
Well, I actually we're starting with the
Well, I actually we're starting with the
air ones because we don't have to do
air ones because we don't have to do
contact
contact
just like way easier.
just like way easier.
People have asked us about like
People have asked us about like
quadripeds.
quadripeds.
I don't know. I think we could probably
I don't know. I think we could probably
eventually do quadripeds.
I think I'd be more interested though in
I think I'd be more interested though in
um like a six degree of freedom arm
would probably be ideal.
would probably be ideal.
Actually, I got to ask a roboticist why
Actually, I got to ask a roboticist why
all the arms are six degrees of freedom.
all the arms are six degrees of freedom.
Like what can you do with six degrees
Like what can you do with six degrees
that you can't do with four? Is it like
that you can't do with four? Is it like
one,
one,
two,
two,
is it two joints on a six degree arm or
is it two joints on a six degree arm or
is it
two joints?
Yeah. No, it is. It's like
Is it three joints?
Is it three joints?
Yeah.
Yeah.
Oh, it's because you can't do wrists,
Oh, it's because you can't do wrists,
right? It's because you don't have the
right? It's because you don't have the
ball socket for uh for a wrist that you
ball socket for uh for a wrist that you
have to do it.
have to do it.
Quad spiders doing wrestling is good.
Quad spiders doing wrestling is good.
You have like physical. You have it on
You have like physical. You have it on
real hardware doing wrestling. That's
real hardware doing wrestling. That's
cool.
Should try our RL stack.
Like our RL is probably just going to be
Like our RL is probably just going to be
way simpler and faster.
way simpler and faster.
the stuff out there.
the stuff out there.
Plus, we just we have our own algorithm,
Plus, we just we have our own algorithm,
right?
right?
Be better than whatever PO
Be better than whatever PO
implementation.
Let's get him. Lag
Let's get him. Lag
virtual semi. Okay. not that far off
virtual semi. Okay. not that far off
from what we're
from what we're
Yeah, definitely try our algo then. See
Yeah, definitely try our algo then. See
if it just works better for you.
Uh yeah, let's just let's get the flag
Uh yeah, let's just let's get the flag
while I'm chatting here. Let's let's get
while I'm chatting here. Let's let's get
the flag baseline. I'm going to start
the flag baseline. I'm going to start
messing with this. I think that there
messing with this. I think that there
are like some things I want to tweak
are like some things I want to tweak
with collision.
with collision.
My first time seeing this. taking
My first time seeing this. taking
inspiration from nature.
inspiration from nature.
Um
Um
the inspiration is very loose at best. I
the inspiration is very loose at best. I
would say
would say
it is sort of in the sense that you have
it is sort of in the sense that you have
very local rewards that produce global
very local rewards that produce global
behaviors. I suppose
I have a lot of material on RL for
I have a lot of material on RL for
beginners on my uh my X articles tab.
beginners on my uh my X articles tab.
Right.
So, at least now we have a decent dev
So, at least now we have a decent dev
cycle, right? This is like one minute.
We're just going to go off of Perf.
Might have to up the learning rate. See
So, I the thing that I want to mess with
So, I the thing that I want to mess with
here.
Yeah. See, it's a multiplicative reward.
Yeah. See, it's a multiplicative reward.
Probably bad.
It does end up learning this pretty
It does end up learning this pretty
well. I think
with a 1.4% collision rate, right?
See
if this changes anything. Just I sort of
if this changes anything. Just I sort of
realize there's a bit of an issue
realize there's a bit of an issue
doing it before.
Hey Aar, what do you think about gold
Hey Aar, what do you think about gold
medal immo?
medal immo?
Yeah, that's kind of crazy.
Yeah, that's kind of crazy.
Um, I don't understand how it is that
Um, I don't understand how it is that
they have IMO AI before they have AI
they have IMO AI before they have AI
that can do any of the super basic
that can do any of the super basic
programming that I do for all of this.
programming that I do for all of this.
But somehow we live in a world where we
But somehow we live in a world where we
have gold medal metal imo AI that like
have gold medal metal imo AI that like
can't do basic autonomous programming.
can't do basic autonomous programming.
The gold code. Yes.
I've been meaning to read your paper
I've been meaning to read your paper
with Ken by the way. I have not gotten
with Ken by the way. I have not gotten
the chance to. I really should.
The thing is like math is not and maybe
The thing is like math is not and maybe
I'm wrong. Maybe I put it on too much of
I'm wrong. Maybe I put it on too much of
a pedestal, but I math really isn't that
a pedestal, but I math really isn't that
structured and narrow, right? It really
structured and narrow, right? It really
is this crazy
is this crazy
crazy search and exploration task, isn't
crazy search and exploration task, isn't
it?
I mean, heck, like writing the code is
I mean, heck, like writing the code is
not
not
it really requires not that much
it really requires not that much
creativity what I'm doing here, right?
creativity what I'm doing here, right?
Like a lot of stuff is just like keeping
Like a lot of stuff is just like keeping
things simple and not trying to make
things simple and not trying to make
yourself feel clever at
yourself feel clever at
writing bad code.
Oh.
Oh.
Hey guys, I just made it way better.
Hey guys, I just made it way better.
There you go. My rewards were dumb.
There you go. My rewards were dumb.
and uh 1%.
and uh 1%.
That's like a pretty solid improvement.
Want to like uh let's just let's see
Want to like uh let's just let's see
real quick how this looks.
real quick how this looks.
200 million steps. So, one minute for
200 million steps. So, one minute for
flag behavior.
Yeah, if you wait around a second at
Yeah, if you wait around a second at
Cart, we'll show you drones forming an
Cart, we'll show you drones forming an
American flag.
Been having fun with these.
Let me I'll read your comment on this
Let me I'll read your comment on this
thing.
Okay.
Okay.
Happy
think I have to switch the task on. This
think I have to switch the task on. This
is D.
They're only trained on the flag T.
They're only trained on the flag T.
Okay.
not randomized.
To be fair, these are like all sorts of
To be fair, these are like all sorts of
different shaped kind of hard for them.
different shaped kind of hard for them.
Nice. This doesn't look quite as good as
Nice. This doesn't look quite as good as
it should, though. I think that I didn't
it should, though. I think that I didn't
fully Oh, you know what it is? It's that
fully Oh, you know what it is? It's that
I didn't change the reward. So, yeah, I
I didn't change the reward. So, yeah, I
got to commit it to get it to look
got to commit it to get it to look
exactly the same.
exactly the same.
like the paper but it implies a lot of
like the paper but it implies a lot of
things for neurations learned by SG.
things for neurations learned by SG.
Does it actually apply apply imply a lot
Does it actually apply apply imply a lot
of things or is it like imply that the
of things or is it like imply that the
old theory is bad?
old theory is bad?
I will have to go look.
I will have to go look.
You do this every day?
You do this every day?
Uh pretty much I do take days off
Uh pretty much I do take days off
occasionally.
occasionally.
I also have meetings that I don't don't
I also have meetings that I don't don't
stream
stream
my dev. I stream. Yeah,
I should actually make this work real
I should actually make this work real
quick cuz this will look really cool if
quick cuz this will look really cool if
I
made it real quick.
I wish I had my
I wish I had my
high-end local box. I should probably
high-end local box. I should probably
just buy another one. Bought so many
just buy another one. Bought so many
damn desktops. Kind of sick of setting
damn desktops. Kind of sick of setting
new up
and hang on.
us.
Our
paper basically says optimization
paper basically says optimization
creates messy neural representations
on policy and
on policy and
everything is kind of like slightly off
everything is kind of like slightly off
policy.
Essie
there work like that literally the more
there work like that literally the more
you optimize the better the
you optimize the better the
representations get more compressed they
representations get more compressed they
get
get
sentiment neuron stuff and stuff
sentiment neuron stuff and stuff
interpretability work,
not much creativity, I think.
But me saying that there's not much
But me saying that there's not much
creativity in a lot of the sim work I
creativity in a lot of the sim work I
do.
do.
I mean, the creativity came from like
I mean, the creativity came from like
how to set it up the way that it's now
how to set it up the way that it's now
easy and straightforward.
easy and straightforward.
It's not that bad at the moment.
Generational. Oh, yeah. This is way
Generational. Oh, yeah. This is way
better. Yeah. So, here we go. There's
better. Yeah. So, here we go. There's
your flag.
your flag.
Keep in mind the drones are all
Keep in mind the drones are all
different sizes, so they all control
different sizes, so they all control
differently.
differently.
But yeah, that's a pretty clean American
But yeah, that's a pretty clean American
flag.
If I give it the exact same drone for
If I give it the exact same drone for
all of them and it's like a perfect
all of them and it's like a perfect
flag.
flag.
But yeah, this is and you can see they
But yeah, this is and you can see they
like they self-organized.
like they self-organized.
This is trained in one minute, right?
This is trained in one minute, right?
Yes, it shared weight. So that's the
Yes, it shared weight. So that's the
tricky thing, right? It's shared weight.
tricky thing, right? It's shared weight.
But if you look at the drones, look, do
But if you look at the drones, look, do
you see how they're completely like some
you see how they're completely like some
of them are bigger, some of them are
of them are bigger, some of them are
smaller? They have all different
smaller? They have all different
weights, inertia, all sorts of different
weights, inertia, all sorts of different
parameters. And the agent can't see
parameters. And the agent can't see
these parameters. So basically, the
these parameters. So basically, the
agent has to do online system
agent has to do online system
identification in the weights of the LS
identification in the weights of the LS
in the latent space LSTM
in the latent space LSTM
in order to do this.
in order to do this.
So it's like dramatically harder to do
So it's like dramatically harder to do
this than it is to do it for a single
this than it is to do it for a single
drone. I'll show you the difference if I
drone. I'll show you the difference if I
just do it for a single drone with like
just do it for a single drone with like
how easy it is by comparison.
how easy it is by comparison.
It's kind it's like implicit meta RL I
It's kind it's like implicit meta RL I
guess you could say. We're just doing
guess you could say. We're just doing
this for robustness. Um but here I'll
this for robustness. Um but here I'll
show you the difference.
I mean this is just the type of stuff
I mean this is just the type of stuff
that would like never work correctly
that would like never work correctly
before when things were slow but now it
before when things were slow but now it
kind of works with stuff being fast. Let
kind of works with stuff being fast. Let
me get you this
me get you this
take like one minute.
take like one minute.
We had like what 967 before like
you can also so I have it working now
you can also so I have it working now
that you can have the drones do a ton of
that you can have the drones do a ton of
different formations with one policy.
different formations with one policy.
All the drones do different formations
All the drones do different formations
or you can have the drones like race.
or you can have the drones like race.
Um but you I can't yet get them cleanly
Um but you I can't yet get them cleanly
racing and doing formations. That's the
racing and doing formations. That's the
next thing.
next thing.
One policy just does all drones.
Yeah, I've known about that for a bit.
Yeah, I've known about that for a bit.
A'll
A'll
be good.
be good.
I want to steal him for some nut hack
I want to steal him for some nut hack
work officially starts.
[Music]
Okay, so the collision rate is down like
Okay, so the collision rate is down like
about half of what it was before
about half of what it was before
already.
Perf is a bit higher as well. One drone.
Perf is a bit higher as well. One drone.
Let's uh let's see what this looks like.
Let's uh let's see what this looks like.
I think it should be pretty clean.
takes ages to train.
A minute too long for training for you.
With anything other than pop, this would
With anything other than pop, this would
literally take over. You'd have to
literally take over. You'd have to
overnight this.
I could probably optimize the dev loop
I could probably optimize the dev loop
quite a bit more to be fair and I should
quite a bit more to be fair and I should
put the time in to do that.
put the time in to do that.
Can only spend so much time optimizing
Can only spend so much time optimizing
dev loop.
All right, so here is
Yeah, look way cleaner flag, right? This
Yeah, look way cleaner flag, right? This
is basically spot on
like a school of fish where they try to
like a school of fish where they try to
avoid each other as well. Like when one
avoid each other as well. Like when one
of them gets out of place, they all kind
of them gets out of place, they all kind
of shift around it a little bit. Like
of shift around it a little bit. Like
this guy was like, "Hey, get out of my
this guy was like, "Hey, get out of my
way. How you doing? You're in my spot."
way. How you doing? You're in my spot."
Yeah, Magnus.
Okay. I mean, so this just works.
I actually am kind of happy that like
I actually am kind of happy that like
it's not fully perfect because you can
it's not fully perfect because you can
kind of see like this guy doesn't know
kind of see like this guy doesn't know
what to do because this guy's in his
what to do because this guy's in his
spot.
spot.
This guy's probably doesn't know what to
This guy's probably doesn't know what to
do because this guy's in his spot. So
do because this guy's in his spot. So
it's like a school of fish.
Now this guy's like
Now this guy's like
they only see local neighborhood. Uh
they only see local neighborhood. Uh
they see their goal and they literally
they see their goal and they literally
only see the nearest drone to them.
They don't see very much at all.
Back to the randomized variant. That's
Back to the randomized variant. That's
actually like hard.
I mean, so based on this
the full task again. Maybe
not quite the full task. I think we do
not quite the full task. I think we do
this one.
Oh, yeah. I know, right? You see the
Oh, yeah. I know, right? You see the
neural MMO 3 policies though, Aar?
neural MMO 3 policies though, Aar?
Because if you've seen the neural MMO 3
Because if you've seen the neural MMO 3
stuff, like basically there's almost
stuff, like basically there's almost
nothing I should be able to do that's
nothing I should be able to do that's
surprising at
like a crazy policy.
I think it's just it doesn't really
I think it's just it doesn't really
matter though. It's like a two line of
matter though. It's like a two line of
code change one or the other.
This is probably not trained for long
This is probably not trained for long
enough here is my guess for all these
enough here is my guess for all these
tasks. We'll see.
Low 90 is
Low 90 is
good though.
Higher.
Higher.
No. 3% collisions. Fine.
So, this is the multitask setup.
So, this is the multitask setup.
This is training the drones for bunch of
This is training the drones for bunch of
different formations. I'm not expecting
different formations. I'm not expecting
this one to be amazing
this one to be amazing
because
because
all these different tasks and I didn't
all these different tasks and I didn't
train for any longer to compensate.
train for any longer to compensate.
Right.
Right.
We can absolutely train this for longer
We can absolutely train this for longer
and get something better. But I just
and get something better. But I just
want to test if the changes that I made
want to test if the changes that I made
actually help over
actually help over
think we should get at least
set
set
Uh,
oh yeah, there was also there's a guy
guy I want to chat with about um
guy I want to chat with about um
Pokemon followup search.
How many I missed?
[Music]
All right, here we go. That runs now.
Okay, so this go diffuse task. This
Okay, so this go diffuse task. This
fine.
fine.
The hover in place task
The hover in place task
mostly hovering in place. Little bit
mostly hovering in place. Little bit
off.
off.
Little bit off.
Definitely way better than the racing
Definitely way better than the racing
model because this is like pretty close
model because this is like pretty close
to a sphere, right?
Follow task. Here's cube.
Follow task. Here's cube.
They form a cube
They form a cube
like a cube. That's pretty close, right?
This one. This one one's hard.
Oh yeah, though. It's like it's kind of
Oh yeah, though. It's like it's kind of
getting it. Like look at these ones.
getting it. Like look at these ones.
They're like
They're like
starting to do the Congo.
starting to do the Congo.
That one's a tough task. I kind of want
That one's a tough task. I kind of want
to train that one on just to see. Here's
to train that one on just to see. Here's
the flag.
the flag.
So, this will be the good comparison for
So, this will be the good comparison for
us. So this is like you can see this is
us. So this is like you can see this is
a little bit worse than before because
a little bit worse than before because
we've trained on all these different
we've trained on all these different
tasks. It doesn't have enough data for
tasks. It doesn't have enough data for
this. Really not that much like a little
this. Really not that much like a little
bit jiggly.
bit jiggly.
That's kind of it. So
That's kind of it. So
pretty happy with this.
pretty happy with this.
I think for my taste this is like
I think for my taste this is like
what's this?
what's this?
Go in a ball I guess.
Go in a ball I guess.
Pretty
good policy.
good policy.
Let's see if we can do the racing one.
Let's see if we can do the racing one.
Now,
we're going to make this slightly longer
we're going to make this slightly longer
to account for the racing task, but not
to account for the racing task, but not
massively longer. I
massively longer. I
do like this.
do like this.
Okay, we'll we'll we will rebuild and
Okay, we'll we'll we will rebuild and
I'll do four let's do like 400 million
I'll do four let's do like 400 million
steps.
In practice, these things suck up a ton
In practice, these things suck up a ton
of data. In theory, we should just be
of data. In theory, we should just be
able to do like 400 mil. It should be
able to do like 400 mil. It should be
fine
terminals. Lovely.
I'm really interested characterizing all
I'm really interested characterizing all
M's which have local interaction
M's which have local interaction
local
all possible
all possible
you have to be a little bit careful AAR
you have to be a little bit careful AAR
because if you don't like if there's not
because if you don't like if there's not
at least some structure then you're
at least some structure then you're
training on random MDPs
training on random MDPs
just random noise and you can't really
just random noise and you can't really
compress random noise
compress random noise
there has to be some notion of all
there has to be some notion of all
reasonable M's or something like that
reasonable M's or something like that
right
you're willing to do like all reasonable
you're willing to do like all reasonable
M's then come on like just start
M's then come on like just start
implementing over
implementing over
No idea what's going on. Sorry.
No idea what's going on. Sorry.
Presentation on
Presentation on
neural MMO
neural MMO
start learning this. Where should I
start learning this. Where should I
start? Thank you. That is my PhD
start? Thank you. That is my PhD
presentation that you saw. Um
presentation that you saw. Um
I will link you there. We do have
I will link you there. We do have
resources for beginners. Now
resources for beginners. Now
people kept asking me for them for so
people kept asking me for them for so
long that I just went and I actually
long that I just went and I actually
made some.
my articles tab.
my articles tab.
Got the quick start guide.
Got the quick start guide.
Got the ultra opinionated guide to
Got the ultra opinionated guide to
reinforcement learn. There's the more
reinforcement learn. There's the more
general intro guide.
Only structure is local interaction.
You just want to like fit some small
all
update rule. This is like the cellular
update rule. This is like the cellular
automa thing that you were doing before,
automa thing that you were doing before,
right?
right?
I mean, you can go ahead and try it.
I mean, you can go ahead and try it.
Like
Like
stuff is so fast now that things that
stuff is so fast now that things that
didn't work before probably work and uh
didn't work before probably work and uh
our algorithms have just gotten better.
our algorithms have just gotten better.
So
So
what are your thoughts about paper
what are your thoughts about paper
talking about how RL with randomware
talking about how RL with randomware
that's some janky language model thing
that's some janky language model thing
that's absolutely not true generally
the closest thing that we have to like
the closest thing that we have to like
some janky random thing doing stuff like
some janky random thing doing stuff like
R&D random network distillation or
R&D random network distillation or
whatever and that relies on the fact
whatever and that relies on the fact
that like random convolutions.
that like random convolutions.
They'll give you some uh still give you
They'll give you some uh still give you
image prior.
image prior.
Not really random.
Not really random.
Also, locomotion,
random rewards or random goals.
I don't trust any of this stuff,
I don't trust any of this stuff,
honestly. Like I'll look at a paper if
honestly. Like I'll look at a paper if
you want to link something quickly, but
you want to link something quickly, but
I kind of just assume all published
I kind of just assume all published
research is wrong by default because
research is wrong by default because
it's literally it's like I'm right 80%
it's literally it's like I'm right 80%
of the time just that.
of the time just that.
What machine are you using to train less
What machine are you using to train less
than a minute? A MacBook takes three
than a minute? A MacBook takes three
hours
hours
with Puffer. It definitely shouldn't
with Puffer. It definitely shouldn't
take three hours with Puffer. If it
take three hours with Puffer. If it
takes one minute on my machine with a
takes one minute on my machine with a
MacBook, it should take you anywhere
MacBook, it should take you anywhere
between five and 20 minutes, not take
between five and 20 minutes, not take
three hours.
three hours.
M4 would probably be like 10 minutes.
Wasn't this literally This is
Wasn't this literally This is
legitimately better than before, isn't
legitimately better than before, isn't
it? I've never seen 86% on this task.
Wait, but there's no rings passed. Hang
Wait, but there's no rings passed. Hang
on. Did I do something wrong?
Rebuild.
I'm confused.
Something wrong here.
Something wrong here.
Have rings passed.
how many PPO steps can you get in that
how many PPO steps can you get in that
hack billions?
hack billions?
Uh, we haven't tried that hard at KH
Uh, we haven't tried that hard at KH
because
because
we basically need to go mess around with
we basically need to go mess around with
the way the multi-threading works and
the way the multi-threading works and
the architecture and stuff.
the architecture and stuff.
I think you get environment bottlenecked
I think you get environment bottlenecked
until we do a little bit of engineering
until we do a little bit of engineering
which is the main thing that we would
which is the main thing that we would
have to do that.
have to do that.
Um
Um
if we can make it faster my guess will
if we can make it faster my guess will
be we can't solve the game for sure
be we can't solve the game for sure
because you need you need external
because you need you need external
knowledge to solve the game. Um but I
knowledge to solve the game. Um but I
think we can do a heck of a lot better
think we can do a heck of a lot better
than the current benchmarks
cuz like billions is not that much even
cuz like billions is not that much even
if we can get billions. So neural MMO 3,
if we can get billions. So neural MMO 3,
we did 640 billion and we didn't
we did 640 billion and we didn't
saturate it.
The net hack is harder than neural MMO
The net hack is harder than neural MMO
3.
Realize the paper's regards to offline.
Realize the paper's regards to offline.
Well, offline RL is just not RL.
It's just not RL supervised learning.
Survival instinct offline. RL
None of the normal authors.
like the simplest possible path.
Welcome
Oh, are they doing a thing where just
Oh, are they doing a thing where just
like
like
if the rewards are positive for have a
if the rewards are positive for have a
survival bias? Um because you get more
survival bias? Um because you get more
total rewards if you survive for longer.
total rewards if you survive for longer.
So that's not like that the rewards are
So that's not like that the rewards are
wrong, it's that some of the rewards are
wrong, it's that some of the rewards are
wrong, I guess.
Yeah. Okay, I'd believe that.
But the thing is like the only reason
But the thing is like the only reason
that it trains at all is because the
that it trains at all is because the
task is trivial.
task is trivial.
Like you can't give it wrong rewards and
Like you can't give it wrong rewards and
have it solve anything that's like
have it solve anything that's like
tough.
They're not robot. These are like Yeah,
They're not robot. These are like Yeah,
these are not robotics tests, are they?
these are not robotics tests, are they?
What are these? No, these are actually
What are these? No, these are actually
Hang on.
Right. But they have demonstration data
Right. But they have demonstration data
because it's offline. So that's still
because it's offline. So that's still
trivial with demonstration data. It's
trivial with demonstration data. It's
hard online.
hard online.
Yeah. Yeah.
Yeah. Yeah.
Okay. If I've interpreted it correctly,
Okay. If I've interpreted it correctly,
then yeah. Okay. That's kind of true.
then yeah. Okay. That's kind of true.
But it's not it's not like the result
But it's not it's not like the result
that's like, oh yeah, you can just train
that's like, oh yeah, you can just train
with wrong rewards.
They completely randomized. I'd have to
They completely randomized. I'd have to
see if there's a bias though because
see if there's a bias though because
they talked about length bias and like
they talked about length bias and like
because you have a term state. Um
because you have a term state. Um
like let's say you have positive rewards
like let's say you have positive rewards
then it's always better to just survive
then it's always better to just survive
for longer.
for longer.
Offline RL does not scale at all.
Offline RL does not scale at all.
What do you mean doesn't scale at all?
What do you mean doesn't scale at all?
Like it doesn't get outside of the data
Like it doesn't get outside of the data
support, right?
support, right?
Is that what you mean?
Is that what you mean?
Yeah, it doesn't get outside of the data
Yeah, it doesn't get outside of the data
support at least not by much. Which is
support at least not by much. Which is
why it's just dumb supervised learning.
why it's just dumb supervised learning.
Why? Like, oh yeah, we can do offline
Why? Like, oh yeah, we can do offline
RL's kind of stupid
learning.
Okay, so I had just forgotten to
Okay, so I had just forgotten to
recompile it. Uh, this is still better
recompile it. Uh, this is still better
than before though.
than before though.
That's
That's
like a few percentage points better than
like a few percentage points better than
before and in way less data.
I think that there's still um
I think that there's still um
some stuff we can
That looks a little better than before.
That looks a little better than before.
Not like a good sphere, but at least
Not like a good sphere, but at least
like they've got some intentionality to
like they've got some intentionality to
them now where they actually like go to
them now where they actually like go to
the targets quite quickly.
the targets quite quickly.
It's only 400 million steps.
It's only 400 million steps.
That's like not terrible. Okay,
That's like not terrible. Okay,
progress.
progress.
Keep in mind this is also training on
Keep in mind this is also training on
racing at the same time. So like half of
racing at the same time. So like half of
the data fully is racing data. It's like
the data fully is racing data. It's like
a very weird task distribution.
Broken glass and readers all day. Now
Broken glass and readers all day. Now
it's fun to read.
it's fun to read.
Yeah.
Uh I mean reading academic papers is
Uh I mean reading academic papers is
basically
basically
okay that's actually a recognizable flag
okay that's actually a recognizable flag
which we did not have before.
which we did not have before.
So
So
and that's progress
and that's progress
again. This is a very very hard setting
again. This is a very very hard setting
here we're doing cuz it's it's mixing in
here we're doing cuz it's it's mixing in
race data. Like let me see if I can show
race data. Like let me see if I can show
you the race data. Oh yeah, it's not
you the race data. Oh yeah, it's not
even doing the race data on this.
Actually see the racing policy.
Q-learning is not yet scalable.
Wait, Q-learning is not offline.
Your learning is off, Paul.
Wait, what?
I think bias
get the bias from generalized advantage
get the bias from generalized advantage
estimation.
estimation.
It based to a specific horizon.
Yeah, the strict one step is really
Yeah, the strict one step is really
stupid though. Correct.
stupid though. Correct.
Um, it's not strict one step though
Um, it's not strict one step though
because Rainbow like they do like three
because Rainbow like they do like three
or five step. Still dumb.
Yeah, like this. Some of these problems
Yeah, like this. Some of these problems
are just trivial. Oh, I guess it's a
are just trivial. Oh, I guess it's a
humanoid, which is like a
humanoid, which is like a
pure robotics only benchmark. It's also
pure robotics only benchmark. It's also
not a great way to do RL.
Okay, 1 billion is not near infinite
Okay, 1 billion is not near infinite
data. 1 billion is small. Uh, you think
data. 1 billion is small. Uh, you think
1 billion is infinite because your
1 billion is infinite because your
simulators are slow as
the data set to cover it. Don't know how
the data set to cover it. Don't know how
you did that.
But like if you do vanilla Q-learning,
But like if you do vanilla Q-learning,
it's just a bad algorithm. That's like
it's just a bad algorithm. That's like
comparing to reinfor
Oh, but they also did SAC. Okay,
Oh, but they also did SAC. Okay,
huh?
1,000x larger than typical data set.
1,000x larger than typical data set.
Yeah, this is you guys just trolling.
Yeah, this is you guys just trolling.
Like, if you're trying to do RL with
Like, if you're trying to do RL with
million like a million observations,
million like a million observations,
you're just being dumb.
Like this blog post is fine so far, but
Like this blog post is fine so far, but
like the context for this is a lot of
like the context for this is a lot of
the offpaul work like or the offline
the offpaul work like or the offline
work trying to do anything with a
work trying to do anything with a
million data points is just stupid.
Stop improving at all after billions of
Stop improving at all after billions of
steps.
Well, this almost seems wrong, right?
Well, this almost seems wrong, right?
like can't possibly go down.
Yeah. So, horizon reduction does work.
Yeah. So, horizon reduction does work.
Um,
the thing is that we kind of can just
the thing is that we kind of can just
solve RL with very long horizons anyways
solve RL with very long horizons anyways
because we're fast
hierarchical. What? What hierarchical
hierarchical. What? What hierarchical
methods?
methods?
available
available
off
your thing is
your thing is
they're conflating offline and off
they're conflating offline and off
policy a little bit, right?
policy a little bit, right?
It's like fundamentally you do need
It's like fundamentally you do need
fresh data when you're doing when you
fresh data when you're doing when you
don't have expert data. You will always
don't have expert data. You will always
need fresh data because your stupid
need fresh data because your stupid
policy can't collect good data, right?
Yeah, their scaling curve definitely
Yeah, their scaling curve definitely
shouldn't go down a little. That's
shouldn't go down a little. That's
sketch. Hey, Sahil, welcome.
Are you one of the people who have
Are you one of the people who have
messaged me who I haven't replied to
messaged me who I haven't replied to
yet? I've been meaning to get to all the
yet? I've been meaning to get to all the
DMs asking for meetings. I've have a lot
DMs asking for meetings. I've have a lot
of them in the last couple
I think this is a red herring. Honestly,
I don't know if I agree with this
I don't know if I agree with this
conclusion at all. Like
The thing is that every like all of RL
The thing is that every like all of RL
is slightly off policy.
is slightly off policy.
Pretty much the only thing that you
Pretty much the only thing that you
really want from off policy is you want
really want from off policy is you want
the ability to reuse old highquality
the ability to reuse old highquality
data. But that doesn't mean you don't
data. But that doesn't mean you don't
want to stop collecting new data. You
want to stop collecting new data. You
want as much fresh data as you can
want as much fresh data as you can
possibly get and then you want to like
possibly get and then you want to like
compute fill basically while you're
compute fill basically while you're
waiting with for new data. You want to
waiting with for new data. You want to
fill with high quality old data? No,
fill with high quality old data? No,
just saw some stuff in my live feed. All
just saw some stuff in my live feed. All
right, cool
representational
representational
doesn't learn a good rep.
We have on policy working very very well
We have on policy working very very well
in the high data. Now
in the high data. Now
I mean the proof of this is just stuff
I mean the proof of this is just stuff
that don't hear. Oh, hey Kevin. They got
that don't hear. Oh, hey Kevin. They got
feedback from Kevin on
interesting post. Um
interesting post. Um
I don't
I don't
Horizon reduction is basically like make
Horizon reduction is basically like make
the problem simpler is thing
cuz like the techniques that they have
cuz like the techniques that they have
there like endstep and hierarchical and
there like endstep and hierarchical and
stuff like you get a certain amount out
stuff like you get a certain amount out
of those but at some point it's like the
of those but at some point it's like the
really long horizons are not really
really long horizons are not really
amendable to algorithmic horizon
amendable to algorithmic horizon
reduction as far as I've seen. There
reduction as far as I've seen. There
might be a way around it. You definitely
might be a way around it. You definitely
don't want to have all your tasks be
don't want to have all your tasks be
robotics like this
on the paper. All right, cool.
on the paper. All right, cool.
Not a good skill. Yeah, I agree.
Not a good skill. Yeah, I agree.
I mean I will say on the research side
I mean I will say on the research side
the most uh the thing that we are most
the most uh the thing that we are most
interested in doing next is at least
interested in doing next is at least
some form of semi-off Paul basically but
some form of semi-off Paul basically but
I I think people are looking at it kind
I I think people are looking at it kind
of wrong right what you want to have is
of wrong right what you want to have is
you don't want to have like all these
you don't want to have like all these
fancy algorithms right you want to have
fancy algorithms right you want to have
an algorithm crank up all the data you
an algorithm crank up all the data you
have unlimited data you can use as
have unlimited data you can use as
little compute as possible or you want
little compute as possible or you want
to be able to crank it the other way and
to be able to crank it the other way and
use less data data with more compute and
use less data data with more compute and
you want that to be like a clean
you want that to be like a clean
tradeoff with the simplest algorithm
tradeoff with the simplest algorithm
possible. That's what you want.
Chunking has been crucial. Yeah, it's
Chunking has been crucial. Yeah, it's
cuz you guys have no data though. Like
cuz you guys have no data though. Like
they're like they're bragging about
they're like they're bragging about
their 1 billion samples that they've
their 1 billion samples that they've
collected. Like, okay, here's 400
collected. Like, okay, here's 400
million in two minutes. We have 640
million in two minutes. We have 640
billion that we run on one uh we run
billion that we run on one uh we run
this on one server. We've done 640
this on one server. We've done 640
billion observations
billion observations
online as well like
online as well like
right.
Uh did I look at this yet? I did look at
Uh did I look at this yet? I did look at
this policy already. I I should have had
this policy already. I I should have had
this running while I was chatting.
this running while I was chatting.
We need to run this for a little longer.
We need to run this for a little longer.
I have 10 minute run.
I have 10 minute run.
Okay, number to beat is 86% with 3.3%
Okay, number to beat is 86% with 3.3%
collisions. Let's see if we can get that
collisions. Let's see if we can get that
to work. And I'm going to Neptune.
Uh, also I see next algorithm use best
Uh, also I see next algorithm use best
hypers.
hypers.
So gamma is the horrible hyper, right?
So gamma is the horrible hyper, right?
Gamma is the really really awful one.
Gamma is the really really awful one.
Uh, because it implies a fixed horizon.
Uh, because it implies a fixed horizon.
I will say that on fitting hypers like
I will say that on fitting hypers like
we kind of just made the hyperparameter
we kind of just made the hyperparameter
tuning algorithm better so it's not as
tuning algorithm better so it's not as
much of a problem anymore.
much of a problem anymore.
But the problem with using less hypers
But the problem with using less hypers
right is like you typically can always
right is like you typically can always
design for any algorithm that you design
design for any algorithm that you design
right you can always make it better by
right you can always make it better by
introducing more hyperparameters because
introducing more hyperparameters because
you add more degrees of freedom
that's the tough part
like basically what you could do right
like basically what you could do right
is you could define a new algorithm
is you could define a new algorithm
could define like awesome advantage or
could define like awesome advantage or
whatever is just generalized advantage
whatever is just generalized advantage
estimation with gamma hardcoded to 0.99
estimation with gamma hardcoded to 0.99
and lambda hardcoded to 0.9 right and
and lambda hardcoded to 0.9 right and
now it doesn't have the hyperparameters
now it doesn't have the hyperparameters
um but like generalized advantage
um but like generalized advantage
estimation with proper tuning is always
estimation with proper tuning is always
going to be better
going to be better
a lot of the like the no hyperprem
a lot of the like the no hyperprem
algorithms are actually just this in
algorithms are actually just this in
disguise right where they've just kind
disguise right where they've just kind
of like stripped away degrees of freedom
of like stripped away degrees of freedom
set some reasonable defaults
Even when it doesn't look like they've
Even when it doesn't look like they've
set constants, usually it's like they've
set constants, usually it's like they've
set a constant to one basically so it
set a constant to one basically so it
cancels.
That's the tough the tough part that
I would love to have no hyper pram RL
I would love to have no hyper pram RL
but um what I've kind of seen it's like
but um what I've kind of seen it's like
little tricky. Now, we absolutely do
little tricky. Now, we absolutely do
need to come up with something that's
need to come up with something that's
not gamma.
not gamma.
Gamma as a hyper pram has been a
Gamma as a hyper pram has been a
disaster.
Um,
they're not differentiable is the
they're not differentiable is the
problem.
problem.
Not using carbs. But at least we have
Not using carbs. But at least we have
something a little better than carbs
something a little better than carbs
now, right? We've got protein.
now, right? We've got protein.
One of our improvements in 3L
problem is a lot of the like the hypers
problem is a lot of the like the hypers
aren't differentiable
aren't differentiable
generally very difficult to make the
generally very difficult to make the
hypersable
You'd have to switch the comparisons as
You'd have to switch the comparisons as
well because basically if you're going
well because basically if you're going
to fit those hyperparameters online
to fit those hyperparameters online
like the actual training run that you do
like the actual training run that you do
going to take longer than a well
going to take longer than a well
hyperparameter tuned
hyperparameter tuned
individual run.
individual run.
Comparisons get very fiddly. It's not
Comparisons get very fiddly. It's not
that it's a bad idea, but you're going
that it's a bad idea, but you're going
to have to be very careful with how you
to have to be very careful with how you
define everything.
Just go up and then back down.
Yeah. So, this was like doing better and
Yeah. So, this was like doing better and
then it kind of did this
500 some odd mil.
AI.
AI.
Yeah, we're uh we're working on that.
Yeah, we're uh we're working on that.
Actually, I'm going to probably as soon
Actually, I'm going to probably as soon
as I finish this, I'm going to be
as I finish this, I'm going to be
hacking on that. Um the training is all
hacking on that. Um the training is all
puffer, you know.
how this happened. Guess let's check
how this happened. Guess let's check
Perf.
Oh, Perf is actually a bit more stable
Oh, Perf is actually a bit more stable
though, right? Like look at this. 2%
though, right? Like look at this. 2%
higher trending upward. It's
the gems.
Yeah,
rate should be going down faster than
Well, we still have some knobs to
Well, we still have some knobs to
Do other
Oh,
I don't think that this did very much,
I don't think that this did very much,
which is actually not terrible for us
which is actually not terrible for us
because it go back to a reasonable step
Okay. I mean, the racing policy is good,
Okay. I mean, the racing policy is good,
right?
It's like super snappy.
I forget to randomize the drones.
I did randomize during
my whisker racer game. Trained fairly
my whisker racer game. Trained fairly
well last night. 50k.
Uh, what are you training it on?
I'd have to see the stats.
On a good GPU, you should be able to hit
On a good GPU, you should be able to hit
millions with Puffer.
Yeah. So, here's the drone racing with
Yeah. So, here's the drone racing with
all sorts of different types of
all sorts of different types of
It's still nice and robust.
here. Right.
here. Right.
This
cube
guys make
guys make
pretty close.
pretty close.
That's pretty darn close.
That's pretty darn close.
How much of a flag do you guys make?
How much of a flag do you guys make?
Recognizable flag.
Just about a recognizable flag.
Track made with JPEG and R.
Yeah, you kind of just want to draw a
Yeah, you kind of just want to draw a
bunch of curves probably with bezier
bunch of curves probably with bezier
functions.
functions.
Probably just want to draw a bunch of
Probably just want to draw a bunch of
curves, man.
curves, man.
Not do that like loading stuff.
Not do that like loading stuff.
Definitely don't want to be
Definitely don't want to be
bottlenecked.
bottlenecked.
Not a fun place to be, especially
Not a fun place to be, especially
because if you try to scale anything
because if you try to scale anything
like even more bottlenecked because then
like even more bottlenecked because then
you have more GPUs cores
you have more GPUs cores
or really fast are nice.
or really fast are nice.
Okay. So, go down to 500 mele
steps.
Now,
Now,
there a few other things I wanted to do
there a few other things I wanted to do
this.
So, I'm going to add the uh
reward
reward
here.
So just shy of 10 rings
So just shy of 10 rings
85 per.
Now this should actually make the racing
Now this should actually make the racing
policy a bit worse on paper.
policy a bit worse on paper.
Uh because it'll tell the drones to not
Uh because it'll tell the drones to not
crash.
crash into.
crash into.
At the moment, they're told to not crash
At the moment, they're told to not crash
each other when SW, but the racing one,
each other when SW, but the racing one,
they're told to do what?
they're told to do what?
We're gonna see what this does.
Great. Garbage error.
Clearly no usable error messaging.
Yep.
Oh, we're way way way worse on Perf now,
Oh, we're way way way worse on Perf now,
huh?
That's funny. That totally crashes
That's funny. That totally crashes
training, huh?
It's actually like better at some
It's actually like better at some
weird.
Oh, you know what? Maybe it's not bad.
Oh, you know what? Maybe it's not bad.
Hang on. Maybe it's just the Maybe it's
Hang on. Maybe it's just the Maybe it's
just a difference in logging.
Difference logging. Okay.
They look a bit more spread out to me.
can obviously improve observations
can obviously improve observations
similar, right? But
here's a little worse.
worse.
Generally, mostly a little worse.
Definitely makes it harder.
kind of did the uh the data mix
kind of did the uh the data mix
arbitrarily, didn't I?
You think we still get the same problem
You think we still get the same problem
if I just do this?
I think we're not going to get a good
I think we're not going to get a good
racing policy. I do it this way.
racing policy. I do it this way.
The idea is like what if I just do
The idea is like what if I just do
random over tasks like this?
Maybe you don't need that much racing.
Maybe you don't need that much racing.
Who knows?
and totally mess up the ring's Last
and totally mess up the ring's Last
minute.
Looks like it's not learning the racing
Looks like it's not learning the racing
task at all yet.
got good collision Right.
almost like up to the same purpose.
almost like up to the same purpose.
Well,
guess it makes sense because the reward
guess it makes sense because the reward
function is kind of fundamentally
function is kind of fundamentally
different, right?
What do I do about this?
I try one more thing. I hate doing like
I try one more thing. I hate doing like
these experiments.
these experiments.
I think this is like a 2:1ish ratio.
Please add information about what we're
Please add information about what we're
trying to do here.
trying to do here.
I think I have Did I add the links to
I think I have Did I add the links to
the uh the YouTube? I thought I had
the uh the YouTube? I thought I had
links added automatically to my
links added automatically to my
description.
Yeah, we have links, don't we?
Yeah, we have links, don't we?
All the information is on puper.ai.
All the information is on puper.ai.
It's all like live reinforcement
It's all like live reinforcement
learning dev.
At the moment, this is
working on simulated drones.
Get this to train and I'll say a little
Get this to train and I'll say a little
bit about it. What I'm trying to do at
bit about it. What I'm trying to do at
the moment, right, is I have a neural
the moment, right, is I have a neural
net that can train drones to do swarming
net that can train drones to do swarming
formations and I have a neural net that
formations and I have a neural net that
can train drones to do uh racing.
can train drones to do uh racing.
I'm trying to see if I can get one
I'm trying to see if I can get one
neural net to do all the different
neural net to do all the different
tasks.
tasks.
Been a little bit tricky. So
Been a little bit tricky. So
bit tricky.
If this actually
it'll be pretty funny if this doesn't
it'll be pretty funny if this doesn't
work. I basically just guessed
work. I basically just guessed
my first probably had a mix last night.
It looks like it is at least getting
It looks like it is at least getting
some signal now.
some signal now.
Yeah. Okay.
Yeah. Okay.
So, it's at least learning now that uh
So, it's at least learning now that uh
with a quarter of the data on racing and
with a quarter of the data on racing and
three quarters of the data to swarming,
three quarters of the data to swarming,
it actually does at least learn the
it actually does at least learn the
racing task a bit now.
Just saying. Thank you.
Just saying. Thank you.
All sorts of fundra
messed up.
Curious to see what the heck type of
Curious to see what the heck type of
policy we get out of this.
policy we get out of this.
This backward
backwards.
backwards.
Yeah, it would be
Oh, it is backwards.
Oh, it is backwards.
Totally backwards.
Well, get a very good racing policy with
Well, get a very good racing policy with
three quarters of the data on obviously
just hack something real quick.
You like this?
I think we're getting the rewards
I think we're getting the rewards
blended up too much.
This isn't even necessarily reward
This isn't even necessarily reward
design. It's just the fact that like
design. It's just the fact that like
the rewards don't really line up too
the rewards don't really line up too
nicely across um different objectives
nicely across um different objectives
have. So, the only reason this is a
have. So, the only reason this is a
problem is you're doing multi-objective
Yeah, but with a quarter of the data,
Yeah, but with a quarter of the data,
we're still not learning.
I figure that this would learn.
Wonder if this is a problem where we can
Wonder if this is a problem where we can
use bigger batch sizes cuz like
use bigger batch sizes cuz like
we have all these different tasks. Maybe
we have all these different tasks. Maybe
it is something that could benefit from
it is something that could benefit from
very large batches.
very large batches.
Actually,
it is starting to learn the ring task.
Okay, so in the meantime, while this
Okay, so in the meantime, while this
finishes training, looks like it's
finishes training, looks like it's
finally caught on.
give it the penalty. I think
give it the penalty. I think
needs to get the uh the distance penalty
needs to get the uh the distance penalty
or the collision penalty
thing.
regarding touring machines able to solve
regarding touring machines able to solve
fourdigit edition.
fourdigit edition.
Nicely done. I actually don't know what
Nicely done. I actually don't know what
that looks like in a touring machine.
that looks like in a touring machine.
How many operations is that?
gets to 76 per
gets to 76 per
like 2.8 rings, right?
like 2.8 rings, right?
See if this helps or hinders
any
I need binary operation
I need binary operation
not oper
so it actually I mean it takes a while
so it actually I mean it takes a while
to discover that I'd imagine
So, interestingly,
So, interestingly,
this improves performance,
this improves performance,
but it's no longer learning the ring
but it's no longer learning the ring
task at all.
Not at all
on the
Yeah. So that's like combinatorial
Yeah. So that's like combinatorial
tough exploration.
tough exploration.
Kind of brute force it a little bit
Kind of brute force it a little bit
though.
I just barely got a little bit of ring
forever to learn this. Yeah, I would
forever to learn this. Yeah, I would
expect so. Sounds like it should take
expect so. Sounds like it should take
forever.
Is there any other way I can bring this
Is there any other way I can bring this
drone ring reward in line with the storm
drone ring reward in line with the storm
reward?
reward?
It's a little annoying because like
you have to go you have to hit the
you have to go you have to hit the
target from a specific direction.
I could make all of the objectives have
I could make all of the objectives have
a specific pose technically, right?
It's a little difficult though when it's
It's a little difficult though when it's
like stationary versus fly through a
like stationary versus fly through a
target.
If I just do two policies, it's a lot
If I just do two policies, it's a lot
easier, isn't
Let's play around with the um
Let's play around with the um
getting like irritating. Let's play
getting like irritating. Let's play
around a little bit with
Congo is a very hard task
Congo is a very hard task
for a swarm.
for a swarm.
See if it can do this.
Hey, the vectorization is stuff uh for
Hey, the vectorization is stuff uh for
variant of
variant of
place. traditional play buffer
max out heart pole. Okay, cool.
max out heart pole. Okay, cool.
Um,
trying to think what a good problem
trying to think what a good problem
would be. Not going to want to be doing
would be. Not going to want to be doing
this stuff in a notebook very long. I
this stuff in a notebook very long. I
can tell you that.
Probably like breakout or something.
Maybe you have to start with Pong. Pong
Maybe you have to start with Pong. Pong
is faster to solve.
is faster to solve.
New to this field and I'm learning data
New to this field and I'm learning data
science. Never worked on RL. Can you
science. Never worked on RL. Can you
talk about the metrics on
talk about the metrics on
right? So the metrics on the right are a
right? So the metrics on the right are a
whole bunch of losses.
whole bunch of losses.
Um they're not actually all that useful
Um they're not actually all that useful
in reinforcement learning. Pretty much
in reinforcement learning. Pretty much
they're not supposed to explode. If they
they're not supposed to explode. If they
explode they're bad. Like that's bad
explode they're bad. Like that's bad
ones that I do occasionally look at. So
ones that I do occasionally look at. So
entropy crashing too low means the
entropy crashing too low means the
policy is taking deterministic action
policy is taking deterministic action
really bad. Um clip frack being too high
really bad. Um clip frack being too high
your policy is making gigantic unstable
your policy is making gigantic unstable
updates
updates
and uh yeah the rest of them generally
and uh yeah the rest of them generally
just not blow up otherwise you have
just not blow up otherwise you have
numerical stuff.
numerical stuff.
You've seen this error before in eval
You've seen this error before in eval
but not in train
but not in train
helping debug for some else
helping debug for some else
I use
Not.
Yeah, Spencer. It's probably
Yeah, Spencer. It's probably
if you look at the way the actions are
if you look at the way the actions are
being sampled, they're probably like not
being sampled, they're probably like not
an array or not the right data type or
an array or not the right data type or
something.
If you change like the data type or you
If you change like the data type or you
change like maybe it was like an like a
change like maybe it was like an like a
numpy array and like they added an extra
numpy array and like they added an extra
dimension or something, it'll break.
dimension or something, it'll break.
API usage error means that you're doing
API usage error means that you're doing
something wrong.
something wrong.
Just like print out the data types and
Just like print out the data types and
shapes before and after.
What are they doing with the action
What are they doing with the action
Nice.
change to different one. I had 137 and
change to different one. I had 137 and
now we're going
now we're going
you loading one policy like a policy
you loading one policy like a policy
that's old that's like outputting
that's old that's like outputting
actions that are outside the range.
actions that are outside the range.
That'll break it.
Not perfect, but pretty dang good.
what this looks like without
what this looks like without
randomization.
randomization.
94 does better without random.
94 does better without random.
If so, then we can use that as our like
If so, then we can use that as our like
hard task
ID.
What was the issue? racing. So basically
What was the issue? racing. So basically
for any of these tasks, we can get any
for any of these tasks, we can get any
of the individual tasks to work on their
of the individual tasks to work on their
own. Get racing to work on its own, get
own. Get racing to work on its own, get
swarming to work on its own. It's just
swarming to work on its own. It's just
trying to do all these tasks together
trying to do all these tasks together
with randomization and everything else
with randomization and everything else
is hard. Actually, that's probably what
is hard. Actually, that's probably what
I should do next is I should try them
I should do next is I should try them
jointly without randomization.
ly this doesn't seem to do any better at
ly this doesn't seem to do any better at
the moment.
the moment.
Generally the uh non-randomized
Generally the uh non-randomized
train initially
it still has half this
think we'll try to see if nonrandomiz
think we'll try to see if nonrandomiz
actually works
actually works
across all tasks next. That'll be
across all tasks next. That'll be
decent.
decent.
How goes the grifting?
I thought you weren't on Twitter
I thought you weren't on Twitter
constantly. Ryan, how's it going?
When When are we doing net hack AGI?
Still waiting on my
Still waiting on my
When are we doing net hack AGI, man?
coin.
Yeah, FYI folks, none of those coins are
Yeah, FYI folks, none of those coins are
real. Like people, a lot of people keep
real. Like people, a lot of people keep
making fake coins like labeled puffer.
making fake coins like labeled puffer.
There's no coin.
I had jury duty,
I had jury duty,
got sick, so big dud. That sucks.
Straight to jail. Not to not collect
Straight to jail. Not to not collect
$200.
Not pass go. Straight to jail.
Interesting
that this doesn't to be
that this doesn't to be
to be much better, but
We have all sorts of cool new stuff that
We have all sorts of cool new stuff that
we're starting though with we're
we're starting though with we're
starting to actually
starting to actually
we're starting to actually figure out
we're starting to actually figure out
some cool applications part of science
some cool applications part of science
but
I have a day or two to start before RLC
I have a day or two to start before RLC
and then a week after
and then a week after
Canada.
Canada.
Oh man, that's rough. No barbecue for
Oh man, that's rough. No barbecue for
you.
Is there a thing where like is RLC the
Is there a thing where like is RLC the
conference where everybody has talks or
conference where everybody has talks or
no? Do I just have to make a poster?
I think I should just have to make a
I think I should just have to make a
poster, right? Or is there talks? We all
poster, right? Or is there talks? We all
have eight minute talks. Oh, great. So,
have eight minute talks. Oh, great. So,
I got to figure that out.
I got to figure that out.
That'll be problem for me next week.
I mean, this is visibly like slightly
I mean, this is visibly like slightly
better. It's not perfect.
better. It's not perfect.
Drone Congo is very Congo.
Like the drone congo
board poster
buffer poster.
This is a decent enough task on it.
buffer and syllabus yellow and now yeah
buffer and syllabus yellow and now yeah
I'm done I'm done presenting like I'm
I'm done I'm done presenting like I'm
done publishing
done publishing
too much of a
Think of it
yellows.
Yeah, this is true.
Yeah, this is true.
The growth on Puffer lately has been
The growth on Puffer lately has been
absolutely great. Like
your uh How's your new advisor on here?
All right, I'm more than halfway there,
All right, I'm more than halfway there,
man.
That's how it works, right? When you get
That's how it works, right? When you get
more Twitter followers, you become the
more Twitter followers, you become the
professor.
But yeah, like the uh
But yeah, like the uh
Huffer's been almost did 3K stars on it,
Huffer's been almost did 3K stars on it,
too.
Working on it.
Working on it.
Get like 10 likes.
Get like 10 likes.
Yeah.
Well, it's it has to do with density,
Well, it's it has to do with density,
right? If you post about a bunch of
right? If you post about a bunch of
different topics,
you don't have the density.
I pretty much post only RL. And like
I pretty much post only RL. And like
usually when people post random dumb
usually when people post random dumb
funny stuff, it gets like more
funny stuff, it gets like more
attention.
attention.
But when I post random dumb like stuff,
But when I post random dumb like stuff,
it gets no attention. It's like the
it gets no attention. It's like the
entire audience is there for the
entire audience is there for the
technical RLC.
technical RLC.
Kind of awesome.
Like even the normal like oh big company
Like even the normal like oh big company
bad stuff gets no attention, right?
bad stuff gets no attention, right?
Literally just the pure technical
Literally just the pure technical
content. Kind of great.
I want it to be even easier. It's just I
I want it to be even easier. It's just I
can't spend all my time on making it
can't spend all my time on making it
easier because I also have to spend time
easier because I also have to spend time
on like solving stuff.
search.
search.
I mean, I I really just care about
I mean, I I really just care about
making RL work as a field. So, I don't
making RL work as a field. So, I don't
mind doing all theing
mind doing all theing
and stuff. I do mind having to deal with
and stuff. I do mind having to deal with
Python's packaging for that.
Python's packaging.
Okay, so I reduced us to um a smaller
Okay, so I reduced us to um a smaller
network
network
and now we're training at up to 4
and now we're training at up to 4
million steps per second.
million steps per second.
Uh it's still
Uh it's still
almost same PF
almost same PF
9.2.
So
need to really make it just file one end
need to really make it just file one end
of at a time because it's ridiculous.
Add that it wouldn't that long.
2% collision.
Okay, almost identical,
Okay, almost identical,
but we'll stick with the small policy
but we'll stick with the small policy
cuz due to deploy anyways.
How do we improve this?
Let's go
take a quick look at um
I mean
I mean
pretty good
pretty good
curve.
curve.
These aren't comparable.
pretty good train curve.
I wonder if it's somehow more stable.
I wonder if it's somehow more stable.
Can I just literally do
this and have it work better?
my training. This is Okay, this is
my training. This is Okay, this is
randomizations
randomizations
on the Congo task.
on the Congo task.
Probably the hardest of the swarm tasks.
What else we could with this
word signal should be very good.
Should return very very low.
really tempted.
Maybe I will try that.
Maybe I will try that.
This would return like
if that even
standardized advance. I think it's
That hack is going to be cool. I think
That hack is going to be cool. I think
it's
it's
it's the type of thing where we're going
it's the type of thing where we're going
to have to definitely run all the speed
to have to definitely run all the speed
tests first to make sure it's actually
tests first to make sure it's actually
feasible.
feasible.
Like if it's below 100k,
Like if it's below 100k,
below 100k is not fun.
Honestly, I'd like to have it at a
Honestly, I'd like to have it at a
million.
million.
If we can get that
If we can get that
supposed to actually run at a million,
supposed to actually run at a million,
isn't it?
isn't it?
Can actually just get the data from
Can actually just get the data from
point A to point B fast enough to run
point A to point B fast enough to run
them.
There's like no reason that game 100k
There's like no reason that game 100k
like old school C.
Have you ever just gotten like the
Have you ever just gotten like the
low-level interface and run it in a for
low-level interface and run it in a for
loop and seen how fast it is?
loop and seen how fast it is?
Conditional checks don't matter. CPUs
Conditional checks don't matter. CPUs
love conditional.
We have tons of them.
Full
if statements are slow business
if statements are slow business
of jacks.
out real quick.
This crap is definitely low.
We're going to just delete all the end
We're going to just delete all the end
rappers.
about the rent. Yeah.
All of these like spaces things,
All of these like spaces things,
they have this super messy space.
Like you need to not even you can't like
Like you need to not even you can't like
you need to not even grab and like be
you need to not even grab and like be
copying all this to only grab the stuff
copying all this to only grab the stuff
you actually need.
you actually need.
Ideally, you would start with the
Ideally, you would start with the
minimal set of observations that get
minimal set of observations that get
away with. make it really fast. And then
away with. make it really fast. And then
what else you actually need there?
They have like a thousand for loop here
of like what this is
like just a lot of Python.
It's just they have a lot of Python
It's just they have a lot of Python
that's kind of like
that's kind of like
Yeah,
Yeah,
like lots of Python.
It's set gem space to four and three
It's set gem space to four and three
is appearing in their second act.
Seriously?
Um, well, did they change the action
Um, well, did they change the action
head?
like hardcoded.
Shouldn't be able to have a three
Word skill makes a meaningful friends.
They get to almost
They get to almost
not reward scale being
not reward scale being
observations then.
I focus on poster editing if
I focus on poster editing if
all my work done. I'm starting to hack,
all my work done. I'm starting to hack,
bro. How do you have uh how long does it
bro. How do you have uh how long does it
take to make a poster in a talk, man?
take to make a poster in a talk, man?
I'm allocating like two days for this
I'm allocating like two days for this
max.
Taking posters is boring work.
Taking posters is boring work.
No fun.
Well, okay. Let's just do
figure out
comments
near velocity.
Polish syllabus.
Polish syllabus.
I see. Okay.
I see. Okay.
Moving to Canada.
Yeah, it sounded good. Let me know
Yeah, it sounded good. Let me know
of all the things.
Do we really think that it's like
Do we really think that it's like
observations needing to be rotated or
observations needing to be rotated or
some weird thing?
I just be able to learn this.
Maybe it can't
To be fair, we have these like really
To be fair, we have these like really
shallow nets, right?
Wait, come.
All right. You know that things are
All right. You know that things are
stupid when I'm like starting to
stupid when I'm like starting to
actually mess with this, but we'll do it
actually mess with this, but we'll do it
anyways for
Why the hell did I just do this one?
Why the hell did I just do this one?
Dummy.
Dummy.
I don't know what that
the drone right
There.
a mess of all.
help me with RL project.
Um,
you have a whole community of people on
you have a whole community of people on
Discord. you're like new to RL and
Discord. you're like new to RL and
getting into stuff.
So
So
have to add
have to add
like add
discord.gg/puffer.
I just want to see if it's like a dumb
I just want to see if it's like a dumb
model capacity or depth thing.
Like I kind of forget that we use tiny
Like I kind of forget that we use tiny
little so often, but
I did actually catch one like oversight
I did actually catch one like oversight
and puffer withization.
and puffer withization.
Good that I happen to look at this. I
Good that I happen to look at this. I
don't know if it makes a huge difference
don't know if it makes a huge difference
to anything at all, but it is a it is a
to anything at all, but it is a it is a
difference.
funny enough, this actually does worse
funny enough, this actually does worse
so far.
Thank you.
probably like over optimization at this
probably like over optimization at this
point.
point.
I guess
I guess
I'll rerun this just to this shouldn't
I'll rerun this just to this shouldn't
make it workization.
I play with a few more things before I
I play with a few more things before I
just like decide that manually fiddling
just like decide that manually fiddling
with this is not a good use of time.
Give yourself a little bit of time to
Give yourself a little bit of time to
tinker with these.
Looks like a better curve.
Is this closer
person on the
tried making up loops for RLM loop. LLM
tried making up loops for RLM loop. LLM
loops. No. Trying to do everything
loops. No. Trying to do everything
except that
except that
models are just so big and clunky. Like
models are just so big and clunky. Like
there's really nothing you can do with
there's really nothing you can do with
them.
them.
Stupid amounts of comput
only. Oh, wait.
Ax mini battery.
Now we're at 5 million steps per
bigger batches.
if this makes any friends.
message. It's like slightly worse far.
message. It's like slightly worse far.
Nice and consistent, but like slightly
Nice and consistent, but like slightly
warped.
gets to the same spot though.
I'll take it if we're going to get the
I'll take it if we're going to get the
uh the same level of perf
uh the same level of perf
level of perf
faster.
Hypers just have not been swept in a
Hypers just have not been swept in a
long time.
Realistically, that's just going to be
Realistically, that's just going to be
the blocker till I sweep the hypers.
the blocker till I sweep the hypers.
Like, find a stable way to sweep hypers.
Like, find a stable way to sweep hypers.
Not going to be a ton I can do with it
Not going to be a ton I can do with it
that's better than this.
Let me just try the defaults real quick.
Let me just try the defaults real quick.
Like you literally
Like you literally
you never know really in RL
to see if there's like something to
to see if there's like something to
this, right?
I don't think this will do anything.
I don't think this will do anything.
It's worth trying to do.
Way slower. Holy.
Way slower. Holy.
Forgot about that.
Try this next
just tinkering experiments.
After that, we'll say, "Okay, I tried
After that, we'll say, "Okay, I tried
all the obvious stuff. I'll have to just
all the obvious stuff. I'll have to just
automate some sweeps and figure out how
automate some sweeps and figure out how
to make them stable.
Here's a restroom real quick. I'll be
Here's a restroom real quick. I'll be
right back.
All right.
Okay. These defaults didn't work at all.
Why would the mini batch size bigger?
It's reasonable perf.
It's reasonable perf.
think I'm expecting this to do any
think I'm expecting this to do any
better, but every so often it's like,
better, but every so often it's like,
hey, you go and you fix your problem and
hey, you go and you fix your problem and
work.
Worth checking.
Worth checking.
Not we'll just figure out how to set up
Not we'll just figure out how to set up
a sweep that doesn't crash.
lower. Hard to say if it's like actually
lower. Hard to say if it's like actually
plateaued low and unstable right here.
plateaued low and unstable right here.
This one was actually
This one was actually
hyper just
probably doing too much tinkering here.
probably doing too much tinkering here.
In fact, if I knew that this sweeps were
In fact, if I knew that this sweeps were
stable, I would not been done.
Always invest more.
Not right.
We'll see how that goes.
A whole bunch of small changes to add
A whole bunch of small changes to add
here.
Actually, I don't want to run that sweep
Actually, I don't want to run that sweep
box.
Get it set up on the other one.
All
right. So, we'll see how stable this
right. So, we'll see how stable this
end.
Now, we're not going to have this box. I
Now, we're not going to have this box. I
need this one. It's the fast box.
I have no recollection what the last
I have no recollection what the last
date of this was.
See
like a reasonably quick turnar around
like a reasonably quick turnar around
time for this.
Oh yeah, there's Leela's cool.
All right. So, this is training, right?
All right. So, this is training, right?
So, uh, the fun problem we're going to
So, uh, the fun problem we're going to
have is I'm going to merge this and
have is I'm going to merge this and
we're going to have about 50 million
we're going to have about 50 million
commits worth of insanity,
at least a version.
Oh,
Oh,
apparently I ran five bill at some
apparently I ran five bill at some
point.
Got bunch of hearts.
We're just going to see what the latest
We're just going to see what the latest
thing goes.
Yeah, the config's totally changed. Got
Yeah, the config's totally changed. Got
uh
difference.
Actually don't know if this one
Actually don't know if this one
stick with this for now.
stick with this for now.
A reasonable baseline
A reasonable baseline
to work.
might clipping a bunch.
might clipping a bunch.
Looks like it could.
Looks like it could.
Oh, how the heck it got knocked over.
Oh, how the heck it got knocked over.
Weird.
Weird.
When I did that,
When I did that,
could be better.
Okay, so this is actually working very
Okay, so this is actually working very
well. It's going right up.
If I go to sync this, how bad is it
If I go to sync this, how bad is it
going to
357 commits in like a month, right?
Okay.
We're going to have the before and after
We're going to have the before and after
at the very least.
at the very least.
As closely as we could possibly have it,
As closely as we could possibly have it,
we'll have the before and after.
Seven minutes is not too bad of a not
Seven minutes is not too bad of a not
ideal for dev loop, What?
So, six hearts, right?
So, six hearts, right?
Basically what we get is parts.
I'm going to have to reapply this umpire
I'm going to have to reapply this umpire
gymnasium fires.
going to remove the ones that I know I
going to remove the ones that I know I
already have.
I have like everything way too
I have like everything way too
aggressively pinned, I think.
That's my bad
being weird.
Know how it always corrupts the first
Know how it always corrupts the first
character.
And everything's moving around again.
And everything's moving around again.
Hey,
Okay, I remember at least what they did
Okay, I remember at least what they did
here.
Huh?
Huh?
Wait, what?
Wait, what?
Why is this inside packages?
Oh, I know. That's fine.
What the heck is all this?
What the heck is all this?
Configuration changes, I suppose.
Go see what their new config This
comment on why you think writing D is
comment on why you think writing D is
better than Jacks.
better than Jacks.
X is quite simple.
X is quite simple.
So here's why. Um you have to express
So here's why. Um you have to express
all of your logic in terms of array
all of your logic in terms of array
operation,
operation,
right? You're not you're really not
right? You're not you're really not
writing Python. You're writing a domain
writing Python. You're writing a domain
specific language. it's forcing you to
specific language. it's forcing you to
express all operations terms of arrays.
express all operations terms of arrays.
So
So
you can't really just write like
you can't really just write like
arbitrary branching logic like you would
arbitrary branching logic like you would
like to be able to. You can sort of
like to be able to. You can sort of
force it into that if you really want
force it into that if you really want
to. Uh and then that gets to be slow
to. Uh and then that gets to be slow
because the GPU has to execute all
because the GPU has to execute all
parallel branches
parallel branches
and then you have to be very clever to
and then you have to be very clever to
work around that to reduce the number of
work around that to reduce the number of
parallel branches.
parallel branches.
to do so is essentially to solve a
to do so is essentially to solve a
massive puzzle because this is not
massive puzzle because this is not
general programming. Like you're no
general programming. Like you're no
longer really doing general programming
longer really doing general programming
anymore.
anymore.
And what do you gain from doing this,
And what do you gain from doing this,
right? Okay, your end can run on the
right? Okay, your end can run on the
GPU. Why did you want to run your env on
GPU. Why did you want to run your env on
the GPU? It was because it was slow. Why
the GPU? It was because it was slow. Why
was it slow? It was slow because it was
was it slow? It was slow because it was
originally in horribly unoptimized
originally in horribly unoptimized
Python. So what we do instead, right, is
Python. So what we do instead, right, is
we just write really, really basic C.
we just write really, really basic C.
It's much much easier than writing in
It's much much easier than writing in
jacks because just write arbitrary
jacks because just write arbitrary
logic, right? No restrictions on
logic, right? No restrictions on
branching or conditionals or anything
branching or conditionals or anything
like that or like restrictions on having
like that or like restrictions on having
to use a large number of ends for the
to use a large number of ends for the
GPU to be efficient. Don't have any of
GPU to be efficient. Don't have any of
those sorts of restrictions and we can
those sorts of restrictions and we can
just write whatever we want.
But like okay so even if you can
But like okay so even if you can
technically express your thing in arrays
technically express your thing in arrays
with enough work why would you want to
with enough work why would you want to
do that?
The only use case really is if you are
The only use case really is if you are
doing heavy physics sim and writing some
doing heavy physics sim and writing some
sort of like tensorbased engine fine
sort of like tensorbased engine fine
right but if you're doing anything else
right but if you're doing anything else
like why would you want to have to write
like why would you want to have to write
everything in array operations versus
everything in array operations versus
just being able to write arbitrary logic
just being able to write arbitrary logic
the only answer I can come up with is
the only answer I can come up with is
because researchers are allergic to
because researchers are allergic to
writing anything that's not Python even
writing anything that's not Python even
though really Jax is not Python it's a
though really Jax is not Python it's a
direct it's a domain specific language
direct it's a domain specific language
that happens to have Pythones syntax but
that happens to have Pythones syntax but
it's really something quite
It gets way way way harder for no real
It gets way way way harder for no real
reason than just writing some basic C
obs and actions are arrays. They're
obs and actions are arrays. They're
tabular.
Yeah. Well, wouldn't you like to be able
Yeah. Well, wouldn't you like to be able
to write arbitrary logic, though?
I mean, so Neural MMO 3, for instance,
I mean, so Neural MMO 3, for instance,
is
is
like that thing runs a million and a
like that thing runs a million and a
half steps per second. It's a full It's
half steps per second. It's a full It's
a miniature MMO game, right?
a miniature MMO game, right?
Million and a half steps per second on
Million and a half steps per second on
one CPU core without us having to do any
one CPU core without us having to do any
weird array operations.
weird array operations.
Even though, yeah, we have all sorts of
Even though, yeah, we have all sorts of
like array like data structures in
like array like data structures in
there, right? But it's not all arrays.
there, right? But it's not all arrays.
there's also branching logic and stuff
there's also branching logic and stuff
on top of it.
on top of it.
You just never have to deal with it.
You just never have to deal with it.
You're just if you're using an actual
You're just if you're using an actual
programming language, right? If you're
programming language, right? If you're
actually like writing something in
actually like writing something in
that's something that is a full
that's something that is a full
programming language that's not a domain
programming language that's not a domain
specific language,
specific language,
just have it work.
Look, there are totally people that are
Look, there are totally people that are
like, "Oh yeah, we're smart. We can make
like, "Oh yeah, we're smart. We can make
it work in Jax." And that's cool, but
it work in Jax." And that's cool, but
like could also just use a full
like could also just use a full
programming language and also have it
programming language and also have it
work and also have spare time.
work and also have spare time.
It just be much much less painful.
Yeah, exactly right.
Yeah, exactly right.
Like it's literally the reason that
Like it's literally the reason that
people do this because they're allergic
people do this because they're allergic
to not writing Python. There's no other
to not writing Python. There's no other
reason.
It's really not though because I have
It's really not though because I have
brand new programmers doing this.
brand new programmers doing this.
Like if you look at this the code that
Like if you look at this the code that
we've written, it's like first course in
we've written, it's like first course in
systems level C. like a freshman
systems level C. like a freshman
undergrad who's taken their first
undergrad who's taken their first
systems do this
like frankly writing jacks it's way
like frankly writing jacks it's way
harder like what you're forcing yourself
harder like what you're forcing yourself
to do by writing M's and jacks is way
to do by writing M's and jacks is way
way harder than just writing some
way harder than just writing some
low-level code
like once you actually write some stuff
like once you actually write some stuff
in like just start doing a little bit of
in like just start doing a little bit of
low-level dev in this it's you'll see
low-level dev in this it's you'll see
the difference like oh yeah that's
the difference like oh yeah that's
insane
Yeah, sure thing.
isn't that bad when you have a template
isn't that bad when you have a template
to start from.
to start from.
Yeah.
Well, honestly, the worst thing about
Well, honestly, the worst thing about
the C is like the bindings to Python
the C is like the bindings to Python
because that API sucks,
because that API sucks,
but we kind of have like that's just
but we kind of have like that's just
taken for care of for you. And if you
taken for care of for you. And if you
really want to know how it works, like
really want to know how it works, like
you have one file to read that's it's
you have one file to read that's it's
like several hundred lines, but it's not
like several hundred lines, but it's not
gigantic, right?
gigantic, right?
It's mostly just a bunch of Python CAPI
It's mostly just a bunch of Python CAPI
glue.
glue.
It's nothing like
It's nothing like
It's really nothing that Is he?
Yeah,
you do need to understand pointers
you do need to understand pointers
because otherwise
because otherwise
I mean not teaching pointers is kind of
I mean not teaching pointers is kind of
just as much of a problem because then
just as much of a problem because then
like all the strs are copy on pass.
like all the strs are copy on pass.
So um like everything is immutable
So um like everything is immutable
essentially which is not a good thing.
you write like immutable C, you're going
you write like immutable C, you're going
to lose a lot of the performance benefit
to lose a lot of the performance benefit
of writing C.
It's like a like a very like functional
It's like a like a very like functional
thing. Not a good idea.
A tiny grad.
Well, it's not faster um on Nvidia
Well, it's not faster um on Nvidia
hardware and won't be for a while,
hardware and won't be for a while,
right?
like it's slower on Nvidia hardware like
like it's slower on Nvidia hardware like
because it's still early. They're mostly
because it's still early. They're mostly
doing alternative hardware at the
doing alternative hardware at the
moment.
moment.
If you have Nvidia hardware, it's like
If you have Nvidia hardware, it's like
kind of too early to adopt any like to
kind of too early to adopt any like to
look at adopting yet. It's a cool
look at adopting yet. It's a cool
project.
That's This
when will we see ML move to the true
when will we see ML move to the true
best language? Rust. Yeah, I hate Rust.
best language? Rust. Yeah, I hate Rust.
I do not enjoy Rust one bit, man.
Okay, here's the here's the thing with
Okay, here's the here's the thing with
Rust, right?
Rust, right?
The whole freaking language is designed
The whole freaking language is designed
around this borrow checker which makes
around this borrow checker which makes
you structure all your code differently
you structure all your code differently
from every other language. What is the
from every other language. What is the
point of this? You avoid one class of
point of this? You avoid one class of
error, right? You avoid memory leaks.
error, right? You avoid memory leaks.
Basically, you avoid one class of error
Basically, you avoid one class of error
that was never a problem in the first
that was never a problem in the first
place.
place.
So, no, piss off Rust.
So, no, piss off Rust.
[Music]
God,
God,
look, C has its problems, but it's
look, C has its problems, but it's
Rust leaves those problems in and then
Rust leaves those problems in and then
freaking makes its own problems. That
freaking makes its own problems. That
ain't the fix.
ain't the fix.
That just ain't it.
just to avoid memory leaks. I mean,
just to avoid memory leaks. I mean,
look, there probably some other bugs, I
look, there probably some other bugs, I
guess, that you can catch, but like
guess, that you can catch, but like
fundamentally,
fundamentally,
I think that most of the things that
I think that most of the things that
you're trying to do at a language level
you're trying to do at a language level
are just done better as debug compile
are just done better as debug compile
options. Um, like mem leaks aren't
options. Um, like mem leaks aren't
really a problem. Typically, it's out of
really a problem. Typically, it's out of
bounds writes and reads on arrays is the
bounds writes and reads on arrays is the
biggest one, but like can just use an
biggest one, but like can just use an
address sanitizer. Like the address
address sanitizer. Like the address
sanitizer kind of fixes all the problems
sanitizer kind of fixes all the problems
that force the user to write different
that force the user to write different
code in order to attempt to solve with
code in order to attempt to solve with
Rust.
Like how do you make Rust fast anyways?
Like how do you make Rust fast anyways?
You immediately start writing unsafe.
You immediately start writing unsafe.
Anyways,
look, it's it's like fine if you're
look, it's it's like fine if you're
doing embedded systems dev where you're
doing embedded systems dev where you're
really worried about these specific
really worried about these specific
classes of errors. Stuff is really
classes of errors. Stuff is really
fiddly, but like it's being massively
fiddly, but like it's being massively
overused.
He is just like so easy
He is just like so easy
is just like it's just so easy.
Hey, welcome boxing.
How you going to be on stream for today?
How you going to be on stream for today?
No idea.
No idea.
Probably until I figure out environment
Probably until I figure out environment
plus a few other things.
Oops. Actually,
I just saw
it actually might not be a bad time for
it actually might not be a bad time for
me to go take a couple meetings. I have
me to go take a couple meetings. I have
a bunch of messages. I'm mostly going to
a bunch of messages. I'm mostly going to
be waiting for uh the meta guys to reply
be waiting for uh the meta guys to reply
on like where they've moved everything.
This checking out your PO implementation
This checking out your PO implementation
modification.
modification.
I've checked
I've checked
are what
implement differences are the advantage
implement differences are the advantage
parameter sweeps.
parameter sweeps.
So it is
So it is
muon is a big one. Trajectory level uh
muon is a big one. Trajectory level uh
trajectory segment level advantage
trajectory segment level advantage
filtering with prioritized experience
filtering with prioritized experience
replay is another one. Uh the new
replay is another one. Uh the new
advantage filter uh the new advantage
advantage filter uh the new advantage
function is another one.
function is another one.
Sure I missed a couple but the rest it's
Sure I missed a couple but the rest it's
like all in the blog post on X as well.
like all in the blog post on X as well.
discuss papers
discuss papers
late. So
around six hours
you should get more than six hours of
you should get more than six hours of
sleep in I would highly suggest that uh
sleep in I would highly suggest that uh
I the six hours is
I the six hours is
like 8ish maybe can just if you message
like 8ish maybe can just if you message
me later in the evening uh I might still
me later in the evening uh I might still
be around. It depends. cuz I got to go
be around. It depends. cuz I got to go
to sleep early tonight, though, cuz I
to sleep early tonight, though, cuz I
got to get up early for uh SF trips.
got to get up early for uh SF trips.
Long day. All right. Well, get some
Long day. All right. Well, get some
rest, man.
rest, man.
I got to go take this meeting. So, the
I got to go take this meeting. So, the
folks who've uh been tuning in, I will
folks who've uh been tuning in, I will
probably be back afterwards once I
probably be back afterwards once I
finish this and then the meta guys reply
finish this and then the meta guys reply
and tell me where they've moved all the
and tell me where they've moved all the
stuff around to. We'll probably be
stuff around to. We'll probably be
working on getting this end of training
working on getting this end of training
nicely with their new code. Um, for
nicely with their new code. Um, for
anyone who's new here, I stream all my
anyone who's new here, I stream all my
research. Sometimes we do fiddly
research. Sometimes we do fiddly
optimization stuff like you've seen.
optimization stuff like you've seen.
Sometimes we make drones fly in sim in
Sometimes we make drones fly in sim in
really cool ways. I just stream all the
really cool ways. I just stream all the
dev. Interested in my work more
dev. Interested in my work more
generally at puffer.ai.
generally at puffer.ai.
Help me out for free by starting the
Help me out for free by starting the
repo. We're almost at 3k stars. Want to
repo. We're almost at 3k stars. Want to
get involved with dev? Join the Discord.
get involved with dev? Join the Discord.
We've had a huge number of people join
We've had a huge number of people join
this in the past couple of weeks. And
this in the past couple of weeks. And
yeah, you can follow me on X for all
yeah, you can follow me on X for all
those resources.
those resources.
Thanks and I will see you around.

Kind: captions
Language: en
Good morning.
Be live here.
Be live here.
That's working. Hi.
Few things to work on today.
Okay, so still the drone stuff to figure
Okay, so still the drone stuff to figure
out. I don't think the experiments went
out. I don't think the experiments went
super great on this overnight. Uh, I
super great on this overnight. Uh, I
didn't really have time to queue up
didn't really have time to queue up
stuff the way I wanted to. I don't think
stuff the way I wanted to. I don't think
it
I kind of don't want to spend a whole
I kind of don't want to spend a whole
bunch of time today just fiddling with
bunch of time today just fiddling with
the drone stuff when I think it's
the drone stuff when I think it's
mostly a uh a problem of automated
mostly a uh a problem of automated
automating the experiments at this
automating the experiments at this
point. It seems like it should be pretty
point. It seems like it should be pretty
stable.
Let's see what happened to guy here,
Let's see what happened to guy here,
right?
right?
drone 10 bill
got all these like weird jumps in it,
got all these like weird jumps in it,
right?
Yeah. And then this PF is
kind of weird.
kind of weird.
I think it crashed actually because this
I think it crashed actually because this
looks like Yeah, this is only a three
looks like Yeah, this is only a three
bill.
bill.
It must have crashed.
That's a bit annoying, right?
Yeah, you can see we have ns in here.
And we've seen this before in a lot of
And we've seen this before in a lot of
different I don't think this is bug. I
different I don't think this is bug. I
think we just have some stability stuff
think we just have some stability stuff
that we need to uh prove.
that we need to uh prove.
And as as you get longer and longer
And as as you get longer and longer
runs, write larger and larger
runs, write larger and larger
experiments, you run into these edge
experiments, you run into these edge
cases way more often.
trying to think what the best way is to
trying to think what the best way is to
approach this.
Like I kind of want to just run an
Like I kind of want to just run an
automated sweep on this and work on
automated sweep on this and work on
other stuff for a bit because I do think
other stuff for a bit because I do think
that there are hyper prim in here that
that there are hyper prim in here that
should dissolve it,
should dissolve it,
right?
But
But
we do end up getting nanned out. A lot
we do end up getting nanned out. A lot
of them
like fixing the nan thing is going to
like fixing the nan thing is going to
actually be
actually be
that's like something I'm going to do in
that's like something I'm going to do in
the next big engineering task cuz that's
the next big engineering task cuz that's
actually going to be a fair bit of work.
I might just give myself like a small
I might just give myself like a small
budget of time to mess with it manually
budget of time to mess with it manually
just for a little bit.
just for a little bit.
If I can get something stable.
I think that's going to uh
I think that's going to uh
best option here.
best option here.
Like
Like
if I do this,
our starting point,
our starting point,
right?
right?
We like fit this to the
start here and then we'll see.
We'll do two bill
We'll do two bill
10 minute experiment is not ideal but
10 minute experiment is not ideal but
terrible.
terrible.
Use this time to start sort of thinking
Use this time to start sort of thinking
about some other stuff in the process.
Another day, another M script activate.
Well, I guess when we do use MS, we have
Well, I guess when we do use MS, we have
UV, so it'll be a little different from
UV, so it'll be a little different from
that. But yeah,
there's a whole bunch of new stuff I
there's a whole bunch of new stuff I
want to start on to be fair. Um, we're
want to start on to be fair. Um, we're
not just going to do drone things all
not just going to do drone things all
day today. I'm
day today. I'm
going to give myself a little time to
going to give myself a little time to
just fiddle with this a bit since seems
just fiddle with this a bit since seems
like for whatever reason on this
like for whatever reason on this
specific end we have more instability
specific end we have more instability
when running automated experiments. You
when running automated experiments. You
tend to like crash some stuff.
But after this we've got stuff to do on
But after this we've got stuff to do on
meta which is this uh like grid based
meta which is this uh like grid based
kind of factoryes and
kind of factoryes and
need to get like some basic basic things
need to get like some basic basic things
running on this.
uh later in the week on that. Have a
uh later in the week on that. Have a
head start.
Welcome to the folks on YouTube.
I have a couple new projects. Well, I
I have a couple new projects. Well, I
actually have several new projects in
actually have several new projects in
mind that would all be like relatively
mind that would all be like relatively
simple to get started on like at least
simple to get started on like at least
wouldn't take a huge amount of time.
wouldn't take a huge amount of time.
Um the project in material science I
Um the project in material science I
just started uh discussing with the
just started uh discussing with the
material scientists Stanford yesterday.
material scientists Stanford yesterday.
I think would be very cool for research
I think would be very cool for research
stuff we can do in robotics. I have um I
stuff we can do in robotics. I have um I
I've started like looking into how we
I've started like looking into how we
would do our own 60F arm sim
would do our own 60F arm sim
do that. That'd be a little bit of math
do that. That'd be a little bit of math
but it would not terrible I think.
but it would not terrible I think.
Uh and then there's also this power
Uh and then there's also this power
optimization problem.
optimization problem.
There's a lab that would be very very
There's a lab that would be very very
happy if we gave them them for that.
Lots and lots of applications to
Lots and lots of applications to
really the main bottleneck at the moment
really the main bottleneck at the moment
is just how many meetings I've got. Kind
is just how many meetings I've got. Kind
of getting my mind out of the dev swing.
of getting my mind out of the dev swing.
Awesome to catch you live. Just started
Awesome to catch you live. Just started
recording my Hearthstone clone puffer.
recording my Hearthstone clone puffer.
Well, that's awesome. So, uh, let me
Well, that's awesome. So, uh, let me
show you something. I don't think we
show you something. I don't think we
ever uploaded the there's a probably an
ever uploaded the there's a probably an
open PR for this. I just haven't merged.
open PR for this. I just haven't merged.
Uh it's Noah in the discord that uh
Uh it's Noah in the discord that uh
helped us. I did the initial bit.
helped us. I did the initial bit.
Okay. So there's this Magic the
Okay. So there's this Magic the
Gathering style clone here and uh we
Gathering style clone here and uh we
have some good ways to design this so
have some good ways to design this so
that it's useful for RL. So like you can
that it's useful for RL. So like you can
play a land and play a zero cost one one
play a land and play a zero cost one one
pass or you attack you swing
pass or you attack you swing
block play my land I play my uh two mana
block play my land I play my uh two mana
3 three
3 three
that's all I can do attack phase
that's all I can do attack phase
you know so on and so forth
you know so on and so forth
we have um
we have um
we have like really good ways to set
we have like really good ways to set
this stuff up for RL
this stuff up for RL
if you want to chat about that at some
I think the very important thing to
I think the very important thing to
getting it to work is going to be to as
getting it to work is going to be to as
much as possible just make it like the
much as possible just make it like the
whole UI of this I'm literally just
whole UI of this I'm literally just
pressing the buttons one through nine
pressing the buttons one through nine
and enter. So I've gotten it down to a
and enter. So I've gotten it down to a
very small number of button combos to
very small number of button combos to
take all the actions. That makes a big
take all the actions. That makes a big
difference.
Okay. So, we are still stuck on or
Okay. So, we are still stuck on or
whatever.
whatever.
Go check the
the episode return here and
not super great.
Going to start getting better set up.
Going to start getting better set up.
Trying to remember.
Trying to remember.
I have to do this on the remote, right?
Got to do this on vote.
Is it worth doing a sort of OCR
Is it worth doing a sort of OCR
technique the cards
technique the cards
got the number
got the number
definitely don't want to be doing like
definitely don't want to be doing like
from pixels hardstone
from pixels hardstone
that's going to be terrible.
that's going to be terrible.
You don't like if you're building the
You don't like if you're building the
sim, you don't need to do that, right?
sim, you don't need to do that, right?
Because like just have the numbers in
Because like just have the numbers in
the sim and you can observe them
the sim and you can observe them
directly.
Once you're talking about doing OCR on
Once you're talking about doing OCR on
pixels, you're like you're basically
pixels, you're like you're basically
you've lost by about five orders of
you've lost by about five orders of
magnitude in speed already.
You see this number here?
You see this number here?
This says that it's doing 3.1 million
This says that it's doing 3.1 million
interactions with the environment per
interactions with the environment per
second.
second.
That's training on 3.1.
That's training on 3.1.
So
So
if the drone is I think what are we
if the drone is I think what are we
doing hertz or 50 hertz or something
doing hertz or 50 hertz or something
like that let's call it 50 htz even so
like that let's call it 50 htz even so
that is what
thousand seconds I believe of data
thousand seconds I believe of data
second of interaction thousand seconds
second of interaction thousand seconds
per second uh that is almost 20 hours of
per second uh that is almost 20 hours of
data or like 17ish hours data every
data or like 17ish hours data every
single second.
A lot of data
actually you just divide this number by
actually you just divide this number by
50, right? You divide by 50, you get
50, right? You divide by 50, you get
your Did I say 60? Yeah, 60,000. It's
your Did I say 60? Yeah, 60,000. It's
running at 60,000 times real.
Learn it physics engine.
Learn it physics engine.
Learn
Learn
physics engine.
If you want to learn the physics engine
If you want to learn the physics engine
itself,
I've seen some stuff in this area. I I
I've seen some stuff in this area. I I
don't know if it works generally.
don't know if it works generally.
So the thing with RL, right, is as long
So the thing with RL, right, is as long
as you actually have access to P
as you actually have access to P
simulator dynamics randomize,
simulator dynamics randomize,
uh, it tends to be self-correcting,
uh, it tends to be self-correcting,
right? So like rather than the drone,
right? So like rather than the drone,
and this is the thing we're going to try
and this is the thing we're going to try
to get as well, we're going to try to
to get as well, we're going to try to
set this up so that rather than having
set this up so that rather than having
errors between the sim and the real
errors between the sim and the real
world accumulate,
world accumulate,
agent's actually going to be
agent's actually going to be
selfcorrecting,
selfcorrecting,
right? such that if the if its actions
right? such that if the if its actions
don't produce exactly the effect that it
don't produce exactly the effect that it
desires,
desires,
it will see that instantly
it will see that instantly
automatically correct core. That's the
automatically correct core. That's the
really cool thing that you can do with
really cool thing that you can do with
RL.
RL.
And we actually have some decent
And we actually have some decent
evidence.
evidence.
Um the problem is when you replace the
Um the problem is when you replace the
sim with an approximation of the sim
sim with an approximation of the sim
that like fails in like qualitatively
that like fails in like qualitatively
quite different ways.
quite different ways.
I don't know whether you get that same
I don't know whether you get that same
thing or you get the opposite which is
thing or you get the opposite which is
errors compounding.
Definitely don't want that one.
Exponentially compounding errors is very
Exponentially compounding errors is very
bad.
You guys are doing practical. We're
You guys are doing practical. We're
trying to be practical here, right? I
trying to be practical here, right? I
mean, this is a it's a research lab, but
mean, this is a it's a research lab, but
uh it's we're not doing research just
uh it's we're not doing research just
like to make ourselves feel clever,
like to make ourselves feel clever,
right? We're trying to actually solve
right? We're trying to actually solve
problems with it.
High performance sim in general seems
High performance sim in general seems
like a good tool, like good investment,
like a good tool, like good investment,
right? Being able to learn from large
right? Being able to learn from large
quantities of interaction data like a
quantities of interaction data like a
very good investment.
very good investment.
And we're sort of just spiraling out
And we're sort of just spiraling out
into different application areas looking
into different application areas looking
for problems that okay, we have this
for problems that okay, we have this
core fundamental tech. What can we solve
core fundamental tech. What can we solve
mostly how I look at things
trying to think what I can do about this
trying to think what I can do about this
drone sim not working amazingly well.
It just be the data ratios.
Could literally just
ratios, right?
ratios, right?
Well, let's actually at least have
Let's see if I can get them to like not
Let's see if I can get them to like not
facing
There's probably just some stuff we can
That's That's not any good.
Did rings pass go up.
Oh, you know what? This actually did
Oh, you know what? This actually did
kind of go up.
kind of go up.
Let me at least eval this locally
Let me at least eval this locally
because this might
because this might
this might kind of be worth something.
Get rid of
all right. So, here is uh the racing
all right. So, here is uh the racing
policy. Good.
policy. Good.
Here's our like go to wherever
Here's our like go to wherever
kind of drift around and do your thing.
like kind of a thing, but it's not
like kind of a thing, but it's not
brilliant, right?
How about the flag? The flag is like a
How about the flag? The flag is like a
really visually obvious one. Works.
Yeah. Really not
Yeah. Really not
not doing it this side. Okay.
not doing it this side. Okay.
Well, we'll play with this.
Definitely play with this.
bring any of the flag task
doing land robots not flying yet.
Well, I actually we're starting with the
Well, I actually we're starting with the
air ones because we don't have to do
air ones because we don't have to do
contact
contact
just like way easier.
just like way easier.
People have asked us about like
People have asked us about like
quadripeds.
quadripeds.
I don't know. I think we could probably
I don't know. I think we could probably
eventually do quadripeds.
I think I'd be more interested though in
I think I'd be more interested though in
um like a six degree of freedom arm
would probably be ideal.
would probably be ideal.
Actually, I got to ask a roboticist why
Actually, I got to ask a roboticist why
all the arms are six degrees of freedom.
all the arms are six degrees of freedom.
Like what can you do with six degrees
Like what can you do with six degrees
that you can't do with four? Is it like
that you can't do with four? Is it like
one,
one,
two,
two,
is it two joints on a six degree arm or
is it two joints on a six degree arm or
is it
two joints?
Yeah. No, it is. It's like
Is it three joints?
Is it three joints?
Yeah.
Yeah.
Oh, it's because you can't do wrists,
Oh, it's because you can't do wrists,
right? It's because you don't have the
right? It's because you don't have the
ball socket for uh for a wrist that you
ball socket for uh for a wrist that you
have to do it.
have to do it.
Quad spiders doing wrestling is good.
Quad spiders doing wrestling is good.
You have like physical. You have it on
You have like physical. You have it on
real hardware doing wrestling. That's
real hardware doing wrestling. That's
cool.
Should try our RL stack.
Like our RL is probably just going to be
Like our RL is probably just going to be
way simpler and faster.
way simpler and faster.
the stuff out there.
the stuff out there.
Plus, we just we have our own algorithm,
Plus, we just we have our own algorithm,
right?
right?
Be better than whatever PO
Be better than whatever PO
implementation.
Let's get him. Lag
Let's get him. Lag
virtual semi. Okay. not that far off
virtual semi. Okay. not that far off
from what we're
from what we're
Yeah, definitely try our algo then. See
Yeah, definitely try our algo then. See
if it just works better for you.
Uh yeah, let's just let's get the flag
Uh yeah, let's just let's get the flag
while I'm chatting here. Let's let's get
while I'm chatting here. Let's let's get
the flag baseline. I'm going to start
the flag baseline. I'm going to start
messing with this. I think that there
messing with this. I think that there
are like some things I want to tweak
are like some things I want to tweak
with collision.
with collision.
My first time seeing this. taking
My first time seeing this. taking
inspiration from nature.
inspiration from nature.
Um
Um
the inspiration is very loose at best. I
the inspiration is very loose at best. I
would say
would say
it is sort of in the sense that you have
it is sort of in the sense that you have
very local rewards that produce global
very local rewards that produce global
behaviors. I suppose
I have a lot of material on RL for
I have a lot of material on RL for
beginners on my uh my X articles tab.
beginners on my uh my X articles tab.
Right.
So, at least now we have a decent dev
So, at least now we have a decent dev
cycle, right? This is like one minute.
We're just going to go off of Perf.
Might have to up the learning rate. See
So, I the thing that I want to mess with
So, I the thing that I want to mess with
here.
Yeah. See, it's a multiplicative reward.
Yeah. See, it's a multiplicative reward.
Probably bad.
It does end up learning this pretty
It does end up learning this pretty
well. I think
with a 1.4% collision rate, right?
See
if this changes anything. Just I sort of
if this changes anything. Just I sort of
realize there's a bit of an issue
realize there's a bit of an issue
doing it before.
Hey Aar, what do you think about gold
Hey Aar, what do you think about gold
medal immo?
medal immo?
Yeah, that's kind of crazy.
Yeah, that's kind of crazy.
Um, I don't understand how it is that
Um, I don't understand how it is that
they have IMO AI before they have AI
they have IMO AI before they have AI
that can do any of the super basic
that can do any of the super basic
programming that I do for all of this.
programming that I do for all of this.
But somehow we live in a world where we
But somehow we live in a world where we
have gold medal metal imo AI that like
have gold medal metal imo AI that like
can't do basic autonomous programming.
can't do basic autonomous programming.
The gold code. Yes.
I've been meaning to read your paper
I've been meaning to read your paper
with Ken by the way. I have not gotten
with Ken by the way. I have not gotten
the chance to. I really should.
The thing is like math is not and maybe
The thing is like math is not and maybe
I'm wrong. Maybe I put it on too much of
I'm wrong. Maybe I put it on too much of
a pedestal, but I math really isn't that
a pedestal, but I math really isn't that
structured and narrow, right? It really
structured and narrow, right? It really
is this crazy
is this crazy
crazy search and exploration task, isn't
crazy search and exploration task, isn't
it?
I mean, heck, like writing the code is
I mean, heck, like writing the code is
not
not
it really requires not that much
it really requires not that much
creativity what I'm doing here, right?
creativity what I'm doing here, right?
Like a lot of stuff is just like keeping
Like a lot of stuff is just like keeping
things simple and not trying to make
things simple and not trying to make
yourself feel clever at
yourself feel clever at
writing bad code.
Oh.
Oh.
Hey guys, I just made it way better.
Hey guys, I just made it way better.
There you go. My rewards were dumb.
There you go. My rewards were dumb.
and uh 1%.
and uh 1%.
That's like a pretty solid improvement.
Want to like uh let's just let's see
Want to like uh let's just let's see
real quick how this looks.
real quick how this looks.
200 million steps. So, one minute for
200 million steps. So, one minute for
flag behavior.
Yeah, if you wait around a second at
Yeah, if you wait around a second at
Cart, we'll show you drones forming an
Cart, we'll show you drones forming an
American flag.
Been having fun with these.
Let me I'll read your comment on this
Let me I'll read your comment on this
thing.
Okay.
Okay.
Happy
think I have to switch the task on. This
think I have to switch the task on. This
is D.
They're only trained on the flag T.
They're only trained on the flag T.
Okay.
not randomized.
To be fair, these are like all sorts of
To be fair, these are like all sorts of
different shaped kind of hard for them.
different shaped kind of hard for them.
Nice. This doesn't look quite as good as
Nice. This doesn't look quite as good as
it should, though. I think that I didn't
it should, though. I think that I didn't
fully Oh, you know what it is? It's that
fully Oh, you know what it is? It's that
I didn't change the reward. So, yeah, I
I didn't change the reward. So, yeah, I
got to commit it to get it to look
got to commit it to get it to look
exactly the same.
exactly the same.
like the paper but it implies a lot of
like the paper but it implies a lot of
things for neurations learned by SG.
things for neurations learned by SG.
Does it actually apply apply imply a lot
Does it actually apply apply imply a lot
of things or is it like imply that the
of things or is it like imply that the
old theory is bad?
old theory is bad?
I will have to go look.
I will have to go look.
You do this every day?
You do this every day?
Uh pretty much I do take days off
Uh pretty much I do take days off
occasionally.
occasionally.
I also have meetings that I don't don't
I also have meetings that I don't don't
stream
stream
my dev. I stream. Yeah,
I should actually make this work real
I should actually make this work real
quick cuz this will look really cool if
quick cuz this will look really cool if
I
made it real quick.
I wish I had my
I wish I had my
high-end local box. I should probably
high-end local box. I should probably
just buy another one. Bought so many
just buy another one. Bought so many
damn desktops. Kind of sick of setting
damn desktops. Kind of sick of setting
new up
and hang on.
us.
Our
paper basically says optimization
paper basically says optimization
creates messy neural representations
on policy and
on policy and
everything is kind of like slightly off
everything is kind of like slightly off
policy.
Essie
there work like that literally the more
there work like that literally the more
you optimize the better the
you optimize the better the
representations get more compressed they
representations get more compressed they
get
get
sentiment neuron stuff and stuff
sentiment neuron stuff and stuff
interpretability work,
not much creativity, I think.
But me saying that there's not much
But me saying that there's not much
creativity in a lot of the sim work I
creativity in a lot of the sim work I
do.
do.
I mean, the creativity came from like
I mean, the creativity came from like
how to set it up the way that it's now
how to set it up the way that it's now
easy and straightforward.
easy and straightforward.
It's not that bad at the moment.
Generational. Oh, yeah. This is way
Generational. Oh, yeah. This is way
better. Yeah. So, here we go. There's
better. Yeah. So, here we go. There's
your flag.
your flag.
Keep in mind the drones are all
Keep in mind the drones are all
different sizes, so they all control
different sizes, so they all control
differently.
differently.
But yeah, that's a pretty clean American
But yeah, that's a pretty clean American
flag.
If I give it the exact same drone for
If I give it the exact same drone for
all of them and it's like a perfect
all of them and it's like a perfect
flag.
flag.
But yeah, this is and you can see they
But yeah, this is and you can see they
like they self-organized.
like they self-organized.
This is trained in one minute, right?
This is trained in one minute, right?
Yes, it shared weight. So that's the
Yes, it shared weight. So that's the
tricky thing, right? It's shared weight.
tricky thing, right? It's shared weight.
But if you look at the drones, look, do
But if you look at the drones, look, do
you see how they're completely like some
you see how they're completely like some
of them are bigger, some of them are
of them are bigger, some of them are
smaller? They have all different
smaller? They have all different
weights, inertia, all sorts of different
weights, inertia, all sorts of different
parameters. And the agent can't see
parameters. And the agent can't see
these parameters. So basically, the
these parameters. So basically, the
agent has to do online system
agent has to do online system
identification in the weights of the LS
identification in the weights of the LS
in the latent space LSTM
in the latent space LSTM
in order to do this.
in order to do this.
So it's like dramatically harder to do
So it's like dramatically harder to do
this than it is to do it for a single
this than it is to do it for a single
drone. I'll show you the difference if I
drone. I'll show you the difference if I
just do it for a single drone with like
just do it for a single drone with like
how easy it is by comparison.
how easy it is by comparison.
It's kind it's like implicit meta RL I
It's kind it's like implicit meta RL I
guess you could say. We're just doing
guess you could say. We're just doing
this for robustness. Um but here I'll
this for robustness. Um but here I'll
show you the difference.
I mean this is just the type of stuff
I mean this is just the type of stuff
that would like never work correctly
that would like never work correctly
before when things were slow but now it
before when things were slow but now it
kind of works with stuff being fast. Let
kind of works with stuff being fast. Let
me get you this
me get you this
take like one minute.
take like one minute.
We had like what 967 before like
you can also so I have it working now
you can also so I have it working now
that you can have the drones do a ton of
that you can have the drones do a ton of
different formations with one policy.
different formations with one policy.
All the drones do different formations
All the drones do different formations
or you can have the drones like race.
or you can have the drones like race.
Um but you I can't yet get them cleanly
Um but you I can't yet get them cleanly
racing and doing formations. That's the
racing and doing formations. That's the
next thing.
next thing.
One policy just does all drones.
Yeah, I've known about that for a bit.
Yeah, I've known about that for a bit.
A'll
A'll
be good.
be good.
I want to steal him for some nut hack
I want to steal him for some nut hack
work officially starts.
[Music]
Okay, so the collision rate is down like
Okay, so the collision rate is down like
about half of what it was before
about half of what it was before
already.
Perf is a bit higher as well. One drone.
Perf is a bit higher as well. One drone.
Let's uh let's see what this looks like.
Let's uh let's see what this looks like.
I think it should be pretty clean.
takes ages to train.
A minute too long for training for you.
With anything other than pop, this would
With anything other than pop, this would
literally take over. You'd have to
literally take over. You'd have to
overnight this.
I could probably optimize the dev loop
I could probably optimize the dev loop
quite a bit more to be fair and I should
quite a bit more to be fair and I should
put the time in to do that.
put the time in to do that.
Can only spend so much time optimizing
Can only spend so much time optimizing
dev loop.
All right, so here is
Yeah, look way cleaner flag, right? This
Yeah, look way cleaner flag, right? This
is basically spot on
like a school of fish where they try to
like a school of fish where they try to
avoid each other as well. Like when one
avoid each other as well. Like when one
of them gets out of place, they all kind
of them gets out of place, they all kind
of shift around it a little bit. Like
of shift around it a little bit. Like
this guy was like, "Hey, get out of my
this guy was like, "Hey, get out of my
way. How you doing? You're in my spot."
way. How you doing? You're in my spot."
Yeah, Magnus.
Okay. I mean, so this just works.
I actually am kind of happy that like
I actually am kind of happy that like
it's not fully perfect because you can
it's not fully perfect because you can
kind of see like this guy doesn't know
kind of see like this guy doesn't know
what to do because this guy's in his
what to do because this guy's in his
spot.
spot.
This guy's probably doesn't know what to
This guy's probably doesn't know what to
do because this guy's in his spot. So
do because this guy's in his spot. So
it's like a school of fish.
Now this guy's like
Now this guy's like
they only see local neighborhood. Uh
they only see local neighborhood. Uh
they see their goal and they literally
they see their goal and they literally
only see the nearest drone to them.
They don't see very much at all.
Back to the randomized variant. That's
Back to the randomized variant. That's
actually like hard.
I mean, so based on this
the full task again. Maybe
not quite the full task. I think we do
not quite the full task. I think we do
this one.
Oh, yeah. I know, right? You see the
Oh, yeah. I know, right? You see the
neural MMO 3 policies though, Aar?
neural MMO 3 policies though, Aar?
Because if you've seen the neural MMO 3
Because if you've seen the neural MMO 3
stuff, like basically there's almost
stuff, like basically there's almost
nothing I should be able to do that's
nothing I should be able to do that's
surprising at
like a crazy policy.
I think it's just it doesn't really
I think it's just it doesn't really
matter though. It's like a two line of
matter though. It's like a two line of
code change one or the other.
This is probably not trained for long
This is probably not trained for long
enough here is my guess for all these
enough here is my guess for all these
tasks. We'll see.
Low 90 is
Low 90 is
good though.
Higher.
Higher.
No. 3% collisions. Fine.
So, this is the multitask setup.
So, this is the multitask setup.
This is training the drones for bunch of
This is training the drones for bunch of
different formations. I'm not expecting
different formations. I'm not expecting
this one to be amazing
this one to be amazing
because
because
all these different tasks and I didn't
all these different tasks and I didn't
train for any longer to compensate.
train for any longer to compensate.
Right.
Right.
We can absolutely train this for longer
We can absolutely train this for longer
and get something better. But I just
and get something better. But I just
want to test if the changes that I made
want to test if the changes that I made
actually help over
actually help over
think we should get at least
set
set
Uh,
oh yeah, there was also there's a guy
guy I want to chat with about um
guy I want to chat with about um
Pokemon followup search.
How many I missed?
[Music]
All right, here we go. That runs now.
Okay, so this go diffuse task. This
Okay, so this go diffuse task. This
fine.
fine.
The hover in place task
The hover in place task
mostly hovering in place. Little bit
mostly hovering in place. Little bit
off.
off.
Little bit off.
Definitely way better than the racing
Definitely way better than the racing
model because this is like pretty close
model because this is like pretty close
to a sphere, right?
Follow task. Here's cube.
Follow task. Here's cube.
They form a cube
They form a cube
like a cube. That's pretty close, right?
This one. This one one's hard.
Oh yeah, though. It's like it's kind of
Oh yeah, though. It's like it's kind of
getting it. Like look at these ones.
getting it. Like look at these ones.
They're like
They're like
starting to do the Congo.
starting to do the Congo.
That one's a tough task. I kind of want
That one's a tough task. I kind of want
to train that one on just to see. Here's
to train that one on just to see. Here's
the flag.
the flag.
So, this will be the good comparison for
So, this will be the good comparison for
us. So this is like you can see this is
us. So this is like you can see this is
a little bit worse than before because
a little bit worse than before because
we've trained on all these different
we've trained on all these different
tasks. It doesn't have enough data for
tasks. It doesn't have enough data for
this. Really not that much like a little
this. Really not that much like a little
bit jiggly.
bit jiggly.
That's kind of it. So
That's kind of it. So
pretty happy with this.
pretty happy with this.
I think for my taste this is like
I think for my taste this is like
what's this?
what's this?
Go in a ball I guess.
Go in a ball I guess.
Pretty
good policy.
good policy.
Let's see if we can do the racing one.
Let's see if we can do the racing one.
Now,
we're going to make this slightly longer
we're going to make this slightly longer
to account for the racing task, but not
to account for the racing task, but not
massively longer. I
massively longer. I
do like this.
do like this.
Okay, we'll we'll we will rebuild and
Okay, we'll we'll we will rebuild and
I'll do four let's do like 400 million
I'll do four let's do like 400 million
steps.
In practice, these things suck up a ton
In practice, these things suck up a ton
of data. In theory, we should just be
of data. In theory, we should just be
able to do like 400 mil. It should be
able to do like 400 mil. It should be
fine
terminals. Lovely.
I'm really interested characterizing all
I'm really interested characterizing all
M's which have local interaction
M's which have local interaction
local
all possible
all possible
you have to be a little bit careful AAR
you have to be a little bit careful AAR
because if you don't like if there's not
because if you don't like if there's not
at least some structure then you're
at least some structure then you're
training on random MDPs
training on random MDPs
just random noise and you can't really
just random noise and you can't really
compress random noise
compress random noise
there has to be some notion of all
there has to be some notion of all
reasonable M's or something like that
reasonable M's or something like that
right
you're willing to do like all reasonable
you're willing to do like all reasonable
M's then come on like just start
M's then come on like just start
implementing over
implementing over
No idea what's going on. Sorry.
No idea what's going on. Sorry.
Presentation on
Presentation on
neural MMO
neural MMO
start learning this. Where should I
start learning this. Where should I
start? Thank you. That is my PhD
start? Thank you. That is my PhD
presentation that you saw. Um
presentation that you saw. Um
I will link you there. We do have
I will link you there. We do have
resources for beginners. Now
resources for beginners. Now
people kept asking me for them for so
people kept asking me for them for so
long that I just went and I actually
long that I just went and I actually
made some.
my articles tab.
my articles tab.
Got the quick start guide.
Got the quick start guide.
Got the ultra opinionated guide to
Got the ultra opinionated guide to
reinforcement learn. There's the more
reinforcement learn. There's the more
general intro guide.
Only structure is local interaction.
You just want to like fit some small
all
update rule. This is like the cellular
update rule. This is like the cellular
automa thing that you were doing before,
automa thing that you were doing before,
right?
right?
I mean, you can go ahead and try it.
I mean, you can go ahead and try it.
Like
Like
stuff is so fast now that things that
stuff is so fast now that things that
didn't work before probably work and uh
didn't work before probably work and uh
our algorithms have just gotten better.
our algorithms have just gotten better.
So
So
what are your thoughts about paper
what are your thoughts about paper
talking about how RL with randomware
talking about how RL with randomware
that's some janky language model thing
that's some janky language model thing
that's absolutely not true generally
the closest thing that we have to like
the closest thing that we have to like
some janky random thing doing stuff like
some janky random thing doing stuff like
R&D random network distillation or
R&D random network distillation or
whatever and that relies on the fact
whatever and that relies on the fact
that like random convolutions.
that like random convolutions.
They'll give you some uh still give you
They'll give you some uh still give you
image prior.
image prior.
Not really random.
Not really random.
Also, locomotion,
random rewards or random goals.
I don't trust any of this stuff,
I don't trust any of this stuff,
honestly. Like I'll look at a paper if
honestly. Like I'll look at a paper if
you want to link something quickly, but
you want to link something quickly, but
I kind of just assume all published
I kind of just assume all published
research is wrong by default because
research is wrong by default because
it's literally it's like I'm right 80%
it's literally it's like I'm right 80%
of the time just that.
of the time just that.
What machine are you using to train less
What machine are you using to train less
than a minute? A MacBook takes three
than a minute? A MacBook takes three
hours
hours
with Puffer. It definitely shouldn't
with Puffer. It definitely shouldn't
take three hours with Puffer. If it
take three hours with Puffer. If it
takes one minute on my machine with a
takes one minute on my machine with a
MacBook, it should take you anywhere
MacBook, it should take you anywhere
between five and 20 minutes, not take
between five and 20 minutes, not take
three hours.
three hours.
M4 would probably be like 10 minutes.
Wasn't this literally This is
Wasn't this literally This is
legitimately better than before, isn't
legitimately better than before, isn't
it? I've never seen 86% on this task.
Wait, but there's no rings passed. Hang
Wait, but there's no rings passed. Hang
on. Did I do something wrong?
Rebuild.
I'm confused.
Something wrong here.
Something wrong here.
Have rings passed.
how many PPO steps can you get in that
how many PPO steps can you get in that
hack billions?
hack billions?
Uh, we haven't tried that hard at KH
Uh, we haven't tried that hard at KH
because
because
we basically need to go mess around with
we basically need to go mess around with
the way the multi-threading works and
the way the multi-threading works and
the architecture and stuff.
the architecture and stuff.
I think you get environment bottlenecked
I think you get environment bottlenecked
until we do a little bit of engineering
until we do a little bit of engineering
which is the main thing that we would
which is the main thing that we would
have to do that.
have to do that.
Um
Um
if we can make it faster my guess will
if we can make it faster my guess will
be we can't solve the game for sure
be we can't solve the game for sure
because you need you need external
because you need you need external
knowledge to solve the game. Um but I
knowledge to solve the game. Um but I
think we can do a heck of a lot better
think we can do a heck of a lot better
than the current benchmarks
cuz like billions is not that much even
cuz like billions is not that much even
if we can get billions. So neural MMO 3,
if we can get billions. So neural MMO 3,
we did 640 billion and we didn't
we did 640 billion and we didn't
saturate it.
The net hack is harder than neural MMO
The net hack is harder than neural MMO
3.
Realize the paper's regards to offline.
Realize the paper's regards to offline.
Well, offline RL is just not RL.
It's just not RL supervised learning.
Survival instinct offline. RL
None of the normal authors.
like the simplest possible path.
Welcome
Oh, are they doing a thing where just
Oh, are they doing a thing where just
like
like
if the rewards are positive for have a
if the rewards are positive for have a
survival bias? Um because you get more
survival bias? Um because you get more
total rewards if you survive for longer.
total rewards if you survive for longer.
So that's not like that the rewards are
So that's not like that the rewards are
wrong, it's that some of the rewards are
wrong, it's that some of the rewards are
wrong, I guess.
Yeah. Okay, I'd believe that.
But the thing is like the only reason
But the thing is like the only reason
that it trains at all is because the
that it trains at all is because the
task is trivial.
task is trivial.
Like you can't give it wrong rewards and
Like you can't give it wrong rewards and
have it solve anything that's like
have it solve anything that's like
tough.
They're not robot. These are like Yeah,
They're not robot. These are like Yeah,
these are not robotics tests, are they?
these are not robotics tests, are they?
What are these? No, these are actually
What are these? No, these are actually
Hang on.
Right. But they have demonstration data
Right. But they have demonstration data
because it's offline. So that's still
because it's offline. So that's still
trivial with demonstration data. It's
trivial with demonstration data. It's
hard online.
hard online.
Yeah. Yeah.
Yeah. Yeah.
Okay. If I've interpreted it correctly,
Okay. If I've interpreted it correctly,
then yeah. Okay. That's kind of true.
then yeah. Okay. That's kind of true.
But it's not it's not like the result
But it's not it's not like the result
that's like, oh yeah, you can just train
that's like, oh yeah, you can just train
with wrong rewards.
They completely randomized. I'd have to
They completely randomized. I'd have to
see if there's a bias though because
see if there's a bias though because
they talked about length bias and like
they talked about length bias and like
because you have a term state. Um
because you have a term state. Um
like let's say you have positive rewards
like let's say you have positive rewards
then it's always better to just survive
then it's always better to just survive
for longer.
for longer.
Offline RL does not scale at all.
Offline RL does not scale at all.
What do you mean doesn't scale at all?
What do you mean doesn't scale at all?
Like it doesn't get outside of the data
Like it doesn't get outside of the data
support, right?
support, right?
Is that what you mean?
Is that what you mean?
Yeah, it doesn't get outside of the data
Yeah, it doesn't get outside of the data
support at least not by much. Which is
support at least not by much. Which is
why it's just dumb supervised learning.
why it's just dumb supervised learning.
Why? Like, oh yeah, we can do offline
Why? Like, oh yeah, we can do offline
RL's kind of stupid
learning.
Okay, so I had just forgotten to
Okay, so I had just forgotten to
recompile it. Uh, this is still better
recompile it. Uh, this is still better
than before though.
than before though.
That's
That's
like a few percentage points better than
like a few percentage points better than
before and in way less data.
I think that there's still um
I think that there's still um
some stuff we can
That looks a little better than before.
That looks a little better than before.
Not like a good sphere, but at least
Not like a good sphere, but at least
like they've got some intentionality to
like they've got some intentionality to
them now where they actually like go to
them now where they actually like go to
the targets quite quickly.
the targets quite quickly.
It's only 400 million steps.
It's only 400 million steps.
That's like not terrible. Okay,
That's like not terrible. Okay,
progress.
progress.
Keep in mind this is also training on
Keep in mind this is also training on
racing at the same time. So like half of
racing at the same time. So like half of
the data fully is racing data. It's like
the data fully is racing data. It's like
a very weird task distribution.
Broken glass and readers all day. Now
Broken glass and readers all day. Now
it's fun to read.
it's fun to read.
Yeah.
Uh I mean reading academic papers is
Uh I mean reading academic papers is
basically
basically
okay that's actually a recognizable flag
okay that's actually a recognizable flag
which we did not have before.
which we did not have before.
So
So
and that's progress
and that's progress
again. This is a very very hard setting
again. This is a very very hard setting
here we're doing cuz it's it's mixing in
here we're doing cuz it's it's mixing in
race data. Like let me see if I can show
race data. Like let me see if I can show
you the race data. Oh yeah, it's not
you the race data. Oh yeah, it's not
even doing the race data on this.
Actually see the racing policy.
Q-learning is not yet scalable.
Wait, Q-learning is not offline.
Your learning is off, Paul.
Wait, what?
I think bias
get the bias from generalized advantage
get the bias from generalized advantage
estimation.
estimation.
It based to a specific horizon.
Yeah, the strict one step is really
Yeah, the strict one step is really
stupid though. Correct.
stupid though. Correct.
Um, it's not strict one step though
Um, it's not strict one step though
because Rainbow like they do like three
because Rainbow like they do like three
or five step. Still dumb.
Yeah, like this. Some of these problems
Yeah, like this. Some of these problems
are just trivial. Oh, I guess it's a
are just trivial. Oh, I guess it's a
humanoid, which is like a
humanoid, which is like a
pure robotics only benchmark. It's also
pure robotics only benchmark. It's also
not a great way to do RL.
Okay, 1 billion is not near infinite
Okay, 1 billion is not near infinite
data. 1 billion is small. Uh, you think
data. 1 billion is small. Uh, you think
1 billion is infinite because your
1 billion is infinite because your
simulators are slow as
the data set to cover it. Don't know how
the data set to cover it. Don't know how
you did that.
But like if you do vanilla Q-learning,
But like if you do vanilla Q-learning,
it's just a bad algorithm. That's like
it's just a bad algorithm. That's like
comparing to reinfor
Oh, but they also did SAC. Okay,
Oh, but they also did SAC. Okay,
huh?
1,000x larger than typical data set.
1,000x larger than typical data set.
Yeah, this is you guys just trolling.
Yeah, this is you guys just trolling.
Like, if you're trying to do RL with
Like, if you're trying to do RL with
million like a million observations,
million like a million observations,
you're just being dumb.
Like this blog post is fine so far, but
Like this blog post is fine so far, but
like the context for this is a lot of
like the context for this is a lot of
the offpaul work like or the offline
the offpaul work like or the offline
work trying to do anything with a
work trying to do anything with a
million data points is just stupid.
Stop improving at all after billions of
Stop improving at all after billions of
steps.
Well, this almost seems wrong, right?
Well, this almost seems wrong, right?
like can't possibly go down.
Yeah. So, horizon reduction does work.
Yeah. So, horizon reduction does work.
Um,
the thing is that we kind of can just
the thing is that we kind of can just
solve RL with very long horizons anyways
solve RL with very long horizons anyways
because we're fast
hierarchical. What? What hierarchical
hierarchical. What? What hierarchical
methods?
methods?
available
available
off
your thing is
your thing is
they're conflating offline and off
they're conflating offline and off
policy a little bit, right?
policy a little bit, right?
It's like fundamentally you do need
It's like fundamentally you do need
fresh data when you're doing when you
fresh data when you're doing when you
don't have expert data. You will always
don't have expert data. You will always
need fresh data because your stupid
need fresh data because your stupid
policy can't collect good data, right?
Yeah, their scaling curve definitely
Yeah, their scaling curve definitely
shouldn't go down a little. That's
shouldn't go down a little. That's
sketch. Hey, Sahil, welcome.
Are you one of the people who have
Are you one of the people who have
messaged me who I haven't replied to
messaged me who I haven't replied to
yet? I've been meaning to get to all the
yet? I've been meaning to get to all the
DMs asking for meetings. I've have a lot
DMs asking for meetings. I've have a lot
of them in the last couple
I think this is a red herring. Honestly,
I don't know if I agree with this
I don't know if I agree with this
conclusion at all. Like
The thing is that every like all of RL
The thing is that every like all of RL
is slightly off policy.
is slightly off policy.
Pretty much the only thing that you
Pretty much the only thing that you
really want from off policy is you want
really want from off policy is you want
the ability to reuse old highquality
the ability to reuse old highquality
data. But that doesn't mean you don't
data. But that doesn't mean you don't
want to stop collecting new data. You
want to stop collecting new data. You
want as much fresh data as you can
want as much fresh data as you can
possibly get and then you want to like
possibly get and then you want to like
compute fill basically while you're
compute fill basically while you're
waiting with for new data. You want to
waiting with for new data. You want to
fill with high quality old data? No,
fill with high quality old data? No,
just saw some stuff in my live feed. All
just saw some stuff in my live feed. All
right, cool
representational
representational
doesn't learn a good rep.
We have on policy working very very well
We have on policy working very very well
in the high data. Now
in the high data. Now
I mean the proof of this is just stuff
I mean the proof of this is just stuff
that don't hear. Oh, hey Kevin. They got
that don't hear. Oh, hey Kevin. They got
feedback from Kevin on
interesting post. Um
interesting post. Um
I don't
I don't
Horizon reduction is basically like make
Horizon reduction is basically like make
the problem simpler is thing
cuz like the techniques that they have
cuz like the techniques that they have
there like endstep and hierarchical and
there like endstep and hierarchical and
stuff like you get a certain amount out
stuff like you get a certain amount out
of those but at some point it's like the
of those but at some point it's like the
really long horizons are not really
really long horizons are not really
amendable to algorithmic horizon
amendable to algorithmic horizon
reduction as far as I've seen. There
reduction as far as I've seen. There
might be a way around it. You definitely
might be a way around it. You definitely
don't want to have all your tasks be
don't want to have all your tasks be
robotics like this
on the paper. All right, cool.
on the paper. All right, cool.
Not a good skill. Yeah, I agree.
Not a good skill. Yeah, I agree.
I mean I will say on the research side
I mean I will say on the research side
the most uh the thing that we are most
the most uh the thing that we are most
interested in doing next is at least
interested in doing next is at least
some form of semi-off Paul basically but
some form of semi-off Paul basically but
I I think people are looking at it kind
I I think people are looking at it kind
of wrong right what you want to have is
of wrong right what you want to have is
you don't want to have like all these
you don't want to have like all these
fancy algorithms right you want to have
fancy algorithms right you want to have
an algorithm crank up all the data you
an algorithm crank up all the data you
have unlimited data you can use as
have unlimited data you can use as
little compute as possible or you want
little compute as possible or you want
to be able to crank it the other way and
to be able to crank it the other way and
use less data data with more compute and
use less data data with more compute and
you want that to be like a clean
you want that to be like a clean
tradeoff with the simplest algorithm
tradeoff with the simplest algorithm
possible. That's what you want.
Chunking has been crucial. Yeah, it's
Chunking has been crucial. Yeah, it's
cuz you guys have no data though. Like
cuz you guys have no data though. Like
they're like they're bragging about
they're like they're bragging about
their 1 billion samples that they've
their 1 billion samples that they've
collected. Like, okay, here's 400
collected. Like, okay, here's 400
million in two minutes. We have 640
million in two minutes. We have 640
billion that we run on one uh we run
billion that we run on one uh we run
this on one server. We've done 640
this on one server. We've done 640
billion observations
billion observations
online as well like
online as well like
right.
Uh did I look at this yet? I did look at
Uh did I look at this yet? I did look at
this policy already. I I should have had
this policy already. I I should have had
this running while I was chatting.
this running while I was chatting.
We need to run this for a little longer.
We need to run this for a little longer.
I have 10 minute run.
I have 10 minute run.
Okay, number to beat is 86% with 3.3%
Okay, number to beat is 86% with 3.3%
collisions. Let's see if we can get that
collisions. Let's see if we can get that
to work. And I'm going to Neptune.
Uh, also I see next algorithm use best
Uh, also I see next algorithm use best
hypers.
hypers.
So gamma is the horrible hyper, right?
So gamma is the horrible hyper, right?
Gamma is the really really awful one.
Gamma is the really really awful one.
Uh, because it implies a fixed horizon.
Uh, because it implies a fixed horizon.
I will say that on fitting hypers like
I will say that on fitting hypers like
we kind of just made the hyperparameter
we kind of just made the hyperparameter
tuning algorithm better so it's not as
tuning algorithm better so it's not as
much of a problem anymore.
much of a problem anymore.
But the problem with using less hypers
But the problem with using less hypers
right is like you typically can always
right is like you typically can always
design for any algorithm that you design
design for any algorithm that you design
right you can always make it better by
right you can always make it better by
introducing more hyperparameters because
introducing more hyperparameters because
you add more degrees of freedom
that's the tough part
like basically what you could do right
like basically what you could do right
is you could define a new algorithm
is you could define a new algorithm
could define like awesome advantage or
could define like awesome advantage or
whatever is just generalized advantage
whatever is just generalized advantage
estimation with gamma hardcoded to 0.99
estimation with gamma hardcoded to 0.99
and lambda hardcoded to 0.9 right and
and lambda hardcoded to 0.9 right and
now it doesn't have the hyperparameters
now it doesn't have the hyperparameters
um but like generalized advantage
um but like generalized advantage
estimation with proper tuning is always
estimation with proper tuning is always
going to be better
going to be better
a lot of the like the no hyperprem
a lot of the like the no hyperprem
algorithms are actually just this in
algorithms are actually just this in
disguise right where they've just kind
disguise right where they've just kind
of like stripped away degrees of freedom
of like stripped away degrees of freedom
set some reasonable defaults
Even when it doesn't look like they've
Even when it doesn't look like they've
set constants, usually it's like they've
set constants, usually it's like they've
set a constant to one basically so it
set a constant to one basically so it
cancels.
That's the tough the tough part that
I would love to have no hyper pram RL
I would love to have no hyper pram RL
but um what I've kind of seen it's like
but um what I've kind of seen it's like
little tricky. Now, we absolutely do
little tricky. Now, we absolutely do
need to come up with something that's
need to come up with something that's
not gamma.
not gamma.
Gamma as a hyper pram has been a
Gamma as a hyper pram has been a
disaster.
Um,
they're not differentiable is the
they're not differentiable is the
problem.
problem.
Not using carbs. But at least we have
Not using carbs. But at least we have
something a little better than carbs
something a little better than carbs
now, right? We've got protein.
now, right? We've got protein.
One of our improvements in 3L
problem is a lot of the like the hypers
problem is a lot of the like the hypers
aren't differentiable
aren't differentiable
generally very difficult to make the
generally very difficult to make the
hypersable
You'd have to switch the comparisons as
You'd have to switch the comparisons as
well because basically if you're going
well because basically if you're going
to fit those hyperparameters online
to fit those hyperparameters online
like the actual training run that you do
like the actual training run that you do
going to take longer than a well
going to take longer than a well
hyperparameter tuned
hyperparameter tuned
individual run.
individual run.
Comparisons get very fiddly. It's not
Comparisons get very fiddly. It's not
that it's a bad idea, but you're going
that it's a bad idea, but you're going
to have to be very careful with how you
to have to be very careful with how you
define everything.
Just go up and then back down.
Yeah. So, this was like doing better and
Yeah. So, this was like doing better and
then it kind of did this
500 some odd mil.
AI.
AI.
Yeah, we're uh we're working on that.
Yeah, we're uh we're working on that.
Actually, I'm going to probably as soon
Actually, I'm going to probably as soon
as I finish this, I'm going to be
as I finish this, I'm going to be
hacking on that. Um the training is all
hacking on that. Um the training is all
puffer, you know.
how this happened. Guess let's check
how this happened. Guess let's check
Perf.
Oh, Perf is actually a bit more stable
Oh, Perf is actually a bit more stable
though, right? Like look at this. 2%
though, right? Like look at this. 2%
higher trending upward. It's
the gems.
Yeah,
rate should be going down faster than
Well, we still have some knobs to
Well, we still have some knobs to
Do other
Oh,
I don't think that this did very much,
I don't think that this did very much,
which is actually not terrible for us
which is actually not terrible for us
because it go back to a reasonable step
Okay. I mean, the racing policy is good,
Okay. I mean, the racing policy is good,
right?
It's like super snappy.
I forget to randomize the drones.
I did randomize during
my whisker racer game. Trained fairly
my whisker racer game. Trained fairly
well last night. 50k.
Uh, what are you training it on?
I'd have to see the stats.
On a good GPU, you should be able to hit
On a good GPU, you should be able to hit
millions with Puffer.
Yeah. So, here's the drone racing with
Yeah. So, here's the drone racing with
all sorts of different types of
all sorts of different types of
It's still nice and robust.
here. Right.
here. Right.
This
cube
guys make
guys make
pretty close.
pretty close.
That's pretty darn close.
That's pretty darn close.
How much of a flag do you guys make?
How much of a flag do you guys make?
Recognizable flag.
Just about a recognizable flag.
Track made with JPEG and R.
Yeah, you kind of just want to draw a
Yeah, you kind of just want to draw a
bunch of curves probably with bezier
bunch of curves probably with bezier
functions.
functions.
Probably just want to draw a bunch of
Probably just want to draw a bunch of
curves, man.
curves, man.
Not do that like loading stuff.
Not do that like loading stuff.
Definitely don't want to be
Definitely don't want to be
bottlenecked.
bottlenecked.
Not a fun place to be, especially
Not a fun place to be, especially
because if you try to scale anything
because if you try to scale anything
like even more bottlenecked because then
like even more bottlenecked because then
you have more GPUs cores
you have more GPUs cores
or really fast are nice.
or really fast are nice.
Okay. So, go down to 500 mele
steps.
Now,
Now,
there a few other things I wanted to do
there a few other things I wanted to do
this.
So, I'm going to add the uh
reward
reward
here.
So just shy of 10 rings
So just shy of 10 rings
85 per.
Now this should actually make the racing
Now this should actually make the racing
policy a bit worse on paper.
policy a bit worse on paper.
Uh because it'll tell the drones to not
Uh because it'll tell the drones to not
crash.
crash into.
crash into.
At the moment, they're told to not crash
At the moment, they're told to not crash
each other when SW, but the racing one,
each other when SW, but the racing one,
they're told to do what?
they're told to do what?
We're gonna see what this does.
Great. Garbage error.
Clearly no usable error messaging.
Yep.
Oh, we're way way way worse on Perf now,
Oh, we're way way way worse on Perf now,
huh?
That's funny. That totally crashes
That's funny. That totally crashes
training, huh?
It's actually like better at some
It's actually like better at some
weird.
Oh, you know what? Maybe it's not bad.
Oh, you know what? Maybe it's not bad.
Hang on. Maybe it's just the Maybe it's
Hang on. Maybe it's just the Maybe it's
just a difference in logging.
Difference logging. Okay.
They look a bit more spread out to me.
can obviously improve observations
can obviously improve observations
similar, right? But
here's a little worse.
worse.
Generally, mostly a little worse.
Definitely makes it harder.
kind of did the uh the data mix
kind of did the uh the data mix
arbitrarily, didn't I?
You think we still get the same problem
You think we still get the same problem
if I just do this?
I think we're not going to get a good
I think we're not going to get a good
racing policy. I do it this way.
racing policy. I do it this way.
The idea is like what if I just do
The idea is like what if I just do
random over tasks like this?
Maybe you don't need that much racing.
Maybe you don't need that much racing.
Who knows?
and totally mess up the ring's Last
and totally mess up the ring's Last
minute.
Looks like it's not learning the racing
Looks like it's not learning the racing
task at all yet.
got good collision Right.
almost like up to the same purpose.
almost like up to the same purpose.
Well,
guess it makes sense because the reward
guess it makes sense because the reward
function is kind of fundamentally
function is kind of fundamentally
different, right?
What do I do about this?
I try one more thing. I hate doing like
I try one more thing. I hate doing like
these experiments.
these experiments.
I think this is like a 2:1ish ratio.
Please add information about what we're
Please add information about what we're
trying to do here.
trying to do here.
I think I have Did I add the links to
I think I have Did I add the links to
the uh the YouTube? I thought I had
the uh the YouTube? I thought I had
links added automatically to my
links added automatically to my
description.
Yeah, we have links, don't we?
Yeah, we have links, don't we?
All the information is on puper.ai.
All the information is on puper.ai.
It's all like live reinforcement
It's all like live reinforcement
learning dev.
At the moment, this is
working on simulated drones.
Get this to train and I'll say a little
Get this to train and I'll say a little
bit about it. What I'm trying to do at
bit about it. What I'm trying to do at
the moment, right, is I have a neural
the moment, right, is I have a neural
net that can train drones to do swarming
net that can train drones to do swarming
formations and I have a neural net that
formations and I have a neural net that
can train drones to do uh racing.
can train drones to do uh racing.
I'm trying to see if I can get one
I'm trying to see if I can get one
neural net to do all the different
neural net to do all the different
tasks.
tasks.
Been a little bit tricky. So
Been a little bit tricky. So
bit tricky.
If this actually
it'll be pretty funny if this doesn't
it'll be pretty funny if this doesn't
work. I basically just guessed
work. I basically just guessed
my first probably had a mix last night.
It looks like it is at least getting
It looks like it is at least getting
some signal now.
some signal now.
Yeah. Okay.
Yeah. Okay.
So, it's at least learning now that uh
So, it's at least learning now that uh
with a quarter of the data on racing and
with a quarter of the data on racing and
three quarters of the data to swarming,
three quarters of the data to swarming,
it actually does at least learn the
it actually does at least learn the
racing task a bit now.
Just saying. Thank you.
Just saying. Thank you.
All sorts of fundra
messed up.
Curious to see what the heck type of
Curious to see what the heck type of
policy we get out of this.
policy we get out of this.
This backward
backwards.
backwards.
Yeah, it would be
Oh, it is backwards.
Oh, it is backwards.
Totally backwards.
Well, get a very good racing policy with
Well, get a very good racing policy with
three quarters of the data on obviously
just hack something real quick.
You like this?
I think we're getting the rewards
I think we're getting the rewards
blended up too much.
This isn't even necessarily reward
This isn't even necessarily reward
design. It's just the fact that like
design. It's just the fact that like
the rewards don't really line up too
the rewards don't really line up too
nicely across um different objectives
nicely across um different objectives
have. So, the only reason this is a
have. So, the only reason this is a
problem is you're doing multi-objective
Yeah, but with a quarter of the data,
Yeah, but with a quarter of the data,
we're still not learning.
I figure that this would learn.
Wonder if this is a problem where we can
Wonder if this is a problem where we can
use bigger batch sizes cuz like
use bigger batch sizes cuz like
we have all these different tasks. Maybe
we have all these different tasks. Maybe
it is something that could benefit from
it is something that could benefit from
very large batches.
very large batches.
Actually,
it is starting to learn the ring task.
Okay, so in the meantime, while this
Okay, so in the meantime, while this
finishes training, looks like it's
finishes training, looks like it's
finally caught on.
give it the penalty. I think
give it the penalty. I think
needs to get the uh the distance penalty
needs to get the uh the distance penalty
or the collision penalty
thing.
regarding touring machines able to solve
regarding touring machines able to solve
fourdigit edition.
fourdigit edition.
Nicely done. I actually don't know what
Nicely done. I actually don't know what
that looks like in a touring machine.
that looks like in a touring machine.
How many operations is that?
gets to 76 per
gets to 76 per
like 2.8 rings, right?
like 2.8 rings, right?
See if this helps or hinders
any
I need binary operation
I need binary operation
not oper
so it actually I mean it takes a while
so it actually I mean it takes a while
to discover that I'd imagine
So, interestingly,
So, interestingly,
this improves performance,
this improves performance,
but it's no longer learning the ring
but it's no longer learning the ring
task at all.
Not at all
on the
Yeah. So that's like combinatorial
Yeah. So that's like combinatorial
tough exploration.
tough exploration.
Kind of brute force it a little bit
Kind of brute force it a little bit
though.
I just barely got a little bit of ring
forever to learn this. Yeah, I would
forever to learn this. Yeah, I would
expect so. Sounds like it should take
expect so. Sounds like it should take
forever.
Is there any other way I can bring this
Is there any other way I can bring this
drone ring reward in line with the storm
drone ring reward in line with the storm
reward?
reward?
It's a little annoying because like
you have to go you have to hit the
you have to go you have to hit the
target from a specific direction.
I could make all of the objectives have
I could make all of the objectives have
a specific pose technically, right?
It's a little difficult though when it's
It's a little difficult though when it's
like stationary versus fly through a
like stationary versus fly through a
target.
If I just do two policies, it's a lot
If I just do two policies, it's a lot
easier, isn't
Let's play around with the um
Let's play around with the um
getting like irritating. Let's play
getting like irritating. Let's play
around a little bit with
Congo is a very hard task
Congo is a very hard task
for a swarm.
for a swarm.
See if it can do this.
Hey, the vectorization is stuff uh for
Hey, the vectorization is stuff uh for
variant of
variant of
place. traditional play buffer
max out heart pole. Okay, cool.
max out heart pole. Okay, cool.
Um,
trying to think what a good problem
trying to think what a good problem
would be. Not going to want to be doing
would be. Not going to want to be doing
this stuff in a notebook very long. I
this stuff in a notebook very long. I
can tell you that.
Probably like breakout or something.
Maybe you have to start with Pong. Pong
Maybe you have to start with Pong. Pong
is faster to solve.
is faster to solve.
New to this field and I'm learning data
New to this field and I'm learning data
science. Never worked on RL. Can you
science. Never worked on RL. Can you
talk about the metrics on
talk about the metrics on
right? So the metrics on the right are a
right? So the metrics on the right are a
whole bunch of losses.
whole bunch of losses.
Um they're not actually all that useful
Um they're not actually all that useful
in reinforcement learning. Pretty much
in reinforcement learning. Pretty much
they're not supposed to explode. If they
they're not supposed to explode. If they
explode they're bad. Like that's bad
explode they're bad. Like that's bad
ones that I do occasionally look at. So
ones that I do occasionally look at. So
entropy crashing too low means the
entropy crashing too low means the
policy is taking deterministic action
policy is taking deterministic action
really bad. Um clip frack being too high
really bad. Um clip frack being too high
your policy is making gigantic unstable
your policy is making gigantic unstable
updates
updates
and uh yeah the rest of them generally
and uh yeah the rest of them generally
just not blow up otherwise you have
just not blow up otherwise you have
numerical stuff.
numerical stuff.
You've seen this error before in eval
You've seen this error before in eval
but not in train
but not in train
helping debug for some else
helping debug for some else
I use
Not.
Yeah, Spencer. It's probably
Yeah, Spencer. It's probably
if you look at the way the actions are
if you look at the way the actions are
being sampled, they're probably like not
being sampled, they're probably like not
an array or not the right data type or
an array or not the right data type or
something.
If you change like the data type or you
If you change like the data type or you
change like maybe it was like an like a
change like maybe it was like an like a
numpy array and like they added an extra
numpy array and like they added an extra
dimension or something, it'll break.
dimension or something, it'll break.
API usage error means that you're doing
API usage error means that you're doing
something wrong.
something wrong.
Just like print out the data types and
Just like print out the data types and
shapes before and after.
What are they doing with the action
What are they doing with the action
Nice.
change to different one. I had 137 and
change to different one. I had 137 and
now we're going
now we're going
you loading one policy like a policy
you loading one policy like a policy
that's old that's like outputting
that's old that's like outputting
actions that are outside the range.
actions that are outside the range.
That'll break it.
Not perfect, but pretty dang good.
what this looks like without
what this looks like without
randomization.
randomization.
94 does better without random.
94 does better without random.
If so, then we can use that as our like
If so, then we can use that as our like
hard task
ID.
What was the issue? racing. So basically
What was the issue? racing. So basically
for any of these tasks, we can get any
for any of these tasks, we can get any
of the individual tasks to work on their
of the individual tasks to work on their
own. Get racing to work on its own, get
own. Get racing to work on its own, get
swarming to work on its own. It's just
swarming to work on its own. It's just
trying to do all these tasks together
trying to do all these tasks together
with randomization and everything else
with randomization and everything else
is hard. Actually, that's probably what
is hard. Actually, that's probably what
I should do next is I should try them
I should do next is I should try them
jointly without randomization.
ly this doesn't seem to do any better at
ly this doesn't seem to do any better at
the moment.
the moment.
Generally the uh non-randomized
Generally the uh non-randomized
train initially
it still has half this
think we'll try to see if nonrandomiz
think we'll try to see if nonrandomiz
actually works
actually works
across all tasks next. That'll be
across all tasks next. That'll be
decent.
decent.
How goes the grifting?
I thought you weren't on Twitter
I thought you weren't on Twitter
constantly. Ryan, how's it going?
When When are we doing net hack AGI?
Still waiting on my
Still waiting on my
When are we doing net hack AGI, man?
coin.
Yeah, FYI folks, none of those coins are
Yeah, FYI folks, none of those coins are
real. Like people, a lot of people keep
real. Like people, a lot of people keep
making fake coins like labeled puffer.
making fake coins like labeled puffer.
There's no coin.
I had jury duty,
I had jury duty,
got sick, so big dud. That sucks.
Straight to jail. Not to not collect
Straight to jail. Not to not collect
$200.
Not pass go. Straight to jail.
Interesting
that this doesn't to be
that this doesn't to be
to be much better, but
We have all sorts of cool new stuff that
We have all sorts of cool new stuff that
we're starting though with we're
we're starting though with we're
starting to actually
starting to actually
we're starting to actually figure out
we're starting to actually figure out
some cool applications part of science
some cool applications part of science
but
I have a day or two to start before RLC
I have a day or two to start before RLC
and then a week after
and then a week after
Canada.
Canada.
Oh man, that's rough. No barbecue for
Oh man, that's rough. No barbecue for
you.
Is there a thing where like is RLC the
Is there a thing where like is RLC the
conference where everybody has talks or
conference where everybody has talks or
no? Do I just have to make a poster?
I think I should just have to make a
I think I should just have to make a
poster, right? Or is there talks? We all
poster, right? Or is there talks? We all
have eight minute talks. Oh, great. So,
have eight minute talks. Oh, great. So,
I got to figure that out.
I got to figure that out.
That'll be problem for me next week.
I mean, this is visibly like slightly
I mean, this is visibly like slightly
better. It's not perfect.
better. It's not perfect.
Drone Congo is very Congo.
Like the drone congo
board poster
buffer poster.
This is a decent enough task on it.
buffer and syllabus yellow and now yeah
buffer and syllabus yellow and now yeah
I'm done I'm done presenting like I'm
I'm done I'm done presenting like I'm
done publishing
done publishing
too much of a
Think of it
yellows.
Yeah, this is true.
Yeah, this is true.
The growth on Puffer lately has been
The growth on Puffer lately has been
absolutely great. Like
your uh How's your new advisor on here?
All right, I'm more than halfway there,
All right, I'm more than halfway there,
man.
That's how it works, right? When you get
That's how it works, right? When you get
more Twitter followers, you become the
more Twitter followers, you become the
professor.
But yeah, like the uh
But yeah, like the uh
Huffer's been almost did 3K stars on it,
Huffer's been almost did 3K stars on it,
too.
Working on it.
Working on it.
Get like 10 likes.
Get like 10 likes.
Yeah.
Well, it's it has to do with density,
Well, it's it has to do with density,
right? If you post about a bunch of
right? If you post about a bunch of
different topics,
you don't have the density.
I pretty much post only RL. And like
I pretty much post only RL. And like
usually when people post random dumb
usually when people post random dumb
funny stuff, it gets like more
funny stuff, it gets like more
attention.
attention.
But when I post random dumb like stuff,
But when I post random dumb like stuff,
it gets no attention. It's like the
it gets no attention. It's like the
entire audience is there for the
entire audience is there for the
technical RLC.
technical RLC.
Kind of awesome.
Like even the normal like oh big company
Like even the normal like oh big company
bad stuff gets no attention, right?
bad stuff gets no attention, right?
Literally just the pure technical
Literally just the pure technical
content. Kind of great.
I want it to be even easier. It's just I
I want it to be even easier. It's just I
can't spend all my time on making it
can't spend all my time on making it
easier because I also have to spend time
easier because I also have to spend time
on like solving stuff.
search.
search.
I mean, I I really just care about
I mean, I I really just care about
making RL work as a field. So, I don't
making RL work as a field. So, I don't
mind doing all theing
mind doing all theing
and stuff. I do mind having to deal with
and stuff. I do mind having to deal with
Python's packaging for that.
Python's packaging.
Okay, so I reduced us to um a smaller
Okay, so I reduced us to um a smaller
network
network
and now we're training at up to 4
and now we're training at up to 4
million steps per second.
million steps per second.
Uh it's still
Uh it's still
almost same PF
almost same PF
9.2.
So
need to really make it just file one end
need to really make it just file one end
of at a time because it's ridiculous.
Add that it wouldn't that long.
2% collision.
Okay, almost identical,
Okay, almost identical,
but we'll stick with the small policy
but we'll stick with the small policy
cuz due to deploy anyways.
How do we improve this?
Let's go
take a quick look at um
I mean
I mean
pretty good
pretty good
curve.
curve.
These aren't comparable.
pretty good train curve.
I wonder if it's somehow more stable.
I wonder if it's somehow more stable.
Can I just literally do
this and have it work better?
my training. This is Okay, this is
my training. This is Okay, this is
randomizations
randomizations
on the Congo task.
on the Congo task.
Probably the hardest of the swarm tasks.
What else we could with this
word signal should be very good.
Should return very very low.
really tempted.
Maybe I will try that.
Maybe I will try that.
This would return like
if that even
standardized advance. I think it's
That hack is going to be cool. I think
That hack is going to be cool. I think
it's
it's
it's the type of thing where we're going
it's the type of thing where we're going
to have to definitely run all the speed
to have to definitely run all the speed
tests first to make sure it's actually
tests first to make sure it's actually
feasible.
feasible.
Like if it's below 100k,
Like if it's below 100k,
below 100k is not fun.
Honestly, I'd like to have it at a
Honestly, I'd like to have it at a
million.
million.
If we can get that
If we can get that
supposed to actually run at a million,
supposed to actually run at a million,
isn't it?
isn't it?
Can actually just get the data from
Can actually just get the data from
point A to point B fast enough to run
point A to point B fast enough to run
them.
There's like no reason that game 100k
There's like no reason that game 100k
like old school C.
Have you ever just gotten like the
Have you ever just gotten like the
low-level interface and run it in a for
low-level interface and run it in a for
loop and seen how fast it is?
loop and seen how fast it is?
Conditional checks don't matter. CPUs
Conditional checks don't matter. CPUs
love conditional.
We have tons of them.
Full
if statements are slow business
if statements are slow business
of jacks.
out real quick.
This crap is definitely low.
We're going to just delete all the end
We're going to just delete all the end
rappers.
about the rent. Yeah.
All of these like spaces things,
All of these like spaces things,
they have this super messy space.
Like you need to not even you can't like
Like you need to not even you can't like
you need to not even grab and like be
you need to not even grab and like be
copying all this to only grab the stuff
copying all this to only grab the stuff
you actually need.
you actually need.
Ideally, you would start with the
Ideally, you would start with the
minimal set of observations that get
minimal set of observations that get
away with. make it really fast. And then
away with. make it really fast. And then
what else you actually need there?
They have like a thousand for loop here
of like what this is
like just a lot of Python.
It's just they have a lot of Python
It's just they have a lot of Python
that's kind of like
that's kind of like
Yeah,
Yeah,
like lots of Python.
It's set gem space to four and three
It's set gem space to four and three
is appearing in their second act.
Seriously?
Um, well, did they change the action
Um, well, did they change the action
head?
like hardcoded.
Shouldn't be able to have a three
Word skill makes a meaningful friends.
They get to almost
They get to almost
not reward scale being
not reward scale being
observations then.
I focus on poster editing if
I focus on poster editing if
all my work done. I'm starting to hack,
all my work done. I'm starting to hack,
bro. How do you have uh how long does it
bro. How do you have uh how long does it
take to make a poster in a talk, man?
take to make a poster in a talk, man?
I'm allocating like two days for this
I'm allocating like two days for this
max.
Taking posters is boring work.
Taking posters is boring work.
No fun.
Well, okay. Let's just do
figure out
comments
near velocity.
Polish syllabus.
Polish syllabus.
I see. Okay.
I see. Okay.
Moving to Canada.
Yeah, it sounded good. Let me know
Yeah, it sounded good. Let me know
of all the things.
Do we really think that it's like
Do we really think that it's like
observations needing to be rotated or
observations needing to be rotated or
some weird thing?
I just be able to learn this.
Maybe it can't
To be fair, we have these like really
To be fair, we have these like really
shallow nets, right?
Wait, come.
All right. You know that things are
All right. You know that things are
stupid when I'm like starting to
stupid when I'm like starting to
actually mess with this, but we'll do it
actually mess with this, but we'll do it
anyways for
Why the hell did I just do this one?
Why the hell did I just do this one?
Dummy.
Dummy.
I don't know what that
the drone right
There.
a mess of all.
help me with RL project.
Um,
you have a whole community of people on
you have a whole community of people on
Discord. you're like new to RL and
Discord. you're like new to RL and
getting into stuff.
So
So
have to add
have to add
like add
discord.gg/puffer.
I just want to see if it's like a dumb
I just want to see if it's like a dumb
model capacity or depth thing.
Like I kind of forget that we use tiny
Like I kind of forget that we use tiny
little so often, but
I did actually catch one like oversight
I did actually catch one like oversight
and puffer withization.
and puffer withization.
Good that I happen to look at this. I
Good that I happen to look at this. I
don't know if it makes a huge difference
don't know if it makes a huge difference
to anything at all, but it is a it is a
to anything at all, but it is a it is a
difference.
funny enough, this actually does worse
funny enough, this actually does worse
so far.
Thank you.
probably like over optimization at this
probably like over optimization at this
point.
point.
I guess
I guess
I'll rerun this just to this shouldn't
I'll rerun this just to this shouldn't
make it workization.
I play with a few more things before I
I play with a few more things before I
just like decide that manually fiddling
just like decide that manually fiddling
with this is not a good use of time.
Give yourself a little bit of time to
Give yourself a little bit of time to
tinker with these.
Looks like a better curve.
Is this closer
person on the
tried making up loops for RLM loop. LLM
tried making up loops for RLM loop. LLM
loops. No. Trying to do everything
loops. No. Trying to do everything
except that
except that
models are just so big and clunky. Like
models are just so big and clunky. Like
there's really nothing you can do with
there's really nothing you can do with
them.
them.
Stupid amounts of comput
only. Oh, wait.
Ax mini battery.
Now we're at 5 million steps per
bigger batches.
if this makes any friends.
message. It's like slightly worse far.
message. It's like slightly worse far.
Nice and consistent, but like slightly
Nice and consistent, but like slightly
warped.
gets to the same spot though.
I'll take it if we're going to get the
I'll take it if we're going to get the
uh the same level of perf
uh the same level of perf
level of perf
faster.
Hypers just have not been swept in a
Hypers just have not been swept in a
long time.
Realistically, that's just going to be
Realistically, that's just going to be
the blocker till I sweep the hypers.
the blocker till I sweep the hypers.
Like, find a stable way to sweep hypers.
Like, find a stable way to sweep hypers.
Not going to be a ton I can do with it
Not going to be a ton I can do with it
that's better than this.
Let me just try the defaults real quick.
Let me just try the defaults real quick.
Like you literally
Like you literally
you never know really in RL
to see if there's like something to
to see if there's like something to
this, right?
I don't think this will do anything.
I don't think this will do anything.
It's worth trying to do.
Way slower. Holy.
Way slower. Holy.
Forgot about that.
Try this next
just tinkering experiments.
After that, we'll say, "Okay, I tried
After that, we'll say, "Okay, I tried
all the obvious stuff. I'll have to just
all the obvious stuff. I'll have to just
automate some sweeps and figure out how
automate some sweeps and figure out how
to make them stable.
Here's a restroom real quick. I'll be
Here's a restroom real quick. I'll be
right back.
All right.
Okay. These defaults didn't work at all.
Why would the mini batch size bigger?
It's reasonable perf.
It's reasonable perf.
think I'm expecting this to do any
think I'm expecting this to do any
better, but every so often it's like,
better, but every so often it's like,
hey, you go and you fix your problem and
hey, you go and you fix your problem and
work.
Worth checking.
Worth checking.
Not we'll just figure out how to set up
Not we'll just figure out how to set up
a sweep that doesn't crash.
lower. Hard to say if it's like actually
lower. Hard to say if it's like actually
plateaued low and unstable right here.
plateaued low and unstable right here.
This one was actually
This one was actually
hyper just
probably doing too much tinkering here.
probably doing too much tinkering here.
In fact, if I knew that this sweeps were
In fact, if I knew that this sweeps were
stable, I would not been done.
Always invest more.
Not right.
We'll see how that goes.
A whole bunch of small changes to add
A whole bunch of small changes to add
here.
Actually, I don't want to run that sweep
Actually, I don't want to run that sweep
box.
Get it set up on the other one.
All
right. So, we'll see how stable this
right. So, we'll see how stable this
end.
Now, we're not going to have this box. I
Now, we're not going to have this box. I
need this one. It's the fast box.
I have no recollection what the last
I have no recollection what the last
date of this was.
See
like a reasonably quick turnar around
like a reasonably quick turnar around
time for this.
Oh yeah, there's Leela's cool.
All right. So, this is training, right?
All right. So, this is training, right?
So, uh, the fun problem we're going to
So, uh, the fun problem we're going to
have is I'm going to merge this and
have is I'm going to merge this and
we're going to have about 50 million
we're going to have about 50 million
commits worth of insanity,
at least a version.
Oh,
Oh,
apparently I ran five bill at some
apparently I ran five bill at some
point.
Got bunch of hearts.
We're just going to see what the latest
We're just going to see what the latest
thing goes.
Yeah, the config's totally changed. Got
Yeah, the config's totally changed. Got
uh
difference.
Actually don't know if this one
Actually don't know if this one
stick with this for now.
stick with this for now.
A reasonable baseline
A reasonable baseline
to work.
might clipping a bunch.
might clipping a bunch.
Looks like it could.
Looks like it could.
Oh, how the heck it got knocked over.
Oh, how the heck it got knocked over.
Weird.
Weird.
When I did that,
When I did that,
could be better.
Okay, so this is actually working very
Okay, so this is actually working very
well. It's going right up.
If I go to sync this, how bad is it
If I go to sync this, how bad is it
going to
357 commits in like a month, right?
Okay.
We're going to have the before and after
We're going to have the before and after
at the very least.
at the very least.
As closely as we could possibly have it,
As closely as we could possibly have it,
we'll have the before and after.
Seven minutes is not too bad of a not
Seven minutes is not too bad of a not
ideal for dev loop, What?
So, six hearts, right?
So, six hearts, right?
Basically what we get is parts.
I'm going to have to reapply this umpire
I'm going to have to reapply this umpire
gymnasium fires.
going to remove the ones that I know I
going to remove the ones that I know I
already have.
I have like everything way too
I have like everything way too
aggressively pinned, I think.
That's my bad
being weird.
Know how it always corrupts the first
Know how it always corrupts the first
character.
And everything's moving around again.
And everything's moving around again.
Hey,
Okay, I remember at least what they did
Okay, I remember at least what they did
here.
Huh?
Huh?
Wait, what?
Wait, what?
Why is this inside packages?
Oh, I know. That's fine.
What the heck is all this?
What the heck is all this?
Configuration changes, I suppose.
Go see what their new config This
comment on why you think writing D is
comment on why you think writing D is
better than Jacks.
better than Jacks.
X is quite simple.
X is quite simple.
So here's why. Um you have to express
So here's why. Um you have to express
all of your logic in terms of array
all of your logic in terms of array
operation,
operation,
right? You're not you're really not
right? You're not you're really not
writing Python. You're writing a domain
writing Python. You're writing a domain
specific language. it's forcing you to
specific language. it's forcing you to
express all operations terms of arrays.
express all operations terms of arrays.
So
So
you can't really just write like
you can't really just write like
arbitrary branching logic like you would
arbitrary branching logic like you would
like to be able to. You can sort of
like to be able to. You can sort of
force it into that if you really want
force it into that if you really want
to. Uh and then that gets to be slow
to. Uh and then that gets to be slow
because the GPU has to execute all
because the GPU has to execute all
parallel branches
parallel branches
and then you have to be very clever to
and then you have to be very clever to
work around that to reduce the number of
work around that to reduce the number of
parallel branches.
parallel branches.
to do so is essentially to solve a
to do so is essentially to solve a
massive puzzle because this is not
massive puzzle because this is not
general programming. Like you're no
general programming. Like you're no
longer really doing general programming
longer really doing general programming
anymore.
anymore.
And what do you gain from doing this,
And what do you gain from doing this,
right? Okay, your end can run on the
right? Okay, your end can run on the
GPU. Why did you want to run your env on
GPU. Why did you want to run your env on
the GPU? It was because it was slow. Why
the GPU? It was because it was slow. Why
was it slow? It was slow because it was
was it slow? It was slow because it was
originally in horribly unoptimized
originally in horribly unoptimized
Python. So what we do instead, right, is
Python. So what we do instead, right, is
we just write really, really basic C.
we just write really, really basic C.
It's much much easier than writing in
It's much much easier than writing in
jacks because just write arbitrary
jacks because just write arbitrary
logic, right? No restrictions on
logic, right? No restrictions on
branching or conditionals or anything
branching or conditionals or anything
like that or like restrictions on having
like that or like restrictions on having
to use a large number of ends for the
to use a large number of ends for the
GPU to be efficient. Don't have any of
GPU to be efficient. Don't have any of
those sorts of restrictions and we can
those sorts of restrictions and we can
just write whatever we want.
But like okay so even if you can
But like okay so even if you can
technically express your thing in arrays
technically express your thing in arrays
with enough work why would you want to
with enough work why would you want to
do that?
The only use case really is if you are
The only use case really is if you are
doing heavy physics sim and writing some
doing heavy physics sim and writing some
sort of like tensorbased engine fine
sort of like tensorbased engine fine
right but if you're doing anything else
right but if you're doing anything else
like why would you want to have to write
like why would you want to have to write
everything in array operations versus
everything in array operations versus
just being able to write arbitrary logic
just being able to write arbitrary logic
the only answer I can come up with is
the only answer I can come up with is
because researchers are allergic to
because researchers are allergic to
writing anything that's not Python even
writing anything that's not Python even
though really Jax is not Python it's a
though really Jax is not Python it's a
direct it's a domain specific language
direct it's a domain specific language
that happens to have Pythones syntax but
that happens to have Pythones syntax but
it's really something quite
It gets way way way harder for no real
It gets way way way harder for no real
reason than just writing some basic C
obs and actions are arrays. They're
obs and actions are arrays. They're
tabular.
Yeah. Well, wouldn't you like to be able
Yeah. Well, wouldn't you like to be able
to write arbitrary logic, though?
I mean, so Neural MMO 3, for instance,
I mean, so Neural MMO 3, for instance,
is
is
like that thing runs a million and a
like that thing runs a million and a
half steps per second. It's a full It's
half steps per second. It's a full It's
a miniature MMO game, right?
a miniature MMO game, right?
Million and a half steps per second on
Million and a half steps per second on
one CPU core without us having to do any
one CPU core without us having to do any
weird array operations.
weird array operations.
Even though, yeah, we have all sorts of
Even though, yeah, we have all sorts of
like array like data structures in
like array like data structures in
there, right? But it's not all arrays.
there, right? But it's not all arrays.
there's also branching logic and stuff
there's also branching logic and stuff
on top of it.
on top of it.
You just never have to deal with it.
You just never have to deal with it.
You're just if you're using an actual
You're just if you're using an actual
programming language, right? If you're
programming language, right? If you're
actually like writing something in
actually like writing something in
that's something that is a full
that's something that is a full
programming language that's not a domain
programming language that's not a domain
specific language,
specific language,
just have it work.
Look, there are totally people that are
Look, there are totally people that are
like, "Oh yeah, we're smart. We can make
like, "Oh yeah, we're smart. We can make
it work in Jax." And that's cool, but
it work in Jax." And that's cool, but
like could also just use a full
like could also just use a full
programming language and also have it
programming language and also have it
work and also have spare time.
work and also have spare time.
It just be much much less painful.
Yeah, exactly right.
Yeah, exactly right.
Like it's literally the reason that
Like it's literally the reason that
people do this because they're allergic
people do this because they're allergic
to not writing Python. There's no other
to not writing Python. There's no other
reason.
It's really not though because I have
It's really not though because I have
brand new programmers doing this.
brand new programmers doing this.
Like if you look at this the code that
Like if you look at this the code that
we've written, it's like first course in
we've written, it's like first course in
systems level C. like a freshman
systems level C. like a freshman
undergrad who's taken their first
undergrad who's taken their first
systems do this
like frankly writing jacks it's way
like frankly writing jacks it's way
harder like what you're forcing yourself
harder like what you're forcing yourself
to do by writing M's and jacks is way
to do by writing M's and jacks is way
way harder than just writing some
way harder than just writing some
low-level code
like once you actually write some stuff
like once you actually write some stuff
in like just start doing a little bit of
in like just start doing a little bit of
low-level dev in this it's you'll see
low-level dev in this it's you'll see
the difference like oh yeah that's
the difference like oh yeah that's
insane
Yeah, sure thing.
isn't that bad when you have a template
isn't that bad when you have a template
to start from.
to start from.
Yeah.
Well, honestly, the worst thing about
Well, honestly, the worst thing about
the C is like the bindings to Python
the C is like the bindings to Python
because that API sucks,
because that API sucks,
but we kind of have like that's just
but we kind of have like that's just
taken for care of for you. And if you
taken for care of for you. And if you
really want to know how it works, like
really want to know how it works, like
you have one file to read that's it's
you have one file to read that's it's
like several hundred lines, but it's not
like several hundred lines, but it's not
gigantic, right?
gigantic, right?
It's mostly just a bunch of Python CAPI
It's mostly just a bunch of Python CAPI
glue.
glue.
It's nothing like
It's nothing like
It's really nothing that Is he?
Yeah,
you do need to understand pointers
you do need to understand pointers
because otherwise
because otherwise
I mean not teaching pointers is kind of
I mean not teaching pointers is kind of
just as much of a problem because then
just as much of a problem because then
like all the strs are copy on pass.
like all the strs are copy on pass.
So um like everything is immutable
So um like everything is immutable
essentially which is not a good thing.
you write like immutable C, you're going
you write like immutable C, you're going
to lose a lot of the performance benefit
to lose a lot of the performance benefit
of writing C.
It's like a like a very like functional
It's like a like a very like functional
thing. Not a good idea.
A tiny grad.
Well, it's not faster um on Nvidia
Well, it's not faster um on Nvidia
hardware and won't be for a while,
hardware and won't be for a while,
right?
like it's slower on Nvidia hardware like
like it's slower on Nvidia hardware like
because it's still early. They're mostly
because it's still early. They're mostly
doing alternative hardware at the
doing alternative hardware at the
moment.
moment.
If you have Nvidia hardware, it's like
If you have Nvidia hardware, it's like
kind of too early to adopt any like to
kind of too early to adopt any like to
look at adopting yet. It's a cool
look at adopting yet. It's a cool
project.
That's This
when will we see ML move to the true
when will we see ML move to the true
best language? Rust. Yeah, I hate Rust.
best language? Rust. Yeah, I hate Rust.
I do not enjoy Rust one bit, man.
Okay, here's the here's the thing with
Okay, here's the here's the thing with
Rust, right?
Rust, right?
The whole freaking language is designed
The whole freaking language is designed
around this borrow checker which makes
around this borrow checker which makes
you structure all your code differently
you structure all your code differently
from every other language. What is the
from every other language. What is the
point of this? You avoid one class of
point of this? You avoid one class of
error, right? You avoid memory leaks.
error, right? You avoid memory leaks.
Basically, you avoid one class of error
Basically, you avoid one class of error
that was never a problem in the first
that was never a problem in the first
place.
place.
So, no, piss off Rust.
So, no, piss off Rust.
[Music]
God,
God,
look, C has its problems, but it's
look, C has its problems, but it's
Rust leaves those problems in and then
Rust leaves those problems in and then
freaking makes its own problems. That
freaking makes its own problems. That
ain't the fix.
ain't the fix.
That just ain't it.
just to avoid memory leaks. I mean,
just to avoid memory leaks. I mean,
look, there probably some other bugs, I
look, there probably some other bugs, I
guess, that you can catch, but like
guess, that you can catch, but like
fundamentally,
fundamentally,
I think that most of the things that
I think that most of the things that
you're trying to do at a language level
you're trying to do at a language level
are just done better as debug compile
are just done better as debug compile
options. Um, like mem leaks aren't
options. Um, like mem leaks aren't
really a problem. Typically, it's out of
really a problem. Typically, it's out of
bounds writes and reads on arrays is the
bounds writes and reads on arrays is the
biggest one, but like can just use an
biggest one, but like can just use an
address sanitizer. Like the address
address sanitizer. Like the address
sanitizer kind of fixes all the problems
sanitizer kind of fixes all the problems
that force the user to write different
that force the user to write different
code in order to attempt to solve with
code in order to attempt to solve with
Rust.
Like how do you make Rust fast anyways?
Like how do you make Rust fast anyways?
You immediately start writing unsafe.
You immediately start writing unsafe.
Anyways,
look, it's it's like fine if you're
look, it's it's like fine if you're
doing embedded systems dev where you're
doing embedded systems dev where you're
really worried about these specific
really worried about these specific
classes of errors. Stuff is really
classes of errors. Stuff is really
fiddly, but like it's being massively
fiddly, but like it's being massively
overused.
He is just like so easy
He is just like so easy
is just like it's just so easy.
Hey, welcome boxing.
How you going to be on stream for today?
How you going to be on stream for today?
No idea.
No idea.
Probably until I figure out environment
Probably until I figure out environment
plus a few other things.
Oops. Actually,
I just saw
it actually might not be a bad time for
it actually might not be a bad time for
me to go take a couple meetings. I have
me to go take a couple meetings. I have
a bunch of messages. I'm mostly going to
a bunch of messages. I'm mostly going to
be waiting for uh the meta guys to reply
be waiting for uh the meta guys to reply
on like where they've moved everything.
This checking out your PO implementation
This checking out your PO implementation
modification.
modification.
I've checked
I've checked
are what
implement differences are the advantage
implement differences are the advantage
parameter sweeps.
parameter sweeps.
So it is
So it is
muon is a big one. Trajectory level uh
muon is a big one. Trajectory level uh
trajectory segment level advantage
trajectory segment level advantage
filtering with prioritized experience
filtering with prioritized experience
replay is another one. Uh the new
replay is another one. Uh the new
advantage filter uh the new advantage
advantage filter uh the new advantage
function is another one.
function is another one.
Sure I missed a couple but the rest it's
Sure I missed a couple but the rest it's
like all in the blog post on X as well.
like all in the blog post on X as well.
discuss papers
discuss papers
late. So
around six hours
you should get more than six hours of
you should get more than six hours of
sleep in I would highly suggest that uh
sleep in I would highly suggest that uh
I the six hours is
I the six hours is
like 8ish maybe can just if you message
like 8ish maybe can just if you message
me later in the evening uh I might still
me later in the evening uh I might still
be around. It depends. cuz I got to go
be around. It depends. cuz I got to go
to sleep early tonight, though, cuz I
to sleep early tonight, though, cuz I
got to get up early for uh SF trips.
got to get up early for uh SF trips.
Long day. All right. Well, get some
Long day. All right. Well, get some
rest, man.
rest, man.
I got to go take this meeting. So, the
I got to go take this meeting. So, the
folks who've uh been tuning in, I will
folks who've uh been tuning in, I will
probably be back afterwards once I
probably be back afterwards once I
finish this and then the meta guys reply
finish this and then the meta guys reply
and tell me where they've moved all the
and tell me where they've moved all the
stuff around to. We'll probably be
stuff around to. We'll probably be
working on getting this end of training
working on getting this end of training
nicely with their new code. Um, for
nicely with their new code. Um, for
anyone who's new here, I stream all my
anyone who's new here, I stream all my
research. Sometimes we do fiddly
research. Sometimes we do fiddly
optimization stuff like you've seen.
optimization stuff like you've seen.
Sometimes we make drones fly in sim in
Sometimes we make drones fly in sim in
really cool ways. I just stream all the
really cool ways. I just stream all the
dev. Interested in my work more
dev. Interested in my work more
generally at puffer.ai.
generally at puffer.ai.
Help me out for free by starting the
Help me out for free by starting the
repo. We're almost at 3k stars. Want to
repo. We're almost at 3k stars. Want to
get involved with dev? Join the Discord.
get involved with dev? Join the Discord.
We've had a huge number of people join
We've had a huge number of people join
this in the past couple of weeks. And
this in the past couple of weeks. And
yeah, you can follow me on X for all
yeah, you can follow me on X for all
those resources.
those resources.
Thanks and I will see you around.
